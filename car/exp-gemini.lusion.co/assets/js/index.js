!function e(t,n,r){function i(o,s){if(!n[o]){if(!t[o]){var l="function"==typeof require&&require;if(!s&&l)return l(o,!0);if(a)return a(o,!0);var u=new Error("Cannot find module '"+o+"'");throw u.code="MODULE_NOT_FOUND",u}var c=n[o]={exports:{}};t[o][0].call(c.exports,(function(e){return i(t[o][1][e]||e)}),c,c.exports,e,t,n,r)}return n[o].exports}for(var a="function"==typeof require&&require,o=0;o<r.length;o++)i(r[o]);return i}({1:[function(e,t,n){"use strict";t.exports=function(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r},t.exports.__esModule=!0,t.exports.default=t.exports},{}],2:[function(e,t,n){"use strict";t.exports=function(e){if(Array.isArray(e))return e},t.exports.__esModule=!0,t.exports.default=t.exports},{}],3:[function(e,t,n){"use strict";var r=e("./arrayLikeToArray.js");t.exports=function(e){if(Array.isArray(e))return r(e)},t.exports.__esModule=!0,t.exports.default=t.exports},{"./arrayLikeToArray.js":1}],4:[function(e,t,n){"use strict";t.exports=function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e},t.exports.__esModule=!0,t.exports.default=t.exports},{}],5:[function(e,t,n){"use strict";function r(e,t,n,r,i,a,o){try{var s=e[a](o),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(r,i)}t.exports=function(e){return function(){var t=this,n=arguments;return new Promise((function(i,a){var o=e.apply(t,n);function s(e){r(o,i,a,s,l,"next",e)}function l(e){r(o,i,a,s,l,"throw",e)}s(void 0)}))}},t.exports.__esModule=!0,t.exports.default=t.exports},{}],6:[function(e,t,n){"use strict";t.exports=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},t.exports.__esModule=!0,t.exports.default=t.exports},{}],7:[function(e,t,n){"use strict";function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}t.exports=function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e},t.exports.__esModule=!0,t.exports.default=t.exports},{}],8:[function(e,t,n){"use strict";t.exports=function(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e},t.exports.__esModule=!0,t.exports.default=t.exports},{}],9:[function(e,t,n){"use strict";var r=e("./superPropBase.js");function i(){return"undefined"!=typeof Reflect&&Reflect.get?(t.exports=i=Reflect.get,t.exports.__esModule=!0,t.exports.default=t.exports):(t.exports=i=function(e,t,n){var i=r(e,t);if(i){var a=Object.getOwnPropertyDescriptor(i,t);return a.get?a.get.call(arguments.length<3?e:n):a.value}},t.exports.__esModule=!0,t.exports.default=t.exports),i.apply(this,arguments)}t.exports=i,t.exports.__esModule=!0,t.exports.default=t.exports},{"./superPropBase.js":20}],10:[function(e,t,n){"use strict";function r(e){return t.exports=r=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},t.exports.__esModule=!0,t.exports.default=t.exports,r(e)}t.exports=r,t.exports.__esModule=!0,t.exports.default=t.exports},{}],11:[function(e,t,n){"use strict";var r=e("./setPrototypeOf.js");t.exports=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&r(e,t)},t.exports.__esModule=!0,t.exports.default=t.exports},{"./setPrototypeOf.js":18}],12:[function(e,t,n){"use strict";t.exports=function(e){return e&&e.__esModule?e:{default:e}},t.exports.__esModule=!0,t.exports.default=t.exports},{}],13:[function(e,t,n){"use strict";t.exports=function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)},t.exports.__esModule=!0,t.exports.default=t.exports},{}],14:[function(e,t,n){"use strict";t.exports=function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,i,a=[],o=!0,s=!1;try{for(n=n.call(e);!(o=(r=n.next()).done)&&(a.push(r.value),!t||a.length!==t);o=!0);}catch(e){s=!0,i=e}finally{try{o||null==n.return||n.return()}finally{if(s)throw i}}return a}},t.exports.__esModule=!0,t.exports.default=t.exports},{}],15:[function(e,t,n){"use strict";t.exports=function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")},t.exports.__esModule=!0,t.exports.default=t.exports},{}],16:[function(e,t,n){"use strict";t.exports=function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")},t.exports.__esModule=!0,t.exports.default=t.exports},{}],17:[function(e,t,n){"use strict";var r=e("./typeof.js").default,i=e("./assertThisInitialized.js");t.exports=function(e,t){if(t&&("object"===r(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return i(e)},t.exports.__esModule=!0,t.exports.default=t.exports},{"./assertThisInitialized.js":4,"./typeof.js":22}],18:[function(e,t,n){"use strict";function r(e,n){return t.exports=r=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},t.exports.__esModule=!0,t.exports.default=t.exports,r(e,n)}t.exports=r,t.exports.__esModule=!0,t.exports.default=t.exports},{}],19:[function(e,t,n){"use strict";var r=e("./arrayWithHoles.js"),i=e("./iterableToArrayLimit.js"),a=e("./unsupportedIterableToArray.js"),o=e("./nonIterableRest.js");t.exports=function(e,t){return r(e)||i(e,t)||a(e,t)||o()},t.exports.__esModule=!0,t.exports.default=t.exports},{"./arrayWithHoles.js":2,"./iterableToArrayLimit.js":14,"./nonIterableRest.js":15,"./unsupportedIterableToArray.js":23}],20:[function(e,t,n){"use strict";var r=e("./getPrototypeOf.js");t.exports=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=r(e)););return e},t.exports.__esModule=!0,t.exports.default=t.exports},{"./getPrototypeOf.js":10}],21:[function(e,t,n){"use strict";var r=e("./arrayWithoutHoles.js"),i=e("./iterableToArray.js"),a=e("./unsupportedIterableToArray.js"),o=e("./nonIterableSpread.js");t.exports=function(e){return r(e)||i(e)||a(e)||o()},t.exports.__esModule=!0,t.exports.default=t.exports},{"./arrayWithoutHoles.js":3,"./iterableToArray.js":13,"./nonIterableSpread.js":16,"./unsupportedIterableToArray.js":23}],22:[function(e,t,n){"use strict";function r(e){return t.exports=r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},t.exports.__esModule=!0,t.exports.default=t.exports,r(e)}t.exports=r,t.exports.__esModule=!0,t.exports.default=t.exports},{}],23:[function(e,t,n){"use strict";var r=e("./arrayLikeToArray.js");t.exports=function(e,t){if(e){if("string"==typeof e)return r(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?r(e,t):void 0}},t.exports.__esModule=!0,t.exports.default=t.exports},{"./arrayLikeToArray.js":1}],24:[function(e,t,n){"use strict";t.exports=e("regenerator-runtime")},{"regenerator-runtime":62}],25:[function(e,t,n){"use strict";t.exports=function(e,t,n,r){if(r=(n=window.getComputedStyle)?n(e):e.currentStyle)return r[t.replace(/-(\w)/gi,(function(e,t){return t.toUpperCase()}))]}},{}],26:[function(e,t,n){"use strict";t.exports=function(e){"string"==typeof e&&(e=[e]);for(var t=[].slice.call(arguments,1),n=[],r=0;r<e.length-1;r++)n.push(e[r],t[r]||"");return n.push(e[r]),n.join("")}},{}],27:[function(e,t,n){"use strict";var r,i,a=e("@babel/runtime/helpers/interopRequireDefault")(e("@babel/runtime/helpers/typeof"));r=void 0,i=function(e){function t(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e.__proto__=t}function n(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}
/*!
   * GSAP 3.10.4
   * https://greensock.com
   *
   * @license Copyright 2008-2022, GreenSock. All rights reserved.
   * Subject to the terms at https://greensock.com/standard-license or for
   * Club GreenSock members, the agreement issued with that membership.
   * @author: Jack Doyle, jack@greensock.com
  */var r,i,o,s,l,u,c,h,d,f,p,v,m,g,_,y,x,b,w,T,M,S,E,A,L,C,R,k,P={autoSleep:120,force3D:"auto",nullTargetWarn:1,units:{lineHeight:""}},D={duration:.5,overwrite:!1,delay:0},I=1e8,O=1e-8,F=2*Math.PI,N=F/4,U=0,B=Math.sqrt,z=Math.cos,H=Math.sin,G=function(e){return"string"==typeof e},V=function(e){return"function"==typeof e},W=function(e){return"number"==typeof e},j=function(e){return void 0===e},q=function(e){return"object"===(0,a.default)(e)},X=function(e){return!1!==e},Y=function(){return"undefined"!=typeof window},K=function(e){return V(e)||G(e)},Z="function"==typeof ArrayBuffer&&ArrayBuffer.isView||function(){},J=Array.isArray,Q=/(?:-?\.?\d|\.)+/gi,$=/[-+=.]*\d+[.e\-+]*\d*[e\-+]*\d*/g,ee=/[-+=.]*\d+[.e-]*\d*[a-z%]*/g,te=/[-+=.]*\d+\.?\d*(?:e-|e\+)?\d*/gi,ne=/[+-]=-?[.\d]+/,re=/[^,'"\[\]\s]+/gi,ie=/^[+\-=e\s\d]*\d+[.\d]*([a-z]*|%)\s*$/i,ae={},oe={},se=function(e){return(oe=De(e,ae))&&Mn},le=function(e,t){return console.warn("Invalid property",e,"set to",t,"Missing plugin? gsap.registerPlugin()")},ue=function(e,t){return!t&&console.warn(e)},ce=function(e,t){return e&&(ae[e]=t)&&oe&&(oe[e]=t)||ae},he=function(){return 0},de={},fe=[],pe={},ve={},me={},ge=30,_e=[],ye="",xe=function(e){var t,n,r=e[0];if(q(r)||V(r)||(e=[e]),!(t=(r._gsap||{}).harness)){for(n=_e.length;n--&&!_e[n].targetTest(r););t=_e[n]}for(n=e.length;n--;)e[n]&&(e[n]._gsap||(e[n]._gsap=new qt(e[n],t)))||e.splice(n,1);return e},be=function(e){return e._gsap||xe(ht(e))[0]._gsap},we=function(e,t,n){return(n=e[t])&&V(n)?e[t]():j(n)&&e.getAttribute&&e.getAttribute(t)||n},Te=function(e,t){return(e=e.split(",")).forEach(t)||e},Me=function(e){return Math.round(1e5*e)/1e5||0},Se=function(e){return Math.round(1e7*e)/1e7||0},Ee=function(e,t){var n=t.charAt(0),r=parseFloat(t.substr(2));return e=parseFloat(e),"+"===n?e+r:"-"===n?e-r:"*"===n?e*r:e/r},Ae=function(e,t){for(var n=t.length,r=0;e.indexOf(t[r])<0&&++r<n;);return r<n},Le=function(){var e,t,n=fe.length,r=fe.slice(0);for(pe={},fe.length=0,e=0;e<n;e++)(t=r[e])&&t._lazy&&(t.render(t._lazy[0],t._lazy[1],!0)._lazy=0)},Ce=function(e,t,n,r){fe.length&&Le(),e.render(t,n,r),fe.length&&Le()},Re=function(e){var t=parseFloat(e);return(t||0===t)&&(e+"").match(re).length<2?t:G(e)?e.trim():e},ke=function(e){return e},Pe=function(e,t){for(var n in t)n in e||(e[n]=t[n]);return e},De=function(e,t){for(var n in t)e[n]=t[n];return e},Ie=function e(t,n){for(var r in n)"__proto__"!==r&&"constructor"!==r&&"prototype"!==r&&(t[r]=q(n[r])?e(t[r]||(t[r]={}),n[r]):n[r]);return t},Oe=function(e,t){var n,r={};for(n in e)n in t||(r[n]=e[n]);return r},Fe=function(e){var t,n=e.parent||i,r=e.keyframes?(t=J(e.keyframes),function(e,n){for(var r in n)r in e||"duration"===r&&t||"ease"===r||(e[r]=n[r])}):Pe;if(X(e.inherit))for(;n;)r(e,n.vars.defaults),n=n.parent||n._dp;return e},Ne=function(e,t,n,r,i){void 0===n&&(n="_first"),void 0===r&&(r="_last");var a,o=e[r];if(i)for(a=t[i];o&&o[i]>a;)o=o._prev;return o?(t._next=o._next,o._next=t):(t._next=e[n],e[n]=t),t._next?t._next._prev=t:e[r]=t,t._prev=o,t.parent=t._dp=e,t},Ue=function(e,t,n,r){void 0===n&&(n="_first"),void 0===r&&(r="_last");var i=t._prev,a=t._next;i?i._next=a:e[n]===t&&(e[n]=a),a?a._prev=i:e[r]===t&&(e[r]=i),t._next=t._prev=t.parent=null},Be=function(e,t){e.parent&&(!t||e.parent.autoRemoveChildren)&&e.parent.remove(e),e._act=0},ze=function(e,t){if(e&&(!t||t._end>e._dur||t._start<0))for(var n=e;n;)n._dirty=1,n=n.parent;return e},He=function(e){for(var t=e.parent;t&&t.parent;)t._dirty=1,t.totalDuration(),t=t.parent;return e},Ge=function e(t){return!t||t._ts&&e(t.parent)},Ve=function(e){return e._repeat?We(e._tTime,e=e.duration()+e._rDelay)*e:0},We=function(e,t){var n=Math.floor(e/=t);return e&&n===e?n-1:n},je=function(e,t){return(e-t._start)*t._ts+(t._ts>=0?0:t._dirty?t.totalDuration():t._tDur)},qe=function(e){return e._end=Se(e._start+(e._tDur/Math.abs(e._ts||e._rts||O)||0))},Xe=function(e,t){var n=e._dp;return n&&n.smoothChildTiming&&e._ts&&(e._start=Se(n._time-(e._ts>0?t/e._ts:((e._dirty?e.totalDuration():e._tDur)-t)/-e._ts)),qe(e),n._dirty||ze(n,e)),e},Ye=function(e,t){var n;if((t._time||t._initted&&!t._dur)&&(n=je(e.rawTime(),t),(!t._dur||ot(0,t.totalDuration(),n)-t._tTime>O)&&t.render(n,!0)),ze(e,t)._dp&&e._initted&&e._time>=e._dur&&e._ts){if(e._dur<e.duration())for(n=e;n._dp;)n.rawTime()>=0&&n.totalTime(n._tTime),n=n._dp;e._zTime=-1e-8}},Ke=function(e,t,n,r){return t.parent&&Be(t),t._start=Se((W(n)?n:n||e!==i?rt(e,n,t):e._time)+t._delay),t._end=Se(t._start+(t.totalDuration()/Math.abs(t.timeScale())||0)),Ne(e,t,"_first","_last",e._sort?"_start":0),$e(t)||(e._recent=t),r||Ye(e,t),e},Ze=function(e,t){return(ae.ScrollTrigger||le("scrollTrigger",t))&&ae.ScrollTrigger.create(t,e)},Je=function(e,t,n,r){return en(e,t),e._initted?!n&&e._pt&&(e._dur&&!1!==e.vars.lazy||!e._dur&&e.vars.lazy)&&c!==Dt.frame?(fe.push(e),e._lazy=[t,r],1):void 0:1},Qe=function e(t){var n=t.parent;return n&&n._ts&&n._initted&&!n._lock&&(n.rawTime()<0||e(n))},$e=function(e){var t=e.data;return"isFromStart"===t||"isStart"===t},et=function(e,t,n,r){var i=e._repeat,a=Se(t)||0,o=e._tTime/e._tDur;return o&&!r&&(e._time*=a/e._dur),e._dur=a,e._tDur=i?i<0?1e10:Se(a*(i+1)+e._rDelay*i):a,o>0&&!r?Xe(e,e._tTime=e._tDur*o):e.parent&&qe(e),n||ze(e.parent,e),e},tt=function(e){return e instanceof Yt?ze(e):et(e,e._dur)},nt={_start:0,endTime:he,totalDuration:he},rt=function e(t,n,r){var i,a,o,s=t.labels,l=t._recent||nt,u=t.duration()>=I?l.endTime(!1):t._dur;return G(n)&&(isNaN(n)||n in s)?(a=n.charAt(0),o="%"===n.substr(-1),i=n.indexOf("="),"<"===a||">"===a?(i>=0&&(n=n.replace(/=/,"")),("<"===a?l._start:l.endTime(l._repeat>=0))+(parseFloat(n.substr(1))||0)*(o?(i<0?l:r).totalDuration()/100:1)):i<0?(n in s||(s[n]=u),s[n]):(a=parseFloat(n.charAt(i-1)+n.substr(i+1)),o&&r&&(a=a/100*(J(r)?r[0]:r).totalDuration()),i>1?e(t,n.substr(0,i-1),r)+a:u+a)):null==n?u:+n},it=function(e,t,n){var r,i,a=W(t[1]),o=(a?2:1)+(e<2?0:1),s=t[o];if(a&&(s.duration=t[1]),s.parent=n,e){for(r=s,i=n;i&&!("immediateRender"in r);)r=i.vars.defaults||{},i=X(i.vars.inherit)&&i.parent;s.immediateRender=X(r.immediateRender),e<2?s.runBackwards=1:s.startAt=t[o-1]}return new on(t[0],s,t[o+1])},at=function(e,t){return e||0===e?t(e):t},ot=function(e,t,n){return n<e?e:n>t?t:n},st=function(e,t){return G(e)&&(t=ie.exec(e))?t[1]:""},lt=[].slice,ut=function(e,t){return e&&q(e)&&"length"in e&&(!t&&!e.length||e.length-1 in e&&q(e[0]))&&!e.nodeType&&e!==o},ct=function(e,t,n){return void 0===n&&(n=[]),e.forEach((function(e){var r;return G(e)&&!t||ut(e,1)?(r=n).push.apply(r,ht(e)):n.push(e)}))||n},ht=function(e,t,n){return!G(e)||n||!s&&It()?J(e)?ct(e,n):ut(e)?lt.call(e,0):e?[e]:[]:lt.call((t||l).querySelectorAll(e),0)},dt=function(e){return e.sort((function(){return.5-Math.random()}))},ft=function(e){if(V(e))return e;var t=q(e)?e:{each:e},n=Ht(t.ease),r=t.from||0,i=parseFloat(t.base)||0,a={},o=r>0&&r<1,s=isNaN(r)||o,l=t.axis,u=r,c=r;return G(r)?u=c={center:.5,edges:.5,end:1}[r]||0:!o&&s&&(u=r[0],c=r[1]),function(e,o,h){var d,f,p,v,m,g,_,y,x,b=(h||t).length,w=a[b];if(!w){if(!(x="auto"===t.grid?0:(t.grid||[1,I])[1])){for(_=-I;_<(_=h[x++].getBoundingClientRect().left)&&x<b;);x--}for(w=a[b]=[],d=s?Math.min(x,b)*u-.5:r%x,f=x===I?0:s?b*c/x-.5:r/x|0,_=0,y=I,g=0;g<b;g++)p=g%x-d,v=f-(g/x|0),w[g]=m=l?Math.abs("y"===l?v:p):B(p*p+v*v),m>_&&(_=m),m<y&&(y=m);"random"===r&&dt(w),w.max=_-y,w.min=y,w.v=b=(parseFloat(t.amount)||parseFloat(t.each)*(x>b?b-1:l?"y"===l?b/x:x:Math.max(x,b/x))||0)*("edges"===r?-1:1),w.b=b<0?i-b:i,w.u=st(t.amount||t.each)||0,n=n&&b<0?Bt(n):n}return b=(w[e]-w.min)/w.max||0,Se(w.b+(n?n(b):b)*w.v)+w.u}},pt=function(e){var t=Math.pow(10,((e+"").split(".")[1]||"").length);return function(n){var r=Math.round(parseFloat(n)/e)*e*t;return(r-r%1)/t+(W(n)?0:st(n))}},vt=function(e,t){var n,r,i=J(e);return!i&&q(e)&&(n=i=e.radius||I,e.values?(e=ht(e.values),(r=!W(e[0]))&&(n*=n)):e=pt(e.increment)),at(t,i?V(e)?function(t){return r=e(t),Math.abs(r-t)<=n?r:t}:function(t){for(var i,a,o=parseFloat(r?t.x:t),s=parseFloat(r?t.y:0),l=I,u=0,c=e.length;c--;)(i=r?(i=e[c].x-o)*i+(a=e[c].y-s)*a:Math.abs(e[c]-o))<l&&(l=i,u=c);return u=!n||l<=n?e[u]:t,r||u===t||W(t)?u:u+st(t)}:pt(e))},mt=function(e,t,n,r){return at(J(e)?!t:!0===n?!!(n=0):!r,(function(){return J(e)?e[~~(Math.random()*e.length)]:(n=n||1e-5)&&(r=n<1?Math.pow(10,(n+"").length-2):1)&&Math.floor(Math.round((e-n/2+Math.random()*(t-e+.99*n))/n)*n*r)/r}))},gt=function(e,t,n){return at(n,(function(n){return e[~~t(n)]}))},_t=function(e){for(var t,n,r,i,a=0,o="";~(t=e.indexOf("random(",a));)r=e.indexOf(")",t),i="["===e.charAt(t+7),n=e.substr(t+7,r-t-7).match(i?re:Q),o+=e.substr(a,t-a)+mt(i?n:+n[0],i?0:+n[1],+n[2]||1e-5),a=r+1;return o+e.substr(a,e.length-a)},yt=function(e,t,n,r,i){var a=t-e,o=r-n;return at(i,(function(t){return n+((t-e)/a*o||0)}))},xt=function(e,t,n){var r,i,a,o=e.labels,s=I;for(r in o)(i=o[r]-t)<0==!!n&&i&&s>(i=Math.abs(i))&&(a=r,s=i);return a},bt=function(e,t,n){var r,i,a=e.vars,o=a[t];if(o)return r=a[t+"Params"],i=a.callbackScope||e,n&&fe.length&&Le(),r?o.apply(i,r):o.call(i)},wt=function(e){return Be(e),e.scrollTrigger&&e.scrollTrigger.kill(!1),e.progress()<1&&bt(e,"onInterrupt"),e},Tt=function(e){var t=(e=!e.name&&e.default||e).name,n=V(e),r=t&&!n&&e.init?function(){this._props=[]}:e,i={init:he,render:vn,add:Qt,kill:gn,modifier:mn,rawVars:0},a={targetTest:0,get:0,getSetter:hn,aliases:{},register:0};if(It(),e!==r){if(ve[t])return;Pe(r,Pe(Oe(e,i),a)),De(r.prototype,De(i,Oe(e,a))),ve[r.prop=t]=r,e.targetTest&&(_e.push(r),de[t]=1),t=("css"===t?"CSS":t.charAt(0).toUpperCase()+t.substr(1))+"Plugin"}ce(t,r),e.register&&e.register(Mn,r,xn)},Mt=255,St={aqua:[0,Mt,Mt],lime:[0,Mt,0],silver:[192,192,192],black:[0,0,0],maroon:[128,0,0],teal:[0,128,128],blue:[0,0,Mt],navy:[0,0,128],white:[Mt,Mt,Mt],olive:[128,128,0],yellow:[Mt,Mt,0],orange:[Mt,165,0],gray:[128,128,128],purple:[128,0,128],green:[0,128,0],red:[Mt,0,0],pink:[Mt,192,203],cyan:[0,Mt,Mt],transparent:[Mt,Mt,Mt,0]},Et=function(e,t,n){return(6*(e+=e<0?1:e>1?-1:0)<1?t+(n-t)*e*6:e<.5?n:3*e<2?t+(n-t)*(2/3-e)*6:t)*Mt+.5|0},At=function(e,t,n){var r,i,a,o,s,l,u,c,h,d,f=e?W(e)?[e>>16,e>>8&Mt,e&Mt]:0:St.black;if(!f){if(","===e.substr(-1)&&(e=e.substr(0,e.length-1)),St[e])f=St[e];else if("#"===e.charAt(0)){if(e.length<6&&(r=e.charAt(1),i=e.charAt(2),a=e.charAt(3),e="#"+r+r+i+i+a+a+(5===e.length?e.charAt(4)+e.charAt(4):"")),9===e.length)return[(f=parseInt(e.substr(1,6),16))>>16,f>>8&Mt,f&Mt,parseInt(e.substr(7),16)/255];f=[(e=parseInt(e.substr(1),16))>>16,e>>8&Mt,e&Mt]}else if("hsl"===e.substr(0,3))if(f=d=e.match(Q),t){if(~e.indexOf("="))return f=e.match($),n&&f.length<4&&(f[3]=1),f}else o=+f[0]%360/360,s=+f[1]/100,r=2*(l=+f[2]/100)-(i=l<=.5?l*(s+1):l+s-l*s),f.length>3&&(f[3]*=1),f[0]=Et(o+1/3,r,i),f[1]=Et(o,r,i),f[2]=Et(o-1/3,r,i);else f=e.match(Q)||St.transparent;f=f.map(Number)}return t&&!d&&(r=f[0]/Mt,i=f[1]/Mt,a=f[2]/Mt,l=((u=Math.max(r,i,a))+(c=Math.min(r,i,a)))/2,u===c?o=s=0:(h=u-c,s=l>.5?h/(2-u-c):h/(u+c),o=u===r?(i-a)/h+(i<a?6:0):u===i?(a-r)/h+2:(r-i)/h+4,o*=60),f[0]=~~(o+.5),f[1]=~~(100*s+.5),f[2]=~~(100*l+.5)),n&&f.length<4&&(f[3]=1),f},Lt=function(e){var t=[],n=[],r=-1;return e.split(Rt).forEach((function(e){var i=e.match(ee)||[];t.push.apply(t,i),n.push(r+=i.length+1)})),t.c=n,t},Ct=function(e,t,n){var r,i,a,o,s="",l=(e+s).match(Rt),u=t?"hsla(":"rgba(",c=0;if(!l)return e;if(l=l.map((function(e){return(e=At(e,t,1))&&u+(t?e[0]+","+e[1]+"%,"+e[2]+"%,"+e[3]:e.join(","))+")"})),n&&(a=Lt(e),(r=n.c).join(s)!==a.c.join(s)))for(o=(i=e.replace(Rt,"1").split(ee)).length-1;c<o;c++)s+=i[c]+(~r.indexOf(c)?l.shift()||u+"0,0,0,0)":(a.length?a:l.length?l:n).shift());if(!i)for(o=(i=e.split(Rt)).length-1;c<o;c++)s+=i[c]+l[c];return s+i[o]},Rt=function(){var e,t="(?:\\b(?:(?:rgb|rgba|hsl|hsla)\\(.+?\\))|\\B#(?:[0-9a-f]{3,4}){1,2}\\b";for(e in St)t+="|"+e+"\\b";return new RegExp(t+")","gi")}(),kt=/hsl[a]?\(/,Pt=function(e){var t,n=e.join(" ");if(Rt.lastIndex=0,Rt.test(n))return t=kt.test(n),e[1]=Ct(e[1],t),e[0]=Ct(e[0],t,Lt(e[1])),!0},Dt=(y=Date.now,x=500,b=33,w=y(),T=w,S=M=1e3/240,A=function e(t){var n,r,i,a,o=y()-T,s=!0===t;if(o>x&&(w+=o-b),((n=(i=(T+=o)-w)-S)>0||s)&&(a=++m.frame,g=i-1e3*m.time,m.time=i/=1e3,S+=n+(n>=M?4:M-n),r=1),s||(f=p(e)),r)for(_=0;_<E.length;_++)E[_](i,g,a,t)},m={time:0,frame:0,tick:function(){A(!0)},deltaRatio:function(e){return g/(1e3/(e||60))},wake:function(){u&&(!s&&Y()&&(o=s=window,l=o.document||{},ae.gsap=Mn,(o.gsapVersions||(o.gsapVersions=[])).push(Mn.version),se(oe||o.GreenSockGlobals||!o.gsap&&o||{}),v=o.requestAnimationFrame),f&&m.sleep(),p=v||function(e){return setTimeout(e,S-1e3*m.time+1|0)},d=1,A(2))},sleep:function(){(v?o.cancelAnimationFrame:clearTimeout)(f),d=0,p=he},lagSmoothing:function(e,t){x=e||1e8,b=Math.min(t,x,0)},fps:function(e){M=1e3/(e||240),S=1e3*m.time+M},add:function(e,t,n){var r=t?function(t,n,i,a){e(t,n,i,a),m.remove(r)}:e;return m.remove(e),E[n?"unshift":"push"](r),It(),r},remove:function(e,t){~(t=E.indexOf(e))&&E.splice(t,1)&&_>=t&&_--},_listeners:E=[]}),It=function(){return!d&&Dt.wake()},Ot={},Ft=/^[\d.\-M][\d.\-,\s]/,Nt=/["']/g,Ut=function(e){for(var t,n,r,i={},a=e.substr(1,e.length-3).split(":"),o=a[0],s=1,l=a.length;s<l;s++)n=a[s],t=s!==l-1?n.lastIndexOf(","):n.length,r=n.substr(0,t),i[o]=isNaN(r)?r.replace(Nt,"").trim():+r,o=n.substr(t+1).trim();return i},Bt=function(e){return function(t){return 1-e(1-t)}},zt=function e(t,n){for(var r,i=t._first;i;)i instanceof Yt?e(i,n):!i.vars.yoyoEase||i._yoyo&&i._repeat||i._yoyo===n||(i.timeline?e(i.timeline,n):(r=i._ease,i._ease=i._yEase,i._yEase=r,i._yoyo=n)),i=i._next},Ht=function(e,t){return e&&(V(e)?e:Ot[e]||function(e){var t,n,r,i,a=(e+"").split("("),o=Ot[a[0]];return o&&a.length>1&&o.config?o.config.apply(null,~e.indexOf("{")?[Ut(a[1])]:(t=e,n=t.indexOf("(")+1,r=t.indexOf(")"),i=t.indexOf("(",n),t.substring(n,~i&&i<r?t.indexOf(")",r+1):r)).split(",").map(Re)):Ot._CE&&Ft.test(e)?Ot._CE("",e):o}(e))||t},Gt=function(e,t,n,r){void 0===n&&(n=function(e){return 1-t(1-e)}),void 0===r&&(r=function(e){return e<.5?t(2*e)/2:1-t(2*(1-e))/2});var i,a={easeIn:t,easeOut:n,easeInOut:r};return Te(e,(function(e){for(var t in Ot[e]=ae[e]=a,Ot[i=e.toLowerCase()]=n,a)Ot[i+("easeIn"===t?".in":"easeOut"===t?".out":".inOut")]=Ot[e+"."+t]=a[t]})),a},Vt=function(e){return function(t){return t<.5?(1-e(1-2*t))/2:.5+e(2*(t-.5))/2}},Wt=function e(t,n,r){var i=n>=1?n:1,a=(r||(t?.3:.45))/(n<1?n:1),o=a/F*(Math.asin(1/i)||0),s=function(e){return 1===e?1:i*Math.pow(2,-10*e)*H((e-o)*a)+1},l="out"===t?s:"in"===t?function(e){return 1-s(1-e)}:Vt(s);return a=F/a,l.config=function(n,r){return e(t,n,r)},l},jt=function e(t,n){void 0===n&&(n=1.70158);var r=function(e){return e?--e*e*((n+1)*e+n)+1:0},i="out"===t?r:"in"===t?function(e){return 1-r(1-e)}:Vt(r);return i.config=function(n){return e(t,n)},i};Te("Linear,Quad,Cubic,Quart,Quint,Strong",(function(e,t){var n=t<5?t+1:t;Gt(e+",Power"+(n-1),t?function(e){return Math.pow(e,n)}:function(e){return e},(function(e){return 1-Math.pow(1-e,n)}),(function(e){return e<.5?Math.pow(2*e,n)/2:1-Math.pow(2*(1-e),n)/2}))})),Ot.Linear.easeNone=Ot.none=Ot.Linear.easeIn,Gt("Elastic",Wt("in"),Wt("out"),Wt()),L=7.5625,R=1/(C=2.75),Gt("Bounce",(function(e){return 1-k(1-e)}),k=function(e){return e<R?L*e*e:e<.7272727272727273?L*Math.pow(e-1.5/C,2)+.75:e<.9090909090909092?L*(e-=2.25/C)*e+.9375:L*Math.pow(e-2.625/C,2)+.984375}),Gt("Expo",(function(e){return e?Math.pow(2,10*(e-1)):0})),Gt("Circ",(function(e){return-(B(1-e*e)-1)})),Gt("Sine",(function(e){return 1===e?1:1-z(e*N)})),Gt("Back",jt("in"),jt("out"),jt()),Ot.SteppedEase=Ot.steps=ae.SteppedEase={config:function(e,t){void 0===e&&(e=1);var n=1/e,r=e+(t?0:1),i=t?1:0;return function(e){return((r*ot(0,.99999999,e)|0)+i)*n}}},D.ease=Ot["quad.out"],Te("onComplete,onUpdate,onStart,onRepeat,onReverseComplete,onInterrupt",(function(e){return ye+=e+","+e+"Params,"}));var qt=function(e,t){this.id=U++,e._gsap=this,this.target=e,this.harness=t,this.get=t?t.get:we,this.set=t?t.getSetter:hn},Xt=function(){function e(e){this.vars=e,this._delay=+e.delay||0,(this._repeat=e.repeat===1/0?-2:e.repeat||0)&&(this._rDelay=e.repeatDelay||0,this._yoyo=!!e.yoyo||!!e.yoyoEase),this._ts=1,et(this,+e.duration,1,1),this.data=e.data,d||Dt.wake()}var t=e.prototype;return t.delay=function(e){return e||0===e?(this.parent&&this.parent.smoothChildTiming&&this.startTime(this._start+e-this._delay),this._delay=e,this):this._delay},t.duration=function(e){return arguments.length?this.totalDuration(this._repeat>0?e+(e+this._rDelay)*this._repeat:e):this.totalDuration()&&this._dur},t.totalDuration=function(e){return arguments.length?(this._dirty=0,et(this,this._repeat<0?e:(e-this._repeat*this._rDelay)/(this._repeat+1))):this._tDur},t.totalTime=function(e,t){if(It(),!arguments.length)return this._tTime;var n=this._dp;if(n&&n.smoothChildTiming&&this._ts){for(Xe(this,e),!n._dp||n.parent||Ye(n,this);n&&n.parent;)n.parent._time!==n._start+(n._ts>=0?n._tTime/n._ts:(n.totalDuration()-n._tTime)/-n._ts)&&n.totalTime(n._tTime,!0),n=n.parent;!this.parent&&this._dp.autoRemoveChildren&&(this._ts>0&&e<this._tDur||this._ts<0&&e>0||!this._tDur&&!e)&&Ke(this._dp,this,this._start-this._delay)}return(this._tTime!==e||!this._dur&&!t||this._initted&&Math.abs(this._zTime)===O||!e&&!this._initted&&(this.add||this._ptLookup))&&(this._ts||(this._pTime=e),Ce(this,e,t)),this},t.time=function(e,t){return arguments.length?this.totalTime(Math.min(this.totalDuration(),e+Ve(this))%(this._dur+this._rDelay)||(e?this._dur:0),t):this._time},t.totalProgress=function(e,t){return arguments.length?this.totalTime(this.totalDuration()*e,t):this.totalDuration()?Math.min(1,this._tTime/this._tDur):this.ratio},t.progress=function(e,t){return arguments.length?this.totalTime(this.duration()*(!this._yoyo||1&this.iteration()?e:1-e)+Ve(this),t):this.duration()?Math.min(1,this._time/this._dur):this.ratio},t.iteration=function(e,t){var n=this.duration()+this._rDelay;return arguments.length?this.totalTime(this._time+(e-1)*n,t):this._repeat?We(this._tTime,n)+1:1},t.timeScale=function(e){if(!arguments.length)return-1e-8===this._rts?0:this._rts;if(this._rts===e)return this;var t=this.parent&&this._ts?je(this.parent._time,this):this._tTime;return this._rts=+e||0,this._ts=this._ps||-1e-8===e?0:this._rts,this.totalTime(ot(-this._delay,this._tDur,t),!0),qe(this),He(this)},t.paused=function(e){return arguments.length?(this._ps!==e&&(this._ps=e,e?(this._pTime=this._tTime||Math.max(-this._delay,this.rawTime()),this._ts=this._act=0):(It(),this._ts=this._rts,this.totalTime(this.parent&&!this.parent.smoothChildTiming?this.rawTime():this._tTime||this._pTime,1===this.progress()&&Math.abs(this._zTime)!==O&&(this._tTime-=O)))),this):this._ps},t.startTime=function(e){if(arguments.length){this._start=e;var t=this.parent||this._dp;return t&&(t._sort||!this.parent)&&Ke(t,this,e-this._delay),this}return this._start},t.endTime=function(e){return this._start+(X(e)?this.totalDuration():this.duration())/Math.abs(this._ts||1)},t.rawTime=function(e){var t=this.parent||this._dp;return t?e&&(!this._ts||this._repeat&&this._time&&this.totalProgress()<1)?this._tTime%(this._dur+this._rDelay):this._ts?je(t.rawTime(e),this):this._tTime:this._tTime},t.globalTime=function(e){for(var t=this,n=arguments.length?e:t.rawTime();t;)n=t._start+n/(t._ts||1),t=t._dp;return n},t.repeat=function(e){return arguments.length?(this._repeat=e===1/0?-2:e,tt(this)):-2===this._repeat?1/0:this._repeat},t.repeatDelay=function(e){if(arguments.length){var t=this._time;return this._rDelay=e,tt(this),t?this.time(t):this}return this._rDelay},t.yoyo=function(e){return arguments.length?(this._yoyo=e,this):this._yoyo},t.seek=function(e,t){return this.totalTime(rt(this,e),X(t))},t.restart=function(e,t){return this.play().totalTime(e?-this._delay:0,X(t))},t.play=function(e,t){return null!=e&&this.seek(e,t),this.reversed(!1).paused(!1)},t.reverse=function(e,t){return null!=e&&this.seek(e||this.totalDuration(),t),this.reversed(!0).paused(!1)},t.pause=function(e,t){return null!=e&&this.seek(e,t),this.paused(!0)},t.resume=function(){return this.paused(!1)},t.reversed=function(e){return arguments.length?(!!e!==this.reversed()&&this.timeScale(-this._rts||(e?-1e-8:0)),this):this._rts<0},t.invalidate=function(){return this._initted=this._act=0,this._zTime=-1e-8,this},t.isActive=function(){var e,t=this.parent||this._dp,n=this._start;return!(t&&!(this._ts&&this._initted&&t.isActive()&&(e=t.rawTime(!0))>=n&&e<this.endTime(!0)-O))},t.eventCallback=function(e,t,n){var r=this.vars;return arguments.length>1?(t?(r[e]=t,n&&(r[e+"Params"]=n),"onUpdate"===e&&(this._onUpdate=t)):delete r[e],this):r[e]},t.then=function(e){var t=this;return new Promise((function(n){var r=V(e)?e:ke,i=function(){var e=t.then;t.then=null,V(r)&&(r=r(t))&&(r.then||r===t)&&(t.then=e),n(r),t.then=e};t._initted&&1===t.totalProgress()&&t._ts>=0||!t._tTime&&t._ts<0?i():t._prom=i}))},t.kill=function(){wt(this)},e}();Pe(Xt.prototype,{_time:0,_start:0,_end:0,_tTime:0,_tDur:0,_dirty:0,_repeat:0,_yoyo:!1,parent:null,_initted:!1,_rDelay:0,_ts:1,_dp:0,ratio:0,_zTime:-1e-8,_prom:0,_ps:!1,_rts:1});var Yt=function(e){function r(t,r){var a;return void 0===t&&(t={}),(a=e.call(this,t)||this).labels={},a.smoothChildTiming=!!t.smoothChildTiming,a.autoRemoveChildren=!!t.autoRemoveChildren,a._sort=X(t.sortChildren),i&&Ke(t.parent||i,n(a),r),t.reversed&&a.reverse(),t.paused&&a.paused(!0),t.scrollTrigger&&Ze(n(a),t.scrollTrigger),a}t(r,e);var a=r.prototype;return a.to=function(e,t,n){return it(0,arguments,this),this},a.from=function(e,t,n){return it(1,arguments,this),this},a.fromTo=function(e,t,n,r){return it(2,arguments,this),this},a.set=function(e,t,n){return t.duration=0,t.parent=this,Fe(t).repeatDelay||(t.repeat=0),t.immediateRender=!!t.immediateRender,new on(e,t,rt(this,n),1),this},a.call=function(e,t,n){return Ke(this,on.delayedCall(0,e,t),n)},a.staggerTo=function(e,t,n,r,i,a,o){return n.duration=t,n.stagger=n.stagger||r,n.onComplete=a,n.onCompleteParams=o,n.parent=this,new on(e,n,rt(this,i)),this},a.staggerFrom=function(e,t,n,r,i,a,o){return n.runBackwards=1,Fe(n).immediateRender=X(n.immediateRender),this.staggerTo(e,t,n,r,i,a,o)},a.staggerFromTo=function(e,t,n,r,i,a,o,s){return r.startAt=n,Fe(r).immediateRender=X(r.immediateRender),this.staggerTo(e,t,r,i,a,o,s)},a.render=function(e,t,n){var r,a,o,s,l,u,c,h,d,f,p,v,m=this._time,g=this._dirty?this.totalDuration():this._tDur,_=this._dur,y=e<=0?0:Se(e),x=this._zTime<0!=e<0&&(this._initted||!_);if(this!==i&&y>g&&e>=0&&(y=g),y!==this._tTime||n||x){if(m!==this._time&&_&&(y+=this._time-m,e+=this._time-m),r=y,d=this._start,u=!(h=this._ts),x&&(_||(m=this._zTime),(e||!t)&&(this._zTime=e)),this._repeat){if(p=this._yoyo,l=_+this._rDelay,this._repeat<-1&&e<0)return this.totalTime(100*l+e,t,n);if(r=Se(y%l),y===g?(s=this._repeat,r=_):((s=~~(y/l))&&s===y/l&&(r=_,s--),r>_&&(r=_)),f=We(this._tTime,l),!m&&this._tTime&&f!==s&&(f=s),p&&1&s&&(r=_-r,v=1),s!==f&&!this._lock){var b=p&&1&f,w=b===(p&&1&s);if(s<f&&(b=!b),m=b?0:_,this._lock=1,this.render(m||(v?0:Se(s*l)),t,!_)._lock=0,this._tTime=y,!t&&this.parent&&bt(this,"onRepeat"),this.vars.repeatRefresh&&!v&&(this.invalidate()._lock=1),m&&m!==this._time||u!==!this._ts||this.vars.onRepeat&&!this.parent&&!this._act)return this;if(_=this._dur,g=this._tDur,w&&(this._lock=2,m=b?_:-1e-4,this.render(m,!0),this.vars.repeatRefresh&&!v&&this.invalidate()),this._lock=0,!this._ts&&!u)return this;zt(this,v)}}if(this._hasPause&&!this._forcing&&this._lock<2&&(c=function(e,t,n){var r;if(n>t)for(r=e._first;r&&r._start<=n;){if("isPause"===r.data&&r._start>t)return r;r=r._next}else for(r=e._last;r&&r._start>=n;){if("isPause"===r.data&&r._start<t)return r;r=r._prev}}(this,Se(m),Se(r)),c&&(y-=r-(r=c._start))),this._tTime=y,this._time=r,this._act=!h,this._initted||(this._onUpdate=this.vars.onUpdate,this._initted=1,this._zTime=e,m=0),!m&&r&&!t&&(bt(this,"onStart"),this._tTime!==y))return this;if(r>=m&&e>=0)for(a=this._first;a;){if(o=a._next,(a._act||r>=a._start)&&a._ts&&c!==a){if(a.parent!==this)return this.render(e,t,n);if(a.render(a._ts>0?(r-a._start)*a._ts:(a._dirty?a.totalDuration():a._tDur)+(r-a._start)*a._ts,t,n),r!==this._time||!this._ts&&!u){c=0,o&&(y+=this._zTime=-1e-8);break}}a=o}else{a=this._last;for(var T=e<0?e:r;a;){if(o=a._prev,(a._act||T<=a._end)&&a._ts&&c!==a){if(a.parent!==this)return this.render(e,t,n);if(a.render(a._ts>0?(T-a._start)*a._ts:(a._dirty?a.totalDuration():a._tDur)+(T-a._start)*a._ts,t,n),r!==this._time||!this._ts&&!u){c=0,o&&(y+=this._zTime=T?-1e-8:O);break}}a=o}}if(c&&!t&&(this.pause(),c.render(r>=m?0:-1e-8)._zTime=r>=m?1:-1,this._ts))return this._start=d,qe(this),this.render(e,t,n);this._onUpdate&&!t&&bt(this,"onUpdate",!0),(y===g&&this._tTime>=this.totalDuration()||!y&&m)&&(d!==this._start&&Math.abs(h)===Math.abs(this._ts)||this._lock||((e||!_)&&(y===g&&this._ts>0||!y&&this._ts<0)&&Be(this,1),t||e<0&&!m||!y&&!m&&g||(bt(this,y===g&&e>=0?"onComplete":"onReverseComplete",!0),this._prom&&!(y<g&&this.timeScale()>0)&&this._prom())))}return this},a.add=function(e,t){var n=this;if(W(t)||(t=rt(this,t,e)),!(e instanceof Xt)){if(J(e))return e.forEach((function(e){return n.add(e,t)})),this;if(G(e))return this.addLabel(e,t);if(!V(e))return this;e=on.delayedCall(0,e)}return this!==e?Ke(this,e,t):this},a.getChildren=function(e,t,n,r){void 0===e&&(e=!0),void 0===t&&(t=!0),void 0===n&&(n=!0),void 0===r&&(r=-I);for(var i=[],a=this._first;a;)a._start>=r&&(a instanceof on?t&&i.push(a):(n&&i.push(a),e&&i.push.apply(i,a.getChildren(!0,t,n)))),a=a._next;return i},a.getById=function(e){for(var t=this.getChildren(1,1,1),n=t.length;n--;)if(t[n].vars.id===e)return t[n]},a.remove=function(e){return G(e)?this.removeLabel(e):V(e)?this.killTweensOf(e):(Ue(this,e),e===this._recent&&(this._recent=this._last),ze(this))},a.totalTime=function(t,n){return arguments.length?(this._forcing=1,!this._dp&&this._ts&&(this._start=Se(Dt.time-(this._ts>0?t/this._ts:(this.totalDuration()-t)/-this._ts))),e.prototype.totalTime.call(this,t,n),this._forcing=0,this):this._tTime},a.addLabel=function(e,t){return this.labels[e]=rt(this,t),this},a.removeLabel=function(e){return delete this.labels[e],this},a.addPause=function(e,t,n){var r=on.delayedCall(0,t||he,n);return r.data="isPause",this._hasPause=1,Ke(this,r,rt(this,e))},a.removePause=function(e){var t=this._first;for(e=rt(this,e);t;)t._start===e&&"isPause"===t.data&&Be(t),t=t._next},a.killTweensOf=function(e,t,n){for(var r=this.getTweensOf(e,n),i=r.length;i--;)Kt!==r[i]&&r[i].kill(e,t);return this},a.getTweensOf=function(e,t){for(var n,r=[],i=ht(e),a=this._first,o=W(t);a;)a instanceof on?Ae(a._targets,i)&&(o?(!Kt||a._initted&&a._ts)&&a.globalTime(0)<=t&&a.globalTime(a.totalDuration())>t:!t||a.isActive())&&r.push(a):(n=a.getTweensOf(i,t)).length&&r.push.apply(r,n),a=a._next;return r},a.tweenTo=function(e,t){t=t||{};var n,r=this,i=rt(r,e),a=t,o=a.startAt,s=a.onStart,l=a.onStartParams,u=a.immediateRender,c=on.to(r,Pe({ease:t.ease||"none",lazy:!1,immediateRender:!1,time:i,overwrite:"auto",duration:t.duration||Math.abs((i-(o&&"time"in o?o.time:r._time))/r.timeScale())||O,onStart:function(){if(r.pause(),!n){var e=t.duration||Math.abs((i-(o&&"time"in o?o.time:r._time))/r.timeScale());c._dur!==e&&et(c,e,0,1).render(c._time,!0,!0),n=1}s&&s.apply(c,l||[])}},t));return u?c.render(0):c},a.tweenFromTo=function(e,t,n){return this.tweenTo(t,Pe({startAt:{time:rt(this,e)}},n))},a.recent=function(){return this._recent},a.nextLabel=function(e){return void 0===e&&(e=this._time),xt(this,rt(this,e))},a.previousLabel=function(e){return void 0===e&&(e=this._time),xt(this,rt(this,e),1)},a.currentLabel=function(e){return arguments.length?this.seek(e,!0):this.previousLabel(this._time+O)},a.shiftChildren=function(e,t,n){void 0===n&&(n=0);for(var r,i=this._first,a=this.labels;i;)i._start>=n&&(i._start+=e,i._end+=e),i=i._next;if(t)for(r in a)a[r]>=n&&(a[r]+=e);return ze(this)},a.invalidate=function(){var t=this._first;for(this._lock=0;t;)t.invalidate(),t=t._next;return e.prototype.invalidate.call(this)},a.clear=function(e){void 0===e&&(e=!0);for(var t,n=this._first;n;)t=n._next,this.remove(n),n=t;return this._dp&&(this._time=this._tTime=this._pTime=0),e&&(this.labels={}),ze(this)},a.totalDuration=function(e){var t,n,r,a=0,o=this,s=o._last,l=I;if(arguments.length)return o.timeScale((o._repeat<0?o.duration():o.totalDuration())/(o.reversed()?-e:e));if(o._dirty){for(r=o.parent;s;)t=s._prev,s._dirty&&s.totalDuration(),(n=s._start)>l&&o._sort&&s._ts&&!o._lock?(o._lock=1,Ke(o,s,n-s._delay,1)._lock=0):l=n,n<0&&s._ts&&(a-=n,(!r&&!o._dp||r&&r.smoothChildTiming)&&(o._start+=n/o._ts,o._time-=n,o._tTime-=n),o.shiftChildren(-n,!1,-Infinity),l=0),s._end>a&&s._ts&&(a=s._end),s=t;et(o,o===i&&o._time>a?o._time:a,1,1),o._dirty=0}return o._tDur},r.updateRoot=function(e){if(i._ts&&(Ce(i,je(e,i)),c=Dt.frame),Dt.frame>=ge){ge+=P.autoSleep||120;var t=i._first;if((!t||!t._ts)&&P.autoSleep&&Dt._listeners.length<2){for(;t&&!t._ts;)t=t._next;t||Dt.sleep()}}},r}(Xt);Pe(Yt.prototype,{_lock:0,_hasPause:0,_forcing:0});var Kt,Zt,Jt=function(e,t,n,r,i,a,o){var s,l,u,c,h,d,f,p,v=new xn(this._pt,e,t,0,1,pn,null,i),m=0,g=0;for(v.b=n,v.e=r,n+="",(f=~(r+="").indexOf("random("))&&(r=_t(r)),a&&(a(p=[n,r],e,t),n=p[0],r=p[1]),l=n.match(te)||[];s=te.exec(r);)c=s[0],h=r.substring(m,s.index),u?u=(u+1)%5:"rgba("===h.substr(-5)&&(u=1),c!==l[g++]&&(d=parseFloat(l[g-1])||0,v._pt={_next:v._pt,p:h||1===g?h:",",s:d,c:"="===c.charAt(1)?Ee(d,c)-d:parseFloat(c)-d,m:u&&u<4?Math.round:0},m=te.lastIndex);return v.c=m<r.length?r.substring(m,r.length):"",v.fp=o,(ne.test(r)||f)&&(v.e=0),this._pt=v,v},Qt=function(e,t,n,r,i,a,o,s,l){V(r)&&(r=r(i||0,e,a));var u,c=e[t],h="get"!==n?n:V(c)?l?e[t.indexOf("set")||!V(e["get"+t.substr(3)])?t:"get"+t.substr(3)](l):e[t]():c,d=V(c)?l?un:ln:sn;if(G(r)&&(~r.indexOf("random(")&&(r=_t(r)),"="===r.charAt(1)&&((u=Ee(h,r)+(st(h)||0))||0===u)&&(r=u)),h!==r||Zt)return isNaN(h*r)||""===r?(!c&&!(t in e)&&le(t,r),Jt.call(this,e,t,h,r,d,s||P.stringFilter,l)):(u=new xn(this._pt,e,t,+h||0,r-(h||0),"boolean"==typeof c?fn:dn,0,d),l&&(u.fp=l),o&&u.modifier(o,this,e),this._pt=u)},$t=function(e,t,n,r,i,a){var o,s,l,u;if(ve[e]&&!1!==(o=new ve[e]).init(i,o.rawVars?t[e]:function(e,t,n,r,i){if(V(e)&&(e=nn(e,i,t,n,r)),!q(e)||e.style&&e.nodeType||J(e)||Z(e))return G(e)?nn(e,i,t,n,r):e;var a,o={};for(a in e)o[a]=nn(e[a],i,t,n,r);return o}(t[e],r,i,a,n),n,r,a)&&(n._pt=s=new xn(n._pt,i,e,0,1,o.render,o,0,o.priority),n!==h))for(l=n._ptLookup[n._targets.indexOf(i)],u=o._props.length;u--;)l[o._props[u]]=s;return o},en=function e(t,n){var a,o,s,l,u,c,h,d,f,p,v,m,g,_=t.vars,y=_.ease,x=_.startAt,b=_.immediateRender,w=_.lazy,T=_.onUpdate,M=_.onUpdateParams,S=_.callbackScope,E=_.runBackwards,A=_.yoyoEase,L=_.keyframes,C=_.autoRevert,R=t._dur,k=t._startAt,P=t._targets,F=t.parent,N=F&&"nested"===F.data?F.parent._targets:P,U="auto"===t._overwrite&&!r,B=t.timeline;if(B&&(!L||!y)&&(y="none"),t._ease=Ht(y,D.ease),t._yEase=A?Bt(Ht(!0===A?y:A,D.ease)):0,A&&t._yoyo&&!t._repeat&&(A=t._yEase,t._yEase=t._ease,t._ease=A),t._from=!B&&!!_.runBackwards,!B||L&&!_.stagger){if(m=(d=P[0]?be(P[0]).harness:0)&&_[d.prop],a=Oe(_,de),k&&(Be(k.render(-1,!0)),k._lazy=0),x)if(Be(t._startAt=on.set(P,Pe({data:"isStart",overwrite:!1,parent:F,immediateRender:!0,lazy:X(w),startAt:null,delay:0,onUpdate:T,onUpdateParams:M,callbackScope:S,stagger:0},x))),n<0&&!b&&!C&&t._startAt.render(-1,!0),b){if(n>0&&!C&&(t._startAt=0),R&&n<=0)return void(n&&(t._zTime=n))}else!1===C&&(t._startAt=0);else if(E&&R)if(k)!C&&(t._startAt=0);else if(n&&(b=!1),s=Pe({overwrite:!1,data:"isFromStart",lazy:b&&X(w),immediateRender:b,stagger:0,parent:F},a),m&&(s[d.prop]=m),Be(t._startAt=on.set(P,s)),n<0&&t._startAt.render(-1,!0),t._zTime=n,b){if(!n)return}else e(t._startAt,O);for(t._pt=t._ptCache=0,w=R&&X(w)||w&&!R,o=0;o<P.length;o++){if(h=(u=P[o])._gsap||xe(P)[o]._gsap,t._ptLookup[o]=p={},pe[h.id]&&fe.length&&Le(),v=N===P?o:N.indexOf(u),d&&!1!==(f=new d).init(u,m||a,t,v,N)&&(t._pt=l=new xn(t._pt,u,f.name,0,1,f.render,f,0,f.priority),f._props.forEach((function(e){p[e]=l})),f.priority&&(c=1)),!d||m)for(s in a)ve[s]&&(f=$t(s,a,t,v,u,N))?f.priority&&(c=1):p[s]=l=Qt.call(t,u,s,"get",a[s],v,N,0,_.stringFilter);t._op&&t._op[o]&&t.kill(u,t._op[o]),U&&t._pt&&(Kt=t,i.killTweensOf(u,p,t.globalTime(n)),g=!t.parent,Kt=0),t._pt&&w&&(pe[h.id]=1)}c&&yn(t),t._onInit&&t._onInit(t)}t._onUpdate=T,t._initted=(!t._op||t._pt)&&!g,L&&n<=0&&B.render(I,!0,!0)},tn=function(e,t,n,r){var i,a,o=t.ease||r||"power1.inOut";if(J(t))a=n[e]||(n[e]=[]),t.forEach((function(e,n){return a.push({t:n/(t.length-1)*100,v:e,e:o})}));else for(i in t)a=n[i]||(n[i]=[]),"ease"===i||a.push({t:parseFloat(e),v:t[i],e:o})},nn=function(e,t,n,r,i){return V(e)?e.call(t,n,r,i):G(e)&&~e.indexOf("random(")?_t(e):e},rn=ye+"repeat,repeatDelay,yoyo,repeatRefresh,yoyoEase,autoRevert",an={};Te(rn+",id,stagger,delay,duration,paused,scrollTrigger",(function(e){return an[e]=1}));var on=function(e){function a(t,a,o,s){var l;"number"==typeof a&&(o.duration=a,a=o,o=null);var u,c,h,d,f,p,v,m,g=(l=e.call(this,s?a:Fe(a))||this).vars,_=g.duration,y=g.delay,x=g.immediateRender,b=g.stagger,w=g.overwrite,T=g.keyframes,M=g.defaults,S=g.scrollTrigger,E=g.yoyoEase,A=a.parent||i,L=(J(t)||Z(t)?W(t[0]):"length"in a)?[t]:ht(t);if(l._targets=L.length?xe(L):ue("GSAP target "+t+" not found. https://greensock.com",!P.nullTargetWarn)||[],l._ptLookup=[],l._overwrite=w,T||b||K(_)||K(y)){if(a=l.vars,(u=l.timeline=new Yt({data:"nested",defaults:M||{}})).kill(),u.parent=u._dp=n(l),u._start=0,b||K(_)||K(y)){if(d=L.length,v=b&&ft(b),q(b))for(f in b)~rn.indexOf(f)&&(m||(m={}),m[f]=b[f]);for(c=0;c<d;c++)(h=Oe(a,an)).stagger=0,E&&(h.yoyoEase=E),m&&De(h,m),p=L[c],h.duration=+nn(_,n(l),c,p,L),h.delay=(+nn(y,n(l),c,p,L)||0)-l._delay,!b&&1===d&&h.delay&&(l._delay=y=h.delay,l._start+=y,h.delay=0),u.to(p,h,v?v(c,p,L):0),u._ease=Ot.none;u.duration()?_=y=0:l.timeline=0}else if(T){Fe(Pe(u.vars.defaults,{ease:"none"})),u._ease=Ht(T.ease||a.ease||"none");var C,R,k,D=0;if(J(T))T.forEach((function(e){return u.to(L,e,">")}));else{for(f in h={},T)"ease"===f||"easeEach"===f||tn(f,T[f],h,T.easeEach);for(f in h)for(C=h[f].sort((function(e,t){return e.t-t.t})),D=0,c=0;c<C.length;c++)(k={ease:(R=C[c]).e,duration:(R.t-(c?C[c-1].t:0))/100*_})[f]=R.v,u.to(L,k,D),D+=k.duration;u.duration()<_&&u.to({},{duration:_-u.duration()})}}_||l.duration(_=u.duration())}else l.timeline=0;return!0!==w||r||(Kt=n(l),i.killTweensOf(L),Kt=0),Ke(A,n(l),o),a.reversed&&l.reverse(),a.paused&&l.paused(!0),(x||!_&&!T&&l._start===Se(A._time)&&X(x)&&Ge(n(l))&&"nested"!==A.data)&&(l._tTime=-1e-8,l.render(Math.max(0,-y))),S&&Ze(n(l),S),l}t(a,e);var o=a.prototype;return o.render=function(e,t,n){var r,i,a,o,s,l,u,c,h,d=this._time,f=this._tDur,p=this._dur,v=e>f-O&&e>=0?f:e<O?0:e;if(p){if(v!==this._tTime||!e||n||!this._initted&&this._tTime||this._startAt&&this._zTime<0!=e<0){if(r=v,c=this.timeline,this._repeat){if(o=p+this._rDelay,this._repeat<-1&&e<0)return this.totalTime(100*o+e,t,n);if(r=Se(v%o),v===f?(a=this._repeat,r=p):((a=~~(v/o))&&a===v/o&&(r=p,a--),r>p&&(r=p)),(l=this._yoyo&&1&a)&&(h=this._yEase,r=p-r),s=We(this._tTime,o),r===d&&!n&&this._initted)return this._tTime=v,this;a!==s&&(c&&this._yEase&&zt(c,l),!this.vars.repeatRefresh||l||this._lock||(this._lock=n=1,this.render(Se(o*a),!0).invalidate()._lock=0))}if(!this._initted){if(Je(this,e<0?e:r,n,t))return this._tTime=0,this;if(d!==this._time)return this;if(p!==this._dur)return this.render(e,t,n)}if(this._tTime=v,this._time=r,!this._act&&this._ts&&(this._act=1,this._lazy=0),this.ratio=u=(h||this._ease)(r/p),this._from&&(this.ratio=u=1-u),r&&!d&&!t&&(bt(this,"onStart"),this._tTime!==v))return this;for(i=this._pt;i;)i.r(u,i.d),i=i._next;c&&c.render(e<0?e:!r&&l?-1e-8:c._dur*c._ease(r/this._dur),t,n)||this._startAt&&(this._zTime=e),this._onUpdate&&!t&&(e<0&&this._startAt&&this._startAt.render(e,!0,n),bt(this,"onUpdate")),this._repeat&&a!==s&&this.vars.onRepeat&&!t&&this.parent&&bt(this,"onRepeat"),v!==this._tDur&&v||this._tTime!==v||(e<0&&this._startAt&&!this._onUpdate&&this._startAt.render(e,!0,!0),(e||!p)&&(v===this._tDur&&this._ts>0||!v&&this._ts<0)&&Be(this,1),t||e<0&&!d||!v&&!d||(bt(this,v===f?"onComplete":"onReverseComplete",!0),this._prom&&!(v<f&&this.timeScale()>0)&&this._prom()))}}else!function(e,t,n,r){var i,a,o,s=e.ratio,l=t<0||!t&&(!e._start&&Qe(e)&&(e._initted||!$e(e))||(e._ts<0||e._dp._ts<0)&&!$e(e))?0:1,u=e._rDelay,c=0;if(u&&e._repeat&&(c=ot(0,e._tDur,t),a=We(c,u),e._yoyo&&1&a&&(l=1-l),a!==We(e._tTime,u)&&(s=1-l,e.vars.repeatRefresh&&e._initted&&e.invalidate())),l!==s||r||e._zTime===O||!t&&e._zTime){if(!e._initted&&Je(e,t,r,n))return;for(o=e._zTime,e._zTime=t||(n?O:0),n||(n=t&&!o),e.ratio=l,e._from&&(l=1-l),e._time=0,e._tTime=c,i=e._pt;i;)i.r(l,i.d),i=i._next;e._startAt&&t<0&&e._startAt.render(t,!0,!0),e._onUpdate&&!n&&bt(e,"onUpdate"),c&&e._repeat&&!n&&e.parent&&bt(e,"onRepeat"),(t>=e._tDur||t<0)&&e.ratio===l&&(l&&Be(e,1),n||(bt(e,l?"onComplete":"onReverseComplete",!0),e._prom&&e._prom()))}else e._zTime||(e._zTime=t)}(this,e,t,n);return this},o.targets=function(){return this._targets},o.invalidate=function(){return this._pt=this._op=this._startAt=this._onUpdate=this._lazy=this.ratio=0,this._ptLookup=[],this.timeline&&this.timeline.invalidate(),e.prototype.invalidate.call(this)},o.resetTo=function(e,t,n,r){d||Dt.wake(),this._ts||this.play();var i=Math.min(this._dur,(this._dp._time-this._start)*this._ts);return this._initted||en(this,i),function(e,t,n,r,i,a,o){var s,l,u,c=(e._pt&&e._ptCache||(e._ptCache={}))[t];if(!c)for(c=e._ptCache[t]=[],l=e._ptLookup,u=e._targets.length;u--;){if((s=l[u][t])&&s.d&&s.d._pt)for(s=s.d._pt;s&&s.p!==t;)s=s._next;if(!s)return Zt=1,e.vars[t]="+=0",en(e,o),Zt=0,1;c.push(s)}for(u=c.length;u--;)(s=c[u]).s=!r&&0!==r||i?s.s+(r||0)+a*s.c:r,s.c=n-s.s,s.e&&(s.e=Me(n)+st(s.e)),s.b&&(s.b=s.s+st(s.b))}(this,e,t,n,r,this._ease(i/this._dur),i)?this.resetTo(e,t,n,r):(Xe(this,0),this.parent||Ne(this._dp,this,"_first","_last",this._dp._sort?"_start":0),this.render(0))},o.kill=function(e,t){if(void 0===t&&(t="all"),!(e||t&&"all"!==t))return this._lazy=this._pt=0,this.parent?wt(this):this;if(this.timeline){var n=this.timeline.totalDuration();return this.timeline.killTweensOf(e,t,Kt&&!0!==Kt.vars.overwrite)._first||wt(this),this.parent&&n!==this.timeline.totalDuration()&&et(this,this._dur*this.timeline._tDur/n,0,1),this}var r,i,a,o,s,l,u,c=this._targets,h=e?ht(e):c,d=this._ptLookup,f=this._pt;if((!t||"all"===t)&&function(e,t){for(var n=e.length,r=n===t.length;r&&n--&&e[n]===t[n];);return n<0}(c,h))return"all"===t&&(this._pt=0),wt(this);for(r=this._op=this._op||[],"all"!==t&&(G(t)&&(s={},Te(t,(function(e){return s[e]=1})),t=s),t=function(e,t){var n,r,i,a,o=e[0]?be(e[0]).harness:0,s=o&&o.aliases;if(!s)return t;for(r in n=De({},t),s)if(r in n)for(i=(a=s[r].split(",")).length;i--;)n[a[i]]=n[r];return n}(c,t)),u=c.length;u--;)if(~h.indexOf(c[u]))for(s in i=d[u],"all"===t?(r[u]=t,o=i,a={}):(a=r[u]=r[u]||{},o=t),o)(l=i&&i[s])&&("kill"in l.d&&!0!==l.d.kill(s)||Ue(this,l,"_pt"),delete i[s]),"all"!==a&&(a[s]=1);return this._initted&&!this._pt&&f&&wt(this),this},a.to=function(e,t){return new a(e,t,arguments[2])},a.from=function(e,t){return it(1,arguments)},a.delayedCall=function(e,t,n,r){return new a(t,0,{immediateRender:!1,lazy:!1,overwrite:!1,delay:e,onComplete:t,onReverseComplete:t,onCompleteParams:n,onReverseCompleteParams:n,callbackScope:r})},a.fromTo=function(e,t,n){return it(2,arguments)},a.set=function(e,t){return t.duration=0,t.repeatDelay||(t.repeat=0),new a(e,t)},a.killTweensOf=function(e,t,n){return i.killTweensOf(e,t,n)},a}(Xt);Pe(on.prototype,{_targets:[],_lazy:0,_startAt:0,_op:0,_onInit:0}),Te("staggerTo,staggerFrom,staggerFromTo",(function(e){on[e]=function(){var t=new Yt,n=lt.call(arguments,0);return n.splice("staggerFromTo"===e?5:4,0,0),t[e].apply(t,n)}}));var sn=function(e,t,n){return e[t]=n},ln=function(e,t,n){return e[t](n)},un=function(e,t,n,r){return e[t](r.fp,n)},cn=function(e,t,n){return e.setAttribute(t,n)},hn=function(e,t){return V(e[t])?ln:j(e[t])&&e.setAttribute?cn:sn},dn=function(e,t){return t.set(t.t,t.p,Math.round(1e6*(t.s+t.c*e))/1e6,t)},fn=function(e,t){return t.set(t.t,t.p,!!(t.s+t.c*e),t)},pn=function(e,t){var n=t._pt,r="";if(!e&&t.b)r=t.b;else if(1===e&&t.e)r=t.e;else{for(;n;)r=n.p+(n.m?n.m(n.s+n.c*e):Math.round(1e4*(n.s+n.c*e))/1e4)+r,n=n._next;r+=t.c}t.set(t.t,t.p,r,t)},vn=function(e,t){for(var n=t._pt;n;)n.r(e,n.d),n=n._next},mn=function(e,t,n,r){for(var i,a=this._pt;a;)i=a._next,a.p===r&&a.modifier(e,t,n),a=i},gn=function(e){for(var t,n,r=this._pt;r;)n=r._next,r.p===e&&!r.op||r.op===e?Ue(this,r,"_pt"):r.dep||(t=1),r=n;return!t},_n=function(e,t,n,r){r.mSet(e,t,r.m.call(r.tween,n,r.mt),r)},yn=function(e){for(var t,n,r,i,a=e._pt;a;){for(t=a._next,n=r;n&&n.pr>a.pr;)n=n._next;(a._prev=n?n._prev:i)?a._prev._next=a:r=a,(a._next=n)?n._prev=a:i=a,a=t}e._pt=r},xn=function(){function e(e,t,n,r,i,a,o,s,l){this.t=t,this.s=r,this.c=i,this.p=n,this.r=a||dn,this.d=o||this,this.set=s||sn,this.pr=l||0,this._next=e,e&&(e._prev=this)}return e.prototype.modifier=function(e,t,n){this.mSet=this.mSet||this.set,this.set=_n,this.m=e,this.mt=n,this.tween=t},e}();Te(ye+"parent,duration,ease,delay,overwrite,runBackwards,startAt,yoyo,immediateRender,repeat,repeatDelay,data,paused,reversed,lazy,callbackScope,stringFilter,id,yoyoEase,stagger,inherit,repeatRefresh,keyframes,autoRevert,scrollTrigger",(function(e){return de[e]=1})),ae.TweenMax=ae.TweenLite=on,ae.TimelineLite=ae.TimelineMax=Yt,i=new Yt({sortChildren:!1,defaults:D,autoRemoveChildren:!0,id:"root",smoothChildTiming:!0}),P.stringFilter=Pt;var bn={registerPlugin:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];t.forEach((function(e){return Tt(e)}))},timeline:function(e){return new Yt(e)},getTweensOf:function(e,t){return i.getTweensOf(e,t)},getProperty:function(e,t,n,r){G(e)&&(e=ht(e)[0]);var i=be(e||{}).get,a=n?ke:Re;return"native"===n&&(n=""),e?t?a((ve[t]&&ve[t].get||i)(e,t,n,r)):function(t,n,r){return a((ve[t]&&ve[t].get||i)(e,t,n,r))}:e},quickSetter:function(e,t,n){if((e=ht(e)).length>1){var r=e.map((function(e){return Mn.quickSetter(e,t,n)})),i=r.length;return function(e){for(var t=i;t--;)r[t](e)}}e=e[0]||{};var a=ve[t],o=be(e),s=o.harness&&(o.harness.aliases||{})[t]||t,l=a?function(t){var r=new a;h._pt=0,r.init(e,n?t+n:t,h,0,[e]),r.render(1,r),h._pt&&vn(1,h)}:o.set(e,s);return a?l:function(t){return l(e,s,n?t+n:t,o,1)}},quickTo:function(e,t,n){var r,i=Mn.to(e,De(((r={})[t]="+=0.1",r.paused=!0,r),n||{})),a=function(e,n,r){return i.resetTo(t,e,n,r)};return a.tween=i,a},isTweening:function(e){return i.getTweensOf(e,!0).length>0},defaults:function(e){return e&&e.ease&&(e.ease=Ht(e.ease,D.ease)),Ie(D,e||{})},config:function(e){return Ie(P,e||{})},registerEffect:function(e){var t=e.name,n=e.effect,r=e.plugins,i=e.defaults,a=e.extendTimeline;(r||"").split(",").forEach((function(e){return e&&!ve[e]&&!ae[e]&&ue(t+" effect requires "+e+" plugin.")})),me[t]=function(e,t,r){return n(ht(e),Pe(t||{},i),r)},a&&(Yt.prototype[t]=function(e,n,r){return this.add(me[t](e,q(n)?n:(r=n)&&{},this),r)})},registerEase:function(e,t){Ot[e]=Ht(t)},parseEase:function(e,t){return arguments.length?Ht(e,t):Ot},getById:function(e){return i.getById(e)},exportRoot:function(e,t){void 0===e&&(e={});var n,r,a=new Yt(e);for(a.smoothChildTiming=X(e.smoothChildTiming),i.remove(a),a._dp=0,a._time=a._tTime=i._time,n=i._first;n;)r=n._next,!t&&!n._dur&&n instanceof on&&n.vars.onComplete===n._targets[0]||Ke(a,n,n._start-n._delay),n=r;return Ke(i,a,0),a},utils:{wrap:function e(t,n,r){var i=n-t;return J(t)?gt(t,e(0,t.length),n):at(r,(function(e){return(i+(e-t)%i)%i+t}))},wrapYoyo:function e(t,n,r){var i=n-t,a=2*i;return J(t)?gt(t,e(0,t.length-1),n):at(r,(function(e){return t+((e=(a+(e-t)%a)%a||0)>i?a-e:e)}))},distribute:ft,random:mt,snap:vt,normalize:function(e,t,n){return yt(e,t,0,1,n)},getUnit:st,clamp:function(e,t,n){return at(n,(function(n){return ot(e,t,n)}))},splitColor:At,toArray:ht,selector:function(e){return e=ht(e)[0]||ue("Invalid scope")||{},function(t){var n=e.current||e.nativeElement||e;return ht(t,n.querySelectorAll?n:n===e?ue("Invalid scope")||l.createElement("div"):e)}},mapRange:yt,pipe:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(e){return t.reduce((function(e,t){return t(e)}),e)}},unitize:function(e,t){return function(n){return e(parseFloat(n))+(t||st(n))}},interpolate:function e(t,n,r,i){var a=isNaN(t+n)?0:function(e){return(1-e)*t+e*n};if(!a){var o,s,l,u,c,h=G(t),d={};if(!0===r&&(i=1)&&(r=null),h)t={p:t},n={p:n};else if(J(t)&&!J(n)){for(l=[],u=t.length,c=u-2,s=1;s<u;s++)l.push(e(t[s-1],t[s]));u--,a=function(e){e*=u;var t=Math.min(c,~~e);return l[t](e-t)},r=n}else i||(t=De(J(t)?[]:{},t));if(!l){for(o in n)Qt.call(d,t,o,"get",n[o]);a=function(e){return vn(e,d)||(h?t.p:t)}}}return at(r,a)},shuffle:dt},install:se,effects:me,ticker:Dt,updateRoot:Yt.updateRoot,plugins:ve,globalTimeline:i,core:{PropTween:xn,globals:ce,Tween:on,Timeline:Yt,Animation:Xt,getCache:be,_removeLinkedListItem:Ue,suppressOverwrites:function(e){return r=e}}};Te("to,from,fromTo,delayedCall,set,killTweensOf",(function(e){return bn[e]=on[e]})),Dt.add(Yt.updateRoot),h=bn.to({},{duration:0});var wn=function(e,t){for(var n=e._pt;n&&n.p!==t&&n.op!==t&&n.fp!==t;)n=n._next;return n},Tn=function(e,t){return{name:e,rawVars:1,init:function(e,n,r){r._onInit=function(e){var r,i;if(G(n)&&(r={},Te(n,(function(e){return r[e]=1})),n=r),t){for(i in r={},n)r[i]=t(n[i]);n=r}!function(e,t){var n,r,i,a=e._targets;for(n in t)for(r=a.length;r--;)(i=e._ptLookup[r][n])&&(i=i.d)&&(i._pt&&(i=wn(i,n)),i&&i.modifier&&i.modifier(t[n],e,a[r],n))}(e,n)}}}},Mn=bn.registerPlugin({name:"attr",init:function(e,t,n,r,i){var a,o;for(a in t)(o=this.add(e,"setAttribute",(e.getAttribute(a)||0)+"",t[a],r,i,0,0,a))&&(o.op=a),this._props.push(a)}},{name:"endArray",init:function(e,t){for(var n=t.length;n--;)this.add(e,n,e[n]||0,t[n])}},Tn("roundProps",pt),Tn("modifiers"),Tn("snap",vt))||bn;on.version=Yt.version=Mn.version="3.10.4",u=1,Y()&&It();var Sn,En,An,Ln,Cn,Rn,kn,Pn=Ot.Power0,Dn=Ot.Power1,In=Ot.Power2,On=Ot.Power3,Fn=Ot.Power4,Nn=Ot.Linear,Un=Ot.Quad,Bn=Ot.Cubic,zn=Ot.Quart,Hn=Ot.Quint,Gn=Ot.Strong,Vn=Ot.Elastic,Wn=Ot.Back,jn=Ot.SteppedEase,qn=Ot.Bounce,Xn=Ot.Sine,Yn=Ot.Expo,Kn=Ot.Circ,Zn={},Jn=180/Math.PI,Qn=Math.PI/180,$n=Math.atan2,er=/([A-Z])/g,tr=/(left|right|width|margin|padding|x)/i,nr=/[\s,\(]\S/,rr={autoAlpha:"opacity,visibility",scale:"scaleX,scaleY",alpha:"opacity"},ir=function(e,t){return t.set(t.t,t.p,Math.round(1e4*(t.s+t.c*e))/1e4+t.u,t)},ar=function(e,t){return t.set(t.t,t.p,1===e?t.e:Math.round(1e4*(t.s+t.c*e))/1e4+t.u,t)},or=function(e,t){return t.set(t.t,t.p,e?Math.round(1e4*(t.s+t.c*e))/1e4+t.u:t.b,t)},sr=function(e,t){var n=t.s+t.c*e;t.set(t.t,t.p,~~(n+(n<0?-.5:.5))+t.u,t)},lr=function(e,t){return t.set(t.t,t.p,e?t.e:t.b,t)},ur=function(e,t){return t.set(t.t,t.p,1!==e?t.b:t.e,t)},cr=function(e,t,n){return e.style[t]=n},hr=function(e,t,n){return e.style.setProperty(t,n)},dr=function(e,t,n){return e._gsap[t]=n},fr=function(e,t,n){return e._gsap.scaleX=e._gsap.scaleY=n},pr=function(e,t,n,r,i){var a=e._gsap;a.scaleX=a.scaleY=n,a.renderTransform(i,a)},vr=function(e,t,n,r,i){var a=e._gsap;a[t]=n,a.renderTransform(i,a)},mr="transform",gr=mr+"Origin",_r=function(e,t){var n=En.createElementNS?En.createElementNS((t||"http://www.w3.org/1999/xhtml").replace(/^https/,"http"),e):En.createElement(e);return n.style?n:En.createElement(e)},yr=function e(t,n,r){var i=getComputedStyle(t);return i[n]||i.getPropertyValue(n.replace(er,"-$1").toLowerCase())||i.getPropertyValue(n)||!r&&e(t,br(n)||n,1)||""},xr="O,Moz,ms,Ms,Webkit".split(","),br=function(e,t,n){var r=(t||Cn).style,i=5;if(e in r&&!n)return e;for(e=e.charAt(0).toUpperCase()+e.substr(1);i--&&!(xr[i]+e in r););return i<0?null:(3===i?"ms":i>=0?xr[i]:"")+e},wr=function(){"undefined"!=typeof window&&window.document&&(Sn=window,En=Sn.document,An=En.documentElement,Cn=_r("div")||{style:{}},_r("div"),mr=br(mr),gr=mr+"Origin",Cn.style.cssText="border-width:0;line-height:0;position:absolute;padding:0",kn=!!br("perspective"),Ln=1)},Tr=function e(t){var n,r=_r("svg",this.ownerSVGElement&&this.ownerSVGElement.getAttribute("xmlns")||"http://www.w3.org/2000/svg"),i=this.parentNode,a=this.nextSibling,o=this.style.cssText;if(An.appendChild(r),r.appendChild(this),this.style.display="block",t)try{n=this.getBBox(),this._gsapBBox=this.getBBox,this.getBBox=e}catch(e){}else this._gsapBBox&&(n=this._gsapBBox());return i&&(a?i.insertBefore(this,a):i.appendChild(this)),An.removeChild(r),this.style.cssText=o,n},Mr=function(e,t){for(var n=t.length;n--;)if(e.hasAttribute(t[n]))return e.getAttribute(t[n])},Sr=function(e){var t;try{t=e.getBBox()}catch(n){t=Tr.call(e,!0)}return t&&(t.width||t.height)||e.getBBox===Tr||(t=Tr.call(e,!0)),!t||t.width||t.x||t.y?t:{x:+Mr(e,["x","cx","x1"])||0,y:+Mr(e,["y","cy","y1"])||0,width:0,height:0}},Er=function(e){return!(!e.getCTM||e.parentNode&&!e.ownerSVGElement||!Sr(e))},Ar=function(e,t){if(t){var n=e.style;t in Zn&&t!==gr&&(t=mr),n.removeProperty?("ms"!==t.substr(0,2)&&"webkit"!==t.substr(0,6)||(t="-"+t),n.removeProperty(t.replace(er,"-$1").toLowerCase())):n.removeAttribute(t)}},Lr=function(e,t,n,r,i,a){var o=new xn(e._pt,t,n,0,1,a?ur:lr);return e._pt=o,o.b=r,o.e=i,e._props.push(n),o},Cr={deg:1,rad:1,turn:1},Rr=function e(t,n,r,i){var a,o,s,l,u=parseFloat(r)||0,c=(r+"").trim().substr((u+"").length)||"px",h=Cn.style,d=tr.test(n),f="svg"===t.tagName.toLowerCase(),p=(f?"client":"offset")+(d?"Width":"Height"),v=100,m="px"===i,g="%"===i;return i===c||!u||Cr[i]||Cr[c]?u:("px"!==c&&!m&&(u=e(t,n,r,"px")),l=t.getCTM&&Er(t),!g&&"%"!==c||!Zn[n]&&!~n.indexOf("adius")?(h[d?"width":"height"]=v+(m?c:i),o=~n.indexOf("adius")||"em"===i&&t.appendChild&&!f?t:t.parentNode,l&&(o=(t.ownerSVGElement||{}).parentNode),o&&o!==En&&o.appendChild||(o=En.body),(s=o._gsap)&&g&&s.width&&d&&s.time===Dt.time?Me(u/s.width*v):((g||"%"===c)&&(h.position=yr(t,"position")),o===t&&(h.position="static"),o.appendChild(Cn),a=Cn[p],o.removeChild(Cn),h.position="absolute",d&&g&&((s=be(o)).time=Dt.time,s.width=o[p]),Me(m?a*u/v:a&&u?v/a*u:0))):(a=l?t.getBBox()[d?"width":"height"]:t[p],Me(g?u/a*v:u/100*a)))},kr=function(e,t,n,r){var i;return Ln||wr(),t in rr&&"transform"!==t&&~(t=rr[t]).indexOf(",")&&(t=t.split(",")[0]),Zn[t]&&"transform"!==t?(i=Gr(e,r),i="transformOrigin"!==t?i[t]:i.svg?i.origin:Vr(yr(e,gr))+" "+i.zOrigin+"px"):(!(i=e.style[t])||"auto"===i||r||~(i+"").indexOf("calc("))&&(i=Or[t]&&Or[t](e,t,n)||yr(e,t)||we(e,t)||("opacity"===t?1:0)),n&&!~(i+"").trim().indexOf(" ")?Rr(e,t,i,n)+n:i},Pr=function(e,t,n,r){if(!n||"none"===n){var i=br(t,e,1),a=i&&yr(e,i,1);a&&a!==n?(t=i,n=a):"borderColor"===t&&(n=yr(e,"borderTopColor"))}var o,s,l,u,c,h,d,f,p,v,m,g=new xn(this._pt,e.style,t,0,1,pn),_=0,y=0;if(g.b=n,g.e=r,n+="","auto"==(r+="")&&(e.style[t]=r,r=yr(e,t)||r,e.style[t]=n),Pt(o=[n,r]),r=o[1],l=(n=o[0]).match(ee)||[],(r.match(ee)||[]).length){for(;s=ee.exec(r);)d=s[0],p=r.substring(_,s.index),c?c=(c+1)%5:"rgba("!==p.substr(-5)&&"hsla("!==p.substr(-5)||(c=1),d!==(h=l[y++]||"")&&(u=parseFloat(h)||0,m=h.substr((u+"").length),"="===d.charAt(1)&&(d=Ee(u,d)+m),f=parseFloat(d),v=d.substr((f+"").length),_=ee.lastIndex-v.length,v||(v=v||P.units[t]||m,_===r.length&&(r+=v,g.e+=v)),m!==v&&(u=Rr(e,t,h,v)||0),g._pt={_next:g._pt,p:p||1===y?p:",",s:u,c:f-u,m:c&&c<4||"zIndex"===t?Math.round:0});g.c=_<r.length?r.substring(_,r.length):""}else g.r="display"===t&&"none"===r?ur:lr;return ne.test(r)&&(g.e=0),this._pt=g,g},Dr={top:"0%",bottom:"100%",left:"0%",right:"100%",center:"50%"},Ir=function(e,t){if(t.tween&&t.tween._time===t.tween._dur){var n,r,i,a=t.t,o=a.style,s=t.u,l=a._gsap;if("all"===s||!0===s)o.cssText="",r=1;else for(i=(s=s.split(",")).length;--i>-1;)n=s[i],Zn[n]&&(r=1,n="transformOrigin"===n?gr:mr),Ar(a,n);r&&(Ar(a,mr),l&&(l.svg&&a.removeAttribute("transform"),Gr(a,1),l.uncache=1))}},Or={clearProps:function(e,t,n,r,i){if("isFromStart"!==i.data){var a=e._pt=new xn(e._pt,t,n,0,0,Ir);return a.u=r,a.pr=-10,a.tween=i,e._props.push(n),1}}},Fr=[1,0,0,1,0,0],Nr={},Ur=function(e){return"matrix(1, 0, 0, 1, 0, 0)"===e||"none"===e||!e},Br=function(e){var t=yr(e,mr);return Ur(t)?Fr:t.substr(7).match($).map(Me)},zr=function(e,t){var n,r,i,a,o=e._gsap||be(e),s=e.style,l=Br(e);return o.svg&&e.getAttribute("transform")?"1,0,0,1,0,0"===(l=[(i=e.transform.baseVal.consolidate().matrix).a,i.b,i.c,i.d,i.e,i.f]).join(",")?Fr:l:(l!==Fr||e.offsetParent||e===An||o.svg||(i=s.display,s.display="block",(n=e.parentNode)&&e.offsetParent||(a=1,r=e.nextSibling,An.appendChild(e)),l=Br(e),i?s.display=i:Ar(e,"display"),a&&(r?n.insertBefore(e,r):n?n.appendChild(e):An.removeChild(e))),t&&l.length>6?[l[0],l[1],l[4],l[5],l[12],l[13]]:l)},Hr=function(e,t,n,r,i,a){var o,s,l,u=e._gsap,c=i||zr(e,!0),h=u.xOrigin||0,d=u.yOrigin||0,f=u.xOffset||0,p=u.yOffset||0,v=c[0],m=c[1],g=c[2],_=c[3],y=c[4],x=c[5],b=t.split(" "),w=parseFloat(b[0])||0,T=parseFloat(b[1])||0;n?c!==Fr&&(s=v*_-m*g)&&(l=w*(-m/s)+T*(v/s)-(v*x-m*y)/s,w=w*(_/s)+T*(-g/s)+(g*x-_*y)/s,T=l):(w=(o=Sr(e)).x+(~b[0].indexOf("%")?w/100*o.width:w),T=o.y+(~(b[1]||b[0]).indexOf("%")?T/100*o.height:T)),r||!1!==r&&u.smooth?(y=w-h,x=T-d,u.xOffset=f+(y*v+x*g)-y,u.yOffset=p+(y*m+x*_)-x):u.xOffset=u.yOffset=0,u.xOrigin=w,u.yOrigin=T,u.smooth=!!r,u.origin=t,u.originIsAbsolute=!!n,e.style[gr]="0px 0px",a&&(Lr(a,u,"xOrigin",h,w),Lr(a,u,"yOrigin",d,T),Lr(a,u,"xOffset",f,u.xOffset),Lr(a,u,"yOffset",p,u.yOffset)),e.setAttribute("data-svg-origin",w+" "+T)},Gr=function(e,t){var n=e._gsap||new qt(e);if("x"in n&&!t&&!n.uncache)return n;var r,i,a,o,s,l,u,c,h,d,f,p,v,m,g,_,y,x,b,w,T,M,S,E,A,L,C,R,k,D,I,O,F=e.style,N=n.scaleX<0,U="px",B="deg",z=yr(e,gr)||"0";return r=i=a=l=u=c=h=d=f=0,o=s=1,n.svg=!(!e.getCTM||!Er(e)),m=zr(e,n.svg),n.svg&&(E=(!n.uncache||"0px 0px"===z)&&!t&&e.getAttribute("data-svg-origin"),Hr(e,E||z,!!E||n.originIsAbsolute,!1!==n.smooth,m)),p=n.xOrigin||0,v=n.yOrigin||0,m!==Fr&&(x=m[0],b=m[1],w=m[2],T=m[3],r=M=m[4],i=S=m[5],6===m.length?(o=Math.sqrt(x*x+b*b),s=Math.sqrt(T*T+w*w),l=x||b?$n(b,x)*Jn:0,(h=w||T?$n(w,T)*Jn+l:0)&&(s*=Math.abs(Math.cos(h*Qn))),n.svg&&(r-=p-(p*x+v*w),i-=v-(p*b+v*T))):(O=m[6],D=m[7],C=m[8],R=m[9],k=m[10],I=m[11],r=m[12],i=m[13],a=m[14],u=(g=$n(O,k))*Jn,g&&(E=M*(_=Math.cos(-g))+C*(y=Math.sin(-g)),A=S*_+R*y,L=O*_+k*y,C=M*-y+C*_,R=S*-y+R*_,k=O*-y+k*_,I=D*-y+I*_,M=E,S=A,O=L),c=(g=$n(-w,k))*Jn,g&&(_=Math.cos(-g),I=T*(y=Math.sin(-g))+I*_,x=E=x*_-C*y,b=A=b*_-R*y,w=L=w*_-k*y),l=(g=$n(b,x))*Jn,g&&(E=x*(_=Math.cos(g))+b*(y=Math.sin(g)),A=M*_+S*y,b=b*_-x*y,S=S*_-M*y,x=E,M=A),u&&Math.abs(u)+Math.abs(l)>359.9&&(u=l=0,c=180-c),o=Me(Math.sqrt(x*x+b*b+w*w)),s=Me(Math.sqrt(S*S+O*O)),g=$n(M,S),h=Math.abs(g)>2e-4?g*Jn:0,f=I?1/(I<0?-I:I):0),n.svg&&(E=e.getAttribute("transform"),n.forceCSS=e.setAttribute("transform","")||!Ur(yr(e,mr)),E&&e.setAttribute("transform",E))),Math.abs(h)>90&&Math.abs(h)<270&&(N?(o*=-1,h+=l<=0?180:-180,l+=l<=0?180:-180):(s*=-1,h+=h<=0?180:-180)),t=t||n.uncache,n.x=r-((n.xPercent=r&&(!t&&n.xPercent||(Math.round(e.offsetWidth/2)===Math.round(-r)?-50:0)))?e.offsetWidth*n.xPercent/100:0)+U,n.y=i-((n.yPercent=i&&(!t&&n.yPercent||(Math.round(e.offsetHeight/2)===Math.round(-i)?-50:0)))?e.offsetHeight*n.yPercent/100:0)+U,n.z=a+U,n.scaleX=Me(o),n.scaleY=Me(s),n.rotation=Me(l)+B,n.rotationX=Me(u)+B,n.rotationY=Me(c)+B,n.skewX=h+B,n.skewY=d+B,n.transformPerspective=f+U,(n.zOrigin=parseFloat(z.split(" ")[2])||0)&&(F[gr]=Vr(z)),n.xOffset=n.yOffset=0,n.force3D=P.force3D,n.renderTransform=n.svg?Zr:kn?Kr:jr,n.uncache=0,n},Vr=function(e){return(e=e.split(" "))[0]+" "+e[1]},Wr=function(e,t,n){var r=st(t);return Me(parseFloat(t)+parseFloat(Rr(e,"x",n+"px",r)))+r},jr=function(e,t){t.z="0px",t.rotationY=t.rotationX="0deg",t.force3D=0,Kr(e,t)},qr="0deg",Xr="0px",Yr=") ",Kr=function(e,t){var n=t||this,r=n.xPercent,i=n.yPercent,a=n.x,o=n.y,s=n.z,l=n.rotation,u=n.rotationY,c=n.rotationX,h=n.skewX,d=n.skewY,f=n.scaleX,p=n.scaleY,v=n.transformPerspective,m=n.force3D,g=n.target,_=n.zOrigin,y="",x="auto"===m&&e&&1!==e||!0===m;if(_&&(c!==qr||u!==qr)){var b,w=parseFloat(u)*Qn,T=Math.sin(w),M=Math.cos(w);w=parseFloat(c)*Qn,b=Math.cos(w),a=Wr(g,a,T*b*-_),o=Wr(g,o,-Math.sin(w)*-_),s=Wr(g,s,M*b*-_+_)}v!==Xr&&(y+="perspective("+v+Yr),(r||i)&&(y+="translate("+r+"%, "+i+"%) "),(x||a!==Xr||o!==Xr||s!==Xr)&&(y+=s!==Xr||x?"translate3d("+a+", "+o+", "+s+") ":"translate("+a+", "+o+Yr),l!==qr&&(y+="rotate("+l+Yr),u!==qr&&(y+="rotateY("+u+Yr),c!==qr&&(y+="rotateX("+c+Yr),h===qr&&d===qr||(y+="skew("+h+", "+d+Yr),1===f&&1===p||(y+="scale("+f+", "+p+Yr),g.style[mr]=y||"translate(0, 0)"},Zr=function(e,t){var n,r,i,a,o,s=t||this,l=s.xPercent,u=s.yPercent,c=s.x,h=s.y,d=s.rotation,f=s.skewX,p=s.skewY,v=s.scaleX,m=s.scaleY,g=s.target,_=s.xOrigin,y=s.yOrigin,x=s.xOffset,b=s.yOffset,w=s.forceCSS,T=parseFloat(c),M=parseFloat(h);d=parseFloat(d),f=parseFloat(f),(p=parseFloat(p))&&(f+=p=parseFloat(p),d+=p),d||f?(d*=Qn,f*=Qn,n=Math.cos(d)*v,r=Math.sin(d)*v,i=Math.sin(d-f)*-m,a=Math.cos(d-f)*m,f&&(p*=Qn,o=Math.tan(f-p),i*=o=Math.sqrt(1+o*o),a*=o,p&&(o=Math.tan(p),n*=o=Math.sqrt(1+o*o),r*=o)),n=Me(n),r=Me(r),i=Me(i),a=Me(a)):(n=v,a=m,r=i=0),(T&&!~(c+"").indexOf("px")||M&&!~(h+"").indexOf("px"))&&(T=Rr(g,"x",c,"px"),M=Rr(g,"y",h,"px")),(_||y||x||b)&&(T=Me(T+_-(_*n+y*i)+x),M=Me(M+y-(_*r+y*a)+b)),(l||u)&&(o=g.getBBox(),T=Me(T+l/100*o.width),M=Me(M+u/100*o.height)),o="matrix("+n+","+r+","+i+","+a+","+T+","+M+")",g.setAttribute("transform",o),w&&(g.style[mr]=o)},Jr=function(e,t,n,r,i){var a,o,s=360,l=G(i),u=parseFloat(i)*(l&&~i.indexOf("rad")?Jn:1)-r,c=r+u+"deg";return l&&("short"===(a=i.split("_")[1])&&(u%=s)!=u%180&&(u+=u<0?s:-360),"cw"===a&&u<0?u=(u+36e9)%s-~~(u/s)*s:"ccw"===a&&u>0&&(u=(u-36e9)%s-~~(u/s)*s)),e._pt=o=new xn(e._pt,t,n,r,u,ar),o.e=c,o.u="deg",e._props.push(n),o},Qr=function(e,t){for(var n in t)e[n]=t[n];return e},$r=function(e,t,n){var r,i,a,o,s,l,u,c=Qr({},n._gsap),h=n.style;for(i in c.svg?(a=n.getAttribute("transform"),n.setAttribute("transform",""),h[mr]=t,r=Gr(n,1),Ar(n,mr),n.setAttribute("transform",a)):(a=getComputedStyle(n)[mr],h[mr]=t,r=Gr(n,1),h[mr]=a),Zn)(a=c[i])!==(o=r[i])&&"perspective,force3D,transformOrigin,svgOrigin".indexOf(i)<0&&(s=st(a)!==(u=st(o))?Rr(n,i,a,u):parseFloat(a),l=parseFloat(o),e._pt=new xn(e._pt,r,i,s,l-s,ir),e._pt.u=u||0,e._props.push(i));Qr(r,c)};Te("padding,margin,Width,Radius",(function(e,t){var n="Top",r="Right",i="Bottom",a="Left",o=(t<3?[n,r,i,a]:[n+a,n+r,i+r,i+a]).map((function(n){return t<2?e+n:"border"+n+e}));Or[t>1?"border"+e:e]=function(e,t,n,r,i){var a,s;if(arguments.length<4)return a=o.map((function(t){return kr(e,t,n)})),5===(s=a.join(" ")).split(a[0]).length?a[0]:s;a=(r+"").split(" "),s={},o.forEach((function(e,t){return s[e]=a[t]=a[t]||a[(t-1)/2|0]})),e.init(t,s,i)}}));var ei,ti,ni,ri={name:"css",register:wr,targetTest:function(e){return e.style&&e.nodeType},init:function(e,t,n,r,i){var o,s,l,u,c,h,d,f,p,v,m,g,_,y,x,b,w,T,M,S=this._props,E=e.style,A=n.vars.startAt;for(d in Ln||wr(),t)if("autoRound"!==d&&(s=t[d],!ve[d]||!$t(d,t,n,r,e,i)))if(c=(0,a.default)(s),h=Or[d],"function"===c&&(s=s.call(n,r,e,i),c=(0,a.default)(s)),"string"===c&&~s.indexOf("random(")&&(s=_t(s)),h)h(this,e,d,s,n)&&(x=1);else if("--"===d.substr(0,2))o=(getComputedStyle(e).getPropertyValue(d)+"").trim(),s+="",Rt.lastIndex=0,Rt.test(o)||(f=st(o),p=st(s)),p?f!==p&&(o=Rr(e,d,o,p)+p):f&&(s+=f),this.add(E,"setProperty",o,s,r,i,0,0,d),S.push(d);else if("undefined"!==c){if(A&&d in A?(o="function"==typeof A[d]?A[d].call(n,r,e,i):A[d],G(o)&&~o.indexOf("random(")&&(o=_t(o)),st(o+"")||(o+=P.units[d]||st(kr(e,d))||""),"="===(o+"").charAt(1)&&(o=kr(e,d))):o=kr(e,d),u=parseFloat(o),(v="string"===c&&"="===s.charAt(1)&&s.substr(0,2))&&(s=s.substr(2)),l=parseFloat(s),d in rr&&("autoAlpha"===d&&(1===u&&"hidden"===kr(e,"visibility")&&l&&(u=0),Lr(this,E,"visibility",u?"inherit":"hidden",l?"inherit":"hidden",!l)),"scale"!==d&&"transform"!==d&&~(d=rr[d]).indexOf(",")&&(d=d.split(",")[0])),m=d in Zn)if(g||((_=e._gsap).renderTransform&&!t.parseTransform||Gr(e,t.parseTransform),y=!1!==t.smoothOrigin&&_.smooth,(g=this._pt=new xn(this._pt,E,mr,0,1,_.renderTransform,_,0,-1)).dep=1),"scale"===d)this._pt=new xn(this._pt,_,"scaleY",_.scaleY,(v?Ee(_.scaleY,v+l):l)-_.scaleY||0),S.push("scaleY",d),d+="X";else{if("transformOrigin"===d){w=void 0,T=void 0,M=void 0,w=(b=s).split(" "),T=w[0],M=w[1]||"50%","top"!==T&&"bottom"!==T&&"left"!==M&&"right"!==M||(b=T,T=M,M=b),w[0]=Dr[T]||T,w[1]=Dr[M]||M,s=w.join(" "),_.svg?Hr(e,s,0,y,0,this):((p=parseFloat(s.split(" ")[2])||0)!==_.zOrigin&&Lr(this,_,"zOrigin",_.zOrigin,p),Lr(this,E,d,Vr(o),Vr(s)));continue}if("svgOrigin"===d){Hr(e,s,1,y,0,this);continue}if(d in Nr){Jr(this,_,d,u,v?Ee(u,v+s):s);continue}if("smoothOrigin"===d){Lr(this,_,"smooth",_.smooth,s);continue}if("force3D"===d){_[d]=s;continue}if("transform"===d){$r(this,s,e);continue}}else d in E||(d=br(d)||d);if(m||(l||0===l)&&(u||0===u)&&!nr.test(s)&&d in E)l||(l=0),(f=(o+"").substr((u+"").length))!==(p=st(s)||(d in P.units?P.units[d]:f))&&(u=Rr(e,d,o,p)),this._pt=new xn(this._pt,m?_:E,d,u,(v?Ee(u,v+l):l)-u,m||"px"!==p&&"zIndex"!==d||!1===t.autoRound?ir:sr),this._pt.u=p||0,f!==p&&"%"!==p&&(this._pt.b=o,this._pt.r=or);else if(d in E)Pr.call(this,e,d,o,v?v+s:s);else{if(!(d in e)){le(d,s);continue}this.add(e,d,o||e[d],v?v+s:s,r,i)}S.push(d)}x&&yn(this)},get:kr,aliases:rr,getSetter:function(e,t,n){var r=rr[t];return r&&r.indexOf(",")<0&&(t=r),t in Zn&&t!==gr&&(e._gsap.x||kr(e,"x"))?n&&Rn===n?"scale"===t?fr:dr:(Rn=n||{})&&("scale"===t?pr:vr):e.style&&!j(e.style[t])?cr:~t.indexOf("-")?hr:hn(e,t)},core:{_removeProperty:Ar,_getMatrix:zr}};Mn.utils.checkPrefix=br,ni=Te((ei="x,y,z,scale,scaleX,scaleY,xPercent,yPercent")+","+(ti="rotation,rotationX,rotationY,skewX,skewY")+",transform,transformOrigin,svgOrigin,force3D,smoothOrigin,transformPerspective",(function(e){Zn[e]=1})),Te(ti,(function(e){P.units[e]="deg",Nr[e]=1})),rr[ni[13]]=ei+","+ti,Te("0:translateX,1:translateY,2:translateZ,8:rotate,8:rotationZ,8:rotateZ,9:rotateX,10:rotateY",(function(e){var t=e.split(":");rr[t[1]]=ni[t[0]]})),Te("x,y,z,top,right,bottom,left,width,height,fontSize,padding,margin,perspective",(function(e){P.units[e]="px"})),Mn.registerPlugin(ri);var ii=Mn.registerPlugin(ri)||Mn,ai=ii.core.Tween;e.Back=Wn,e.Bounce=qn,e.CSSPlugin=ri,e.Circ=Kn,e.Cubic=Bn,e.Elastic=Vn,e.Expo=Yn,e.Linear=Nn,e.Power0=Pn,e.Power1=Dn,e.Power2=In,e.Power3=On,e.Power4=Fn,e.Quad=Un,e.Quart=zn,e.Quint=Hn,e.Sine=Xn,e.SteppedEase=jn,e.Strong=Gn,e.TimelineLite=Yt,e.TimelineMax=Yt,e.TweenLite=on,e.TweenMax=ai,e.default=ii,e.gsap=ii,"undefined"==typeof window||window!==e?Object.defineProperty(e,"__esModule",{value:!0}):delete window.default},"object"===(void 0===n?"undefined":(0,a.default)(n))&&void 0!==t?i(n):"function"==typeof define&&define.amd?define(["exports"],i):i((r=r||self).window=r.window||{})},{"@babel/runtime/helpers/interopRequireDefault":12,"@babel/runtime/helpers/typeof":22}],28:[function(e,t,n){"use strict";var r=e("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(n,"__esModule",{value:!0}),n.wrapYoyo=n.wrap=n.unitize=n.toArray=n.splitColor=n.snap=n.shuffle=n.selector=n.random=n.pipe=n.normalize=n.mapRange=n.interpolate=n.gsap=n.getUnit=n.distribute=n.default=n.clamp=n._ticker=n._sortPropTweensByPriority=n._setDefaults=n._roundModifier=n._round=n._replaceRandom=n._renderComplexString=n._removeLinkedListItem=n._relExp=n._plugins=n._parseRelative=n._numWithUnitExp=n._numExp=n._missingPlugin=n._isUndefined=n._isString=n._getSetter=n._getProperty=n._getCache=n._forEachName=n._config=n._colorStringFilter=n._colorExp=n._checkPlugin=n.TweenMax=n.TweenLite=n.Tween=n.TimelineMax=n.TimelineLite=n.Timeline=n.Strong=n.SteppedEase=n.Sine=n.Quint=n.Quart=n.Quad=n.PropTween=n.Power4=n.Power3=n.Power2=n.Power1=n.Power0=n.Linear=n.GSCache=n.Expo=n.Elastic=n.Cubic=n.Circ=n.Bounce=n.Back=n.Animation=void 0;var i=r(e("@babel/runtime/helpers/typeof"));function a(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function o(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e.__proto__=t}
/*!
 * GSAP 3.10.4
 * https://greensock.com
 *
 * @license Copyright 2008-2022, GreenSock. All rights reserved.
 * Subject to the terms at https://greensock.com/standard-license or for
 * Club GreenSock members, the agreement issued with that membership.
 * @author: Jack Doyle, jack@greensock.com
*/var s,l,u,c,h,d,f,p,v,m,g,_,y,x,b,w,T,M,S,E,A,L,C,R,k,P,D,I,O={autoSleep:120,force3D:"auto",nullTargetWarn:1,units:{lineHeight:""}},F={duration:.5,overwrite:!1,delay:0},N=1e8,U=1e-8,B=2*Math.PI,z=B/4,H=0,G=Math.sqrt,V=Math.cos,W=Math.sin,j=function(e){return"string"==typeof e},q=function(e){return"function"==typeof e},X=function(e){return"number"==typeof e},Y=function(e){return void 0===e},K=function(e){return"object"===(0,i.default)(e)},Z=function(e){return!1!==e},J=function(){return"undefined"!=typeof window},Q=function(e){return q(e)||j(e)},$="function"==typeof ArrayBuffer&&ArrayBuffer.isView||function(){},ee=Array.isArray,te=/(?:-?\.?\d|\.)+/gi,ne=/[-+=.]*\d+[.e\-+]*\d*[e\-+]*\d*/g,re=/[-+=.]*\d+[.e-]*\d*[a-z%]*/g,ie=/[-+=.]*\d+\.?\d*(?:e-|e\+)?\d*/gi,ae=/[+-]=-?[.\d]+/,oe=/[^,'"\[\]\s]+/gi,se=/^[+\-=e\s\d]*\d+[.\d]*([a-z]*|%)\s*$/i,le={},ue={},ce=function(e){return(ue=Fe(e,le))&&On},he=function(e,t){return console.warn("Invalid property",e,"set to",t,"Missing plugin? gsap.registerPlugin()")},de=function(e,t){return!t&&console.warn(e)},fe=function(e,t){return e&&(le[e]=t)&&ue&&(ue[e]=t)||le},pe=function(){return 0},ve={},me=[],ge={},_e={},ye={},xe=30,be=[],we="",Te=function(e){var t,n,r=e[0];if(K(r)||q(r)||(e=[e]),!(t=(r._gsap||{}).harness)){for(n=be.length;n--&&!be[n].targetTest(r););t=be[n]}for(n=e.length;n--;)e[n]&&(e[n]._gsap||(e[n]._gsap=new rn(e[n],t)))||e.splice(n,1);return e},Me=function(e){return e._gsap||Te(vt(e))[0]._gsap},Se=function(e,t,n){return(n=e[t])&&q(n)?e[t]():Y(n)&&e.getAttribute&&e.getAttribute(t)||n},Ee=function(e,t){return(e=e.split(",")).forEach(t)||e},Ae=function(e){return Math.round(1e5*e)/1e5||0},Le=function(e){return Math.round(1e7*e)/1e7||0},Ce=function(e,t){var n=t.charAt(0),r=parseFloat(t.substr(2));return e=parseFloat(e),"+"===n?e+r:"-"===n?e-r:"*"===n?e*r:e/r},Re=function(e,t){for(var n=t.length,r=0;e.indexOf(t[r])<0&&++r<n;);return r<n},ke=function(){var e,t,n=me.length,r=me.slice(0);for(ge={},me.length=0,e=0;e<n;e++)(t=r[e])&&t._lazy&&(t.render(t._lazy[0],t._lazy[1],!0)._lazy=0)},Pe=function(e,t,n,r){me.length&&ke(),e.render(t,n,r),me.length&&ke()},De=function(e){var t=parseFloat(e);return(t||0===t)&&(e+"").match(oe).length<2?t:j(e)?e.trim():e},Ie=function(e){return e},Oe=function(e,t){for(var n in t)n in e||(e[n]=t[n]);return e},Fe=function(e,t){for(var n in t)e[n]=t[n];return e},Ne=function e(t,n){for(var r in n)"__proto__"!==r&&"constructor"!==r&&"prototype"!==r&&(t[r]=K(n[r])?e(t[r]||(t[r]={}),n[r]):n[r]);return t},Ue=function(e,t){var n,r={};for(n in e)n in t||(r[n]=e[n]);return r},Be=function(e){var t,n=e.parent||l,r=e.keyframes?(t=ee(e.keyframes),function(e,n){for(var r in n)r in e||"duration"===r&&t||"ease"===r||(e[r]=n[r])}):Oe;if(Z(e.inherit))for(;n;)r(e,n.vars.defaults),n=n.parent||n._dp;return e},ze=function(e,t,n,r,i){void 0===n&&(n="_first"),void 0===r&&(r="_last");var a,o=e[r];if(i)for(a=t[i];o&&o[i]>a;)o=o._prev;return o?(t._next=o._next,o._next=t):(t._next=e[n],e[n]=t),t._next?t._next._prev=t:e[r]=t,t._prev=o,t.parent=t._dp=e,t},He=function(e,t,n,r){void 0===n&&(n="_first"),void 0===r&&(r="_last");var i=t._prev,a=t._next;i?i._next=a:e[n]===t&&(e[n]=a),a?a._prev=i:e[r]===t&&(e[r]=i),t._next=t._prev=t.parent=null},Ge=function(e,t){e.parent&&(!t||e.parent.autoRemoveChildren)&&e.parent.remove(e),e._act=0},Ve=function(e,t){if(e&&(!t||t._end>e._dur||t._start<0))for(var n=e;n;)n._dirty=1,n=n.parent;return e},We=function(e){for(var t=e.parent;t&&t.parent;)t._dirty=1,t.totalDuration(),t=t.parent;return e},je=function e(t){return!t||t._ts&&e(t.parent)},qe=function(e){return e._repeat?Xe(e._tTime,e=e.duration()+e._rDelay)*e:0},Xe=function(e,t){var n=Math.floor(e/=t);return e&&n===e?n-1:n},Ye=function(e,t){return(e-t._start)*t._ts+(t._ts>=0?0:t._dirty?t.totalDuration():t._tDur)},Ke=function(e){return e._end=Le(e._start+(e._tDur/Math.abs(e._ts||e._rts||U)||0))},Ze=function(e,t){var n=e._dp;return n&&n.smoothChildTiming&&e._ts&&(e._start=Le(n._time-(e._ts>0?t/e._ts:((e._dirty?e.totalDuration():e._tDur)-t)/-e._ts)),Ke(e),n._dirty||Ve(n,e)),e},Je=function(e,t){var n;if((t._time||t._initted&&!t._dur)&&(n=Ye(e.rawTime(),t),(!t._dur||ut(0,t.totalDuration(),n)-t._tTime>U)&&t.render(n,!0)),Ve(e,t)._dp&&e._initted&&e._time>=e._dur&&e._ts){if(e._dur<e.duration())for(n=e;n._dp;)n.rawTime()>=0&&n.totalTime(n._tTime),n=n._dp;e._zTime=-1e-8}},Qe=function(e,t,n,r){return t.parent&&Ge(t),t._start=Le((X(n)?n:n||e!==l?ot(e,n,t):e._time)+t._delay),t._end=Le(t._start+(t.totalDuration()/Math.abs(t.timeScale())||0)),ze(e,t,"_first","_last",e._sort?"_start":0),nt(t)||(e._recent=t),r||Je(e,t),e},$e=function(e,t){return(le.ScrollTrigger||he("scrollTrigger",t))&&le.ScrollTrigger.create(t,e)},et=function(e,t,n,r){return dn(e,t),e._initted?!n&&e._pt&&(e._dur&&!1!==e.vars.lazy||!e._dur&&e.vars.lazy)&&f!==Wt.frame?(me.push(e),e._lazy=[t,r],1):void 0:1},tt=function e(t){var n=t.parent;return n&&n._ts&&n._initted&&!n._lock&&(n.rawTime()<0||e(n))},nt=function(e){var t=e.data;return"isFromStart"===t||"isStart"===t},rt=function(e,t,n,r){var i=e._repeat,a=Le(t)||0,o=e._tTime/e._tDur;return o&&!r&&(e._time*=a/e._dur),e._dur=a,e._tDur=i?i<0?1e10:Le(a*(i+1)+e._rDelay*i):a,o>0&&!r?Ze(e,e._tTime=e._tDur*o):e.parent&&Ke(e),n||Ve(e.parent,e),e},it=function(e){return e instanceof on?Ve(e):rt(e,e._dur)},at={_start:0,endTime:pe,totalDuration:pe},ot=function e(t,n,r){var i,a,o,s=t.labels,l=t._recent||at,u=t.duration()>=N?l.endTime(!1):t._dur;return j(n)&&(isNaN(n)||n in s)?(a=n.charAt(0),o="%"===n.substr(-1),i=n.indexOf("="),"<"===a||">"===a?(i>=0&&(n=n.replace(/=/,"")),("<"===a?l._start:l.endTime(l._repeat>=0))+(parseFloat(n.substr(1))||0)*(o?(i<0?l:r).totalDuration()/100:1)):i<0?(n in s||(s[n]=u),s[n]):(a=parseFloat(n.charAt(i-1)+n.substr(i+1)),o&&r&&(a=a/100*(ee(r)?r[0]:r).totalDuration()),i>1?e(t,n.substr(0,i-1),r)+a:u+a)):null==n?u:+n},st=function(e,t,n){var r,i,a=X(t[1]),o=(a?2:1)+(e<2?0:1),s=t[o];if(a&&(s.duration=t[1]),s.parent=n,e){for(r=s,i=n;i&&!("immediateRender"in r);)r=i.vars.defaults||{},i=Z(i.vars.inherit)&&i.parent;s.immediateRender=Z(r.immediateRender),e<2?s.runBackwards=1:s.startAt=t[o-1]}return new gn(t[0],s,t[o+1])},lt=function(e,t){return e||0===e?t(e):t},ut=function(e,t,n){return n<e?e:n>t?t:n},ct=function(e,t){return j(e)&&(t=se.exec(e))?t[1]:""},ht=function(e,t,n){return lt(n,(function(n){return ut(e,t,n)}))},dt=[].slice,ft=function(e,t){return e&&K(e)&&"length"in e&&(!t&&!e.length||e.length-1 in e&&K(e[0]))&&!e.nodeType&&e!==u},pt=function(e,t,n){return void 0===n&&(n=[]),e.forEach((function(e){var r;return j(e)&&!t||ft(e,1)?(r=n).push.apply(r,vt(e)):n.push(e)}))||n},vt=function(e,t,n){return!j(e)||n||!c&&jt()?ee(e)?pt(e,n):ft(e)?dt.call(e,0):e?[e]:[]:dt.call((t||h).querySelectorAll(e),0)},mt=function(e){return e=vt(e)[0]||de("Invalid scope")||{},function(t){var n=e.current||e.nativeElement||e;return vt(t,n.querySelectorAll?n:n===e?de("Invalid scope")||h.createElement("div"):e)}},gt=function(e){return e.sort((function(){return.5-Math.random()}))},_t=function(e){if(q(e))return e;var t=K(e)?e:{each:e},n=Qt(t.ease),r=t.from||0,i=parseFloat(t.base)||0,a={},o=r>0&&r<1,s=isNaN(r)||o,l=t.axis,u=r,c=r;return j(r)?u=c={center:.5,edges:.5,end:1}[r]||0:!o&&s&&(u=r[0],c=r[1]),function(e,o,h){var d,f,p,v,m,g,_,y,x,b=(h||t).length,w=a[b];if(!w){if(!(x="auto"===t.grid?0:(t.grid||[1,N])[1])){for(_=-N;_<(_=h[x++].getBoundingClientRect().left)&&x<b;);x--}for(w=a[b]=[],d=s?Math.min(x,b)*u-.5:r%x,f=x===N?0:s?b*c/x-.5:r/x|0,_=0,y=N,g=0;g<b;g++)p=g%x-d,v=f-(g/x|0),w[g]=m=l?Math.abs("y"===l?v:p):G(p*p+v*v),m>_&&(_=m),m<y&&(y=m);"random"===r&&gt(w),w.max=_-y,w.min=y,w.v=b=(parseFloat(t.amount)||parseFloat(t.each)*(x>b?b-1:l?"y"===l?b/x:x:Math.max(x,b/x))||0)*("edges"===r?-1:1),w.b=b<0?i-b:i,w.u=ct(t.amount||t.each)||0,n=n&&b<0?Zt(n):n}return b=(w[e]-w.min)/w.max||0,Le(w.b+(n?n(b):b)*w.v)+w.u}},yt=function(e){var t=Math.pow(10,((e+"").split(".")[1]||"").length);return function(n){var r=Math.round(parseFloat(n)/e)*e*t;return(r-r%1)/t+(X(n)?0:ct(n))}},xt=function(e,t){var n,r,i=ee(e);return!i&&K(e)&&(n=i=e.radius||N,e.values?(e=vt(e.values),(r=!X(e[0]))&&(n*=n)):e=yt(e.increment)),lt(t,i?q(e)?function(t){return r=e(t),Math.abs(r-t)<=n?r:t}:function(t){for(var i,a,o=parseFloat(r?t.x:t),s=parseFloat(r?t.y:0),l=N,u=0,c=e.length;c--;)(i=r?(i=e[c].x-o)*i+(a=e[c].y-s)*a:Math.abs(e[c]-o))<l&&(l=i,u=c);return u=!n||l<=n?e[u]:t,r||u===t||X(t)?u:u+ct(t)}:yt(e))},bt=function(e,t,n,r){return lt(ee(e)?!t:!0===n?!!(n=0):!r,(function(){return ee(e)?e[~~(Math.random()*e.length)]:(n=n||1e-5)&&(r=n<1?Math.pow(10,(n+"").length-2):1)&&Math.floor(Math.round((e-n/2+Math.random()*(t-e+.99*n))/n)*n*r)/r}))},wt=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(e){return t.reduce((function(e,t){return t(e)}),e)}},Tt=function(e,t){return function(n){return e(parseFloat(n))+(t||ct(n))}},Mt=function(e,t,n){return Ct(e,t,0,1,n)},St=function(e,t,n){return lt(n,(function(n){return e[~~t(n)]}))},Et=function e(t,n,r){var i=n-t;return ee(t)?St(t,e(0,t.length),n):lt(r,(function(e){return(i+(e-t)%i)%i+t}))},At=function e(t,n,r){var i=n-t,a=2*i;return ee(t)?St(t,e(0,t.length-1),n):lt(r,(function(e){return t+((e=(a+(e-t)%a)%a||0)>i?a-e:e)}))},Lt=function(e){for(var t,n,r,i,a=0,o="";~(t=e.indexOf("random(",a));)r=e.indexOf(")",t),i="["===e.charAt(t+7),n=e.substr(t+7,r-t-7).match(i?oe:te),o+=e.substr(a,t-a)+bt(i?n:+n[0],i?0:+n[1],+n[2]||1e-5),a=r+1;return o+e.substr(a,e.length-a)},Ct=function(e,t,n,r,i){var a=t-e,o=r-n;return lt(i,(function(t){return n+((t-e)/a*o||0)}))},Rt=function e(t,n,r,i){var a=isNaN(t+n)?0:function(e){return(1-e)*t+e*n};if(!a){var o,s,l,u,c,h=j(t),d={};if(!0===r&&(i=1)&&(r=null),h)t={p:t},n={p:n};else if(ee(t)&&!ee(n)){for(l=[],u=t.length,c=u-2,s=1;s<u;s++)l.push(e(t[s-1],t[s]));u--,a=function(e){e*=u;var t=Math.min(c,~~e);return l[t](e-t)},r=n}else i||(t=Fe(ee(t)?[]:{},t));if(!l){for(o in n)cn.call(d,t,o,"get",n[o]);a=function(e){return En(e,d)||(h?t.p:t)}}}return lt(r,a)},kt=function(e,t,n){var r,i,a,o=e.labels,s=N;for(r in o)(i=o[r]-t)<0==!!n&&i&&s>(i=Math.abs(i))&&(a=r,s=i);return a},Pt=function(e,t,n){var r,i,a=e.vars,o=a[t];if(o)return r=a[t+"Params"],i=a.callbackScope||e,n&&me.length&&ke(),r?o.apply(i,r):o.call(i)},Dt=function(e){return Ge(e),e.scrollTrigger&&e.scrollTrigger.kill(!1),e.progress()<1&&Pt(e,"onInterrupt"),e},It=function(e){var t=(e=!e.name&&e.default||e).name,n=q(e),r=t&&!n&&e.init?function(){this._props=[]}:e,i={init:pe,render:En,add:cn,kill:Ln,modifier:An,rawVars:0},a={targetTest:0,get:0,getSetter:wn,aliases:{},register:0};if(jt(),e!==r){if(_e[t])return;Oe(r,Oe(Ue(e,i),a)),Fe(r.prototype,Fe(i,Ue(e,a))),_e[r.prop=t]=r,e.targetTest&&(be.push(r),ve[t]=1),t=("css"===t?"CSS":t.charAt(0).toUpperCase()+t.substr(1))+"Plugin"}fe(t,r),e.register&&e.register(On,r,kn)},Ot=255,Ft={aqua:[0,Ot,Ot],lime:[0,Ot,0],silver:[192,192,192],black:[0,0,0],maroon:[128,0,0],teal:[0,128,128],blue:[0,0,Ot],navy:[0,0,128],white:[Ot,Ot,Ot],olive:[128,128,0],yellow:[Ot,Ot,0],orange:[Ot,165,0],gray:[128,128,128],purple:[128,0,128],green:[0,128,0],red:[Ot,0,0],pink:[Ot,192,203],cyan:[0,Ot,Ot],transparent:[Ot,Ot,Ot,0]},Nt=function(e,t,n){return(6*(e+=e<0?1:e>1?-1:0)<1?t+(n-t)*e*6:e<.5?n:3*e<2?t+(n-t)*(2/3-e)*6:t)*Ot+.5|0},Ut=function(e,t,n){var r,i,a,o,s,l,u,c,h,d,f=e?X(e)?[e>>16,e>>8&Ot,e&Ot]:0:Ft.black;if(!f){if(","===e.substr(-1)&&(e=e.substr(0,e.length-1)),Ft[e])f=Ft[e];else if("#"===e.charAt(0)){if(e.length<6&&(r=e.charAt(1),i=e.charAt(2),a=e.charAt(3),e="#"+r+r+i+i+a+a+(5===e.length?e.charAt(4)+e.charAt(4):"")),9===e.length)return[(f=parseInt(e.substr(1,6),16))>>16,f>>8&Ot,f&Ot,parseInt(e.substr(7),16)/255];f=[(e=parseInt(e.substr(1),16))>>16,e>>8&Ot,e&Ot]}else if("hsl"===e.substr(0,3))if(f=d=e.match(te),t){if(~e.indexOf("="))return f=e.match(ne),n&&f.length<4&&(f[3]=1),f}else o=+f[0]%360/360,s=+f[1]/100,r=2*(l=+f[2]/100)-(i=l<=.5?l*(s+1):l+s-l*s),f.length>3&&(f[3]*=1),f[0]=Nt(o+1/3,r,i),f[1]=Nt(o,r,i),f[2]=Nt(o-1/3,r,i);else f=e.match(te)||Ft.transparent;f=f.map(Number)}return t&&!d&&(r=f[0]/Ot,i=f[1]/Ot,a=f[2]/Ot,l=((u=Math.max(r,i,a))+(c=Math.min(r,i,a)))/2,u===c?o=s=0:(h=u-c,s=l>.5?h/(2-u-c):h/(u+c),o=u===r?(i-a)/h+(i<a?6:0):u===i?(a-r)/h+2:(r-i)/h+4,o*=60),f[0]=~~(o+.5),f[1]=~~(100*s+.5),f[2]=~~(100*l+.5)),n&&f.length<4&&(f[3]=1),f},Bt=function(e){var t=[],n=[],r=-1;return e.split(Ht).forEach((function(e){var i=e.match(re)||[];t.push.apply(t,i),n.push(r+=i.length+1)})),t.c=n,t},zt=function(e,t,n){var r,i,a,o,s="",l=(e+s).match(Ht),u=t?"hsla(":"rgba(",c=0;if(!l)return e;if(l=l.map((function(e){return(e=Ut(e,t,1))&&u+(t?e[0]+","+e[1]+"%,"+e[2]+"%,"+e[3]:e.join(","))+")"})),n&&(a=Bt(e),(r=n.c).join(s)!==a.c.join(s)))for(o=(i=e.replace(Ht,"1").split(re)).length-1;c<o;c++)s+=i[c]+(~r.indexOf(c)?l.shift()||u+"0,0,0,0)":(a.length?a:l.length?l:n).shift());if(!i)for(o=(i=e.split(Ht)).length-1;c<o;c++)s+=i[c]+l[c];return s+i[o]},Ht=function(){var e,t="(?:\\b(?:(?:rgb|rgba|hsl|hsla)\\(.+?\\))|\\B#(?:[0-9a-f]{3,4}){1,2}\\b";for(e in Ft)t+="|"+e+"\\b";return new RegExp(t+")","gi")}(),Gt=/hsl[a]?\(/,Vt=function(e){var t,n=e.join(" ");if(Ht.lastIndex=0,Ht.test(n))return t=Gt.test(n),e[1]=zt(e[1],t),e[0]=zt(e[0],t,Bt(e[1])),!0},Wt=(w=Date.now,T=500,M=33,S=w(),E=S,L=A=1e3/240,R=function e(t){var n,r,i,a,o=w()-E,s=!0===t;if(o>T&&(S+=o-M),((n=(i=(E+=o)-S)-L)>0||s)&&(a=++y.frame,x=i-1e3*y.time,y.time=i/=1e3,L+=n+(n>=A?4:A-n),r=1),s||(m=g(e)),r)for(b=0;b<C.length;b++)C[b](i,x,a,t)},y={time:0,frame:0,tick:function(){R(!0)},deltaRatio:function(e){return x/(1e3/(e||60))},wake:function(){d&&(!c&&J()&&(u=c=window,h=u.document||{},le.gsap=On,(u.gsapVersions||(u.gsapVersions=[])).push(On.version),ce(ue||u.GreenSockGlobals||!u.gsap&&u||{}),_=u.requestAnimationFrame),m&&y.sleep(),g=_||function(e){return setTimeout(e,L-1e3*y.time+1|0)},v=1,R(2))},sleep:function(){(_?u.cancelAnimationFrame:clearTimeout)(m),v=0,g=pe},lagSmoothing:function(e,t){T=e||1e8,M=Math.min(t,T,0)},fps:function(e){A=1e3/(e||240),L=1e3*y.time+A},add:function(e,t,n){var r=t?function(t,n,i,a){e(t,n,i,a),y.remove(r)}:e;return y.remove(e),C[n?"unshift":"push"](r),jt(),r},remove:function(e,t){~(t=C.indexOf(e))&&C.splice(t,1)&&b>=t&&b--},_listeners:C=[]}),jt=function(){return!v&&Wt.wake()},qt={},Xt=/^[\d.\-M][\d.\-,\s]/,Yt=/["']/g,Kt=function(e){for(var t,n,r,i={},a=e.substr(1,e.length-3).split(":"),o=a[0],s=1,l=a.length;s<l;s++)n=a[s],t=s!==l-1?n.lastIndexOf(","):n.length,r=n.substr(0,t),i[o]=isNaN(r)?r.replace(Yt,"").trim():+r,o=n.substr(t+1).trim();return i},Zt=function(e){return function(t){return 1-e(1-t)}},Jt=function e(t,n){for(var r,i=t._first;i;)i instanceof on?e(i,n):!i.vars.yoyoEase||i._yoyo&&i._repeat||i._yoyo===n||(i.timeline?e(i.timeline,n):(r=i._ease,i._ease=i._yEase,i._yEase=r,i._yoyo=n)),i=i._next},Qt=function(e,t){return e&&(q(e)?e:qt[e]||function(e){var t,n,r,i,a=(e+"").split("("),o=qt[a[0]];return o&&a.length>1&&o.config?o.config.apply(null,~e.indexOf("{")?[Kt(a[1])]:(t=e,n=t.indexOf("(")+1,r=t.indexOf(")"),i=t.indexOf("(",n),t.substring(n,~i&&i<r?t.indexOf(")",r+1):r)).split(",").map(De)):qt._CE&&Xt.test(e)?qt._CE("",e):o}(e))||t},$t=function(e,t,n,r){void 0===n&&(n=function(e){return 1-t(1-e)}),void 0===r&&(r=function(e){return e<.5?t(2*e)/2:1-t(2*(1-e))/2});var i,a={easeIn:t,easeOut:n,easeInOut:r};return Ee(e,(function(e){for(var t in qt[e]=le[e]=a,qt[i=e.toLowerCase()]=n,a)qt[i+("easeIn"===t?".in":"easeOut"===t?".out":".inOut")]=qt[e+"."+t]=a[t]})),a},en=function(e){return function(t){return t<.5?(1-e(1-2*t))/2:.5+e(2*(t-.5))/2}},tn=function e(t,n,r){var i=n>=1?n:1,a=(r||(t?.3:.45))/(n<1?n:1),o=a/B*(Math.asin(1/i)||0),s=function(e){return 1===e?1:i*Math.pow(2,-10*e)*W((e-o)*a)+1},l="out"===t?s:"in"===t?function(e){return 1-s(1-e)}:en(s);return a=B/a,l.config=function(n,r){return e(t,n,r)},l},nn=function e(t,n){void 0===n&&(n=1.70158);var r=function(e){return e?--e*e*((n+1)*e+n)+1:0},i="out"===t?r:"in"===t?function(e){return 1-r(1-e)}:en(r);return i.config=function(n){return e(t,n)},i};n._ticker=Wt,n._colorStringFilter=Vt,n._colorExp=Ht,n.splitColor=Ut,n.interpolate=Rt,n.mapRange=Ct,n._replaceRandom=Lt,n.wrapYoyo=At,n.wrap=Et,n.normalize=Mt,n.unitize=Tt,n.pipe=wt,n.random=bt,n.snap=xt,n._roundModifier=yt,n.distribute=_t,n.shuffle=gt,n.selector=mt,n.toArray=vt,n.clamp=ht,n.getUnit=ct,n._removeLinkedListItem=He,n._setDefaults=Oe,n._parseRelative=Ce,n._round=Ae,n._forEachName=Ee,n._getProperty=Se,n._getCache=Me,n._plugins=_e,n._missingPlugin=he,n._relExp=ae,n._numWithUnitExp=re,n._numExp=ne,n._isUndefined=Y,n._isString=j,n._config=O,Ee("Linear,Quad,Cubic,Quart,Quint,Strong",(function(e,t){var n=t<5?t+1:t;$t(e+",Power"+(n-1),t?function(e){return Math.pow(e,n)}:function(e){return e},(function(e){return 1-Math.pow(1-e,n)}),(function(e){return e<.5?Math.pow(2*e,n)/2:1-Math.pow(2*(1-e),n)/2}))})),qt.Linear.easeNone=qt.none=qt.Linear.easeIn,$t("Elastic",tn("in"),tn("out"),tn()),k=7.5625,D=1/(P=2.75),$t("Bounce",(function(e){return 1-I(1-e)}),I=function(e){return e<D?k*e*e:e<.7272727272727273?k*Math.pow(e-1.5/P,2)+.75:e<.9090909090909092?k*(e-=2.25/P)*e+.9375:k*Math.pow(e-2.625/P,2)+.984375}),$t("Expo",(function(e){return e?Math.pow(2,10*(e-1)):0})),$t("Circ",(function(e){return-(G(1-e*e)-1)})),$t("Sine",(function(e){return 1===e?1:1-V(e*z)})),$t("Back",nn("in"),nn("out"),nn()),qt.SteppedEase=qt.steps=le.SteppedEase={config:function(e,t){void 0===e&&(e=1);var n=1/e,r=e+(t?0:1),i=t?1:0;return function(e){return((r*ut(0,.99999999,e)|0)+i)*n}}},F.ease=qt["quad.out"],Ee("onComplete,onUpdate,onStart,onRepeat,onReverseComplete,onInterrupt",(function(e){return we+=e+","+e+"Params,"}));var rn=function(e,t){this.id=H++,e._gsap=this,this.target=e,this.harness=t,this.get=t?t.get:Se,this.set=t?t.getSetter:wn};n.GSCache=rn;var an=function(){function e(e){this.vars=e,this._delay=+e.delay||0,(this._repeat=e.repeat===1/0?-2:e.repeat||0)&&(this._rDelay=e.repeatDelay||0,this._yoyo=!!e.yoyo||!!e.yoyoEase),this._ts=1,rt(this,+e.duration,1,1),this.data=e.data,v||Wt.wake()}var t=e.prototype;return t.delay=function(e){return e||0===e?(this.parent&&this.parent.smoothChildTiming&&this.startTime(this._start+e-this._delay),this._delay=e,this):this._delay},t.duration=function(e){return arguments.length?this.totalDuration(this._repeat>0?e+(e+this._rDelay)*this._repeat:e):this.totalDuration()&&this._dur},t.totalDuration=function(e){return arguments.length?(this._dirty=0,rt(this,this._repeat<0?e:(e-this._repeat*this._rDelay)/(this._repeat+1))):this._tDur},t.totalTime=function(e,t){if(jt(),!arguments.length)return this._tTime;var n=this._dp;if(n&&n.smoothChildTiming&&this._ts){for(Ze(this,e),!n._dp||n.parent||Je(n,this);n&&n.parent;)n.parent._time!==n._start+(n._ts>=0?n._tTime/n._ts:(n.totalDuration()-n._tTime)/-n._ts)&&n.totalTime(n._tTime,!0),n=n.parent;!this.parent&&this._dp.autoRemoveChildren&&(this._ts>0&&e<this._tDur||this._ts<0&&e>0||!this._tDur&&!e)&&Qe(this._dp,this,this._start-this._delay)}return(this._tTime!==e||!this._dur&&!t||this._initted&&Math.abs(this._zTime)===U||!e&&!this._initted&&(this.add||this._ptLookup))&&(this._ts||(this._pTime=e),Pe(this,e,t)),this},t.time=function(e,t){return arguments.length?this.totalTime(Math.min(this.totalDuration(),e+qe(this))%(this._dur+this._rDelay)||(e?this._dur:0),t):this._time},t.totalProgress=function(e,t){return arguments.length?this.totalTime(this.totalDuration()*e,t):this.totalDuration()?Math.min(1,this._tTime/this._tDur):this.ratio},t.progress=function(e,t){return arguments.length?this.totalTime(this.duration()*(!this._yoyo||1&this.iteration()?e:1-e)+qe(this),t):this.duration()?Math.min(1,this._time/this._dur):this.ratio},t.iteration=function(e,t){var n=this.duration()+this._rDelay;return arguments.length?this.totalTime(this._time+(e-1)*n,t):this._repeat?Xe(this._tTime,n)+1:1},t.timeScale=function(e){if(!arguments.length)return-1e-8===this._rts?0:this._rts;if(this._rts===e)return this;var t=this.parent&&this._ts?Ye(this.parent._time,this):this._tTime;return this._rts=+e||0,this._ts=this._ps||-1e-8===e?0:this._rts,this.totalTime(ut(-this._delay,this._tDur,t),!0),Ke(this),We(this)},t.paused=function(e){return arguments.length?(this._ps!==e&&(this._ps=e,e?(this._pTime=this._tTime||Math.max(-this._delay,this.rawTime()),this._ts=this._act=0):(jt(),this._ts=this._rts,this.totalTime(this.parent&&!this.parent.smoothChildTiming?this.rawTime():this._tTime||this._pTime,1===this.progress()&&Math.abs(this._zTime)!==U&&(this._tTime-=U)))),this):this._ps},t.startTime=function(e){if(arguments.length){this._start=e;var t=this.parent||this._dp;return t&&(t._sort||!this.parent)&&Qe(t,this,e-this._delay),this}return this._start},t.endTime=function(e){return this._start+(Z(e)?this.totalDuration():this.duration())/Math.abs(this._ts||1)},t.rawTime=function(e){var t=this.parent||this._dp;return t?e&&(!this._ts||this._repeat&&this._time&&this.totalProgress()<1)?this._tTime%(this._dur+this._rDelay):this._ts?Ye(t.rawTime(e),this):this._tTime:this._tTime},t.globalTime=function(e){for(var t=this,n=arguments.length?e:t.rawTime();t;)n=t._start+n/(t._ts||1),t=t._dp;return n},t.repeat=function(e){return arguments.length?(this._repeat=e===1/0?-2:e,it(this)):-2===this._repeat?1/0:this._repeat},t.repeatDelay=function(e){if(arguments.length){var t=this._time;return this._rDelay=e,it(this),t?this.time(t):this}return this._rDelay},t.yoyo=function(e){return arguments.length?(this._yoyo=e,this):this._yoyo},t.seek=function(e,t){return this.totalTime(ot(this,e),Z(t))},t.restart=function(e,t){return this.play().totalTime(e?-this._delay:0,Z(t))},t.play=function(e,t){return null!=e&&this.seek(e,t),this.reversed(!1).paused(!1)},t.reverse=function(e,t){return null!=e&&this.seek(e||this.totalDuration(),t),this.reversed(!0).paused(!1)},t.pause=function(e,t){return null!=e&&this.seek(e,t),this.paused(!0)},t.resume=function(){return this.paused(!1)},t.reversed=function(e){return arguments.length?(!!e!==this.reversed()&&this.timeScale(-this._rts||(e?-1e-8:0)),this):this._rts<0},t.invalidate=function(){return this._initted=this._act=0,this._zTime=-1e-8,this},t.isActive=function(){var e,t=this.parent||this._dp,n=this._start;return!(t&&!(this._ts&&this._initted&&t.isActive()&&(e=t.rawTime(!0))>=n&&e<this.endTime(!0)-U))},t.eventCallback=function(e,t,n){var r=this.vars;return arguments.length>1?(t?(r[e]=t,n&&(r[e+"Params"]=n),"onUpdate"===e&&(this._onUpdate=t)):delete r[e],this):r[e]},t.then=function(e){var t=this;return new Promise((function(n){var r=q(e)?e:Ie,i=function(){var e=t.then;t.then=null,q(r)&&(r=r(t))&&(r.then||r===t)&&(t.then=e),n(r),t.then=e};t._initted&&1===t.totalProgress()&&t._ts>=0||!t._tTime&&t._ts<0?i():t._prom=i}))},t.kill=function(){Dt(this)},e}();n.Animation=an,Oe(an.prototype,{_time:0,_start:0,_end:0,_tTime:0,_tDur:0,_dirty:0,_repeat:0,_yoyo:!1,parent:null,_initted:!1,_rDelay:0,_ts:1,_dp:0,ratio:0,_zTime:-1e-8,_prom:0,_ps:!1,_rts:1});var on=function(e){function t(t,n){var r;return void 0===t&&(t={}),(r=e.call(this,t)||this).labels={},r.smoothChildTiming=!!t.smoothChildTiming,r.autoRemoveChildren=!!t.autoRemoveChildren,r._sort=Z(t.sortChildren),l&&Qe(t.parent||l,a(r),n),t.reversed&&r.reverse(),t.paused&&r.paused(!0),t.scrollTrigger&&$e(a(r),t.scrollTrigger),r}o(t,e);var n=t.prototype;return n.to=function(e,t,n){return st(0,arguments,this),this},n.from=function(e,t,n){return st(1,arguments,this),this},n.fromTo=function(e,t,n,r){return st(2,arguments,this),this},n.set=function(e,t,n){return t.duration=0,t.parent=this,Be(t).repeatDelay||(t.repeat=0),t.immediateRender=!!t.immediateRender,new gn(e,t,ot(this,n),1),this},n.call=function(e,t,n){return Qe(this,gn.delayedCall(0,e,t),n)},n.staggerTo=function(e,t,n,r,i,a,o){return n.duration=t,n.stagger=n.stagger||r,n.onComplete=a,n.onCompleteParams=o,n.parent=this,new gn(e,n,ot(this,i)),this},n.staggerFrom=function(e,t,n,r,i,a,o){return n.runBackwards=1,Be(n).immediateRender=Z(n.immediateRender),this.staggerTo(e,t,n,r,i,a,o)},n.staggerFromTo=function(e,t,n,r,i,a,o,s){return r.startAt=n,Be(r).immediateRender=Z(r.immediateRender),this.staggerTo(e,t,r,i,a,o,s)},n.render=function(e,t,n){var r,i,a,o,s,u,c,h,d,f,p,v,m=this._time,g=this._dirty?this.totalDuration():this._tDur,_=this._dur,y=e<=0?0:Le(e),x=this._zTime<0!=e<0&&(this._initted||!_);if(this!==l&&y>g&&e>=0&&(y=g),y!==this._tTime||n||x){if(m!==this._time&&_&&(y+=this._time-m,e+=this._time-m),r=y,d=this._start,u=!(h=this._ts),x&&(_||(m=this._zTime),(e||!t)&&(this._zTime=e)),this._repeat){if(p=this._yoyo,s=_+this._rDelay,this._repeat<-1&&e<0)return this.totalTime(100*s+e,t,n);if(r=Le(y%s),y===g?(o=this._repeat,r=_):((o=~~(y/s))&&o===y/s&&(r=_,o--),r>_&&(r=_)),f=Xe(this._tTime,s),!m&&this._tTime&&f!==o&&(f=o),p&&1&o&&(r=_-r,v=1),o!==f&&!this._lock){var b=p&&1&f,w=b===(p&&1&o);if(o<f&&(b=!b),m=b?0:_,this._lock=1,this.render(m||(v?0:Le(o*s)),t,!_)._lock=0,this._tTime=y,!t&&this.parent&&Pt(this,"onRepeat"),this.vars.repeatRefresh&&!v&&(this.invalidate()._lock=1),m&&m!==this._time||u!==!this._ts||this.vars.onRepeat&&!this.parent&&!this._act)return this;if(_=this._dur,g=this._tDur,w&&(this._lock=2,m=b?_:-1e-4,this.render(m,!0),this.vars.repeatRefresh&&!v&&this.invalidate()),this._lock=0,!this._ts&&!u)return this;Jt(this,v)}}if(this._hasPause&&!this._forcing&&this._lock<2&&(c=function(e,t,n){var r;if(n>t)for(r=e._first;r&&r._start<=n;){if("isPause"===r.data&&r._start>t)return r;r=r._next}else for(r=e._last;r&&r._start>=n;){if("isPause"===r.data&&r._start<t)return r;r=r._prev}}(this,Le(m),Le(r)),c&&(y-=r-(r=c._start))),this._tTime=y,this._time=r,this._act=!h,this._initted||(this._onUpdate=this.vars.onUpdate,this._initted=1,this._zTime=e,m=0),!m&&r&&!t&&(Pt(this,"onStart"),this._tTime!==y))return this;if(r>=m&&e>=0)for(i=this._first;i;){if(a=i._next,(i._act||r>=i._start)&&i._ts&&c!==i){if(i.parent!==this)return this.render(e,t,n);if(i.render(i._ts>0?(r-i._start)*i._ts:(i._dirty?i.totalDuration():i._tDur)+(r-i._start)*i._ts,t,n),r!==this._time||!this._ts&&!u){c=0,a&&(y+=this._zTime=-1e-8);break}}i=a}else{i=this._last;for(var T=e<0?e:r;i;){if(a=i._prev,(i._act||T<=i._end)&&i._ts&&c!==i){if(i.parent!==this)return this.render(e,t,n);if(i.render(i._ts>0?(T-i._start)*i._ts:(i._dirty?i.totalDuration():i._tDur)+(T-i._start)*i._ts,t,n),r!==this._time||!this._ts&&!u){c=0,a&&(y+=this._zTime=T?-1e-8:U);break}}i=a}}if(c&&!t&&(this.pause(),c.render(r>=m?0:-1e-8)._zTime=r>=m?1:-1,this._ts))return this._start=d,Ke(this),this.render(e,t,n);this._onUpdate&&!t&&Pt(this,"onUpdate",!0),(y===g&&this._tTime>=this.totalDuration()||!y&&m)&&(d!==this._start&&Math.abs(h)===Math.abs(this._ts)||this._lock||((e||!_)&&(y===g&&this._ts>0||!y&&this._ts<0)&&Ge(this,1),t||e<0&&!m||!y&&!m&&g||(Pt(this,y===g&&e>=0?"onComplete":"onReverseComplete",!0),this._prom&&!(y<g&&this.timeScale()>0)&&this._prom())))}return this},n.add=function(e,t){var n=this;if(X(t)||(t=ot(this,t,e)),!(e instanceof an)){if(ee(e))return e.forEach((function(e){return n.add(e,t)})),this;if(j(e))return this.addLabel(e,t);if(!q(e))return this;e=gn.delayedCall(0,e)}return this!==e?Qe(this,e,t):this},n.getChildren=function(e,t,n,r){void 0===e&&(e=!0),void 0===t&&(t=!0),void 0===n&&(n=!0),void 0===r&&(r=-N);for(var i=[],a=this._first;a;)a._start>=r&&(a instanceof gn?t&&i.push(a):(n&&i.push(a),e&&i.push.apply(i,a.getChildren(!0,t,n)))),a=a._next;return i},n.getById=function(e){for(var t=this.getChildren(1,1,1),n=t.length;n--;)if(t[n].vars.id===e)return t[n]},n.remove=function(e){return j(e)?this.removeLabel(e):q(e)?this.killTweensOf(e):(He(this,e),e===this._recent&&(this._recent=this._last),Ve(this))},n.totalTime=function(t,n){return arguments.length?(this._forcing=1,!this._dp&&this._ts&&(this._start=Le(Wt.time-(this._ts>0?t/this._ts:(this.totalDuration()-t)/-this._ts))),e.prototype.totalTime.call(this,t,n),this._forcing=0,this):this._tTime},n.addLabel=function(e,t){return this.labels[e]=ot(this,t),this},n.removeLabel=function(e){return delete this.labels[e],this},n.addPause=function(e,t,n){var r=gn.delayedCall(0,t||pe,n);return r.data="isPause",this._hasPause=1,Qe(this,r,ot(this,e))},n.removePause=function(e){var t=this._first;for(e=ot(this,e);t;)t._start===e&&"isPause"===t.data&&Ge(t),t=t._next},n.killTweensOf=function(e,t,n){for(var r=this.getTweensOf(e,n),i=r.length;i--;)sn!==r[i]&&r[i].kill(e,t);return this},n.getTweensOf=function(e,t){for(var n,r=[],i=vt(e),a=this._first,o=X(t);a;)a instanceof gn?Re(a._targets,i)&&(o?(!sn||a._initted&&a._ts)&&a.globalTime(0)<=t&&a.globalTime(a.totalDuration())>t:!t||a.isActive())&&r.push(a):(n=a.getTweensOf(i,t)).length&&r.push.apply(r,n),a=a._next;return r},n.tweenTo=function(e,t){t=t||{};var n,r=this,i=ot(r,e),a=t,o=a.startAt,s=a.onStart,l=a.onStartParams,u=a.immediateRender,c=gn.to(r,Oe({ease:t.ease||"none",lazy:!1,immediateRender:!1,time:i,overwrite:"auto",duration:t.duration||Math.abs((i-(o&&"time"in o?o.time:r._time))/r.timeScale())||U,onStart:function(){if(r.pause(),!n){var e=t.duration||Math.abs((i-(o&&"time"in o?o.time:r._time))/r.timeScale());c._dur!==e&&rt(c,e,0,1).render(c._time,!0,!0),n=1}s&&s.apply(c,l||[])}},t));return u?c.render(0):c},n.tweenFromTo=function(e,t,n){return this.tweenTo(t,Oe({startAt:{time:ot(this,e)}},n))},n.recent=function(){return this._recent},n.nextLabel=function(e){return void 0===e&&(e=this._time),kt(this,ot(this,e))},n.previousLabel=function(e){return void 0===e&&(e=this._time),kt(this,ot(this,e),1)},n.currentLabel=function(e){return arguments.length?this.seek(e,!0):this.previousLabel(this._time+U)},n.shiftChildren=function(e,t,n){void 0===n&&(n=0);for(var r,i=this._first,a=this.labels;i;)i._start>=n&&(i._start+=e,i._end+=e),i=i._next;if(t)for(r in a)a[r]>=n&&(a[r]+=e);return Ve(this)},n.invalidate=function(){var t=this._first;for(this._lock=0;t;)t.invalidate(),t=t._next;return e.prototype.invalidate.call(this)},n.clear=function(e){void 0===e&&(e=!0);for(var t,n=this._first;n;)t=n._next,this.remove(n),n=t;return this._dp&&(this._time=this._tTime=this._pTime=0),e&&(this.labels={}),Ve(this)},n.totalDuration=function(e){var t,n,r,i=0,a=this,o=a._last,s=N;if(arguments.length)return a.timeScale((a._repeat<0?a.duration():a.totalDuration())/(a.reversed()?-e:e));if(a._dirty){for(r=a.parent;o;)t=o._prev,o._dirty&&o.totalDuration(),(n=o._start)>s&&a._sort&&o._ts&&!a._lock?(a._lock=1,Qe(a,o,n-o._delay,1)._lock=0):s=n,n<0&&o._ts&&(i-=n,(!r&&!a._dp||r&&r.smoothChildTiming)&&(a._start+=n/a._ts,a._time-=n,a._tTime-=n),a.shiftChildren(-n,!1,-Infinity),s=0),o._end>i&&o._ts&&(i=o._end),o=t;rt(a,a===l&&a._time>i?a._time:i,1,1),a._dirty=0}return a._tDur},t.updateRoot=function(e){if(l._ts&&(Pe(l,Ye(e,l)),f=Wt.frame),Wt.frame>=xe){xe+=O.autoSleep||120;var t=l._first;if((!t||!t._ts)&&O.autoSleep&&Wt._listeners.length<2){for(;t&&!t._ts;)t=t._next;t||Wt.sleep()}}},t}(an);n.TimelineLite=n.TimelineMax=n.Timeline=on,Oe(on.prototype,{_lock:0,_hasPause:0,_forcing:0});var sn,ln,un=function(e,t,n,r,i,a,o){var s,l,u,c,h,d,f,p,v=new kn(this._pt,e,t,0,1,Sn,null,i),m=0,g=0;for(v.b=n,v.e=r,n+="",(f=~(r+="").indexOf("random("))&&(r=Lt(r)),a&&(a(p=[n,r],e,t),n=p[0],r=p[1]),l=n.match(ie)||[];s=ie.exec(r);)c=s[0],h=r.substring(m,s.index),u?u=(u+1)%5:"rgba("===h.substr(-5)&&(u=1),c!==l[g++]&&(d=parseFloat(l[g-1])||0,v._pt={_next:v._pt,p:h||1===g?h:",",s:d,c:"="===c.charAt(1)?Ce(d,c)-d:parseFloat(c)-d,m:u&&u<4?Math.round:0},m=ie.lastIndex);return v.c=m<r.length?r.substring(m,r.length):"",v.fp=o,(ae.test(r)||f)&&(v.e=0),this._pt=v,v},cn=function(e,t,n,r,i,a,o,s,l){q(r)&&(r=r(i||0,e,a));var u,c=e[t],h="get"!==n?n:q(c)?l?e[t.indexOf("set")||!q(e["get"+t.substr(3)])?t:"get"+t.substr(3)](l):e[t]():c,d=q(c)?l?xn:yn:_n;if(j(r)&&(~r.indexOf("random(")&&(r=Lt(r)),"="===r.charAt(1)&&((u=Ce(h,r)+(ct(h)||0))||0===u)&&(r=u)),h!==r||ln)return isNaN(h*r)||""===r?(!c&&!(t in e)&&he(t,r),un.call(this,e,t,h,r,d,s||O.stringFilter,l)):(u=new kn(this._pt,e,t,+h||0,r-(h||0),"boolean"==typeof c?Mn:Tn,0,d),l&&(u.fp=l),o&&u.modifier(o,this,e),this._pt=u)},hn=function(e,t,n,r,i,a){var o,s,l,u;if(_e[e]&&!1!==(o=new _e[e]).init(i,o.rawVars?t[e]:function(e,t,n,r,i){if(q(e)&&(e=pn(e,i,t,n,r)),!K(e)||e.style&&e.nodeType||ee(e)||$(e))return j(e)?pn(e,i,t,n,r):e;var a,o={};for(a in e)o[a]=pn(e[a],i,t,n,r);return o}(t[e],r,i,a,n),n,r,a)&&(n._pt=s=new kn(n._pt,i,e,0,1,o.render,o,0,o.priority),n!==p))for(l=n._ptLookup[n._targets.indexOf(i)],u=o._props.length;u--;)l[o._props[u]]=s;return o},dn=function e(t,n){var r,i,a,o,u,c,h,d,f,p,v,m,g,_=t.vars,y=_.ease,x=_.startAt,b=_.immediateRender,w=_.lazy,T=_.onUpdate,M=_.onUpdateParams,S=_.callbackScope,E=_.runBackwards,A=_.yoyoEase,L=_.keyframes,C=_.autoRevert,R=t._dur,k=t._startAt,P=t._targets,D=t.parent,I=D&&"nested"===D.data?D.parent._targets:P,O="auto"===t._overwrite&&!s,B=t.timeline;if(B&&(!L||!y)&&(y="none"),t._ease=Qt(y,F.ease),t._yEase=A?Zt(Qt(!0===A?y:A,F.ease)):0,A&&t._yoyo&&!t._repeat&&(A=t._yEase,t._yEase=t._ease,t._ease=A),t._from=!B&&!!_.runBackwards,!B||L&&!_.stagger){if(m=(d=P[0]?Me(P[0]).harness:0)&&_[d.prop],r=Ue(_,ve),k&&(Ge(k.render(-1,!0)),k._lazy=0),x)if(Ge(t._startAt=gn.set(P,Oe({data:"isStart",overwrite:!1,parent:D,immediateRender:!0,lazy:Z(w),startAt:null,delay:0,onUpdate:T,onUpdateParams:M,callbackScope:S,stagger:0},x))),n<0&&!b&&!C&&t._startAt.render(-1,!0),b){if(n>0&&!C&&(t._startAt=0),R&&n<=0)return void(n&&(t._zTime=n))}else!1===C&&(t._startAt=0);else if(E&&R)if(k)!C&&(t._startAt=0);else if(n&&(b=!1),a=Oe({overwrite:!1,data:"isFromStart",lazy:b&&Z(w),immediateRender:b,stagger:0,parent:D},r),m&&(a[d.prop]=m),Ge(t._startAt=gn.set(P,a)),n<0&&t._startAt.render(-1,!0),t._zTime=n,b){if(!n)return}else e(t._startAt,U);for(t._pt=t._ptCache=0,w=R&&Z(w)||w&&!R,i=0;i<P.length;i++){if(h=(u=P[i])._gsap||Te(P)[i]._gsap,t._ptLookup[i]=p={},ge[h.id]&&me.length&&ke(),v=I===P?i:I.indexOf(u),d&&!1!==(f=new d).init(u,m||r,t,v,I)&&(t._pt=o=new kn(t._pt,u,f.name,0,1,f.render,f,0,f.priority),f._props.forEach((function(e){p[e]=o})),f.priority&&(c=1)),!d||m)for(a in r)_e[a]&&(f=hn(a,r,t,v,u,I))?f.priority&&(c=1):p[a]=o=cn.call(t,u,a,"get",r[a],v,I,0,_.stringFilter);t._op&&t._op[i]&&t.kill(u,t._op[i]),O&&t._pt&&(sn=t,l.killTweensOf(u,p,t.globalTime(n)),g=!t.parent,sn=0),t._pt&&w&&(ge[h.id]=1)}c&&Rn(t),t._onInit&&t._onInit(t)}t._onUpdate=T,t._initted=(!t._op||t._pt)&&!g,L&&n<=0&&B.render(N,!0,!0)},fn=function(e,t,n,r){var i,a,o=t.ease||r||"power1.inOut";if(ee(t))a=n[e]||(n[e]=[]),t.forEach((function(e,n){return a.push({t:n/(t.length-1)*100,v:e,e:o})}));else for(i in t)a=n[i]||(n[i]=[]),"ease"===i||a.push({t:parseFloat(e),v:t[i],e:o})},pn=function(e,t,n,r,i){return q(e)?e.call(t,n,r,i):j(e)&&~e.indexOf("random(")?Lt(e):e},vn=we+"repeat,repeatDelay,yoyo,repeatRefresh,yoyoEase,autoRevert",mn={};n._checkPlugin=hn,Ee(vn+",id,stagger,delay,duration,paused,scrollTrigger",(function(e){return mn[e]=1}));var gn=function(e){function t(t,n,r,i){var o;"number"==typeof n&&(r.duration=n,n=r,r=null);var u,c,h,d,f,p,v,m,g=(o=e.call(this,i?n:Be(n))||this).vars,_=g.duration,y=g.delay,x=g.immediateRender,b=g.stagger,w=g.overwrite,T=g.keyframes,M=g.defaults,S=g.scrollTrigger,E=g.yoyoEase,A=n.parent||l,L=(ee(t)||$(t)?X(t[0]):"length"in n)?[t]:vt(t);if(o._targets=L.length?Te(L):de("GSAP target "+t+" not found. https://greensock.com",!O.nullTargetWarn)||[],o._ptLookup=[],o._overwrite=w,T||b||Q(_)||Q(y)){if(n=o.vars,(u=o.timeline=new on({data:"nested",defaults:M||{}})).kill(),u.parent=u._dp=a(o),u._start=0,b||Q(_)||Q(y)){if(d=L.length,v=b&&_t(b),K(b))for(f in b)~vn.indexOf(f)&&(m||(m={}),m[f]=b[f]);for(c=0;c<d;c++)(h=Ue(n,mn)).stagger=0,E&&(h.yoyoEase=E),m&&Fe(h,m),p=L[c],h.duration=+pn(_,a(o),c,p,L),h.delay=(+pn(y,a(o),c,p,L)||0)-o._delay,!b&&1===d&&h.delay&&(o._delay=y=h.delay,o._start+=y,h.delay=0),u.to(p,h,v?v(c,p,L):0),u._ease=qt.none;u.duration()?_=y=0:o.timeline=0}else if(T){Be(Oe(u.vars.defaults,{ease:"none"})),u._ease=Qt(T.ease||n.ease||"none");var C,R,k,P=0;if(ee(T))T.forEach((function(e){return u.to(L,e,">")}));else{for(f in h={},T)"ease"===f||"easeEach"===f||fn(f,T[f],h,T.easeEach);for(f in h)for(C=h[f].sort((function(e,t){return e.t-t.t})),P=0,c=0;c<C.length;c++)(k={ease:(R=C[c]).e,duration:(R.t-(c?C[c-1].t:0))/100*_})[f]=R.v,u.to(L,k,P),P+=k.duration;u.duration()<_&&u.to({},{duration:_-u.duration()})}}_||o.duration(_=u.duration())}else o.timeline=0;return!0!==w||s||(sn=a(o),l.killTweensOf(L),sn=0),Qe(A,a(o),r),n.reversed&&o.reverse(),n.paused&&o.paused(!0),(x||!_&&!T&&o._start===Le(A._time)&&Z(x)&&je(a(o))&&"nested"!==A.data)&&(o._tTime=-1e-8,o.render(Math.max(0,-y))),S&&$e(a(o),S),o}o(t,e);var n=t.prototype;return n.render=function(e,t,n){var r,i,a,o,s,l,u,c,h,d=this._time,f=this._tDur,p=this._dur,v=e>f-U&&e>=0?f:e<U?0:e;if(p){if(v!==this._tTime||!e||n||!this._initted&&this._tTime||this._startAt&&this._zTime<0!=e<0){if(r=v,c=this.timeline,this._repeat){if(o=p+this._rDelay,this._repeat<-1&&e<0)return this.totalTime(100*o+e,t,n);if(r=Le(v%o),v===f?(a=this._repeat,r=p):((a=~~(v/o))&&a===v/o&&(r=p,a--),r>p&&(r=p)),(l=this._yoyo&&1&a)&&(h=this._yEase,r=p-r),s=Xe(this._tTime,o),r===d&&!n&&this._initted)return this._tTime=v,this;a!==s&&(c&&this._yEase&&Jt(c,l),!this.vars.repeatRefresh||l||this._lock||(this._lock=n=1,this.render(Le(o*a),!0).invalidate()._lock=0))}if(!this._initted){if(et(this,e<0?e:r,n,t))return this._tTime=0,this;if(d!==this._time)return this;if(p!==this._dur)return this.render(e,t,n)}if(this._tTime=v,this._time=r,!this._act&&this._ts&&(this._act=1,this._lazy=0),this.ratio=u=(h||this._ease)(r/p),this._from&&(this.ratio=u=1-u),r&&!d&&!t&&(Pt(this,"onStart"),this._tTime!==v))return this;for(i=this._pt;i;)i.r(u,i.d),i=i._next;c&&c.render(e<0?e:!r&&l?-1e-8:c._dur*c._ease(r/this._dur),t,n)||this._startAt&&(this._zTime=e),this._onUpdate&&!t&&(e<0&&this._startAt&&this._startAt.render(e,!0,n),Pt(this,"onUpdate")),this._repeat&&a!==s&&this.vars.onRepeat&&!t&&this.parent&&Pt(this,"onRepeat"),v!==this._tDur&&v||this._tTime!==v||(e<0&&this._startAt&&!this._onUpdate&&this._startAt.render(e,!0,!0),(e||!p)&&(v===this._tDur&&this._ts>0||!v&&this._ts<0)&&Ge(this,1),t||e<0&&!d||!v&&!d||(Pt(this,v===f?"onComplete":"onReverseComplete",!0),this._prom&&!(v<f&&this.timeScale()>0)&&this._prom()))}}else!function(e,t,n,r){var i,a,o,s=e.ratio,l=t<0||!t&&(!e._start&&tt(e)&&(e._initted||!nt(e))||(e._ts<0||e._dp._ts<0)&&!nt(e))?0:1,u=e._rDelay,c=0;if(u&&e._repeat&&(c=ut(0,e._tDur,t),a=Xe(c,u),e._yoyo&&1&a&&(l=1-l),a!==Xe(e._tTime,u)&&(s=1-l,e.vars.repeatRefresh&&e._initted&&e.invalidate())),l!==s||r||e._zTime===U||!t&&e._zTime){if(!e._initted&&et(e,t,r,n))return;for(o=e._zTime,e._zTime=t||(n?U:0),n||(n=t&&!o),e.ratio=l,e._from&&(l=1-l),e._time=0,e._tTime=c,i=e._pt;i;)i.r(l,i.d),i=i._next;e._startAt&&t<0&&e._startAt.render(t,!0,!0),e._onUpdate&&!n&&Pt(e,"onUpdate"),c&&e._repeat&&!n&&e.parent&&Pt(e,"onRepeat"),(t>=e._tDur||t<0)&&e.ratio===l&&(l&&Ge(e,1),n||(Pt(e,l?"onComplete":"onReverseComplete",!0),e._prom&&e._prom()))}else e._zTime||(e._zTime=t)}(this,e,t,n);return this},n.targets=function(){return this._targets},n.invalidate=function(){return this._pt=this._op=this._startAt=this._onUpdate=this._lazy=this.ratio=0,this._ptLookup=[],this.timeline&&this.timeline.invalidate(),e.prototype.invalidate.call(this)},n.resetTo=function(e,t,n,r){v||Wt.wake(),this._ts||this.play();var i=Math.min(this._dur,(this._dp._time-this._start)*this._ts);return this._initted||dn(this,i),function(e,t,n,r,i,a,o){var s,l,u,c=(e._pt&&e._ptCache||(e._ptCache={}))[t];if(!c)for(c=e._ptCache[t]=[],l=e._ptLookup,u=e._targets.length;u--;){if((s=l[u][t])&&s.d&&s.d._pt)for(s=s.d._pt;s&&s.p!==t;)s=s._next;if(!s)return ln=1,e.vars[t]="+=0",dn(e,o),ln=0,1;c.push(s)}for(u=c.length;u--;)(s=c[u]).s=!r&&0!==r||i?s.s+(r||0)+a*s.c:r,s.c=n-s.s,s.e&&(s.e=Ae(n)+ct(s.e)),s.b&&(s.b=s.s+ct(s.b))}(this,e,t,n,r,this._ease(i/this._dur),i)?this.resetTo(e,t,n,r):(Ze(this,0),this.parent||ze(this._dp,this,"_first","_last",this._dp._sort?"_start":0),this.render(0))},n.kill=function(e,t){if(void 0===t&&(t="all"),!(e||t&&"all"!==t))return this._lazy=this._pt=0,this.parent?Dt(this):this;if(this.timeline){var n=this.timeline.totalDuration();return this.timeline.killTweensOf(e,t,sn&&!0!==sn.vars.overwrite)._first||Dt(this),this.parent&&n!==this.timeline.totalDuration()&&rt(this,this._dur*this.timeline._tDur/n,0,1),this}var r,i,a,o,s,l,u,c=this._targets,h=e?vt(e):c,d=this._ptLookup,f=this._pt;if((!t||"all"===t)&&function(e,t){for(var n=e.length,r=n===t.length;r&&n--&&e[n]===t[n];);return n<0}(c,h))return"all"===t&&(this._pt=0),Dt(this);for(r=this._op=this._op||[],"all"!==t&&(j(t)&&(s={},Ee(t,(function(e){return s[e]=1})),t=s),t=function(e,t){var n,r,i,a,o=e[0]?Me(e[0]).harness:0,s=o&&o.aliases;if(!s)return t;for(r in n=Fe({},t),s)if(r in n)for(i=(a=s[r].split(",")).length;i--;)n[a[i]]=n[r];return n}(c,t)),u=c.length;u--;)if(~h.indexOf(c[u]))for(s in i=d[u],"all"===t?(r[u]=t,o=i,a={}):(a=r[u]=r[u]||{},o=t),o)(l=i&&i[s])&&("kill"in l.d&&!0!==l.d.kill(s)||He(this,l,"_pt"),delete i[s]),"all"!==a&&(a[s]=1);return this._initted&&!this._pt&&f&&Dt(this),this},t.to=function(e,n){return new t(e,n,arguments[2])},t.from=function(e,t){return st(1,arguments)},t.delayedCall=function(e,n,r,i){return new t(n,0,{immediateRender:!1,lazy:!1,overwrite:!1,delay:e,onComplete:n,onReverseComplete:n,onCompleteParams:r,onReverseCompleteParams:r,callbackScope:i})},t.fromTo=function(e,t,n){return st(2,arguments)},t.set=function(e,n){return n.duration=0,n.repeatDelay||(n.repeat=0),new t(e,n)},t.killTweensOf=function(e,t,n){return l.killTweensOf(e,t,n)},t}(an);n.TweenLite=n.TweenMax=n.Tween=gn,Oe(gn.prototype,{_targets:[],_lazy:0,_startAt:0,_op:0,_onInit:0}),Ee("staggerTo,staggerFrom,staggerFromTo",(function(e){gn[e]=function(){var t=new on,n=dt.call(arguments,0);return n.splice("staggerFromTo"===e?5:4,0,0),t[e].apply(t,n)}}));var _n=function(e,t,n){return e[t]=n},yn=function(e,t,n){return e[t](n)},xn=function(e,t,n,r){return e[t](r.fp,n)},bn=function(e,t,n){return e.setAttribute(t,n)},wn=function(e,t){return q(e[t])?yn:Y(e[t])&&e.setAttribute?bn:_n},Tn=function(e,t){return t.set(t.t,t.p,Math.round(1e6*(t.s+t.c*e))/1e6,t)},Mn=function(e,t){return t.set(t.t,t.p,!!(t.s+t.c*e),t)},Sn=function(e,t){var n=t._pt,r="";if(!e&&t.b)r=t.b;else if(1===e&&t.e)r=t.e;else{for(;n;)r=n.p+(n.m?n.m(n.s+n.c*e):Math.round(1e4*(n.s+n.c*e))/1e4)+r,n=n._next;r+=t.c}t.set(t.t,t.p,r,t)},En=function(e,t){for(var n=t._pt;n;)n.r(e,n.d),n=n._next},An=function(e,t,n,r){for(var i,a=this._pt;a;)i=a._next,a.p===r&&a.modifier(e,t,n),a=i},Ln=function(e){for(var t,n,r=this._pt;r;)n=r._next,r.p===e&&!r.op||r.op===e?He(this,r,"_pt"):r.dep||(t=1),r=n;return!t},Cn=function(e,t,n,r){r.mSet(e,t,r.m.call(r.tween,n,r.mt),r)},Rn=function(e){for(var t,n,r,i,a=e._pt;a;){for(t=a._next,n=r;n&&n.pr>a.pr;)n=n._next;(a._prev=n?n._prev:i)?a._prev._next=a:r=a,(a._next=n)?n._prev=a:i=a,a=t}e._pt=r};n._sortPropTweensByPriority=Rn,n._renderComplexString=Sn,n._getSetter=wn;var kn=function(){function e(e,t,n,r,i,a,o,s,l){this.t=t,this.s=r,this.c=i,this.p=n,this.r=a||Tn,this.d=o||this,this.set=s||_n,this.pr=l||0,this._next=e,e&&(e._prev=this)}return e.prototype.modifier=function(e,t,n){this.mSet=this.mSet||this.set,this.set=Cn,this.m=e,this.mt=n,this.tween=t},e}();n.PropTween=kn,Ee(we+"parent,duration,ease,delay,overwrite,runBackwards,startAt,yoyo,immediateRender,repeat,repeatDelay,data,paused,reversed,lazy,callbackScope,stringFilter,id,yoyoEase,stagger,inherit,repeatRefresh,keyframes,autoRevert,scrollTrigger",(function(e){return ve[e]=1})),le.TweenMax=le.TweenLite=gn,le.TimelineLite=le.TimelineMax=on,l=new on({sortChildren:!1,defaults:F,autoRemoveChildren:!0,id:"root",smoothChildTiming:!0}),O.stringFilter=Vt;var Pn={registerPlugin:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];t.forEach((function(e){return It(e)}))},timeline:function(e){return new on(e)},getTweensOf:function(e,t){return l.getTweensOf(e,t)},getProperty:function(e,t,n,r){j(e)&&(e=vt(e)[0]);var i=Me(e||{}).get,a=n?Ie:De;return"native"===n&&(n=""),e?t?a((_e[t]&&_e[t].get||i)(e,t,n,r)):function(t,n,r){return a((_e[t]&&_e[t].get||i)(e,t,n,r))}:e},quickSetter:function(e,t,n){if((e=vt(e)).length>1){var r=e.map((function(e){return On.quickSetter(e,t,n)})),i=r.length;return function(e){for(var t=i;t--;)r[t](e)}}e=e[0]||{};var a=_e[t],o=Me(e),s=o.harness&&(o.harness.aliases||{})[t]||t,l=a?function(t){var r=new a;p._pt=0,r.init(e,n?t+n:t,p,0,[e]),r.render(1,r),p._pt&&En(1,p)}:o.set(e,s);return a?l:function(t){return l(e,s,n?t+n:t,o,1)}},quickTo:function(e,t,n){var r,i=On.to(e,Fe(((r={})[t]="+=0.1",r.paused=!0,r),n||{})),a=function(e,n,r){return i.resetTo(t,e,n,r)};return a.tween=i,a},isTweening:function(e){return l.getTweensOf(e,!0).length>0},defaults:function(e){return e&&e.ease&&(e.ease=Qt(e.ease,F.ease)),Ne(F,e||{})},config:function(e){return Ne(O,e||{})},registerEffect:function(e){var t=e.name,n=e.effect,r=e.plugins,i=e.defaults,a=e.extendTimeline;(r||"").split(",").forEach((function(e){return e&&!_e[e]&&!le[e]&&de(t+" effect requires "+e+" plugin.")})),ye[t]=function(e,t,r){return n(vt(e),Oe(t||{},i),r)},a&&(on.prototype[t]=function(e,n,r){return this.add(ye[t](e,K(n)?n:(r=n)&&{},this),r)})},registerEase:function(e,t){qt[e]=Qt(t)},parseEase:function(e,t){return arguments.length?Qt(e,t):qt},getById:function(e){return l.getById(e)},exportRoot:function(e,t){void 0===e&&(e={});var n,r,i=new on(e);for(i.smoothChildTiming=Z(e.smoothChildTiming),l.remove(i),i._dp=0,i._time=i._tTime=l._time,n=l._first;n;)r=n._next,!t&&!n._dur&&n instanceof gn&&n.vars.onComplete===n._targets[0]||Qe(i,n,n._start-n._delay),n=r;return Qe(l,i,0),i},utils:{wrap:Et,wrapYoyo:At,distribute:_t,random:bt,snap:xt,normalize:Mt,getUnit:ct,clamp:ht,splitColor:Ut,toArray:vt,selector:mt,mapRange:Ct,pipe:wt,unitize:Tt,interpolate:Rt,shuffle:gt},install:ce,effects:ye,ticker:Wt,updateRoot:on.updateRoot,plugins:_e,globalTimeline:l,core:{PropTween:kn,globals:fe,Tween:gn,Timeline:on,Animation:an,getCache:Me,_removeLinkedListItem:He,suppressOverwrites:function(e){return s=e}}};Ee("to,from,fromTo,delayedCall,set,killTweensOf",(function(e){return Pn[e]=gn[e]})),Wt.add(on.updateRoot),p=Pn.to({},{duration:0});var Dn=function(e,t){for(var n=e._pt;n&&n.p!==t&&n.op!==t&&n.fp!==t;)n=n._next;return n},In=function(e,t){return{name:e,rawVars:1,init:function(e,n,r){r._onInit=function(e){var r,i;if(j(n)&&(r={},Ee(n,(function(e){return r[e]=1})),n=r),t){for(i in r={},n)r[i]=t(n[i]);n=r}!function(e,t){var n,r,i,a=e._targets;for(n in t)for(r=a.length;r--;)(i=e._ptLookup[r][n])&&(i=i.d)&&(i._pt&&(i=Dn(i,n)),i&&i.modifier&&i.modifier(t[n],e,a[r],n))}(e,n)}}}},On=Pn.registerPlugin({name:"attr",init:function(e,t,n,r,i){var a,o;for(a in t)(o=this.add(e,"setAttribute",(e.getAttribute(a)||0)+"",t[a],r,i,0,0,a))&&(o.op=a),this._props.push(a)}},{name:"endArray",init:function(e,t){for(var n=t.length;n--;)this.add(e,n,e[n]||0,t[n])}},In("roundProps",yt),In("modifiers"),In("snap",xt))||Pn;n.default=n.gsap=On,gn.version=on.version=On.version="3.10.4",d=1,J()&&jt();var Fn=qt.Power0,Nn=qt.Power1,Un=qt.Power2,Bn=qt.Power3,zn=qt.Power4,Hn=qt.Linear,Gn=qt.Quad,Vn=qt.Cubic,Wn=qt.Quart,jn=qt.Quint,qn=qt.Strong,Xn=qt.Elastic,Yn=qt.Back,Kn=qt.SteppedEase,Zn=qt.Bounce,Jn=qt.Sine,Qn=qt.Expo,$n=qt.Circ;n.Circ=$n,n.Expo=Qn,n.Sine=Jn,n.Bounce=Zn,n.SteppedEase=Kn,n.Back=Yn,n.Elastic=Xn,n.Strong=qn,n.Quint=jn,n.Quart=Wn,n.Cubic=Vn,n.Quad=Gn,n.Linear=Hn,n.Power4=zn,n.Power3=Bn,n.Power2=Un,n.Power1=Nn,n.Power0=Fn},{"@babel/runtime/helpers/interopRequireDefault":12,"@babel/runtime/helpers/typeof":22}],29:[function(e,t,n){"use strict";!function(e){function n(){this._listeners=[],this.dispatchCount=0}var r=n.prototype;r.add=s,r.addOnce=function(t,n,r,o){if(!t)throw i;var l=this,u=function(){return l.remove.call(l,t,n),t.apply(n,a.call(arguments,0))};1===(o=a.call(arguments,0)).length&&o.push(e);o.splice(2,0,u),s.apply(l,o)},r.remove=function(e,t){if(!e)return this._listeners.length=0,!0;var n,r=this._listeners,i=r.length;for(;i--;)if((n=r[i]).f===e&&(!t||n.c===t))return n.j=0,r.splice(i,1),!0;return!1},r.dispatch=function(e){e=a.call(arguments,0),this.dispatchCount++;var t,n,r=this.dispatchCount,i=this._listeners,o=i.length;for(;o--;)if((t=i[o])&&t.j<r&&(t.j=r,!1===t.r.apply(t.c,t.a.concat(e)))){n=t;break}i=this._listeners,o=i.length;for(;o--;)i[o].j=0;return n};var i="Callback function is missing!",a=Array.prototype.slice;function o(e){e.sort((function(e,t){return e=e.p,(t=t.p)<e?1:e>t?-1:0}))}function s(e,t,n,r){if(!e)throw i;n=n||0;for(var s,l,u,c=this._listeners,h=c.length;h--;)if((s=c[h]).f===e&&s.c===t)return!1;"function"==typeof n&&(l=n,n=r,u=4),c.unshift({f:e,c:t,p:n,r:l||e,a:a.call(arguments,u||3),j:0}),o(c)}void 0!==t&&(t.exports=n)}()},{}],30:[function(e,t,n){"use strict";var r=e("./kindOf"),i=e("./isPlainObject"),a=e("../object/mixIn");t.exports=function(e){switch(r(e)){case"Object":return i(o=e)?a({},o):o;case"Array":return e.slice();case"RegExp":return n="",n+=(t=e).multiline?"m":"",n+=t.global?"g":"",n+=t.ignoreCase?"i":"",new RegExp(t.source,n);case"Date":return new Date(+e);default:return e}var t,n,o}},{"../object/mixIn":45,"./isPlainObject":38,"./kindOf":39}],31:[function(e,t,n){"use strict";var r=e("./clone"),i=e("../object/forOwn"),a=e("./kindOf"),o=e("./isPlainObject");function s(e,t){switch(a(e)){case"Object":return function(e,t){if(o(e)){var n={};return i(e,(function(e,n){this[n]=s(e,t)}),n),n}return t?t(e):e}(e,t);case"Array":return function(e,t){var n=[],r=-1,i=e.length;for(;++r<i;)n[r]=s(e[r],t);return n}(e,t);default:return r(e)}}t.exports=s},{"../object/forOwn":42,"./clone":30,"./isPlainObject":38,"./kindOf":39}],32:[function(e,t,n){"use strict";var r=e("./isKind"),i=Array.isArray||function(e){return r(e,"Array")};t.exports=i},{"./isKind":35}],33:[function(e,t,n){"use strict";var r=e("./isKind");t.exports=function(e){return r(e,"Boolean")}},{"./isKind":35}],34:[function(e,t,n){"use strict";var r=e("./isNumber");t.exports=function(e){return r(e)&&e%1==0}},{"./isNumber":36}],35:[function(e,t,n){"use strict";var r=e("./kindOf");t.exports=function(e,t){return r(e)===t}},{"./kindOf":39}],36:[function(e,t,n){"use strict";var r=e("./isKind");t.exports=function(e){return r(e,"Number")}},{"./isKind":35}],37:[function(e,t,n){"use strict";var r=e("./isKind");t.exports=function(e){return r(e,"Object")}},{"./isKind":35}],38:[function(e,t,n){"use strict";var r=e("@babel/runtime/helpers/interopRequireDefault")(e("@babel/runtime/helpers/typeof"));t.exports=function(e){return!!e&&"object"===(0,r.default)(e)&&e.constructor===Object}},{"@babel/runtime/helpers/interopRequireDefault":12,"@babel/runtime/helpers/typeof":22}],39:[function(e,t,n){"use strict";t.exports=function(e){return Object.prototype.toString.call(e).slice(8,-1)}},{}],40:[function(e,t,n){"use strict";var r=e("./forOwn"),i=e("../lang/isPlainObject");function a(e,t){for(var n,i=0,a=arguments.length;++i<a;)(n=arguments[i])&&r(n,o,e);return e}function o(e,t){var n=this[t];i(e)&&i(n)?a(n,e):this[t]=e}t.exports=a},{"../lang/isPlainObject":38,"./forOwn":42}],41:[function(e,t,n){"use strict";var r,i,a=e("./hasOwn");function o(e,t,n,r){return e.call(r,t[n],n,t)}t.exports=function(e,t,n){var s,l=0;for(s in null==r&&function(){for(var e in i=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],r=!0,{toString:null})r=!1}(),e)if(!1===o(t,e,s,n))break;if(r)for(var u=e.constructor,c=!!u&&e===u.prototype;(s=i[l++])&&("constructor"===s&&(c||!a(e,s))||e[s]===Object.prototype[s]||!1!==o(t,e,s,n)););}},{"./hasOwn":43}],42:[function(e,t,n){"use strict";var r=e("./hasOwn"),i=e("./forIn");t.exports=function(e,t,n){i(e,(function(i,a){if(r(e,a))return t.call(n,e[a],a,e)}))}},{"./forIn":41,"./hasOwn":43}],43:[function(e,t,n){"use strict";t.exports=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}},{}],44:[function(e,t,n){"use strict";var r=e("./hasOwn"),i=e("../lang/deepClone"),a=e("../lang/isObject");t.exports=function e(){var t,n,o,s,l=1;for(s=i(arguments[0]);o=arguments[l++];)for(t in o)r(o,t)&&(n=o[t],a(n)&&a(s[t])?s[t]=e(s[t],n):s[t]=i(n));return s}},{"../lang/deepClone":31,"../lang/isObject":37,"./hasOwn":43}],45:[function(e,t,n){"use strict";var r=e("./forOwn");function i(e,t){this[t]=e}t.exports=function(e,t){for(var n,a=0,o=arguments.length;++a<o;)null!=(n=arguments[a])&&r(n,i,e);return e}},{"./forOwn":42}],46:[function(e,t,n){"use strict";var r=e("../string/typecast"),i=e("../lang/isArray"),a=e("../object/hasOwn");t.exports=function(e,t){for(var n,o,s,l,u=(e||"").replace("?","").split("&"),c=-1,h={};o=u[++c];)n=o.indexOf("="),l=o.substring(0,n),s=decodeURIComponent(o.substring(n+1)),!1!==t&&(s=r(s)),a(h,l)?i(h[l])?h[l].push(s):h[l]=[h[l],s]:h[l]=s;return h}},{"../lang/isArray":32,"../object/hasOwn":43,"../string/typecast":49}],47:[function(e,t,n){"use strict";t.exports=function(e){var t=/\?[a-zA-Z0-9\=\&\%\$\-\_\.\+\!\*\'\(\)\,]+/.exec(e);return t?decodeURIComponent(t[0].replace(/\+/g," ")):""}},{}],48:[function(e,t,n){"use strict";var r=e("./decode"),i=e("./getQuery");t.exports=function(e,t){return r(i(e),t)}},{"./decode":46,"./getQuery":47}],49:[function(e,t,n){"use strict";var r;t.exports=function(e){return null===e||"null"===e?null:"true"===e||"false"!==e&&(e===r||"undefined"===e?r:""===e||isNaN(e)?e:parseFloat(e))}},{}],50:[function(e,t,n){"use strict";t.exports=e("./src/quickLoader"),e("./src/types/JSONPItem"),e("./src/types/JSONItem"),e("./src/types/TextItem"),e("./src/types/AudioItem"),e("./src/types/VideoItem"),e("./src/types/AnyItem"),e("./src/types/ImageItem"),e("./src/types/XHRItem")},{"./src/quickLoader":52,"./src/types/AnyItem":54,"./src/types/AudioItem":55,"./src/types/ImageItem":56,"./src/types/JSONItem":57,"./src/types/JSONPItem":58,"./src/types/TextItem":59,"./src/types/VideoItem":60,"./src/types/XHRItem":61}],51:[function(e,t,n){arguments[4][29][0].apply(n,arguments)},{dup:29}],52:[function(e,t,n){"use strict";var r,i=e("min-signal");function a(){this.isLoading=!1,this.totalWeight=0,this.loadedWeight=0,this.itemUrls={},this.itemList=[],this.loadingSignal=new i,this.crossOriginMap={},this.queue=[],this.activeItems=[],this.maxActiveItems=4}var o=a.prototype;o.addChunk=function(e,t){var n,r,i,a,o,s=v(e,t);for(n=0,i=s.length;n<i;n++)for(o=s[n],r=0,a=o.items.length;r<a;r++)this.add(o.items[r],{type:o.type});return s},o.setCrossOrigin=function(e,t){this.crossOriginMap[e]=t},o.add=function(e,t){var n=s[e];n||(n=this._createItem(e,t&&t.type?t.type:m(e).type,t));t&&t.onLoad&&n.onLoaded.addOnce(t.onLoad);this.itemUrls[e]||(this.itemUrls[e]=n,this.itemList.push(n),this.totalWeight+=n.weight);return n},o.load=function(e,t){var n=s[e];n||(n=this._createItem(e,t&&t.type?t.type:m(e).type,t));t&&t.onLoad&&n.onLoaded.addOnce(t.onLoad);l[e]?n.dispatch():n.isStartLoaded||n.load();return n},o.start=function(e){e&&this.loadingSignal.add(e);this.isLoading=!0;var t=this.itemList.length;if(t){var n,i=this.itemList.splice(0,this.itemList.length);for(var a in this.itemUrls)delete this.itemUrls[a];for(var o=0;o<t;o++){n=i[o];var s=!!l[n.url];n.onLoaded.addOnce(f,this,-1024,n,i,s),n.hasLoading&&n.loadingSignal.add(h,this,-1024,n,i,r),s?n.dispatch(f):n.isStartLoaded||this.queue.push(n)}this.queue.length&&this.loadNext()}else f.call(this,r,this.itemList)},o.loadNext=function(){if(this.queue.length&&this.activeItems.length<this.maxActiveItems){var e=this.queue.shift();this.activeItems.push(e),this.loadNext(),e.load()}},o._createItem=function(e,t,n){if(!(n=n||{}).crossOrigin)for(var r in this.crossOriginMap)if(0===e.indexOf(r)){n.crossOrigin=this.crossOriginMap[r];break}return new c[t](e,n)},o._onLoading=h,o.VERSION="0.1.17",o.register=function(e){c[e.type]||(u.push(e),c[e.type]=e)},o.retrieveAll=v,o.retrieve=m,o.testExtensions=g,o.create=_,o.check=function(){var e=[],t=[];for(var n in s)e.push(n),l[n]||t.push(s[n]);console.log({added:e,notLoaded:t})};var s=o.addedItems={},l=o.loadedItems={},u=o.ITEM_CLASS_LIST=[],c=o.ITEM_CLASSES={};t.exports=_();function h(e,t,n,i,a){e&&!e.isLoaded&&1===e.getCombinedPercent(i)||(a===r&&(this.loadedWeight=d(t),a=this.loadedWeight/this.totalWeight),(n=n||this.loadingSignal).dispatch(a,e))}function d(e){for(var t=0,n=0,r=e.length;n<r;n++)t+=e[n].loadedWeight;return t}function f(e,t,n){if(this.loadedWeight=d(t),!n)for(var r=this.activeItems,a=r.length;a--;)if(r[a]===e){r.splice(a,1);break}var o=this.loadingSignal;this.loadedWeight===this.totalWeight?(this.isLoading=!1,this.loadedWeight=0,this.totalWeight=0,this.loadingSignal=new i,this._onLoading(e,t,o,1,1),e&&e.noCache&&p(e)):(this._onLoading(e,t,o,1,this.loadedWeight/this.totalWeight),e&&e.noCache&&p(e),n||this.loadNext())}function p(e){var t=e.url;e.content=r,s[t]=r,l[t]=r}function v(e,t){var n,r,i=e.length,a=[];if(i&&"string"!=typeof e)for(n=0;n<i;n++)(r=m(e[n],t))&&(a=a.concat(r));else(r=m(e,t))&&(a=a.concat(r));return a}function m(e,t){var n,i,a,o,s;if(t)a=(o=c[t]).retrieve(e);else for(n=0,i=u.length;n<i;n++){if(s=(o=u[n]).type,"string"==typeof e){if(g(e,o)){a=[e];break}}else if((a=o.retrieve(e))&&a.length&&"string"==typeof a[0]&&g(a[0],o))break;a=r,s=r}if(a)return{type:t||s,items:a}}function g(e,t){if(e){for(var n=function(e){return e.split(".").pop().split(/#|\?/)[0]}(e),r=t.extensions,i=r.length;i--;)if(n===r[i])return!0;return!1}}function _(){return new a}},{"min-signal":51}],53:[function(e,t,n){"use strict";var r=e("min-signal"),i=e("../quickLoader");function a(e,t){if(e){for(var n in this.url=e,this.loadedWeight=0,this.weight=1,this.postPercent=0,t)this[n]=t[n];this.type||(this.type=this.constructor.type),this.hasLoading&&(this.loadingSignal=new r,this.loadingSignal.add(s,this),this.onLoading&&this.loadingSignal.add(this.onLoading)),this.onPost?(this.onPostLoadingSignal=new r,this.onPostLoadingSignal.add(this._onPostLoading,this),this.postWeightRatio=this.postWeightRatio||.1):this.postWeightRatio=0;var a=this;this.boundOnLoad=function(){a._onLoad()},this.onLoaded=new r,i.addedItems[e]=this}}t.exports=a;var o=a.prototype;function s(e){this.loadedWeight=this.weight*this.getCombinedPercent(e)}o.load=function(){this.isStartLoaded=!0},o._onLoad=function(){this.onPost?this.onPost.call(this,this.content,this.onPostLoadingSignal):this._onLoadComplete()},o._onLoading=s,o._onPostLoading=function(e){this.postPercent=e,this.hasLoading&&this.loadingSignal.dispatch(1);1===e&&this._onLoadComplete()},o._onLoadComplete=function(){this.isLoaded=!0,this.loadedWeight=this.weight,i.loadedItems[this.url]=this,this.onLoaded.dispatch(this.content)},o.getCombinedPercent=function(e){return e*(1-this.postWeightRatio)+this.postWeightRatio*this.postPercent},o.dispatch=function(){this.hasLoading&&this.loadingSignal.remove();this.onLoaded.dispatch(this.content)},a.extensions=[],a.retrieve=function(){return!1}},{"../quickLoader":52,"min-signal":51}],54:[function(e,t,n){"use strict";var r=e("./AbstractItem"),i=e("../quickLoader");function a(e,t){e&&(o.constructor.call(this,e,t),!this.loadFunc&&console&&console[console.error||console.log]("require loadFunc in the config object."))}t.exports=a,a.type="any",a.extensions=[],i.register(a),a.retrieve=function(){return!1};var o=r.prototype,s=a.prototype=new r;s.constructor=a,s.load=function(){var e=this;this.loadFunc(this.url,(function(t){e.content=t,o._onLoad.call(e)}),this.loadingSignal)}},{"../quickLoader":52,"./AbstractItem":53}],55:[function(e,t,n){"use strict";var r,i=e("./AbstractItem"),a=e("../quickLoader");function o(e,t){if(e){this.loadThrough=!t||t.loadThrough===r||t.loadThrough,s.constructor.apply(this,arguments);try{this.content=this.content||new Audio}catch(e){this.content=this.content||document.createElement("audio")}this.crossOrigin&&(this.content.crossOrigin=this.crossOrigin)}}t.exports=o,o.type="audio",o.extensions=["mp3","ogg"],a.register(o),o.retrieve=function(e){return!1};var s=i.prototype,l=o.prototype=new i;l.constructor=o,l.load=function(){s.load.apply(this,arguments);var e=this,t=e.content;t.src=this.url,this.loadThrough?t.addEventListener("canplaythrough",this.boundOnLoad,!1):t.addEventListener("canplay",this.boundOnLoad,!1);t.load()},l._onLoad=function(){if(this.content.removeEventListener("canplaythrough",this.boundOnLoad,!1),this.content.removeEventListener("canplay",this.boundOnLoad,!1),this.isLoaded)return;s._onLoad.call(this)}},{"../quickLoader":52,"./AbstractItem":53}],56:[function(e,t,n){"use strict";var r=e("./AbstractItem"),i=e("computed-style"),a=e("../quickLoader");function o(e,t){e&&(s.constructor.apply(this,arguments),this.content=this.content||new Image,this.crossOrigin&&(this.content.crossOrigin=this.crossOrigin))}t.exports=o;var s=r.prototype,l=o.prototype=new r;l.constructor=o,l.load=function(){s.load.apply(this,arguments);var e=this.content;e.onload=this.boundOnLoad,e.src=this.url},l._onLoad=function(){delete this.content.onload,this.width=this.content.width,this.height=this.content.height,s._onLoad.call(this)},o.retrieve=function(e){if(e.nodeType&&e.style){var t=[];"img"===e.nodeName.toLowerCase()&&e.src.indexOf(";")<0&&t.push(e.src),i(e,"background-image").replace(/s?url\(\s*?['"]?([^;]*?)['"]?\s*?\)/g,(function(e,n){t.push(n)}));for(var n=t.length;n--;)0===t[n].indexOf("data:")&&t.splice(n,1);return!!t.length&&t}return"string"==typeof e&&[e]},o.type="image",o.extensions=["jpg","gif","png"],a.register(o)},{"../quickLoader":52,"./AbstractItem":53,"computed-style":25}],57:[function(require,module,exports){"use strict";var TextItem=require("./TextItem"),quickLoader=require("../quickLoader");function JSONItem(e){e&&_super.constructor.apply(this,arguments)}module.exports=JSONItem,JSONItem.type="json",JSONItem.extensions=["json"],quickLoader.register(JSONItem),JSONItem.retrieve=function(){return!1};var _super=TextItem.prototype,_p=JSONItem.prototype=new TextItem;function _onLoad(){this.content||(this.content=window.JSON&&window.JSON.parse?JSON.parse(this.xmlhttp.responseText.toString()):eval(this.xmlhttp.responseText.toString())),_super._onLoad.call(this)}_p.constructor=JSONItem,_p._onLoad=_onLoad},{"../quickLoader":52,"./TextItem":59}],58:[function(e,t,n){"use strict";var r=e("./AbstractItem"),i=e("../quickLoader");function a(){return"_jsonp"+(new Date).getTime()+~~(1e8*Math.random())}function o(e){e&&s.constructor.apply(this,arguments)}t.exports=o,o.type="jsonp",o.extensions=[],i.register(o),o.retrieve=function(e){return"string"==typeof e&&e.indexOf("=")>-1&&[e]};var s=r.prototype,l=o.prototype=new r;l.constructor=o,l.load=function(e){s.load.apply(this,arguments);var t=this,n=this.url.lastIndexOf("=")+1,r=this.url.substr(0,n),i=this.url.substr(n);0===i.length?(i=a(),this.jsonpCallback=e):this.jsonpCallback=this.jsonpCallback||window[i];window[i]=function(e){o.parentNode&&o.parentNode.removeChild(o),t.content=e,t._onLoad()};var o=document.createElement("script");o.type="text/javascript",o.src=r+i,document.getElementsByTagName("head")[0].appendChild(o)}},{"../quickLoader":52,"./AbstractItem":53}],59:[function(e,t,n){"use strict";var r=e("./XHRItem"),i=e("../quickLoader");function a(e,t){e&&(t.responseType="text",o.constructor.apply(this,arguments))}t.exports=a,a.type="text",a.extensions=["html","txt","svg"],i.register(a),a.retrieve=function(){return!1};var o=r.prototype,s=a.prototype=new r;s.constructor=a,s._onLoad=function(){this.content||(this.content=this.xmlhttp.responseText);o._onLoad.apply(this,arguments)}},{"../quickLoader":52,"./XHRItem":61}],60:[function(e,t,n){"use strict";var r,i=e("./AbstractItem"),a=e("../quickLoader");function o(e,t){if(e){this.loadThrough=!t||t.loadThrough===r||t.loadThrough,s.constructor.apply(this,arguments);try{this.content=this.content||new Video}catch(e){this.content=this.content||document.createElement("video")}this.crossOrigin&&(this.content.crossOrigin=this.crossOrigin)}}t.exports=o,o.type="video",o.extensions=["mp4","webm","ogv"],a.register(o),o.retrieve=function(e){return!1};var s=i.prototype,l=o.prototype=new i;l.constructor=o,l.load=function(){s.load.apply(this,arguments);var e=this.content;e.preload="auto",e.src=this.url,this.loadThrough?e.addEventListener("canplaythrough",this.boundOnLoad,!1):e.addEventListener("canplay",this.boundOnLoad,!1);e.load()},l._onLoad=function(){if(this.content.removeEventListener("canplaythrough",this.boundOnLoad),this.content.removeEventListener("canplay",this.boundOnLoad),this.isLoaded)return;s._onLoad.call(this)}},{"../quickLoader":52,"./AbstractItem":53}],61:[function(e,t,n){"use strict";var r=e("./AbstractItem"),i=e("../quickLoader"),a=!!window.XMLHttpRequest;function o(e){e&&(s.constructor.apply(this,arguments),this.responseType=this.responseType||"",this.method=this.method||"GET")}t.exports=o,o.type="xhr",o.extensions=[],i.register(o),o.retrieve=function(){return!1};var s=r.prototype,l=o.prototype=new r;l.constructor=o,l.load=function(){s.load.apply(this,arguments);var e,t=this;e=this.xmlhttp=a?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP");this.hasLoading&&(e.onprogress=function(e){t._onXmlHttpProgress(e)});e.onreadystatechange=function(){t._onXmlHttpChange()},e.open(this.method,this.url,!0),this.xmlhttp.responseType=this.responseType,a?e.send(null):e.send()},l._onXmlHttpChange=function(){4===this.xmlhttp.readyState&&200===this.xmlhttp.status&&this._onLoad(this.xmlhttp)},l._onXmlHttpProgress=function(e){this.loadingSignal.dispatch(e.loaded/e.total)},l._onLoad=function(){this.content||(this.content=this.xmlhttp.response);this.xmlhttp=undefined,s._onLoad.call(this)}},{"../quickLoader":52,"./AbstractItem":53}],62:[function(e,t,n){"use strict";var r=e("@babel/runtime/helpers/interopRequireDefault")(e("@babel/runtime/helpers/typeof")),i=function(e){var t,n=Object.prototype,i=n.hasOwnProperty,a="function"==typeof Symbol?Symbol:{},o=a.iterator||"@@iterator",s=a.asyncIterator||"@@asyncIterator",l=a.toStringTag||"@@toStringTag";function u(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{u({},"")}catch(e){u=function(e,t,n){return e[t]=n}}function c(e,t,n,r){var i=t&&t.prototype instanceof g?t:g,a=Object.create(i.prototype),o=new C(r||[]);return a._invoke=function(e,t,n){var r=d;return function(i,a){if(r===p)throw new Error("Generator is already running");if(r===v){if("throw"===i)throw a;return k()}for(n.method=i,n.arg=a;;){var o=n.delegate;if(o){var s=E(o,n);if(s){if(s===m)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(r===d)throw r=v,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r=p;var l=h(e,t,n);if("normal"===l.type){if(r=n.done?v:f,l.arg===m)continue;return{value:l.arg,done:n.done}}"throw"===l.type&&(r=v,n.method="throw",n.arg=l.arg)}}}(e,n,o),a}function h(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}e.wrap=c;var d="suspendedStart",f="suspendedYield",p="executing",v="completed",m={};function g(){}function _(){}function y(){}var x={};u(x,o,(function(){return this}));var b=Object.getPrototypeOf,w=b&&b(b(R([])));w&&w!==n&&i.call(w,o)&&(x=w);var T=y.prototype=g.prototype=Object.create(x);function M(e){["next","throw","return"].forEach((function(t){u(e,t,(function(e){return this._invoke(t,e)}))}))}function S(e,t){function n(a,o,s,l){var u=h(e[a],e,o);if("throw"!==u.type){var c=u.arg,d=c.value;return d&&"object"===(0,r.default)(d)&&i.call(d,"__await")?t.resolve(d.__await).then((function(e){n("next",e,s,l)}),(function(e){n("throw",e,s,l)})):t.resolve(d).then((function(e){c.value=e,s(c)}),(function(e){return n("throw",e,s,l)}))}l(u.arg)}var a;this._invoke=function(e,r){function i(){return new t((function(t,i){n(e,r,t,i)}))}return a=a?a.then(i,i):i()}}function E(e,n){var r=e.iterator[n.method];if(r===t){if(n.delegate=null,"throw"===n.method){if(e.iterator.return&&(n.method="return",n.arg=t,E(e,n),"throw"===n.method))return m;n.method="throw",n.arg=new TypeError("The iterator does not provide a 'throw' method")}return m}var i=h(r,e.iterator,n.arg);if("throw"===i.type)return n.method="throw",n.arg=i.arg,n.delegate=null,m;var a=i.arg;return a?a.done?(n[e.resultName]=a.value,n.next=e.nextLoc,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,m):a:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,m)}function A(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function L(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function C(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(A,this),this.reset(!0)}function R(e){if(e){var n=e[o];if(n)return n.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,a=function n(){for(;++r<e.length;)if(i.call(e,r))return n.value=e[r],n.done=!1,n;return n.value=t,n.done=!0,n};return a.next=a}}return{next:k}}function k(){return{value:t,done:!0}}return _.prototype=y,u(T,"constructor",y),u(y,"constructor",_),_.displayName=u(y,l,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===_||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,y):(e.__proto__=y,u(e,l,"GeneratorFunction")),e.prototype=Object.create(T),e},e.awrap=function(e){return{__await:e}},M(S.prototype),u(S.prototype,s,(function(){return this})),e.AsyncIterator=S,e.async=function(t,n,r,i,a){void 0===a&&(a=Promise);var o=new S(c(t,n,r,i),a);return e.isGeneratorFunction(n)?o:o.next().then((function(e){return e.done?e.value:o.next()}))},M(T),u(T,l,"Generator"),u(T,o,(function(){return this})),u(T,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=[];for(var n in e)t.push(n);return t.reverse(),function n(){for(;t.length;){var r=t.pop();if(r in e)return n.value=r,n.done=!1,n}return n.done=!0,n}},e.values=R,C.prototype={constructor:C,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(L),!e)for(var n in this)"t"===n.charAt(0)&&i.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=t)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function r(r,i){return s.type="throw",s.arg=e,n.next=r,i&&(n.method="next",n.arg=t),!!i}for(var a=this.tryEntries.length-1;a>=0;--a){var o=this.tryEntries[a],s=o.completion;if("root"===o.tryLoc)return r("end");if(o.tryLoc<=this.prev){var l=i.call(o,"catchLoc"),u=i.call(o,"finallyLoc");if(l&&u){if(this.prev<o.catchLoc)return r(o.catchLoc,!0);if(this.prev<o.finallyLoc)return r(o.finallyLoc)}else if(l){if(this.prev<o.catchLoc)return r(o.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return r(o.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.tryLoc<=this.prev&&i.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var a=r;break}}a&&("break"===e||"continue"===e)&&a.tryLoc<=t&&t<=a.finallyLoc&&(a=null);var o=a?a.completion:{};return o.type=e,o.arg=t,a?(this.method="next",this.next=a.finallyLoc,m):this.complete(o)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),m},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),L(n),m}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var i=r.arg;L(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,n,r){return this.delegate={iterator:R(e),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=t),m}},e}("object"===(void 0===t?"undefined":(0,r.default)(t))?t.exports:{});try{regeneratorRuntime=i}catch(e){"object"===("undefined"==typeof globalThis?"undefined":(0,r.default)(globalThis))?globalThis.regeneratorRuntime=i:Function("r","regeneratorRuntime = r")(i)}},{"@babel/runtime/helpers/interopRequireDefault":12,"@babel/runtime/helpers/typeof":22}],63:[function(e,t,n){"use strict";var r,i,a=e("@babel/runtime/helpers/interopRequireDefault"),o=a(e("@babel/runtime/regenerator")),s=a(e("@babel/runtime/helpers/asyncToGenerator")),l=a(e("@babel/runtime/helpers/slicedToArray")),u=a(e("@babel/runtime/helpers/get")),c=a(e("@babel/runtime/helpers/defineProperty")),h=a(e("@babel/runtime/helpers/assertThisInitialized")),d=a(e("@babel/runtime/helpers/inherits")),f=a(e("@babel/runtime/helpers/possibleConstructorReturn")),p=a(e("@babel/runtime/helpers/getPrototypeOf")),v=a(e("@babel/runtime/helpers/classCallCheck")),m=a(e("@babel/runtime/helpers/createClass")),g=a(e("@babel/runtime/helpers/typeof"));function _(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return y(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return y(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw a}}}}function y(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function x(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function b(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}
/**
 * @license
 * Copyright 2010-2021 Three.js Authors
 * SPDX-License-Identifier: MIT
 */();return function(){var n,r=(0,p.default)(e);if(t){var i=(0,p.default)(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return(0,f.default)(this,n)}}r=void 0,i=function(e){for(var t,n="131",r=100,i=300,a=301,g=302,y=303,w=304,T=306,M=307,S=1e3,E=1001,A=1002,L=1003,C=1004,R=1005,k=1006,P=1007,D=1008,I=1009,O=1012,F=1014,N=1015,U=1016,B=1020,z=1022,H=1023,G=1026,V=1027,W=33776,j=33777,q=33778,X=33779,Y=35840,K=35841,Z=35842,J=35843,Q=37492,$=37496,ee=2201,te=2300,ne=2301,re=2302,ie=2400,ae=2401,oe=2402,se=2500,le=2501,ue=3e3,ce=3001,he=3007,de=3002,fe=3004,pe=3005,ve=3006,me=7680,ge=35044,_e=35048,ye="300 es",xe=function(){function e(){(0,v.default)(this,e)}return(0,m.default)(e,[{key:"addEventListener",value:function(e,t){void 0===this._listeners&&(this._listeners={});var n=this._listeners;void 0===n[e]&&(n[e]=[]),-1===n[e].indexOf(t)&&n[e].push(t)}},{key:"hasEventListener",value:function(e,t){if(void 0===this._listeners)return!1;var n=this._listeners;return void 0!==n[e]&&-1!==n[e].indexOf(t)}},{key:"removeEventListener",value:function(e,t){if(void 0!==this._listeners){var n=this._listeners[e];if(void 0!==n){var r=n.indexOf(t);-1!==r&&n.splice(r,1)}}}},{key:"dispatchEvent",value:function(e){if(void 0!==this._listeners){var t=this._listeners[e.type];if(void 0!==t){e.target=this;for(var n=t.slice(0),r=0,i=n.length;r<i;r++)n[r].call(this,e);e.target=null}}}}]),e}(),be=[],we=0;we<256;we++)be[we]=(we<16?"0":"")+we.toString(16);var Te=1234567,Me=Math.PI/180,Se=180/Math.PI;function Ee(){var e=4294967295*Math.random()|0,t=4294967295*Math.random()|0,n=4294967295*Math.random()|0,r=4294967295*Math.random()|0;return(be[255&e]+be[e>>8&255]+be[e>>16&255]+be[e>>24&255]+"-"+be[255&t]+be[t>>8&255]+"-"+be[t>>16&15|64]+be[t>>24&255]+"-"+be[63&n|128]+be[n>>8&255]+"-"+be[n>>16&255]+be[n>>24&255]+be[255&r]+be[r>>8&255]+be[r>>16&255]+be[r>>24&255]).toUpperCase()}function Ae(e,t,n){return Math.max(t,Math.min(n,e))}function Le(e,t){return(e%t+t)%t}function Ce(e,t,n){return(1-n)*e+n*t}function Re(e){return 0==(e&e-1)&&0!==e}function ke(e){return Math.pow(2,Math.ceil(Math.log(e)/Math.LN2))}function Pe(e){return Math.pow(2,Math.floor(Math.log(e)/Math.LN2))}var De=Object.freeze({__proto__:null,DEG2RAD:Me,RAD2DEG:Se,generateUUID:Ee,clamp:Ae,euclideanModulo:Le,mapLinear:function(e,t,n,r,i){return r+(e-t)*(i-r)/(n-t)},inverseLerp:function(e,t,n){return e!==t?(n-e)/(t-e):0},lerp:Ce,damp:function(e,t,n,r){return Ce(e,t,1-Math.exp(-n*r))},pingpong:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return t-Math.abs(Le(e,2*t)-t)},smoothstep:function(e,t,n){return e<=t?0:e>=n?1:(e=(e-t)/(n-t))*e*(3-2*e)},smootherstep:function(e,t,n){return e<=t?0:e>=n?1:(e=(e-t)/(n-t))*e*e*(e*(6*e-15)+10)},randInt:function(e,t){return e+Math.floor(Math.random()*(t-e+1))},randFloat:function(e,t){return e+Math.random()*(t-e)},randFloatSpread:function(e){return e*(.5-Math.random())},seededRandom:function(e){return void 0!==e&&(Te=e%2147483647),((Te=16807*Te%2147483647)-1)/2147483646},degToRad:function(e){return e*Me},radToDeg:function(e){return e*Se},isPowerOfTwo:Re,ceilPowerOfTwo:ke,floorPowerOfTwo:Pe,setQuaternionFromProperEuler:function(e,t,n,r,i){var a=Math.cos,o=Math.sin,s=a(n/2),l=o(n/2),u=a((t+r)/2),c=o((t+r)/2),h=a((t-r)/2),d=o((t-r)/2),f=a((r-t)/2),p=o((r-t)/2);switch(i){case"XYX":e.set(s*c,l*h,l*d,s*u);break;case"YZY":e.set(l*d,s*c,l*h,s*u);break;case"ZXZ":e.set(l*h,l*d,s*c,s*u);break;case"XZX":e.set(s*c,l*p,l*f,s*u);break;case"YXY":e.set(l*f,s*c,l*p,s*u);break;case"ZYZ":e.set(l*p,l*f,s*c,s*u);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+i)}}}),Ie=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;(0,v.default)(this,e),this.x=t,this.y=n}return(0,m.default)(e,[{key:"width",get:function(){return this.x},set:function(e){this.x=e}},{key:"height",get:function(){return this.y},set:function(e){this.y=e}},{key:"set",value:function(e,t){return this.x=e,this.y=t,this}},{key:"setScalar",value:function(e){return this.x=e,this.y=e,this}},{key:"setX",value:function(e){return this.x=e,this}},{key:"setY",value:function(e){return this.y=e,this}},{key:"setComponent",value:function(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}return this}},{key:"getComponent",value:function(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}},{key:"clone",value:function(){return new this.constructor(this.x,this.y)}},{key:"copy",value:function(e){return this.x=e.x,this.y=e.y,this}},{key:"add",value:function(e,t){return void 0!==t?(console.warn("THREE.Vector2: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this)}},{key:"addScalar",value:function(e){return this.x+=e,this.y+=e,this}},{key:"addVectors",value:function(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this}},{key:"addScaledVector",value:function(e,t){return this.x+=e.x*t,this.y+=e.y*t,this}},{key:"sub",value:function(e,t){return void 0!==t?(console.warn("THREE.Vector2: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this)}},{key:"subScalar",value:function(e){return this.x-=e,this.y-=e,this}},{key:"subVectors",value:function(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this}},{key:"multiply",value:function(e){return this.x*=e.x,this.y*=e.y,this}},{key:"multiplyScalar",value:function(e){return this.x*=e,this.y*=e,this}},{key:"divide",value:function(e){return this.x/=e.x,this.y/=e.y,this}},{key:"divideScalar",value:function(e){return this.multiplyScalar(1/e)}},{key:"applyMatrix3",value:function(e){var t=this.x,n=this.y,r=e.elements;return this.x=r[0]*t+r[3]*n+r[6],this.y=r[1]*t+r[4]*n+r[7],this}},{key:"min",value:function(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}},{key:"max",value:function(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}},{key:"clamp",value:function(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this}},{key:"clampScalar",value:function(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this}},{key:"clampLength",value:function(e,t){var n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(t,n)))}},{key:"floor",value:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}},{key:"ceil",value:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}},{key:"round",value:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},{key:"roundToZero",value:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this}},{key:"negate",value:function(){return this.x=-this.x,this.y=-this.y,this}},{key:"dot",value:function(e){return this.x*e.x+this.y*e.y}},{key:"cross",value:function(e){return this.x*e.y-this.y*e.x}},{key:"lengthSq",value:function(){return this.x*this.x+this.y*this.y}},{key:"length",value:function(){return Math.sqrt(this.x*this.x+this.y*this.y)}},{key:"manhattanLength",value:function(){return Math.abs(this.x)+Math.abs(this.y)}},{key:"normalize",value:function(){return this.divideScalar(this.length()||1)}},{key:"angle",value:function(){var e=Math.atan2(-this.y,-this.x)+Math.PI;return e}},{key:"distanceTo",value:function(e){return Math.sqrt(this.distanceToSquared(e))}},{key:"distanceToSquared",value:function(e){var t=this.x-e.x,n=this.y-e.y;return t*t+n*n}},{key:"manhattanDistanceTo",value:function(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}},{key:"setLength",value:function(e){return this.normalize().multiplyScalar(e)}},{key:"lerp",value:function(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this}},{key:"lerpVectors",value:function(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this}},{key:"equals",value:function(e){return e.x===this.x&&e.y===this.y}},{key:"fromArray",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.x=e[t],this.y=e[t+1],this}},{key:"toArray",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e[t]=this.x,e[t+1]=this.y,e}},{key:"fromBufferAttribute",value:function(e,t,n){return void 0!==n&&console.warn("THREE.Vector2: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(t),this.y=e.getY(t),this}},{key:"rotateAround",value:function(e,t){var n=Math.cos(t),r=Math.sin(t),i=this.x-e.x,a=this.y-e.y;return this.x=i*n-a*r+e.x,this.y=i*r+a*n+e.y,this}},{key:"random",value:function(){return this.x=Math.random(),this.y=Math.random(),this}}]),e}();Ie.prototype.isVector2=!0;var Oe,Fe=function(){function e(){(0,v.default)(this,e),this.elements=[1,0,0,0,1,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix3: the constructor no longer reads arguments. use .set() instead.")}return(0,m.default)(e,[{key:"set",value:function(e,t,n,r,i,a,o,s,l){var u=this.elements;return u[0]=e,u[1]=r,u[2]=o,u[3]=t,u[4]=i,u[5]=s,u[6]=n,u[7]=a,u[8]=l,this}},{key:"identity",value:function(){return this.set(1,0,0,0,1,0,0,0,1),this}},{key:"copy",value:function(e){var t=this.elements,n=e.elements;return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],this}},{key:"extractBasis",value:function(e,t,n){return e.setFromMatrix3Column(this,0),t.setFromMatrix3Column(this,1),n.setFromMatrix3Column(this,2),this}},{key:"setFromMatrix4",value:function(e){var t=e.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this}},{key:"multiply",value:function(e){return this.multiplyMatrices(this,e)}},{key:"premultiply",value:function(e){return this.multiplyMatrices(e,this)}},{key:"multiplyMatrices",value:function(e,t){var n=e.elements,r=t.elements,i=this.elements,a=n[0],o=n[3],s=n[6],l=n[1],u=n[4],c=n[7],h=n[2],d=n[5],f=n[8],p=r[0],v=r[3],m=r[6],g=r[1],_=r[4],y=r[7],x=r[2],b=r[5],w=r[8];return i[0]=a*p+o*g+s*x,i[3]=a*v+o*_+s*b,i[6]=a*m+o*y+s*w,i[1]=l*p+u*g+c*x,i[4]=l*v+u*_+c*b,i[7]=l*m+u*y+c*w,i[2]=h*p+d*g+f*x,i[5]=h*v+d*_+f*b,i[8]=h*m+d*y+f*w,this}},{key:"multiplyScalar",value:function(e){var t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this}},{key:"determinant",value:function(){var e=this.elements,t=e[0],n=e[1],r=e[2],i=e[3],a=e[4],o=e[5],s=e[6],l=e[7],u=e[8];return t*a*u-t*o*l-n*i*u+n*o*s+r*i*l-r*a*s}},{key:"invert",value:function(){var e=this.elements,t=e[0],n=e[1],r=e[2],i=e[3],a=e[4],o=e[5],s=e[6],l=e[7],u=e[8],c=u*a-o*l,h=o*s-u*i,d=l*i-a*s,f=t*c+n*h+r*d;if(0===f)return this.set(0,0,0,0,0,0,0,0,0);var p=1/f;return e[0]=c*p,e[1]=(r*l-u*n)*p,e[2]=(o*n-r*a)*p,e[3]=h*p,e[4]=(u*t-r*s)*p,e[5]=(r*i-o*t)*p,e[6]=d*p,e[7]=(n*s-l*t)*p,e[8]=(a*t-n*i)*p,this}},{key:"transpose",value:function(){var e,t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this}},{key:"getNormalMatrix",value:function(e){return this.setFromMatrix4(e).invert().transpose()}},{key:"transposeIntoArray",value:function(e){var t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this}},{key:"setUvTransform",value:function(e,t,n,r,i,a,o){var s=Math.cos(i),l=Math.sin(i);return this.set(n*s,n*l,-n*(s*a+l*o)+a+e,-r*l,r*s,-r*(-l*a+s*o)+o+t,0,0,1),this}},{key:"scale",value:function(e,t){var n=this.elements;return n[0]*=e,n[3]*=e,n[6]*=e,n[1]*=t,n[4]*=t,n[7]*=t,this}},{key:"rotate",value:function(e){var t=Math.cos(e),n=Math.sin(e),r=this.elements,i=r[0],a=r[3],o=r[6],s=r[1],l=r[4],u=r[7];return r[0]=t*i+n*s,r[3]=t*a+n*l,r[6]=t*o+n*u,r[1]=-n*i+t*s,r[4]=-n*a+t*l,r[7]=-n*o+t*u,this}},{key:"translate",value:function(e,t){var n=this.elements;return n[0]+=e*n[2],n[3]+=e*n[5],n[6]+=e*n[8],n[1]+=t*n[2],n[4]+=t*n[5],n[7]+=t*n[8],this}},{key:"equals",value:function(e){for(var t=this.elements,n=e.elements,r=0;r<9;r++)if(t[r]!==n[r])return!1;return!0}},{key:"fromArray",value:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=0;n<9;n++)this.elements[n]=e[n+t];return this}},{key:"toArray",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=this.elements;return e[t]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=n[3],e[t+4]=n[4],e[t+5]=n[5],e[t+6]=n[6],e[t+7]=n[7],e[t+8]=n[8],e}},{key:"clone",value:function(){return(new this.constructor).fromArray(this.elements)}}]),e}();Fe.prototype.isMatrix3=!0;var Ne=function(){function e(){(0,v.default)(this,e)}return(0,m.default)(e,null,[{key:"getDataURL",value:function(e){if(/^data:/i.test(e.src))return e.src;if("undefined"==typeof HTMLCanvasElement)return e.src;var t;if(e instanceof HTMLCanvasElement)t=e;else{void 0===Oe&&(Oe=document.createElementNS("http://www.w3.org/1999/xhtml","canvas")),Oe.width=e.width,Oe.height=e.height;var n=Oe.getContext("2d");e instanceof ImageData?n.putImageData(e,0,0):n.drawImage(e,0,0,e.width,e.height),t=Oe}return t.width>2048||t.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",e),t.toDataURL("image/jpeg",.6)):t.toDataURL("image/png")}}]),e}(),Ue=0,Be=function(e){(0,d.default)(n,e);var t=b(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:n.DEFAULT_IMAGE,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:n.DEFAULT_MAPPING,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:E,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:E,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:k,l=arguments.length>5&&void 0!==arguments[5]?arguments[5]:D,u=arguments.length>6&&void 0!==arguments[6]?arguments[6]:H,c=arguments.length>7&&void 0!==arguments[7]?arguments[7]:I,d=arguments.length>8&&void 0!==arguments[8]?arguments[8]:1,f=arguments.length>9&&void 0!==arguments[9]?arguments[9]:ue;return(0,v.default)(this,n),e=t.call(this),Object.defineProperty((0,h.default)(e),"id",{value:Ue++}),e.uuid=Ee(),e.name="",e.image=r,e.mipmaps=[],e.mapping=i,e.wrapS=a,e.wrapT=o,e.magFilter=s,e.minFilter=l,e.anisotropy=d,e.format=u,e.internalFormat=null,e.type=c,e.offset=new Ie(0,0),e.repeat=new Ie(1,1),e.center=new Ie(0,0),e.rotation=0,e.matrixAutoUpdate=!0,e.matrix=new Fe,e.generateMipmaps=!0,e.premultiplyAlpha=!1,e.flipY=!0,e.unpackAlignment=4,e.encoding=f,e.version=0,e.onUpdate=null,e.isRenderTargetTexture=!1,e}return(0,m.default)(n,[{key:"updateMatrix",value:function(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}},{key:"clone",value:function(){return(new this.constructor).copy(this)}},{key:"copy",value:function(e){return this.name=e.name,this.image=e.image,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.internalFormat=e.internalFormat,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.encoding=e.encoding,this}},{key:"toJSON",value:function(e){var t=void 0===e||"string"==typeof e;if(!t&&void 0!==e.textures[this.uuid])return e.textures[this.uuid];var n={metadata:{version:4.5,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,type:this.type,encoding:this.encoding,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};if(void 0!==this.image){var r=this.image;if(void 0===r.uuid&&(r.uuid=Ee()),!t&&void 0===e.images[r.uuid]){var i;if(Array.isArray(r)){i=[];for(var a=0,o=r.length;a<o;a++)r[a].isDataTexture?i.push(ze(r[a].image)):i.push(ze(r[a]))}else i=ze(r);e.images[r.uuid]={uuid:r.uuid,url:i}}n.image=r.uuid}return t||(e.textures[this.uuid]=n),n}},{key:"dispose",value:function(){this.dispatchEvent({type:"dispose"})}},{key:"transformUv",value:function(e){if(this.mapping!==i)return e;if(e.applyMatrix3(this.matrix),e.x<0||e.x>1)switch(this.wrapS){case S:e.x=e.x-Math.floor(e.x);break;case E:e.x=e.x<0?0:1;break;case A:1===Math.abs(Math.floor(e.x)%2)?e.x=Math.ceil(e.x)-e.x:e.x=e.x-Math.floor(e.x)}if(e.y<0||e.y>1)switch(this.wrapT){case S:e.y=e.y-Math.floor(e.y);break;case E:e.y=e.y<0?0:1;break;case A:1===Math.abs(Math.floor(e.y)%2)?e.y=Math.ceil(e.y)-e.y:e.y=e.y-Math.floor(e.y)}return this.flipY&&(e.y=1-e.y),e}},{key:"needsUpdate",set:function(e){!0===e&&this.version++}}]),n}(xe);function ze(e){return"undefined"!=typeof HTMLImageElement&&e instanceof HTMLImageElement||"undefined"!=typeof HTMLCanvasElement&&e instanceof HTMLCanvasElement||"undefined"!=typeof ImageBitmap&&e instanceof ImageBitmap?Ne.getDataURL(e):e.data?{data:Array.prototype.slice.call(e.data),width:e.width,height:e.height,type:e.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}Be.DEFAULT_IMAGE=void 0,Be.DEFAULT_MAPPING=i,Be.prototype.isTexture=!0;var He=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;(0,v.default)(this,e),this.x=t,this.y=n,this.z=r,this.w=i}return(0,m.default)(e,[{key:"width",get:function(){return this.z},set:function(e){this.z=e}},{key:"height",get:function(){return this.w},set:function(e){this.w=e}},{key:"set",value:function(e,t,n,r){return this.x=e,this.y=t,this.z=n,this.w=r,this}},{key:"setScalar",value:function(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}},{key:"setX",value:function(e){return this.x=e,this}},{key:"setY",value:function(e){return this.y=e,this}},{key:"setZ",value:function(e){return this.z=e,this}},{key:"setW",value:function(e){return this.w=e,this}},{key:"setComponent",value:function(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+e)}return this}},{key:"getComponent",value:function(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}},{key:"clone",value:function(){return new this.constructor(this.x,this.y,this.z,this.w)}},{key:"copy",value:function(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=void 0!==e.w?e.w:1,this}},{key:"add",value:function(e,t){return void 0!==t?(console.warn("THREE.Vector4: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this)}},{key:"addScalar",value:function(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}},{key:"addVectors",value:function(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this}},{key:"addScaledVector",value:function(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this.w+=e.w*t,this}},{key:"sub",value:function(e,t){return void 0!==t?(console.warn("THREE.Vector4: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this)}},{key:"subScalar",value:function(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}},{key:"subVectors",value:function(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this}},{key:"multiply",value:function(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}},{key:"multiplyScalar",value:function(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}},{key:"applyMatrix4",value:function(e){var t=this.x,n=this.y,r=this.z,i=this.w,a=e.elements;return this.x=a[0]*t+a[4]*n+a[8]*r+a[12]*i,this.y=a[1]*t+a[5]*n+a[9]*r+a[13]*i,this.z=a[2]*t+a[6]*n+a[10]*r+a[14]*i,this.w=a[3]*t+a[7]*n+a[11]*r+a[15]*i,this}},{key:"divideScalar",value:function(e){return this.multiplyScalar(1/e)}},{key:"setAxisAngleFromQuaternion",value:function(e){this.w=2*Math.acos(e.w);var t=Math.sqrt(1-e.w*e.w);return t<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this}},{key:"setAxisAngleFromRotationMatrix",value:function(e){var t,n,r,i,a=.01,o=.1,s=e.elements,l=s[0],u=s[4],c=s[8],h=s[1],d=s[5],f=s[9],p=s[2],v=s[6],m=s[10];if(Math.abs(u-h)<a&&Math.abs(c-p)<a&&Math.abs(f-v)<a){if(Math.abs(u+h)<o&&Math.abs(c+p)<o&&Math.abs(f+v)<o&&Math.abs(l+d+m-3)<o)return this.set(1,0,0,0),this;t=Math.PI;var g=(l+1)/2,_=(d+1)/2,y=(m+1)/2,x=(u+h)/4,b=(c+p)/4,w=(f+v)/4;return g>_&&g>y?g<a?(n=0,r=.707106781,i=.707106781):(r=x/(n=Math.sqrt(g)),i=b/n):_>y?_<a?(n=.707106781,r=0,i=.707106781):(n=x/(r=Math.sqrt(_)),i=w/r):y<a?(n=.707106781,r=.707106781,i=0):(n=b/(i=Math.sqrt(y)),r=w/i),this.set(n,r,i,t),this}var T=Math.sqrt((v-f)*(v-f)+(c-p)*(c-p)+(h-u)*(h-u));return Math.abs(T)<.001&&(T=1),this.x=(v-f)/T,this.y=(c-p)/T,this.z=(h-u)/T,this.w=Math.acos((l+d+m-1)/2),this}},{key:"min",value:function(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}},{key:"max",value:function(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}},{key:"clamp",value:function(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this.w=Math.max(e.w,Math.min(t.w,this.w)),this}},{key:"clampScalar",value:function(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this.w=Math.max(e,Math.min(t,this.w)),this}},{key:"clampLength",value:function(e,t){var n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(t,n)))}},{key:"floor",value:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}},{key:"ceil",value:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}},{key:"round",value:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}},{key:"roundToZero",value:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this}},{key:"negate",value:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}},{key:"dot",value:function(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}},{key:"lengthSq",value:function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}},{key:"length",value:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}},{key:"manhattanLength",value:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}},{key:"normalize",value:function(){return this.divideScalar(this.length()||1)}},{key:"setLength",value:function(e){return this.normalize().multiplyScalar(e)}},{key:"lerp",value:function(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this}},{key:"lerpVectors",value:function(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this.z=e.z+(t.z-e.z)*n,this.w=e.w+(t.w-e.w)*n,this}},{key:"equals",value:function(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}},{key:"fromArray",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this}},{key:"toArray",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e}},{key:"fromBufferAttribute",value:function(e,t,n){return void 0!==n&&console.warn("THREE.Vector4: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this.w=e.getW(t),this}},{key:"random",value:function(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}}]),e}();He.prototype.isVector4=!0;var Ge=function(e){(0,d.default)(n,e);var t=b(n);function n(e,r){var i,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return(0,v.default)(this,n),(i=t.call(this)).width=e,i.height=r,i.depth=1,i.scissor=new He(0,0,e,r),i.scissorTest=!1,i.viewport=new He(0,0,e,r),i.texture=new Be(void 0,a.mapping,a.wrapS,a.wrapT,a.magFilter,a.minFilter,a.format,a.type,a.anisotropy,a.encoding),i.texture.isRenderTargetTexture=!0,i.texture.image={width:e,height:r,depth:1},i.texture.generateMipmaps=void 0!==a.generateMipmaps&&a.generateMipmaps,i.texture.minFilter=void 0!==a.minFilter?a.minFilter:k,i.depthBuffer=void 0===a.depthBuffer||a.depthBuffer,i.stencilBuffer=void 0!==a.stencilBuffer&&a.stencilBuffer,i.depthTexture=void 0!==a.depthTexture?a.depthTexture:null,i}return(0,m.default)(n,[{key:"setTexture",value:function(e){e.image={width:this.width,height:this.height,depth:this.depth},this.texture=e}},{key:"setSize",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;this.width===e&&this.height===t&&this.depth===n||(this.width=e,this.height=t,this.depth=n,this.texture.image.width=e,this.texture.image.height=t,this.texture.image.depth=n,this.dispose()),this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)}},{key:"clone",value:function(){return(new this.constructor).copy(this)}},{key:"copy",value:function(e){return this.width=e.width,this.height=e.height,this.depth=e.depth,this.viewport.copy(e.viewport),this.texture=e.texture.clone(),this.texture.image=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?x(Object(n),!0).forEach((function(t){(0,c.default)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):x(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},this.texture.image),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,this.depthTexture=e.depthTexture,this}},{key:"dispose",value:function(){this.dispatchEvent({type:"dispose"})}}]),n}(xe);Ge.prototype.isWebGLRenderTarget=!0;var Ve=function(e){(0,d.default)(n,e);var t=b(n);function n(e,r,i){var a;(0,v.default)(this,n);var o=(a=t.call(this,e,r)).texture;a.texture=[];for(var s=0;s<i;s++)a.texture[s]=o.clone();return a}return(0,m.default)(n,[{key:"setSize",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;if(this.width!==e||this.height!==t||this.depth!==n){this.width=e,this.height=t,this.depth=n;for(var r=0,i=this.texture.length;r<i;r++)this.texture[r].image.width=e,this.texture[r].image.height=t,this.texture[r].image.depth=n;this.dispose()}return this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t),this}},{key:"copy",value:function(e){this.dispose(),this.width=e.width,this.height=e.height,this.depth=e.depth,this.viewport.set(0,0,this.width,this.height),this.scissor.set(0,0,this.width,this.height),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,this.depthTexture=e.depthTexture,this.texture.length=0;for(var t=0,n=e.texture.length;t<n;t++)this.texture[t]=e.texture[t].clone();return this}}]),n}(Ge);Ve.prototype.isWebGLMultipleRenderTargets=!0;var We=function(e){(0,d.default)(n,e);var t=b(n);function n(e,r,i){var a;return(0,v.default)(this,n),(a=t.call(this,e,r,i)).samples=4,a}return(0,m.default)(n,[{key:"copy",value:function(e){return(0,u.default)((0,p.default)(n.prototype),"copy",this).call(this,e),this.samples=e.samples,this}}]),n}(Ge);We.prototype.isWebGLMultisampleRenderTarget=!0;var je=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;(0,v.default)(this,e),this._x=t,this._y=n,this._z=r,this._w=i}return(0,m.default)(e,[{key:"x",get:function(){return this._x},set:function(e){this._x=e,this._onChangeCallback()}},{key:"y",get:function(){return this._y},set:function(e){this._y=e,this._onChangeCallback()}},{key:"z",get:function(){return this._z},set:function(e){this._z=e,this._onChangeCallback()}},{key:"w",get:function(){return this._w},set:function(e){this._w=e,this._onChangeCallback()}},{key:"set",value:function(e,t,n,r){return this._x=e,this._y=t,this._z=n,this._w=r,this._onChangeCallback(),this}},{key:"clone",value:function(){return new this.constructor(this._x,this._y,this._z,this._w)}},{key:"copy",value:function(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}},{key:"setFromEuler",value:function(e,t){if(!e||!e.isEuler)throw new Error("THREE.Quaternion: .setFromEuler() now expects an Euler rotation rather than a Vector3 and order.");var n=e._x,r=e._y,i=e._z,a=e._order,o=Math.cos,s=Math.sin,l=o(n/2),u=o(r/2),c=o(i/2),h=s(n/2),d=s(r/2),f=s(i/2);switch(a){case"XYZ":this._x=h*u*c+l*d*f,this._y=l*d*c-h*u*f,this._z=l*u*f+h*d*c,this._w=l*u*c-h*d*f;break;case"YXZ":this._x=h*u*c+l*d*f,this._y=l*d*c-h*u*f,this._z=l*u*f-h*d*c,this._w=l*u*c+h*d*f;break;case"ZXY":this._x=h*u*c-l*d*f,this._y=l*d*c+h*u*f,this._z=l*u*f+h*d*c,this._w=l*u*c-h*d*f;break;case"ZYX":this._x=h*u*c-l*d*f,this._y=l*d*c+h*u*f,this._z=l*u*f-h*d*c,this._w=l*u*c+h*d*f;break;case"YZX":this._x=h*u*c+l*d*f,this._y=l*d*c+h*u*f,this._z=l*u*f-h*d*c,this._w=l*u*c-h*d*f;break;case"XZY":this._x=h*u*c-l*d*f,this._y=l*d*c-h*u*f,this._z=l*u*f+h*d*c,this._w=l*u*c+h*d*f;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+a)}return!1!==t&&this._onChangeCallback(),this}},{key:"setFromAxisAngle",value:function(e,t){var n=t/2,r=Math.sin(n);return this._x=e.x*r,this._y=e.y*r,this._z=e.z*r,this._w=Math.cos(n),this._onChangeCallback(),this}},{key:"setFromRotationMatrix",value:function(e){var t=e.elements,n=t[0],r=t[4],i=t[8],a=t[1],o=t[5],s=t[9],l=t[2],u=t[6],c=t[10],h=n+o+c;if(h>0){var d=.5/Math.sqrt(h+1);this._w=.25/d,this._x=(u-s)*d,this._y=(i-l)*d,this._z=(a-r)*d}else if(n>o&&n>c){var f=2*Math.sqrt(1+n-o-c);this._w=(u-s)/f,this._x=.25*f,this._y=(r+a)/f,this._z=(i+l)/f}else if(o>c){var p=2*Math.sqrt(1+o-n-c);this._w=(i-l)/p,this._x=(r+a)/p,this._y=.25*p,this._z=(s+u)/p}else{var v=2*Math.sqrt(1+c-n-o);this._w=(a-r)/v,this._x=(i+l)/v,this._y=(s+u)/v,this._z=.25*v}return this._onChangeCallback(),this}},{key:"setFromUnitVectors",value:function(e,t){var n=e.dot(t)+1;return n<Number.EPSILON?(n=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=n):(this._x=0,this._y=-e.z,this._z=e.y,this._w=n)):(this._x=e.y*t.z-e.z*t.y,this._y=e.z*t.x-e.x*t.z,this._z=e.x*t.y-e.y*t.x,this._w=n),this.normalize()}},{key:"angleTo",value:function(e){return 2*Math.acos(Math.abs(Ae(this.dot(e),-1,1)))}},{key:"rotateTowards",value:function(e,t){var n=this.angleTo(e);if(0===n)return this;var r=Math.min(1,t/n);return this.slerp(e,r),this}},{key:"identity",value:function(){return this.set(0,0,0,1)}},{key:"invert",value:function(){return this.conjugate()}},{key:"conjugate",value:function(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}},{key:"dot",value:function(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}},{key:"lengthSq",value:function(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}},{key:"length",value:function(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}},{key:"normalize",value:function(){var e=this.length();return 0===e?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}},{key:"multiply",value:function(e,t){return void 0!==t?(console.warn("THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."),this.multiplyQuaternions(e,t)):this.multiplyQuaternions(this,e)}},{key:"premultiply",value:function(e){return this.multiplyQuaternions(e,this)}},{key:"multiplyQuaternions",value:function(e,t){var n=e._x,r=e._y,i=e._z,a=e._w,o=t._x,s=t._y,l=t._z,u=t._w;return this._x=n*u+a*o+r*l-i*s,this._y=r*u+a*s+i*o-n*l,this._z=i*u+a*l+n*s-r*o,this._w=a*u-n*o-r*s-i*l,this._onChangeCallback(),this}},{key:"slerp",value:function(e,t){if(0===t)return this;if(1===t)return this.copy(e);var n=this._x,r=this._y,i=this._z,a=this._w,o=a*e._w+n*e._x+r*e._y+i*e._z;if(o<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,o=-o):this.copy(e),o>=1)return this._w=a,this._x=n,this._y=r,this._z=i,this;var s=1-o*o;if(s<=Number.EPSILON){var l=1-t;return this._w=l*a+t*this._w,this._x=l*n+t*this._x,this._y=l*r+t*this._y,this._z=l*i+t*this._z,this.normalize(),this._onChangeCallback(),this}var u=Math.sqrt(s),c=Math.atan2(u,o),h=Math.sin((1-t)*c)/u,d=Math.sin(t*c)/u;return this._w=a*h+this._w*d,this._x=n*h+this._x*d,this._y=r*h+this._y*d,this._z=i*h+this._z*d,this._onChangeCallback(),this}},{key:"slerpQuaternions",value:function(e,t,n){this.copy(e).slerp(t,n)}},{key:"equals",value:function(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}},{key:"fromArray",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this._onChangeCallback(),this}},{key:"toArray",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e}},{key:"fromBufferAttribute",value:function(e,t){return this._x=e.getX(t),this._y=e.getY(t),this._z=e.getZ(t),this._w=e.getW(t),this}},{key:"_onChange",value:function(e){return this._onChangeCallback=e,this}},{key:"_onChangeCallback",value:function(){}}],[{key:"slerp",value:function(e,t,n,r){return console.warn("THREE.Quaternion: Static .slerp() has been deprecated. Use qm.slerpQuaternions( qa, qb, t ) instead."),n.slerpQuaternions(e,t,r)}},{key:"slerpFlat",value:function(e,t,n,r,i,a,o){var s=n[r+0],l=n[r+1],u=n[r+2],c=n[r+3],h=i[a+0],d=i[a+1],f=i[a+2],p=i[a+3];if(0===o)return e[t+0]=s,e[t+1]=l,e[t+2]=u,void(e[t+3]=c);if(1===o)return e[t+0]=h,e[t+1]=d,e[t+2]=f,void(e[t+3]=p);if(c!==p||s!==h||l!==d||u!==f){var v=1-o,m=s*h+l*d+u*f+c*p,g=m>=0?1:-1,_=1-m*m;if(_>Number.EPSILON){var y=Math.sqrt(_),x=Math.atan2(y,m*g);v=Math.sin(v*x)/y,o=Math.sin(o*x)/y}var b=o*g;if(s=s*v+h*b,l=l*v+d*b,u=u*v+f*b,c=c*v+p*b,v===1-o){var w=1/Math.sqrt(s*s+l*l+u*u+c*c);s*=w,l*=w,u*=w,c*=w}}e[t]=s,e[t+1]=l,e[t+2]=u,e[t+3]=c}},{key:"multiplyQuaternionsFlat",value:function(e,t,n,r,i,a){var o=n[r],s=n[r+1],l=n[r+2],u=n[r+3],c=i[a],h=i[a+1],d=i[a+2],f=i[a+3];return e[t]=o*f+u*c+s*d-l*h,e[t+1]=s*f+u*h+l*c-o*d,e[t+2]=l*f+u*d+o*h-s*c,e[t+3]=u*f-o*c-s*h-l*d,e}}]),e}();je.prototype.isQuaternion=!0;var qe=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;(0,v.default)(this,e),this.x=t,this.y=n,this.z=r}return(0,m.default)(e,[{key:"set",value:function(e,t,n){return void 0===n&&(n=this.z),this.x=e,this.y=t,this.z=n,this}},{key:"setScalar",value:function(e){return this.x=e,this.y=e,this.z=e,this}},{key:"setX",value:function(e){return this.x=e,this}},{key:"setY",value:function(e){return this.y=e,this}},{key:"setZ",value:function(e){return this.z=e,this}},{key:"setComponent",value:function(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}return this}},{key:"getComponent",value:function(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}},{key:"clone",value:function(){return new this.constructor(this.x,this.y,this.z)}},{key:"copy",value:function(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}},{key:"add",value:function(e,t){return void 0!==t?(console.warn("THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this.z+=e.z,this)}},{key:"addScalar",value:function(e){return this.x+=e,this.y+=e,this.z+=e,this}},{key:"addVectors",value:function(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this}},{key:"addScaledVector",value:function(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this}},{key:"sub",value:function(e,t){return void 0!==t?(console.warn("THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this.z-=e.z,this)}},{key:"subScalar",value:function(e){return this.x-=e,this.y-=e,this.z-=e,this}},{key:"subVectors",value:function(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this}},{key:"multiply",value:function(e,t){return void 0!==t?(console.warn("THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.multiplyVectors(e,t)):(this.x*=e.x,this.y*=e.y,this.z*=e.z,this)}},{key:"multiplyScalar",value:function(e){return this.x*=e,this.y*=e,this.z*=e,this}},{key:"multiplyVectors",value:function(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this}},{key:"applyEuler",value:function(e){return e&&e.isEuler||console.error("THREE.Vector3: .applyEuler() now expects an Euler rotation rather than a Vector3 and order."),this.applyQuaternion(Ye.setFromEuler(e))}},{key:"applyAxisAngle",value:function(e,t){return this.applyQuaternion(Ye.setFromAxisAngle(e,t))}},{key:"applyMatrix3",value:function(e){var t=this.x,n=this.y,r=this.z,i=e.elements;return this.x=i[0]*t+i[3]*n+i[6]*r,this.y=i[1]*t+i[4]*n+i[7]*r,this.z=i[2]*t+i[5]*n+i[8]*r,this}},{key:"applyNormalMatrix",value:function(e){return this.applyMatrix3(e).normalize()}},{key:"applyMatrix4",value:function(e){var t=this.x,n=this.y,r=this.z,i=e.elements,a=1/(i[3]*t+i[7]*n+i[11]*r+i[15]);return this.x=(i[0]*t+i[4]*n+i[8]*r+i[12])*a,this.y=(i[1]*t+i[5]*n+i[9]*r+i[13])*a,this.z=(i[2]*t+i[6]*n+i[10]*r+i[14])*a,this}},{key:"applyQuaternion",value:function(e){var t=this.x,n=this.y,r=this.z,i=e.x,a=e.y,o=e.z,s=e.w,l=s*t+a*r-o*n,u=s*n+o*t-i*r,c=s*r+i*n-a*t,h=-i*t-a*n-o*r;return this.x=l*s+h*-i+u*-o-c*-a,this.y=u*s+h*-a+c*-i-l*-o,this.z=c*s+h*-o+l*-a-u*-i,this}},{key:"project",value:function(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}},{key:"unproject",value:function(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}},{key:"transformDirection",value:function(e){var t=this.x,n=this.y,r=this.z,i=e.elements;return this.x=i[0]*t+i[4]*n+i[8]*r,this.y=i[1]*t+i[5]*n+i[9]*r,this.z=i[2]*t+i[6]*n+i[10]*r,this.normalize()}},{key:"divide",value:function(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}},{key:"divideScalar",value:function(e){return this.multiplyScalar(1/e)}},{key:"min",value:function(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}},{key:"max",value:function(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}},{key:"clamp",value:function(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this}},{key:"clampScalar",value:function(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this}},{key:"clampLength",value:function(e,t){var n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(t,n)))}},{key:"floor",value:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}},{key:"ceil",value:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}},{key:"round",value:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}},{key:"roundToZero",value:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this}},{key:"negate",value:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}},{key:"dot",value:function(e){return this.x*e.x+this.y*e.y+this.z*e.z}},{key:"lengthSq",value:function(){return this.x*this.x+this.y*this.y+this.z*this.z}},{key:"length",value:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}},{key:"manhattanLength",value:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}},{key:"normalize",value:function(){return this.divideScalar(this.length()||1)}},{key:"setLength",value:function(e){return this.normalize().multiplyScalar(e)}},{key:"lerp",value:function(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this}},{key:"lerpVectors",value:function(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this.z=e.z+(t.z-e.z)*n,this}},{key:"cross",value:function(e,t){return void 0!==t?(console.warn("THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.crossVectors(e,t)):this.crossVectors(this,e)}},{key:"crossVectors",value:function(e,t){var n=e.x,r=e.y,i=e.z,a=t.x,o=t.y,s=t.z;return this.x=r*s-i*o,this.y=i*a-n*s,this.z=n*o-r*a,this}},{key:"projectOnVector",value:function(e){var t=e.lengthSq();if(0===t)return this.set(0,0,0);var n=e.dot(this)/t;return this.copy(e).multiplyScalar(n)}},{key:"projectOnPlane",value:function(e){return Xe.copy(this).projectOnVector(e),this.sub(Xe)}},{key:"reflect",value:function(e){return this.sub(Xe.copy(e).multiplyScalar(2*this.dot(e)))}},{key:"angleTo",value:function(e){var t=Math.sqrt(this.lengthSq()*e.lengthSq());if(0===t)return Math.PI/2;var n=this.dot(e)/t;return Math.acos(Ae(n,-1,1))}},{key:"distanceTo",value:function(e){return Math.sqrt(this.distanceToSquared(e))}},{key:"distanceToSquared",value:function(e){var t=this.x-e.x,n=this.y-e.y,r=this.z-e.z;return t*t+n*n+r*r}},{key:"manhattanDistanceTo",value:function(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}},{key:"setFromSpherical",value:function(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}},{key:"setFromSphericalCoords",value:function(e,t,n){var r=Math.sin(t)*e;return this.x=r*Math.sin(n),this.y=Math.cos(t)*e,this.z=r*Math.cos(n),this}},{key:"setFromCylindrical",value:function(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}},{key:"setFromCylindricalCoords",value:function(e,t,n){return this.x=e*Math.sin(t),this.y=n,this.z=e*Math.cos(t),this}},{key:"setFromMatrixPosition",value:function(e){var t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this}},{key:"setFromMatrixScale",value:function(e){var t=this.setFromMatrixColumn(e,0).length(),n=this.setFromMatrixColumn(e,1).length(),r=this.setFromMatrixColumn(e,2).length();return this.x=t,this.y=n,this.z=r,this}},{key:"setFromMatrixColumn",value:function(e,t){return this.fromArray(e.elements,4*t)}},{key:"setFromMatrix3Column",value:function(e,t){return this.fromArray(e.elements,3*t)}},{key:"equals",value:function(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}},{key:"fromArray",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this}},{key:"toArray",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e}},{key:"fromBufferAttribute",value:function(e,t,n){return void 0!==n&&console.warn("THREE.Vector3: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this}},{key:"random",value:function(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}}]),e}();qe.prototype.isVector3=!0;var Xe=new qe,Ye=new je,Ke=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new qe(1/0,1/0,1/0),n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new qe(-1/0,-1/0,-1/0);(0,v.default)(this,e),this.min=t,this.max=n}return(0,m.default)(e,[{key:"set",value:function(e,t){return this.min.copy(e),this.max.copy(t),this}},{key:"setFromArray",value:function(e){for(var t=1/0,n=1/0,r=1/0,i=-1/0,a=-1/0,o=-1/0,s=0,l=e.length;s<l;s+=3){var u=e[s],c=e[s+1],h=e[s+2];u<t&&(t=u),c<n&&(n=c),h<r&&(r=h),u>i&&(i=u),c>a&&(a=c),h>o&&(o=h)}return this.min.set(t,n,r),this.max.set(i,a,o),this}},{key:"setFromBufferAttribute",value:function(e){for(var t=1/0,n=1/0,r=1/0,i=-1/0,a=-1/0,o=-1/0,s=0,l=e.count;s<l;s++){var u=e.getX(s),c=e.getY(s),h=e.getZ(s);u<t&&(t=u),c<n&&(n=c),h<r&&(r=h),u>i&&(i=u),c>a&&(a=c),h>o&&(o=h)}return this.min.set(t,n,r),this.max.set(i,a,o),this}},{key:"setFromPoints",value:function(e){this.makeEmpty();for(var t=0,n=e.length;t<n;t++)this.expandByPoint(e[t]);return this}},{key:"setFromCenterAndSize",value:function(e,t){var n=Je.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(n),this.max.copy(e).add(n),this}},{key:"setFromObject",value:function(e){return this.makeEmpty(),this.expandByObject(e)}},{key:"clone",value:function(){return(new this.constructor).copy(this)}},{key:"copy",value:function(e){return this.min.copy(e.min),this.max.copy(e.max),this}},{key:"makeEmpty",value:function(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}},{key:"isEmpty",value:function(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}},{key:"getCenter",value:function(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}},{key:"getSize",value:function(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}},{key:"expandByPoint",value:function(e){return this.min.min(e),this.max.max(e),this}},{key:"expandByVector",value:function(e){return this.min.sub(e),this.max.add(e),this}},{key:"expandByScalar",value:function(e){return this.min.addScalar(-e),this.max.addScalar(e),this}},{key:"expandByObject",value:function(e){e.updateWorldMatrix(!1,!1);var t=e.geometry;void 0!==t&&(null===t.boundingBox&&t.computeBoundingBox(),Qe.copy(t.boundingBox),Qe.applyMatrix4(e.matrixWorld),this.union(Qe));for(var n=e.children,r=0,i=n.length;r<i;r++)this.expandByObject(n[r]);return this}},{key:"containsPoint",value:function(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y||e.z<this.min.z||e.z>this.max.z)}},{key:"containsBox",value:function(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}},{key:"getParameter",value:function(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}},{key:"intersectsBox",value:function(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y||e.max.z<this.min.z||e.min.z>this.max.z)}},{key:"intersectsSphere",value:function(e){return this.clampPoint(e.center,Je),Je.distanceToSquared(e.center)<=e.radius*e.radius}},{key:"intersectsPlane",value:function(e){var t,n;return e.normal.x>0?(t=e.normal.x*this.min.x,n=e.normal.x*this.max.x):(t=e.normal.x*this.max.x,n=e.normal.x*this.min.x),e.normal.y>0?(t+=e.normal.y*this.min.y,n+=e.normal.y*this.max.y):(t+=e.normal.y*this.max.y,n+=e.normal.y*this.min.y),e.normal.z>0?(t+=e.normal.z*this.min.z,n+=e.normal.z*this.max.z):(t+=e.normal.z*this.max.z,n+=e.normal.z*this.min.z),t<=-e.constant&&n>=-e.constant}},{key:"intersectsTriangle",value:function(e){if(this.isEmpty())return!1;this.getCenter(at),ot.subVectors(this.max,at),$e.subVectors(e.a,at),et.subVectors(e.b,at),tt.subVectors(e.c,at),nt.subVectors(et,$e),rt.subVectors(tt,et),it.subVectors($e,tt);var t=[0,-nt.z,nt.y,0,-rt.z,rt.y,0,-it.z,it.y,nt.z,0,-nt.x,rt.z,0,-rt.x,it.z,0,-it.x,-nt.y,nt.x,0,-rt.y,rt.x,0,-it.y,it.x,0];return!!ut(t,$e,et,tt,ot)&&!!ut(t=[1,0,0,0,1,0,0,0,1],$e,et,tt,ot)&&(st.crossVectors(nt,rt),ut(t=[st.x,st.y,st.z],$e,et,tt,ot))}},{key:"clampPoint",value:function(e,t){return t.copy(e).clamp(this.min,this.max)}},{key:"distanceToPoint",value:function(e){return Je.copy(e).clamp(this.min,this.max).sub(e).length()}},{key:"getBoundingSphere",value:function(e){return this.getCenter(e.center),e.radius=.5*this.getSize(Je).length(),e}},{key:"intersect",value:function(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}},{key:"union",value:function(e){return this.min.min(e.min),this.max.max(e.max),this}},{key:"applyMatrix4",value:function(e){return this.isEmpty()||(Ze[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),Ze[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),Ze[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),Ze[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),Ze[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),Ze[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),Ze[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),Ze[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(Ze)),this}},{key:"translate",value:function(e){return this.min.add(e),this.max.add(e),this}},{key:"equals",value:function(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}]),e}();Ke.prototype.isBox3=!0;var Ze=[new qe,new qe,new qe,new qe,new qe,new qe,new qe,new qe],Je=new qe,Qe=new Ke,$e=new qe,et=new qe,tt=new qe,nt=new qe,rt=new qe,it=new qe,at=new qe,ot=new qe,st=new qe,lt=new qe;function ut(e,t,n,r,i){for(var a=0,o=e.length-3;a<=o;a+=3){lt.fromArray(e,a);var s=i.x*Math.abs(lt.x)+i.y*Math.abs(lt.y)+i.z*Math.abs(lt.z),l=t.dot(lt),u=n.dot(lt),c=r.dot(lt);if(Math.max(-Math.max(l,u,c),Math.min(l,u,c))>s)return!1}return!0}var ct=new Ke,ht=new qe,dt=new qe,ft=new qe,pt=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new qe,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;(0,v.default)(this,e),this.center=t,this.radius=n}return(0,m.default)(e,[{key:"set",value:function(e,t){return this.center.copy(e),this.radius=t,this}},{key:"setFromPoints",value:function(e,t){var n=this.center;void 0!==t?n.copy(t):ct.setFromPoints(e).getCenter(n);for(var r=0,i=0,a=e.length;i<a;i++)r=Math.max(r,n.distanceToSquared(e[i]));return this.radius=Math.sqrt(r),this}},{key:"copy",value:function(e){return this.center.copy(e.center),this.radius=e.radius,this}},{key:"isEmpty",value:function(){return this.radius<0}},{key:"makeEmpty",value:function(){return this.center.set(0,0,0),this.radius=-1,this}},{key:"containsPoint",value:function(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}},{key:"distanceToPoint",value:function(e){return e.distanceTo(this.center)-this.radius}},{key:"intersectsSphere",value:function(e){var t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t}},{key:"intersectsBox",value:function(e){return e.intersectsSphere(this)}},{key:"intersectsPlane",value:function(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}},{key:"clampPoint",value:function(e,t){var n=this.center.distanceToSquared(e);return t.copy(e),n>this.radius*this.radius&&(t.sub(this.center).normalize(),t.multiplyScalar(this.radius).add(this.center)),t}},{key:"getBoundingBox",value:function(e){return this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}},{key:"applyMatrix4",value:function(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}},{key:"translate",value:function(e){return this.center.add(e),this}},{key:"expandByPoint",value:function(e){ft.subVectors(e,this.center);var t=ft.lengthSq();if(t>this.radius*this.radius){var n=Math.sqrt(t),r=.5*(n-this.radius);this.center.add(ft.multiplyScalar(r/n)),this.radius+=r}return this}},{key:"union",value:function(e){return dt.subVectors(e.center,this.center).normalize().multiplyScalar(e.radius),this.expandByPoint(ht.copy(e.center).add(dt)),this.expandByPoint(ht.copy(e.center).sub(dt)),this}},{key:"equals",value:function(e){return e.center.equals(this.center)&&e.radius===this.radius}},{key:"clone",value:function(){return(new this.constructor).copy(this)}}]),e}(),vt=new qe,mt=new qe,gt=new qe,_t=new qe,yt=new qe,xt=new qe,bt=new qe,wt=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new qe,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new qe(0,0,-1);(0,v.default)(this,e),this.origin=t,this.direction=n}return(0,m.default)(e,[{key:"set",value:function(e,t){return this.origin.copy(e),this.direction.copy(t),this}},{key:"copy",value:function(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}},{key:"at",value:function(e,t){return t.copy(this.direction).multiplyScalar(e).add(this.origin)}},{key:"lookAt",value:function(e){return this.direction.copy(e).sub(this.origin).normalize(),this}},{key:"recast",value:function(e){return this.origin.copy(this.at(e,vt)),this}},{key:"closestPointToPoint",value:function(e,t){t.subVectors(e,this.origin);var n=t.dot(this.direction);return n<0?t.copy(this.origin):t.copy(this.direction).multiplyScalar(n).add(this.origin)}},{key:"distanceToPoint",value:function(e){return Math.sqrt(this.distanceSqToPoint(e))}},{key:"distanceSqToPoint",value:function(e){var t=vt.subVectors(e,this.origin).dot(this.direction);return t<0?this.origin.distanceToSquared(e):(vt.copy(this.direction).multiplyScalar(t).add(this.origin),vt.distanceToSquared(e))}},{key:"distanceSqToSegment",value:function(e,t,n,r){mt.copy(e).add(t).multiplyScalar(.5),gt.copy(t).sub(e).normalize(),_t.copy(this.origin).sub(mt);var i,a,o,s,l=.5*e.distanceTo(t),u=-this.direction.dot(gt),c=_t.dot(this.direction),h=-_t.dot(gt),d=_t.lengthSq(),f=Math.abs(1-u*u);if(f>0)if(a=u*c-h,s=l*f,(i=u*h-c)>=0)if(a>=-s)if(a<=s){var p=1/f;o=(i*=p)*(i+u*(a*=p)+2*c)+a*(u*i+a+2*h)+d}else a=l,o=-(i=Math.max(0,-(u*a+c)))*i+a*(a+2*h)+d;else a=-l,o=-(i=Math.max(0,-(u*a+c)))*i+a*(a+2*h)+d;else a<=-s?o=-(i=Math.max(0,-(-u*l+c)))*i+(a=i>0?-l:Math.min(Math.max(-l,-h),l))*(a+2*h)+d:a<=s?(i=0,o=(a=Math.min(Math.max(-l,-h),l))*(a+2*h)+d):o=-(i=Math.max(0,-(u*l+c)))*i+(a=i>0?l:Math.min(Math.max(-l,-h),l))*(a+2*h)+d;else a=u>0?-l:l,o=-(i=Math.max(0,-(u*a+c)))*i+a*(a+2*h)+d;return n&&n.copy(this.direction).multiplyScalar(i).add(this.origin),r&&r.copy(gt).multiplyScalar(a).add(mt),o}},{key:"intersectSphere",value:function(e,t){vt.subVectors(e.center,this.origin);var n=vt.dot(this.direction),r=vt.dot(vt)-n*n,i=e.radius*e.radius;if(r>i)return null;var a=Math.sqrt(i-r),o=n-a,s=n+a;return o<0&&s<0?null:o<0?this.at(s,t):this.at(o,t)}},{key:"intersectsSphere",value:function(e){return this.distanceSqToPoint(e.center)<=e.radius*e.radius}},{key:"distanceToPlane",value:function(e){var t=e.normal.dot(this.direction);if(0===t)return 0===e.distanceToPoint(this.origin)?0:null;var n=-(this.origin.dot(e.normal)+e.constant)/t;return n>=0?n:null}},{key:"intersectPlane",value:function(e,t){var n=this.distanceToPlane(e);return null===n?null:this.at(n,t)}},{key:"intersectsPlane",value:function(e){var t=e.distanceToPoint(this.origin);return 0===t||e.normal.dot(this.direction)*t<0}},{key:"intersectBox",value:function(e,t){var n,r,i,a,o,s,l=1/this.direction.x,u=1/this.direction.y,c=1/this.direction.z,h=this.origin;return l>=0?(n=(e.min.x-h.x)*l,r=(e.max.x-h.x)*l):(n=(e.max.x-h.x)*l,r=(e.min.x-h.x)*l),u>=0?(i=(e.min.y-h.y)*u,a=(e.max.y-h.y)*u):(i=(e.max.y-h.y)*u,a=(e.min.y-h.y)*u),n>a||i>r?null:((i>n||n!=n)&&(n=i),(a<r||r!=r)&&(r=a),c>=0?(o=(e.min.z-h.z)*c,s=(e.max.z-h.z)*c):(o=(e.max.z-h.z)*c,s=(e.min.z-h.z)*c),n>s||o>r?null:((o>n||n!=n)&&(n=o),(s<r||r!=r)&&(r=s),r<0?null:this.at(n>=0?n:r,t)))}},{key:"intersectsBox",value:function(e){return null!==this.intersectBox(e,vt)}},{key:"intersectTriangle",value:function(e,t,n,r,i){yt.subVectors(t,e),xt.subVectors(n,e),bt.crossVectors(yt,xt);var a,o=this.direction.dot(bt);if(o>0){if(r)return null;a=1}else{if(!(o<0))return null;a=-1,o=-o}_t.subVectors(this.origin,e);var s=a*this.direction.dot(xt.crossVectors(_t,xt));if(s<0)return null;var l=a*this.direction.dot(yt.cross(_t));if(l<0)return null;if(s+l>o)return null;var u=-a*_t.dot(bt);return u<0?null:this.at(u/o,i)}},{key:"applyMatrix4",value:function(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}},{key:"equals",value:function(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}},{key:"clone",value:function(){return(new this.constructor).copy(this)}}]),e}(),Tt=function(){function e(){(0,v.default)(this,e),this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix4: the constructor no longer reads arguments. use .set() instead.")}return(0,m.default)(e,[{key:"set",value:function(e,t,n,r,i,a,o,s,l,u,c,h,d,f,p,v){var m=this.elements;return m[0]=e,m[4]=t,m[8]=n,m[12]=r,m[1]=i,m[5]=a,m[9]=o,m[13]=s,m[2]=l,m[6]=u,m[10]=c,m[14]=h,m[3]=d,m[7]=f,m[11]=p,m[15]=v,this}},{key:"identity",value:function(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}},{key:"clone",value:function(){return(new e).fromArray(this.elements)}},{key:"copy",value:function(e){var t=this.elements,n=e.elements;return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],t[9]=n[9],t[10]=n[10],t[11]=n[11],t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15],this}},{key:"copyPosition",value:function(e){var t=this.elements,n=e.elements;return t[12]=n[12],t[13]=n[13],t[14]=n[14],this}},{key:"setFromMatrix3",value:function(e){var t=e.elements;return this.set(t[0],t[3],t[6],0,t[1],t[4],t[7],0,t[2],t[5],t[8],0,0,0,0,1),this}},{key:"extractBasis",value:function(e,t,n){return e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),n.setFromMatrixColumn(this,2),this}},{key:"makeBasis",value:function(e,t,n){return this.set(e.x,t.x,n.x,0,e.y,t.y,n.y,0,e.z,t.z,n.z,0,0,0,0,1),this}},{key:"extractRotation",value:function(e){var t=this.elements,n=e.elements,r=1/Mt.setFromMatrixColumn(e,0).length(),i=1/Mt.setFromMatrixColumn(e,1).length(),a=1/Mt.setFromMatrixColumn(e,2).length();return t[0]=n[0]*r,t[1]=n[1]*r,t[2]=n[2]*r,t[3]=0,t[4]=n[4]*i,t[5]=n[5]*i,t[6]=n[6]*i,t[7]=0,t[8]=n[8]*a,t[9]=n[9]*a,t[10]=n[10]*a,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}},{key:"makeRotationFromEuler",value:function(e){e&&e.isEuler||console.error("THREE.Matrix4: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.");var t=this.elements,n=e.x,r=e.y,i=e.z,a=Math.cos(n),o=Math.sin(n),s=Math.cos(r),l=Math.sin(r),u=Math.cos(i),c=Math.sin(i);if("XYZ"===e.order){var h=a*u,d=a*c,f=o*u,p=o*c;t[0]=s*u,t[4]=-s*c,t[8]=l,t[1]=d+f*l,t[5]=h-p*l,t[9]=-o*s,t[2]=p-h*l,t[6]=f+d*l,t[10]=a*s}else if("YXZ"===e.order){var v=s*u,m=s*c,g=l*u,_=l*c;t[0]=v+_*o,t[4]=g*o-m,t[8]=a*l,t[1]=a*c,t[5]=a*u,t[9]=-o,t[2]=m*o-g,t[6]=_+v*o,t[10]=a*s}else if("ZXY"===e.order){var y=s*u,x=s*c,b=l*u,w=l*c;t[0]=y-w*o,t[4]=-a*c,t[8]=b+x*o,t[1]=x+b*o,t[5]=a*u,t[9]=w-y*o,t[2]=-a*l,t[6]=o,t[10]=a*s}else if("ZYX"===e.order){var T=a*u,M=a*c,S=o*u,E=o*c;t[0]=s*u,t[4]=S*l-M,t[8]=T*l+E,t[1]=s*c,t[5]=E*l+T,t[9]=M*l-S,t[2]=-l,t[6]=o*s,t[10]=a*s}else if("YZX"===e.order){var A=a*s,L=a*l,C=o*s,R=o*l;t[0]=s*u,t[4]=R-A*c,t[8]=C*c+L,t[1]=c,t[5]=a*u,t[9]=-o*u,t[2]=-l*u,t[6]=L*c+C,t[10]=A-R*c}else if("XZY"===e.order){var k=a*s,P=a*l,D=o*s,I=o*l;t[0]=s*u,t[4]=-c,t[8]=l*u,t[1]=k*c+I,t[5]=a*u,t[9]=P*c-D,t[2]=D*c-P,t[6]=o*u,t[10]=I*c+k}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}},{key:"makeRotationFromQuaternion",value:function(e){return this.compose(Et,e,At)}},{key:"lookAt",value:function(e,t,n){var r=this.elements;return Rt.subVectors(e,t),0===Rt.lengthSq()&&(Rt.z=1),Rt.normalize(),Lt.crossVectors(n,Rt),0===Lt.lengthSq()&&(1===Math.abs(n.z)?Rt.x+=1e-4:Rt.z+=1e-4,Rt.normalize(),Lt.crossVectors(n,Rt)),Lt.normalize(),Ct.crossVectors(Rt,Lt),r[0]=Lt.x,r[4]=Ct.x,r[8]=Rt.x,r[1]=Lt.y,r[5]=Ct.y,r[9]=Rt.y,r[2]=Lt.z,r[6]=Ct.z,r[10]=Rt.z,this}},{key:"multiply",value:function(e,t){return void 0!==t?(console.warn("THREE.Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."),this.multiplyMatrices(e,t)):this.multiplyMatrices(this,e)}},{key:"premultiply",value:function(e){return this.multiplyMatrices(e,this)}},{key:"multiplyMatrices",value:function(e,t){var n=e.elements,r=t.elements,i=this.elements,a=n[0],o=n[4],s=n[8],l=n[12],u=n[1],c=n[5],h=n[9],d=n[13],f=n[2],p=n[6],v=n[10],m=n[14],g=n[3],_=n[7],y=n[11],x=n[15],b=r[0],w=r[4],T=r[8],M=r[12],S=r[1],E=r[5],A=r[9],L=r[13],C=r[2],R=r[6],k=r[10],P=r[14],D=r[3],I=r[7],O=r[11],F=r[15];return i[0]=a*b+o*S+s*C+l*D,i[4]=a*w+o*E+s*R+l*I,i[8]=a*T+o*A+s*k+l*O,i[12]=a*M+o*L+s*P+l*F,i[1]=u*b+c*S+h*C+d*D,i[5]=u*w+c*E+h*R+d*I,i[9]=u*T+c*A+h*k+d*O,i[13]=u*M+c*L+h*P+d*F,i[2]=f*b+p*S+v*C+m*D,i[6]=f*w+p*E+v*R+m*I,i[10]=f*T+p*A+v*k+m*O,i[14]=f*M+p*L+v*P+m*F,i[3]=g*b+_*S+y*C+x*D,i[7]=g*w+_*E+y*R+x*I,i[11]=g*T+_*A+y*k+x*O,i[15]=g*M+_*L+y*P+x*F,this}},{key:"multiplyScalar",value:function(e){var t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this}},{key:"determinant",value:function(){var e=this.elements,t=e[0],n=e[4],r=e[8],i=e[12],a=e[1],o=e[5],s=e[9],l=e[13],u=e[2],c=e[6],h=e[10],d=e[14];return e[3]*(+i*s*c-r*l*c-i*o*h+n*l*h+r*o*d-n*s*d)+e[7]*(+t*s*d-t*l*h+i*a*h-r*a*d+r*l*u-i*s*u)+e[11]*(+t*l*c-t*o*d-i*a*c+n*a*d+i*o*u-n*l*u)+e[15]*(-r*o*u-t*s*c+t*o*h+r*a*c-n*a*h+n*s*u)}},{key:"transpose",value:function(){var e,t=this.elements;return e=t[1],t[1]=t[4],t[4]=e,e=t[2],t[2]=t[8],t[8]=e,e=t[6],t[6]=t[9],t[9]=e,e=t[3],t[3]=t[12],t[12]=e,e=t[7],t[7]=t[13],t[13]=e,e=t[11],t[11]=t[14],t[14]=e,this}},{key:"setPosition",value:function(e,t,n){var r=this.elements;return e.isVector3?(r[12]=e.x,r[13]=e.y,r[14]=e.z):(r[12]=e,r[13]=t,r[14]=n),this}},{key:"invert",value:function(){var e=this.elements,t=e[0],n=e[1],r=e[2],i=e[3],a=e[4],o=e[5],s=e[6],l=e[7],u=e[8],c=e[9],h=e[10],d=e[11],f=e[12],p=e[13],v=e[14],m=e[15],g=c*v*l-p*h*l+p*s*d-o*v*d-c*s*m+o*h*m,_=f*h*l-u*v*l-f*s*d+a*v*d+u*s*m-a*h*m,y=u*p*l-f*c*l+f*o*d-a*p*d-u*o*m+a*c*m,x=f*c*s-u*p*s-f*o*h+a*p*h+u*o*v-a*c*v,b=t*g+n*_+r*y+i*x;if(0===b)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);var w=1/b;return e[0]=g*w,e[1]=(p*h*i-c*v*i-p*r*d+n*v*d+c*r*m-n*h*m)*w,e[2]=(o*v*i-p*s*i+p*r*l-n*v*l-o*r*m+n*s*m)*w,e[3]=(c*s*i-o*h*i-c*r*l+n*h*l+o*r*d-n*s*d)*w,e[4]=_*w,e[5]=(u*v*i-f*h*i+f*r*d-t*v*d-u*r*m+t*h*m)*w,e[6]=(f*s*i-a*v*i-f*r*l+t*v*l+a*r*m-t*s*m)*w,e[7]=(a*h*i-u*s*i+u*r*l-t*h*l-a*r*d+t*s*d)*w,e[8]=y*w,e[9]=(f*c*i-u*p*i-f*n*d+t*p*d+u*n*m-t*c*m)*w,e[10]=(a*p*i-f*o*i+f*n*l-t*p*l-a*n*m+t*o*m)*w,e[11]=(u*o*i-a*c*i-u*n*l+t*c*l+a*n*d-t*o*d)*w,e[12]=x*w,e[13]=(u*p*r-f*c*r+f*n*h-t*p*h-u*n*v+t*c*v)*w,e[14]=(f*o*r-a*p*r-f*n*s+t*p*s+a*n*v-t*o*v)*w,e[15]=(a*c*r-u*o*r+u*n*s-t*c*s-a*n*h+t*o*h)*w,this}},{key:"scale",value:function(e){var t=this.elements,n=e.x,r=e.y,i=e.z;return t[0]*=n,t[4]*=r,t[8]*=i,t[1]*=n,t[5]*=r,t[9]*=i,t[2]*=n,t[6]*=r,t[10]*=i,t[3]*=n,t[7]*=r,t[11]*=i,this}},{key:"getMaxScaleOnAxis",value:function(){var e=this.elements,t=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],n=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],r=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(t,n,r))}},{key:"makeTranslation",value:function(e,t,n){return this.set(1,0,0,e,0,1,0,t,0,0,1,n,0,0,0,1),this}},{key:"makeRotationX",value:function(e){var t=Math.cos(e),n=Math.sin(e);return this.set(1,0,0,0,0,t,-n,0,0,n,t,0,0,0,0,1),this}},{key:"makeRotationY",value:function(e){var t=Math.cos(e),n=Math.sin(e);return this.set(t,0,n,0,0,1,0,0,-n,0,t,0,0,0,0,1),this}},{key:"makeRotationZ",value:function(e){var t=Math.cos(e),n=Math.sin(e);return this.set(t,-n,0,0,n,t,0,0,0,0,1,0,0,0,0,1),this}},{key:"makeRotationAxis",value:function(e,t){var n=Math.cos(t),r=Math.sin(t),i=1-n,a=e.x,o=e.y,s=e.z,l=i*a,u=i*o;return this.set(l*a+n,l*o-r*s,l*s+r*o,0,l*o+r*s,u*o+n,u*s-r*a,0,l*s-r*o,u*s+r*a,i*s*s+n,0,0,0,0,1),this}},{key:"makeScale",value:function(e,t,n){return this.set(e,0,0,0,0,t,0,0,0,0,n,0,0,0,0,1),this}},{key:"makeShear",value:function(e,t,n,r,i,a){return this.set(1,n,i,0,e,1,a,0,t,r,1,0,0,0,0,1),this}},{key:"compose",value:function(e,t,n){var r=this.elements,i=t._x,a=t._y,o=t._z,s=t._w,l=i+i,u=a+a,c=o+o,h=i*l,d=i*u,f=i*c,p=a*u,v=a*c,m=o*c,g=s*l,_=s*u,y=s*c,x=n.x,b=n.y,w=n.z;return r[0]=(1-(p+m))*x,r[1]=(d+y)*x,r[2]=(f-_)*x,r[3]=0,r[4]=(d-y)*b,r[5]=(1-(h+m))*b,r[6]=(v+g)*b,r[7]=0,r[8]=(f+_)*w,r[9]=(v-g)*w,r[10]=(1-(h+p))*w,r[11]=0,r[12]=e.x,r[13]=e.y,r[14]=e.z,r[15]=1,this}},{key:"decompose",value:function(e,t,n){var r=this.elements,i=Mt.set(r[0],r[1],r[2]).length(),a=Mt.set(r[4],r[5],r[6]).length(),o=Mt.set(r[8],r[9],r[10]).length();this.determinant()<0&&(i=-i),e.x=r[12],e.y=r[13],e.z=r[14],St.copy(this);var s=1/i,l=1/a,u=1/o;return St.elements[0]*=s,St.elements[1]*=s,St.elements[2]*=s,St.elements[4]*=l,St.elements[5]*=l,St.elements[6]*=l,St.elements[8]*=u,St.elements[9]*=u,St.elements[10]*=u,t.setFromRotationMatrix(St),n.x=i,n.y=a,n.z=o,this}},{key:"makePerspective",value:function(e,t,n,r,i,a){void 0===a&&console.warn("THREE.Matrix4: .makePerspective() has been redefined and has a new signature. Please check the docs.");var o=this.elements,s=2*i/(t-e),l=2*i/(n-r),u=(t+e)/(t-e),c=(n+r)/(n-r),h=-(a+i)/(a-i),d=-2*a*i/(a-i);return o[0]=s,o[4]=0,o[8]=u,o[12]=0,o[1]=0,o[5]=l,o[9]=c,o[13]=0,o[2]=0,o[6]=0,o[10]=h,o[14]=d,o[3]=0,o[7]=0,o[11]=-1,o[15]=0,this}},{key:"makeOrthographic",value:function(e,t,n,r,i,a){var o=this.elements,s=1/(t-e),l=1/(n-r),u=1/(a-i),c=(t+e)*s,h=(n+r)*l,d=(a+i)*u;return o[0]=2*s,o[4]=0,o[8]=0,o[12]=-c,o[1]=0,o[5]=2*l,o[9]=0,o[13]=-h,o[2]=0,o[6]=0,o[10]=-2*u,o[14]=-d,o[3]=0,o[7]=0,o[11]=0,o[15]=1,this}},{key:"equals",value:function(e){for(var t=this.elements,n=e.elements,r=0;r<16;r++)if(t[r]!==n[r])return!1;return!0}},{key:"fromArray",value:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=0;n<16;n++)this.elements[n]=e[n+t];return this}},{key:"toArray",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=this.elements;return e[t]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=n[3],e[t+4]=n[4],e[t+5]=n[5],e[t+6]=n[6],e[t+7]=n[7],e[t+8]=n[8],e[t+9]=n[9],e[t+10]=n[10],e[t+11]=n[11],e[t+12]=n[12],e[t+13]=n[13],e[t+14]=n[14],e[t+15]=n[15],e}}]),e}();Tt.prototype.isMatrix4=!0;var Mt=new qe,St=new Tt,Et=new qe(0,0,0),At=new qe(1,1,1),Lt=new qe,Ct=new qe,Rt=new qe,kt=new Tt,Pt=new je,Dt=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:e.DefaultOrder;(0,v.default)(this,e),this._x=t,this._y=n,this._z=r,this._order=i}return(0,m.default)(e,[{key:"x",get:function(){return this._x},set:function(e){this._x=e,this._onChangeCallback()}},{key:"y",get:function(){return this._y},set:function(e){this._y=e,this._onChangeCallback()}},{key:"z",get:function(){return this._z},set:function(e){this._z=e,this._onChangeCallback()}},{key:"order",get:function(){return this._order},set:function(e){this._order=e,this._onChangeCallback()}},{key:"set",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:this._order;return this._x=e,this._y=t,this._z=n,this._order=r,this._onChangeCallback(),this}},{key:"clone",value:function(){return new this.constructor(this._x,this._y,this._z,this._order)}},{key:"copy",value:function(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this._onChangeCallback(),this}},{key:"setFromRotationMatrix",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this._order,n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=e.elements,i=r[0],a=r[4],o=r[8],s=r[1],l=r[5],u=r[9],c=r[2],h=r[6],d=r[10];switch(t){case"XYZ":this._y=Math.asin(Ae(o,-1,1)),Math.abs(o)<.9999999?(this._x=Math.atan2(-u,d),this._z=Math.atan2(-a,i)):(this._x=Math.atan2(h,l),this._z=0);break;case"YXZ":this._x=Math.asin(-Ae(u,-1,1)),Math.abs(u)<.9999999?(this._y=Math.atan2(o,d),this._z=Math.atan2(s,l)):(this._y=Math.atan2(-c,i),this._z=0);break;case"ZXY":this._x=Math.asin(Ae(h,-1,1)),Math.abs(h)<.9999999?(this._y=Math.atan2(-c,d),this._z=Math.atan2(-a,l)):(this._y=0,this._z=Math.atan2(s,i));break;case"ZYX":this._y=Math.asin(-Ae(c,-1,1)),Math.abs(c)<.9999999?(this._x=Math.atan2(h,d),this._z=Math.atan2(s,i)):(this._x=0,this._z=Math.atan2(-a,l));break;case"YZX":this._z=Math.asin(Ae(s,-1,1)),Math.abs(s)<.9999999?(this._x=Math.atan2(-u,l),this._y=Math.atan2(-c,i)):(this._x=0,this._y=Math.atan2(o,d));break;case"XZY":this._z=Math.asin(-Ae(a,-1,1)),Math.abs(a)<.9999999?(this._x=Math.atan2(h,l),this._y=Math.atan2(o,i)):(this._x=Math.atan2(-u,d),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+t)}return this._order=t,!0===n&&this._onChangeCallback(),this}},{key:"setFromQuaternion",value:function(e,t,n){return kt.makeRotationFromQuaternion(e),this.setFromRotationMatrix(kt,t,n)}},{key:"setFromVector3",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this._order;return this.set(e.x,e.y,e.z,t)}},{key:"reorder",value:function(e){return Pt.setFromEuler(this),this.setFromQuaternion(Pt,e)}},{key:"equals",value:function(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order}},{key:"fromArray",value:function(e){return this._x=e[0],this._y=e[1],this._z=e[2],void 0!==e[3]&&(this._order=e[3]),this._onChangeCallback(),this}},{key:"toArray",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._order,e}},{key:"toVector3",value:function(e){return e?e.set(this._x,this._y,this._z):new qe(this._x,this._y,this._z)}},{key:"_onChange",value:function(e){return this._onChangeCallback=e,this}},{key:"_onChangeCallback",value:function(){}}]),e}();Dt.prototype.isEuler=!0,Dt.DefaultOrder="XYZ",Dt.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"];var It=function(){function e(){(0,v.default)(this,e),this.mask=1}return(0,m.default)(e,[{key:"set",value:function(e){this.mask=1<<e|0}},{key:"enable",value:function(e){this.mask|=1<<e|0}},{key:"enableAll",value:function(){this.mask=-1}},{key:"toggle",value:function(e){this.mask^=1<<e|0}},{key:"disable",value:function(e){this.mask&=~(1<<e|0)}},{key:"disableAll",value:function(){this.mask=0}},{key:"test",value:function(e){return 0!=(this.mask&e.mask)}}]),e}(),Ot=0,Ft=new qe,Nt=new je,Ut=new Tt,Bt=new qe,zt=new qe,Ht=new qe,Gt=new je,Vt=new qe(1,0,0),Wt=new qe(0,1,0),jt=new qe(0,0,1),qt={type:"added"},Xt={type:"removed"},Yt=function(e){(0,d.default)(n,e);var t=b(n);function n(){var e;(0,v.default)(this,n),e=t.call(this),Object.defineProperty((0,h.default)(e),"id",{value:Ot++}),e.uuid=Ee(),e.name="",e.type="Object3D",e.parent=null,e.children=[],e.up=n.DefaultUp.clone();var r=new qe,i=new Dt,a=new je,o=new qe(1,1,1);return i._onChange((function(){a.setFromEuler(i,!1)})),a._onChange((function(){i.setFromQuaternion(a,void 0,!1)})),Object.defineProperties((0,h.default)(e),{position:{configurable:!0,enumerable:!0,value:r},rotation:{configurable:!0,enumerable:!0,value:i},quaternion:{configurable:!0,enumerable:!0,value:a},scale:{configurable:!0,enumerable:!0,value:o},modelViewMatrix:{value:new Tt},normalMatrix:{value:new Fe}}),e.matrix=new Tt,e.matrixWorld=new Tt,e.matrixAutoUpdate=n.DefaultMatrixAutoUpdate,e.matrixWorldNeedsUpdate=!1,e.layers=new It,e.visible=!0,e.castShadow=!1,e.receiveShadow=!1,e.frustumCulled=!0,e.renderOrder=0,e.animations=[],e.userData={},e}return(0,m.default)(n,[{key:"onBeforeRender",value:function(){}},{key:"onAfterRender",value:function(){}},{key:"applyMatrix4",value:function(e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(e),this.matrix.decompose(this.position,this.quaternion,this.scale)}},{key:"applyQuaternion",value:function(e){return this.quaternion.premultiply(e),this}},{key:"setRotationFromAxisAngle",value:function(e,t){this.quaternion.setFromAxisAngle(e,t)}},{key:"setRotationFromEuler",value:function(e){this.quaternion.setFromEuler(e,!0)}},{key:"setRotationFromMatrix",value:function(e){this.quaternion.setFromRotationMatrix(e)}},{key:"setRotationFromQuaternion",value:function(e){this.quaternion.copy(e)}},{key:"rotateOnAxis",value:function(e,t){return Nt.setFromAxisAngle(e,t),this.quaternion.multiply(Nt),this}},{key:"rotateOnWorldAxis",value:function(e,t){return Nt.setFromAxisAngle(e,t),this.quaternion.premultiply(Nt),this}},{key:"rotateX",value:function(e){return this.rotateOnAxis(Vt,e)}},{key:"rotateY",value:function(e){return this.rotateOnAxis(Wt,e)}},{key:"rotateZ",value:function(e){return this.rotateOnAxis(jt,e)}},{key:"translateOnAxis",value:function(e,t){return Ft.copy(e).applyQuaternion(this.quaternion),this.position.add(Ft.multiplyScalar(t)),this}},{key:"translateX",value:function(e){return this.translateOnAxis(Vt,e)}},{key:"translateY",value:function(e){return this.translateOnAxis(Wt,e)}},{key:"translateZ",value:function(e){return this.translateOnAxis(jt,e)}},{key:"localToWorld",value:function(e){return e.applyMatrix4(this.matrixWorld)}},{key:"worldToLocal",value:function(e){return e.applyMatrix4(Ut.copy(this.matrixWorld).invert())}},{key:"lookAt",value:function(e,t,n){e.isVector3?Bt.copy(e):Bt.set(e,t,n);var r=this.parent;this.updateWorldMatrix(!0,!1),zt.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?Ut.lookAt(zt,Bt,this.up):Ut.lookAt(Bt,zt,this.up),this.quaternion.setFromRotationMatrix(Ut),r&&(Ut.extractRotation(r.matrixWorld),Nt.setFromRotationMatrix(Ut),this.quaternion.premultiply(Nt.invert()))}},{key:"add",value:function(e){if(arguments.length>1){for(var t=0;t<arguments.length;t++)this.add(arguments[t]);return this}return e===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",e),this):(e&&e.isObject3D?(null!==e.parent&&e.parent.remove(e),e.parent=this,this.children.push(e),e.dispatchEvent(qt)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",e),this)}},{key:"remove",value:function(e){if(arguments.length>1){for(var t=0;t<arguments.length;t++)this.remove(arguments[t]);return this}var n=this.children.indexOf(e);return-1!==n&&(e.parent=null,this.children.splice(n,1),e.dispatchEvent(Xt)),this}},{key:"removeFromParent",value:function(){var e=this.parent;return null!==e&&e.remove(this),this}},{key:"clear",value:function(){for(var e=0;e<this.children.length;e++){var t=this.children[e];t.parent=null,t.dispatchEvent(Xt)}return this.children.length=0,this}},{key:"attach",value:function(e){return this.updateWorldMatrix(!0,!1),Ut.copy(this.matrixWorld).invert(),null!==e.parent&&(e.parent.updateWorldMatrix(!0,!1),Ut.multiply(e.parent.matrixWorld)),e.applyMatrix4(Ut),this.add(e),e.updateWorldMatrix(!1,!0),this}},{key:"getObjectById",value:function(e){return this.getObjectByProperty("id",e)}},{key:"getObjectByName",value:function(e){return this.getObjectByProperty("name",e)}},{key:"getObjectByProperty",value:function(e,t){if(this[e]===t)return this;for(var n=0,r=this.children.length;n<r;n++){var i=this.children[n].getObjectByProperty(e,t);if(void 0!==i)return i}}},{key:"getWorldPosition",value:function(e){return this.updateWorldMatrix(!0,!1),e.setFromMatrixPosition(this.matrixWorld)}},{key:"getWorldQuaternion",value:function(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(zt,e,Ht),e}},{key:"getWorldScale",value:function(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(zt,Gt,e),e}},{key:"getWorldDirection",value:function(e){this.updateWorldMatrix(!0,!1);var t=this.matrixWorld.elements;return e.set(t[8],t[9],t[10]).normalize()}},{key:"raycast",value:function(){}},{key:"traverse",value:function(e){e(this);for(var t=this.children,n=0,r=t.length;n<r;n++)t[n].traverse(e)}},{key:"traverseVisible",value:function(e){if(!1!==this.visible){e(this);for(var t=this.children,n=0,r=t.length;n<r;n++)t[n].traverseVisible(e)}}},{key:"traverseAncestors",value:function(e){var t=this.parent;null!==t&&(e(t),t.traverseAncestors(e))}},{key:"updateMatrix",value:function(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}},{key:"updateMatrixWorld",value:function(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,e=!0);for(var t=this.children,n=0,r=t.length;n<r;n++)t[n].updateMatrixWorld(e)}},{key:"updateWorldMatrix",value:function(e,t){var n=this.parent;if(!0===e&&null!==n&&n.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),!0===t)for(var r=this.children,i=0,a=r.length;i<a;i++)r[i].updateWorldMatrix(!1,!0)}},{key:"toJSON",value:function(e){var t=void 0===e||"string"==typeof e,n={};t&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{}},n.metadata={version:4.5,type:"Object",generator:"Object3D.toJSON"});var r={};function i(t,n){return void 0===t[n.uuid]&&(t[n.uuid]=n.toJSON(e)),n.uuid}if(r.uuid=this.uuid,r.type=this.type,""!==this.name&&(r.name=this.name),!0===this.castShadow&&(r.castShadow=!0),!0===this.receiveShadow&&(r.receiveShadow=!0),!1===this.visible&&(r.visible=!1),!1===this.frustumCulled&&(r.frustumCulled=!1),0!==this.renderOrder&&(r.renderOrder=this.renderOrder),"{}"!==JSON.stringify(this.userData)&&(r.userData=this.userData),r.layers=this.layers.mask,r.matrix=this.matrix.toArray(),!1===this.matrixAutoUpdate&&(r.matrixAutoUpdate=!1),this.isInstancedMesh&&(r.type="InstancedMesh",r.count=this.count,r.instanceMatrix=this.instanceMatrix.toJSON(),null!==this.instanceColor&&(r.instanceColor=this.instanceColor.toJSON())),this.isScene)this.background&&(this.background.isColor?r.background=this.background.toJSON():this.background.isTexture&&(r.background=this.background.toJSON(e).uuid)),this.environment&&this.environment.isTexture&&(r.environment=this.environment.toJSON(e).uuid);else if(this.isMesh||this.isLine||this.isPoints){r.geometry=i(e.geometries,this.geometry);var a=this.geometry.parameters;if(void 0!==a&&void 0!==a.shapes){var o=a.shapes;if(Array.isArray(o))for(var s=0,l=o.length;s<l;s++){var u=o[s];i(e.shapes,u)}else i(e.shapes,o)}}if(this.isSkinnedMesh&&(r.bindMode=this.bindMode,r.bindMatrix=this.bindMatrix.toArray(),void 0!==this.skeleton&&(i(e.skeletons,this.skeleton),r.skeleton=this.skeleton.uuid)),void 0!==this.material)if(Array.isArray(this.material)){for(var c=[],h=0,d=this.material.length;h<d;h++)c.push(i(e.materials,this.material[h]));r.material=c}else r.material=i(e.materials,this.material);if(this.children.length>0){r.children=[];for(var f=0;f<this.children.length;f++)r.children.push(this.children[f].toJSON(e).object)}if(this.animations.length>0){r.animations=[];for(var p=0;p<this.animations.length;p++){var v=this.animations[p];r.animations.push(i(e.animations,v))}}if(t){var m=T(e.geometries),g=T(e.materials),_=T(e.textures),y=T(e.images),x=T(e.shapes),b=T(e.skeletons),w=T(e.animations);m.length>0&&(n.geometries=m),g.length>0&&(n.materials=g),_.length>0&&(n.textures=_),y.length>0&&(n.images=y),x.length>0&&(n.shapes=x),b.length>0&&(n.skeletons=b),w.length>0&&(n.animations=w)}return n.object=r,n;function T(e){var t=[];for(var n in e){var r=e[n];delete r.metadata,t.push(r)}return t}}},{key:"clone",value:function(e){return(new this.constructor).copy(this,e)}},{key:"copy",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.rotation.order=e.rotation.order,this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.userData=JSON.parse(JSON.stringify(e.userData)),!0===t)for(var n=0;n<e.children.length;n++){var r=e.children[n];this.add(r.clone())}return this}}]),n}(xe);Yt.DefaultUp=new qe(0,1,0),Yt.DefaultMatrixAutoUpdate=!0,Yt.prototype.isObject3D=!0;var Kt=new qe,Zt=new qe,Jt=new qe,Qt=new qe,$t=new qe,en=new qe,tn=new qe,nn=new qe,rn=new qe,an=new qe,on=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new qe,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new qe,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new qe;(0,v.default)(this,e),this.a=t,this.b=n,this.c=r}return(0,m.default)(e,[{key:"set",value:function(e,t,n){return this.a.copy(e),this.b.copy(t),this.c.copy(n),this}},{key:"setFromPointsAndIndices",value:function(e,t,n,r){return this.a.copy(e[t]),this.b.copy(e[n]),this.c.copy(e[r]),this}},{key:"clone",value:function(){return(new this.constructor).copy(this)}},{key:"copy",value:function(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}},{key:"getArea",value:function(){return Kt.subVectors(this.c,this.b),Zt.subVectors(this.a,this.b),.5*Kt.cross(Zt).length()}},{key:"getMidpoint",value:function(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}},{key:"getNormal",value:function(t){return e.getNormal(this.a,this.b,this.c,t)}},{key:"getPlane",value:function(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}},{key:"getBarycoord",value:function(t,n){return e.getBarycoord(t,this.a,this.b,this.c,n)}},{key:"getUV",value:function(t,n,r,i,a){return e.getUV(t,this.a,this.b,this.c,n,r,i,a)}},{key:"containsPoint",value:function(t){return e.containsPoint(t,this.a,this.b,this.c)}},{key:"isFrontFacing",value:function(t){return e.isFrontFacing(this.a,this.b,this.c,t)}},{key:"intersectsBox",value:function(e){return e.intersectsTriangle(this)}},{key:"closestPointToPoint",value:function(e,t){var n,r,i=this.a,a=this.b,o=this.c;$t.subVectors(a,i),en.subVectors(o,i),nn.subVectors(e,i);var s=$t.dot(nn),l=en.dot(nn);if(s<=0&&l<=0)return t.copy(i);rn.subVectors(e,a);var u=$t.dot(rn),c=en.dot(rn);if(u>=0&&c<=u)return t.copy(a);var h=s*c-u*l;if(h<=0&&s>=0&&u<=0)return n=s/(s-u),t.copy(i).addScaledVector($t,n);an.subVectors(e,o);var d=$t.dot(an),f=en.dot(an);if(f>=0&&d<=f)return t.copy(o);var p=d*l-s*f;if(p<=0&&l>=0&&f<=0)return r=l/(l-f),t.copy(i).addScaledVector(en,r);var v=u*f-d*c;if(v<=0&&c-u>=0&&d-f>=0)return tn.subVectors(o,a),r=(c-u)/(c-u+(d-f)),t.copy(a).addScaledVector(tn,r);var m=1/(v+p+h);return n=p*m,r=h*m,t.copy(i).addScaledVector($t,n).addScaledVector(en,r)}},{key:"equals",value:function(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}}],[{key:"getNormal",value:function(e,t,n,r){r.subVectors(n,t),Kt.subVectors(e,t),r.cross(Kt);var i=r.lengthSq();return i>0?r.multiplyScalar(1/Math.sqrt(i)):r.set(0,0,0)}},{key:"getBarycoord",value:function(e,t,n,r,i){Kt.subVectors(r,t),Zt.subVectors(n,t),Jt.subVectors(e,t);var a=Kt.dot(Kt),o=Kt.dot(Zt),s=Kt.dot(Jt),l=Zt.dot(Zt),u=Zt.dot(Jt),c=a*l-o*o;if(0===c)return i.set(-2,-1,-1);var h=1/c,d=(l*s-o*u)*h,f=(a*u-o*s)*h;return i.set(1-d-f,f,d)}},{key:"containsPoint",value:function(e,t,n,r){return this.getBarycoord(e,t,n,r,Qt),Qt.x>=0&&Qt.y>=0&&Qt.x+Qt.y<=1}},{key:"getUV",value:function(e,t,n,r,i,a,o,s){return this.getBarycoord(e,t,n,r,Qt),s.set(0,0),s.addScaledVector(i,Qt.x),s.addScaledVector(a,Qt.y),s.addScaledVector(o,Qt.z),s}},{key:"isFrontFacing",value:function(e,t,n,r){return Kt.subVectors(n,t),Zt.subVectors(e,t),Kt.cross(Zt).dot(r)<0}}]),e}(),sn=0,ln=function(e){(0,d.default)(n,e);var t=b(n);function n(){var e;return(0,v.default)(this,n),e=t.call(this),Object.defineProperty((0,h.default)(e),"id",{value:sn++}),e.uuid=Ee(),e.name="",e.type="Material",e.fog=!0,e.blending=1,e.side=0,e.vertexColors=!1,e.opacity=1,e.transparent=!1,e.blendSrc=204,e.blendDst=205,e.blendEquation=r,e.blendSrcAlpha=null,e.blendDstAlpha=null,e.blendEquationAlpha=null,e.depthFunc=3,e.depthTest=!0,e.depthWrite=!0,e.stencilWriteMask=255,e.stencilFunc=519,e.stencilRef=0,e.stencilFuncMask=255,e.stencilFail=me,e.stencilZFail=me,e.stencilZPass=me,e.stencilWrite=!1,e.clippingPlanes=null,e.clipIntersection=!1,e.clipShadows=!1,e.shadowSide=null,e.colorWrite=!0,e.precision=null,e.polygonOffset=!1,e.polygonOffsetFactor=0,e.polygonOffsetUnits=0,e.dithering=!1,e.alphaTest=0,e.alphaToCoverage=!1,e.premultipliedAlpha=!1,e.visible=!0,e.toneMapped=!0,e.userData={},e.version=0,e}return(0,m.default)(n,[{key:"onBuild",value:function(){}},{key:"onBeforeCompile",value:function(){}},{key:"customProgramCacheKey",value:function(){return this.onBeforeCompile.toString()}},{key:"setValues",value:function(e){if(void 0!==e)for(var t in e){var n=e[t];if(void 0!==n)if("shading"!==t){var r=this[t];void 0!==r?r&&r.isColor?r.set(n):r&&r.isVector3&&n&&n.isVector3?r.copy(n):this[t]=n:console.warn("THREE."+this.type+": '"+t+"' is not a property of this material.")}else console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=1===n;else console.warn("THREE.Material: '"+t+"' parameter is undefined.")}}},{key:"toJSON",value:function(e){var t=void 0===e||"string"==typeof e;t&&(e={textures:{},images:{}});var n={metadata:{version:4.5,type:"Material",generator:"Material.toJSON"}};function r(e){var t=[];for(var n in e){var r=e[n];delete r.metadata,t.push(r)}return t}if(n.uuid=this.uuid,n.type=this.type,""!==this.name&&(n.name=this.name),this.color&&this.color.isColor&&(n.color=this.color.getHex()),void 0!==this.roughness&&(n.roughness=this.roughness),void 0!==this.metalness&&(n.metalness=this.metalness),this.sheen&&this.sheen.isColor&&(n.sheen=this.sheen.getHex()),this.emissive&&this.emissive.isColor&&(n.emissive=this.emissive.getHex()),this.emissiveIntensity&&1!==this.emissiveIntensity&&(n.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(n.specular=this.specular.getHex()),void 0!==this.specularIntensity&&(n.specularIntensity=this.specularIntensity),this.specularTint&&this.specularTint.isColor&&(n.specularTint=this.specularTint.getHex()),void 0!==this.shininess&&(n.shininess=this.shininess),void 0!==this.clearcoat&&(n.clearcoat=this.clearcoat),void 0!==this.clearcoatRoughness&&(n.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(n.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(n.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(n.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,n.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.map&&this.map.isTexture&&(n.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(n.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(n.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(n.lightMap=this.lightMap.toJSON(e).uuid,n.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(n.aoMap=this.aoMap.toJSON(e).uuid,n.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(n.bumpMap=this.bumpMap.toJSON(e).uuid,n.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(n.normalMap=this.normalMap.toJSON(e).uuid,n.normalMapType=this.normalMapType,n.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(n.displacementMap=this.displacementMap.toJSON(e).uuid,n.displacementScale=this.displacementScale,n.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(n.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(n.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(n.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(n.specularMap=this.specularMap.toJSON(e).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(n.specularIntensityMap=this.specularIntensityMap.toJSON(e).uuid),this.specularTintMap&&this.specularTintMap.isTexture&&(n.specularTintMap=this.specularTintMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(n.envMap=this.envMap.toJSON(e).uuid,void 0!==this.combine&&(n.combine=this.combine)),void 0!==this.envMapIntensity&&(n.envMapIntensity=this.envMapIntensity),void 0!==this.reflectivity&&(n.reflectivity=this.reflectivity),void 0!==this.refractionRatio&&(n.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(n.gradientMap=this.gradientMap.toJSON(e).uuid),void 0!==this.transmission&&(n.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(n.transmissionMap=this.transmissionMap.toJSON(e).uuid),void 0!==this.thickness&&(n.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(n.thicknessMap=this.thicknessMap.toJSON(e).uuid),void 0!==this.attenuationDistance&&(n.attenuationDistance=this.attenuationDistance),void 0!==this.attenuationTint&&(n.attenuationTint=this.attenuationTint.getHex()),void 0!==this.size&&(n.size=this.size),null!==this.shadowSide&&(n.shadowSide=this.shadowSide),void 0!==this.sizeAttenuation&&(n.sizeAttenuation=this.sizeAttenuation),1!==this.blending&&(n.blending=this.blending),0!==this.side&&(n.side=this.side),this.vertexColors&&(n.vertexColors=!0),this.opacity<1&&(n.opacity=this.opacity),!0===this.transparent&&(n.transparent=this.transparent),n.depthFunc=this.depthFunc,n.depthTest=this.depthTest,n.depthWrite=this.depthWrite,n.colorWrite=this.colorWrite,n.stencilWrite=this.stencilWrite,n.stencilWriteMask=this.stencilWriteMask,n.stencilFunc=this.stencilFunc,n.stencilRef=this.stencilRef,n.stencilFuncMask=this.stencilFuncMask,n.stencilFail=this.stencilFail,n.stencilZFail=this.stencilZFail,n.stencilZPass=this.stencilZPass,this.rotation&&0!==this.rotation&&(n.rotation=this.rotation),!0===this.polygonOffset&&(n.polygonOffset=!0),0!==this.polygonOffsetFactor&&(n.polygonOffsetFactor=this.polygonOffsetFactor),0!==this.polygonOffsetUnits&&(n.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth&&1!==this.linewidth&&(n.linewidth=this.linewidth),void 0!==this.dashSize&&(n.dashSize=this.dashSize),void 0!==this.gapSize&&(n.gapSize=this.gapSize),void 0!==this.scale&&(n.scale=this.scale),!0===this.dithering&&(n.dithering=!0),this.alphaTest>0&&(n.alphaTest=this.alphaTest),!0===this.alphaToCoverage&&(n.alphaToCoverage=this.alphaToCoverage),!0===this.premultipliedAlpha&&(n.premultipliedAlpha=this.premultipliedAlpha),!0===this.wireframe&&(n.wireframe=this.wireframe),this.wireframeLinewidth>1&&(n.wireframeLinewidth=this.wireframeLinewidth),"round"!==this.wireframeLinecap&&(n.wireframeLinecap=this.wireframeLinecap),"round"!==this.wireframeLinejoin&&(n.wireframeLinejoin=this.wireframeLinejoin),!0===this.flatShading&&(n.flatShading=this.flatShading),!1===this.visible&&(n.visible=!1),!1===this.toneMapped&&(n.toneMapped=!1),"{}"!==JSON.stringify(this.userData)&&(n.userData=this.userData),t){var i=r(e.textures),a=r(e.images);i.length>0&&(n.textures=i),a.length>0&&(n.images=a)}return n}},{key:"clone",value:function(){return(new this.constructor).copy(this)}},{key:"copy",value:function(e){this.name=e.name,this.fog=e.fog,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;var t=e.clippingPlanes,n=null;if(null!==t){var r=t.length;n=new Array(r);for(var i=0;i!==r;++i)n[i]=t[i].clone()}return this.clippingPlanes=n,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.alphaToCoverage=e.alphaToCoverage,this.premultipliedAlpha=e.premultipliedAlpha,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this}},{key:"dispose",value:function(){this.dispatchEvent({type:"dispose"})}},{key:"needsUpdate",set:function(e){!0===e&&this.version++}}]),n}(xe);ln.prototype.isMaterial=!0;var un={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},cn={h:0,s:0,l:0},hn={h:0,s:0,l:0};function dn(e,t,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?e+6*(t-e)*n:n<.5?t:n<2/3?e+6*(t-e)*(2/3-n):e}function fn(e){return e<.04045?.0773993808*e:Math.pow(.9478672986*e+.0521327014,2.4)}function pn(e){return e<.0031308?12.92*e:1.055*Math.pow(e,.41666)-.055}var vn=function(){function e(t,n,r){return(0,v.default)(this,e),void 0===n&&void 0===r?this.set(t):this.setRGB(t,n,r)}return(0,m.default)(e,[{key:"set",value:function(e){return e&&e.isColor?this.copy(e):"number"==typeof e?this.setHex(e):"string"==typeof e&&this.setStyle(e),this}},{key:"setScalar",value:function(e){return this.r=e,this.g=e,this.b=e,this}},{key:"setHex",value:function(e){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(255&e)/255,this}},{key:"setRGB",value:function(e,t,n){return this.r=e,this.g=t,this.b=n,this}},{key:"setHSL",value:function(e,t,n){if(e=Le(e,1),t=Ae(t,0,1),n=Ae(n,0,1),0===t)this.r=this.g=this.b=n;else{var r=n<=.5?n*(1+t):n+t-n*t,i=2*n-r;this.r=dn(i,r,e+1/3),this.g=dn(i,r,e),this.b=dn(i,r,e-1/3)}return this}},{key:"setStyle",value:function(e){function t(t){void 0!==t&&parseFloat(t)<1&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}var n;if(n=/^((?:rgb|hsl)a?)\(([^\)]*)\)/.exec(e)){var r,i=n[1],a=n[2];switch(i){case"rgb":case"rgba":if(r=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return this.r=Math.min(255,parseInt(r[1],10))/255,this.g=Math.min(255,parseInt(r[2],10))/255,this.b=Math.min(255,parseInt(r[3],10))/255,t(r[4]),this;if(r=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return this.r=Math.min(100,parseInt(r[1],10))/100,this.g=Math.min(100,parseInt(r[2],10))/100,this.b=Math.min(100,parseInt(r[3],10))/100,t(r[4]),this;break;case"hsl":case"hsla":if(r=/^\s*(\d*\.?\d+)\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a)){var o=parseFloat(r[1])/360,s=parseInt(r[2],10)/100,l=parseInt(r[3],10)/100;return t(r[4]),this.setHSL(o,s,l)}}}else if(n=/^\#([A-Fa-f\d]+)$/.exec(e)){var u=n[1],c=u.length;if(3===c)return this.r=parseInt(u.charAt(0)+u.charAt(0),16)/255,this.g=parseInt(u.charAt(1)+u.charAt(1),16)/255,this.b=parseInt(u.charAt(2)+u.charAt(2),16)/255,this;if(6===c)return this.r=parseInt(u.charAt(0)+u.charAt(1),16)/255,this.g=parseInt(u.charAt(2)+u.charAt(3),16)/255,this.b=parseInt(u.charAt(4)+u.charAt(5),16)/255,this}return e&&e.length>0?this.setColorName(e):this}},{key:"setColorName",value:function(e){var t=un[e.toLowerCase()];return void 0!==t?this.setHex(t):console.warn("THREE.Color: Unknown color "+e),this}},{key:"clone",value:function(){return new this.constructor(this.r,this.g,this.b)}},{key:"copy",value:function(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}},{key:"copyGammaToLinear",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;return this.r=Math.pow(e.r,t),this.g=Math.pow(e.g,t),this.b=Math.pow(e.b,t),this}},{key:"copyLinearToGamma",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2,n=t>0?1/t:1;return this.r=Math.pow(e.r,n),this.g=Math.pow(e.g,n),this.b=Math.pow(e.b,n),this}},{key:"convertGammaToLinear",value:function(e){return this.copyGammaToLinear(this,e),this}},{key:"convertLinearToGamma",value:function(e){return this.copyLinearToGamma(this,e),this}},{key:"copySRGBToLinear",value:function(e){return this.r=fn(e.r),this.g=fn(e.g),this.b=fn(e.b),this}},{key:"copyLinearToSRGB",value:function(e){return this.r=pn(e.r),this.g=pn(e.g),this.b=pn(e.b),this}},{key:"convertSRGBToLinear",value:function(){return this.copySRGBToLinear(this),this}},{key:"convertLinearToSRGB",value:function(){return this.copyLinearToSRGB(this),this}},{key:"getHex",value:function(){return 255*this.r<<16^255*this.g<<8^255*this.b<<0}},{key:"getHexString",value:function(){return("000000"+this.getHex().toString(16)).slice(-6)}},{key:"getHSL",value:function(e){var t,n,r=this.r,i=this.g,a=this.b,o=Math.max(r,i,a),s=Math.min(r,i,a),l=(s+o)/2;if(s===o)t=0,n=0;else{var u=o-s;switch(n=l<=.5?u/(o+s):u/(2-o-s),o){case r:t=(i-a)/u+(i<a?6:0);break;case i:t=(a-r)/u+2;break;case a:t=(r-i)/u+4}t/=6}return e.h=t,e.s=n,e.l=l,e}},{key:"getStyle",value:function(){return"rgb("+(255*this.r|0)+","+(255*this.g|0)+","+(255*this.b|0)+")"}},{key:"offsetHSL",value:function(e,t,n){return this.getHSL(cn),cn.h+=e,cn.s+=t,cn.l+=n,this.setHSL(cn.h,cn.s,cn.l),this}},{key:"add",value:function(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this}},{key:"addColors",value:function(e,t){return this.r=e.r+t.r,this.g=e.g+t.g,this.b=e.b+t.b,this}},{key:"addScalar",value:function(e){return this.r+=e,this.g+=e,this.b+=e,this}},{key:"sub",value:function(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this}},{key:"multiply",value:function(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this}},{key:"multiplyScalar",value:function(e){return this.r*=e,this.g*=e,this.b*=e,this}},{key:"lerp",value:function(e,t){return this.r+=(e.r-this.r)*t,this.g+=(e.g-this.g)*t,this.b+=(e.b-this.b)*t,this}},{key:"lerpColors",value:function(e,t,n){return this.r=e.r+(t.r-e.r)*n,this.g=e.g+(t.g-e.g)*n,this.b=e.b+(t.b-e.b)*n,this}},{key:"lerpHSL",value:function(e,t){this.getHSL(cn),e.getHSL(hn);var n=Ce(cn.h,hn.h,t),r=Ce(cn.s,hn.s,t),i=Ce(cn.l,hn.l,t);return this.setHSL(n,r,i),this}},{key:"equals",value:function(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}},{key:"fromArray",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.r=e[t],this.g=e[t+1],this.b=e[t+2],this}},{key:"toArray",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e[t]=this.r,e[t+1]=this.g,e[t+2]=this.b,e}},{key:"fromBufferAttribute",value:function(e,t){return this.r=e.getX(t),this.g=e.getY(t),this.b=e.getZ(t),!0===e.normalized&&(this.r/=255,this.g/=255,this.b/=255),this}},{key:"toJSON",value:function(){return this.getHex()}}]),e}();vn.NAMES=un,vn.prototype.isColor=!0,vn.prototype.r=1,vn.prototype.g=1,vn.prototype.b=1;var mn=function(e){(0,d.default)(n,e);var t=b(n);function n(e){var r;return(0,v.default)(this,n),(r=t.call(this)).type="MeshBasicMaterial",r.color=new vn(16777215),r.map=null,r.lightMap=null,r.lightMapIntensity=1,r.aoMap=null,r.aoMapIntensity=1,r.specularMap=null,r.alphaMap=null,r.envMap=null,r.combine=0,r.reflectivity=1,r.refractionRatio=.98,r.wireframe=!1,r.wireframeLinewidth=1,r.wireframeLinecap="round",r.wireframeLinejoin="round",r.setValues(e),r}return(0,m.default)(n,[{key:"copy",value:function(e){return(0,u.default)((0,p.default)(n.prototype),"copy",this).call(this,e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this}}]),n}(ln);mn.prototype.isMeshBasicMaterial=!0;var gn=new qe,_n=new Ie,yn=function(){function e(t,n,r){if((0,v.default)(this,e),Array.isArray(t))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.name="",this.array=t,this.itemSize=n,this.count=void 0!==t?t.length/n:0,this.normalized=!0===r,this.usage=ge,this.updateRange={offset:0,count:-1},this.version=0}return(0,m.default)(e,[{key:"onUploadCallback",value:function(){}},{key:"needsUpdate",set:function(e){!0===e&&this.version++}},{key:"setUsage",value:function(e){return this.usage=e,this}},{key:"copy",value:function(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this}},{key:"copyAt",value:function(e,t,n){e*=this.itemSize,n*=t.itemSize;for(var r=0,i=this.itemSize;r<i;r++)this.array[e+r]=t.array[n+r];return this}},{key:"copyArray",value:function(e){return this.array.set(e),this}},{key:"copyColorsArray",value:function(e){for(var t=this.array,n=0,r=0,i=e.length;r<i;r++){var a=e[r];void 0===a&&(console.warn("THREE.BufferAttribute.copyColorsArray(): color is undefined",r),a=new vn),t[n++]=a.r,t[n++]=a.g,t[n++]=a.b}return this}},{key:"copyVector2sArray",value:function(e){for(var t=this.array,n=0,r=0,i=e.length;r<i;r++){var a=e[r];void 0===a&&(console.warn("THREE.BufferAttribute.copyVector2sArray(): vector is undefined",r),a=new Ie),t[n++]=a.x,t[n++]=a.y}return this}},{key:"copyVector3sArray",value:function(e){for(var t=this.array,n=0,r=0,i=e.length;r<i;r++){var a=e[r];void 0===a&&(console.warn("THREE.BufferAttribute.copyVector3sArray(): vector is undefined",r),a=new qe),t[n++]=a.x,t[n++]=a.y,t[n++]=a.z}return this}},{key:"copyVector4sArray",value:function(e){for(var t=this.array,n=0,r=0,i=e.length;r<i;r++){var a=e[r];void 0===a&&(console.warn("THREE.BufferAttribute.copyVector4sArray(): vector is undefined",r),a=new He),t[n++]=a.x,t[n++]=a.y,t[n++]=a.z,t[n++]=a.w}return this}},{key:"applyMatrix3",value:function(e){if(2===this.itemSize)for(var t=0,n=this.count;t<n;t++)_n.fromBufferAttribute(this,t),_n.applyMatrix3(e),this.setXY(t,_n.x,_n.y);else if(3===this.itemSize)for(var r=0,i=this.count;r<i;r++)gn.fromBufferAttribute(this,r),gn.applyMatrix3(e),this.setXYZ(r,gn.x,gn.y,gn.z);return this}},{key:"applyMatrix4",value:function(e){for(var t=0,n=this.count;t<n;t++)gn.x=this.getX(t),gn.y=this.getY(t),gn.z=this.getZ(t),gn.applyMatrix4(e),this.setXYZ(t,gn.x,gn.y,gn.z);return this}},{key:"applyNormalMatrix",value:function(e){for(var t=0,n=this.count;t<n;t++)gn.x=this.getX(t),gn.y=this.getY(t),gn.z=this.getZ(t),gn.applyNormalMatrix(e),this.setXYZ(t,gn.x,gn.y,gn.z);return this}},{key:"transformDirection",value:function(e){for(var t=0,n=this.count;t<n;t++)gn.x=this.getX(t),gn.y=this.getY(t),gn.z=this.getZ(t),gn.transformDirection(e),this.setXYZ(t,gn.x,gn.y,gn.z);return this}},{key:"set",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.array.set(e,t),this}},{key:"getX",value:function(e){return this.array[e*this.itemSize]}},{key:"setX",value:function(e,t){return this.array[e*this.itemSize]=t,this}},{key:"getY",value:function(e){return this.array[e*this.itemSize+1]}},{key:"setY",value:function(e,t){return this.array[e*this.itemSize+1]=t,this}},{key:"getZ",value:function(e){return this.array[e*this.itemSize+2]}},{key:"setZ",value:function(e,t){return this.array[e*this.itemSize+2]=t,this}},{key:"getW",value:function(e){return this.array[e*this.itemSize+3]}},{key:"setW",value:function(e,t){return this.array[e*this.itemSize+3]=t,this}},{key:"setXY",value:function(e,t,n){return e*=this.itemSize,this.array[e+0]=t,this.array[e+1]=n,this}},{key:"setXYZ",value:function(e,t,n,r){return e*=this.itemSize,this.array[e+0]=t,this.array[e+1]=n,this.array[e+2]=r,this}},{key:"setXYZW",value:function(e,t,n,r,i){return e*=this.itemSize,this.array[e+0]=t,this.array[e+1]=n,this.array[e+2]=r,this.array[e+3]=i,this}},{key:"onUpload",value:function(e){return this.onUploadCallback=e,this}},{key:"clone",value:function(){return new this.constructor(this.array,this.itemSize).copy(this)}},{key:"toJSON",value:function(){var e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.prototype.slice.call(this.array),normalized:this.normalized};return""!==this.name&&(e.name=this.name),this.usage!==ge&&(e.usage=this.usage),0===this.updateRange.offset&&-1===this.updateRange.count||(e.updateRange=this.updateRange),e}}]),e}();yn.prototype.isBufferAttribute=!0;var xn=function(e){(0,d.default)(n,e);var t=b(n);function n(e,r,i){return(0,v.default)(this,n),t.call(this,new Int8Array(e),r,i)}return(0,m.default)(n)}(yn),bn=function(e){(0,d.default)(n,e);var t=b(n);function n(e,r,i){return(0,v.default)(this,n),t.call(this,new Uint8Array(e),r,i)}return(0,m.default)(n)}(yn),wn=function(e){(0,d.default)(n,e);var t=b(n);function n(e,r,i){return(0,v.default)(this,n),t.call(this,new Uint8ClampedArray(e),r,i)}return(0,m.default)(n)}(yn),Tn=function(e){(0,d.default)(n,e);var t=b(n);function n(e,r,i){return(0,v.default)(this,n),t.call(this,new Int16Array(e),r,i)}return(0,m.default)(n)}(yn),Mn=function(e){(0,d.default)(n,e);var t=b(n);function n(e,r,i){return(0,v.default)(this,n),t.call(this,new Uint16Array(e),r,i)}return(0,m.default)(n)}(yn),Sn=function(e){(0,d.default)(n,e);var t=b(n);function n(e,r,i){return(0,v.default)(this,n),t.call(this,new Int32Array(e),r,i)}return(0,m.default)(n)}(yn),En=function(e){(0,d.default)(n,e);var t=b(n);function n(e,r,i){return(0,v.default)(this,n),t.call(this,new Uint32Array(e),r,i)}return(0,m.default)(n)}(yn),An=function(e){(0,d.default)(n,e);var t=b(n);function n(e,r,i){return(0,v.default)(this,n),t.call(this,new Uint16Array(e),r,i)}return(0,m.default)(n)}(yn);An.prototype.isFloat16BufferAttribute=!0;var Ln=function(e){(0,d.default)(n,e);var t=b(n);function n(e,r,i){return(0,v.default)(this,n),t.call(this,new Float32Array(e),r,i)}return(0,m.default)(n)}(yn),Cn=function(e){(0,d.default)(n,e);var t=b(n);function n(e,r,i){return(0,v.default)(this,n),t.call(this,new Float64Array(e),r,i)}return(0,m.default)(n)}(yn);function Rn(e){if(0===e.length)return-1/0;for(var t=e[0],n=1,r=e.length;n<r;++n)e[n]>t&&(t=e[n]);return t}var kn={Int8Array:Int8Array,Uint8Array:Uint8Array,Uint8ClampedArray:Uint8ClampedArray,Int16Array:Int16Array,Uint16Array:Uint16Array,Int32Array:Int32Array,Uint32Array:Uint32Array,Float32Array:Float32Array,Float64Array:Float64Array};function Pn(e,t){return new kn[e](t)}var Dn=0,In=new Tt,On=new Yt,Fn=new qe,Nn=new Ke,Un=new Ke,Bn=new qe,zn=function(e){(0,d.default)(n,e);var t=b(n);function n(){var e;return(0,v.default)(this,n),e=t.call(this),Object.defineProperty((0,h.default)(e),"id",{value:Dn++}),e.uuid=Ee(),e.name="",e.type="BufferGeometry",e.index=null,e.attributes={},e.morphAttributes={},e.morphTargetsRelative=!1,e.groups=[],e.boundingBox=null,e.boundingSphere=null,e.drawRange={start:0,count:1/0},e.userData={},e}return(0,m.default)(n,[{key:"getIndex",value:function(){return this.index}},{key:"setIndex",value:function(e){return Array.isArray(e)?this.index=new(Rn(e)>65535?En:Mn)(e,1):this.index=e,this}},{key:"getAttribute",value:function(e){return this.attributes[e]}},{key:"setAttribute",value:function(e,t){return this.attributes[e]=t,this}},{key:"deleteAttribute",value:function(e){return delete this.attributes[e],this}},{key:"hasAttribute",value:function(e){return void 0!==this.attributes[e]}},{key:"addGroup",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;this.groups.push({start:e,count:t,materialIndex:n})}},{key:"clearGroups",value:function(){this.groups=[]}},{key:"setDrawRange",value:function(e,t){this.drawRange.start=e,this.drawRange.count=t}},{key:"applyMatrix4",value:function(e){var t=this.attributes.position;void 0!==t&&(t.applyMatrix4(e),t.needsUpdate=!0);var n=this.attributes.normal;if(void 0!==n){var r=(new Fe).getNormalMatrix(e);n.applyNormalMatrix(r),n.needsUpdate=!0}var i=this.attributes.tangent;return void 0!==i&&(i.transformDirection(e),i.needsUpdate=!0),null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this}},{key:"applyQuaternion",value:function(e){return In.makeRotationFromQuaternion(e),this.applyMatrix4(In),this}},{key:"rotateX",value:function(e){return In.makeRotationX(e),this.applyMatrix4(In),this}},{key:"rotateY",value:function(e){return In.makeRotationY(e),this.applyMatrix4(In),this}},{key:"rotateZ",value:function(e){return In.makeRotationZ(e),this.applyMatrix4(In),this}},{key:"translate",value:function(e,t,n){return In.makeTranslation(e,t,n),this.applyMatrix4(In),this}},{key:"scale",value:function(e,t,n){return In.makeScale(e,t,n),this.applyMatrix4(In),this}},{key:"lookAt",value:function(e){return On.lookAt(e),On.updateMatrix(),this.applyMatrix4(On.matrix),this}},{key:"center",value:function(){return this.computeBoundingBox(),this.boundingBox.getCenter(Fn).negate(),this.translate(Fn.x,Fn.y,Fn.z),this}},{key:"setFromPoints",value:function(e){for(var t=[],n=0,r=e.length;n<r;n++){var i=e[n];t.push(i.x,i.y,i.z||0)}return this.setAttribute("position",new Ln(t,3)),this}},{key:"computeBoundingBox",value:function(){null===this.boundingBox&&(this.boundingBox=new Ke);var e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute)return console.error('THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box. Alternatively set "mesh.frustumCulled" to "false".',this),void this.boundingBox.set(new qe(-1/0,-1/0,-1/0),new qe(1/0,1/0,1/0));if(void 0!==e){if(this.boundingBox.setFromBufferAttribute(e),t)for(var n=0,r=t.length;n<r;n++){var i=t[n];Nn.setFromBufferAttribute(i),this.morphTargetsRelative?(Bn.addVectors(this.boundingBox.min,Nn.min),this.boundingBox.expandByPoint(Bn),Bn.addVectors(this.boundingBox.max,Nn.max),this.boundingBox.expandByPoint(Bn)):(this.boundingBox.expandByPoint(Nn.min),this.boundingBox.expandByPoint(Nn.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}},{key:"computeBoundingSphere",value:function(){null===this.boundingSphere&&(this.boundingSphere=new pt);var e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute)return console.error('THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere. Alternatively set "mesh.frustumCulled" to "false".',this),void this.boundingSphere.set(new qe,1/0);if(e){var n=this.boundingSphere.center;if(Nn.setFromBufferAttribute(e),t)for(var r=0,i=t.length;r<i;r++){var a=t[r];Un.setFromBufferAttribute(a),this.morphTargetsRelative?(Bn.addVectors(Nn.min,Un.min),Nn.expandByPoint(Bn),Bn.addVectors(Nn.max,Un.max),Nn.expandByPoint(Bn)):(Nn.expandByPoint(Un.min),Nn.expandByPoint(Un.max))}Nn.getCenter(n);for(var o=0,s=0,l=e.count;s<l;s++)Bn.fromBufferAttribute(e,s),o=Math.max(o,n.distanceToSquared(Bn));if(t)for(var u=0,c=t.length;u<c;u++)for(var h=t[u],d=this.morphTargetsRelative,f=0,p=h.count;f<p;f++)Bn.fromBufferAttribute(h,f),d&&(Fn.fromBufferAttribute(e,f),Bn.add(Fn)),o=Math.max(o,n.distanceToSquared(Bn));this.boundingSphere.radius=Math.sqrt(o),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}},{key:"computeFaceNormals",value:function(){}},{key:"computeTangents",value:function(){var e=this.index,t=this.attributes;if(null!==e&&void 0!==t.position&&void 0!==t.normal&&void 0!==t.uv){var n=e.array,r=t.position.array,i=t.normal.array,a=t.uv.array,o=r.length/3;void 0===t.tangent&&this.setAttribute("tangent",new yn(new Float32Array(4*o),4));for(var s=t.tangent.array,l=[],u=[],c=0;c<o;c++)l[c]=new qe,u[c]=new qe;var h=new qe,d=new qe,f=new qe,p=new Ie,v=new Ie,m=new Ie,g=new qe,_=new qe,y=this.groups;0===y.length&&(y=[{start:0,count:n.length}]);for(var x=0,b=y.length;x<b;++x)for(var w=y[x],T=w.start,M=T,S=T+w.count;M<S;M+=3)F(n[M+0],n[M+1],n[M+2]);for(var E=new qe,A=new qe,L=new qe,C=new qe,R=0,k=y.length;R<k;++R)for(var P=y[R],D=P.start,I=D,O=D+P.count;I<O;I+=3)N(n[I+0]),N(n[I+1]),N(n[I+2])}else console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");function F(e,t,n){h.fromArray(r,3*e),d.fromArray(r,3*t),f.fromArray(r,3*n),p.fromArray(a,2*e),v.fromArray(a,2*t),m.fromArray(a,2*n),d.sub(h),f.sub(h),v.sub(p),m.sub(p);var i=1/(v.x*m.y-m.x*v.y);isFinite(i)&&(g.copy(d).multiplyScalar(m.y).addScaledVector(f,-v.y).multiplyScalar(i),_.copy(f).multiplyScalar(v.x).addScaledVector(d,-m.x).multiplyScalar(i),l[e].add(g),l[t].add(g),l[n].add(g),u[e].add(_),u[t].add(_),u[n].add(_))}function N(e){L.fromArray(i,3*e),C.copy(L);var t=l[e];E.copy(t),E.sub(L.multiplyScalar(L.dot(t))).normalize(),A.crossVectors(C,t);var n=A.dot(u[e])<0?-1:1;s[4*e]=E.x,s[4*e+1]=E.y,s[4*e+2]=E.z,s[4*e+3]=n}}},{key:"computeVertexNormals",value:function(){var e=this.index,t=this.getAttribute("position");if(void 0!==t){var n=this.getAttribute("normal");if(void 0===n)n=new yn(new Float32Array(3*t.count),3),this.setAttribute("normal",n);else for(var r=0,i=n.count;r<i;r++)n.setXYZ(r,0,0,0);var a=new qe,o=new qe,s=new qe,l=new qe,u=new qe,c=new qe,h=new qe,d=new qe;if(e)for(var f=0,p=e.count;f<p;f+=3){var v=e.getX(f+0),m=e.getX(f+1),g=e.getX(f+2);a.fromBufferAttribute(t,v),o.fromBufferAttribute(t,m),s.fromBufferAttribute(t,g),h.subVectors(s,o),d.subVectors(a,o),h.cross(d),l.fromBufferAttribute(n,v),u.fromBufferAttribute(n,m),c.fromBufferAttribute(n,g),l.add(h),u.add(h),c.add(h),n.setXYZ(v,l.x,l.y,l.z),n.setXYZ(m,u.x,u.y,u.z),n.setXYZ(g,c.x,c.y,c.z)}else for(var _=0,y=t.count;_<y;_+=3)a.fromBufferAttribute(t,_+0),o.fromBufferAttribute(t,_+1),s.fromBufferAttribute(t,_+2),h.subVectors(s,o),d.subVectors(a,o),h.cross(d),n.setXYZ(_+0,h.x,h.y,h.z),n.setXYZ(_+1,h.x,h.y,h.z),n.setXYZ(_+2,h.x,h.y,h.z);this.normalizeNormals(),n.needsUpdate=!0}}},{key:"merge",value:function(e,t){if(e&&e.isBufferGeometry){void 0===t&&(t=0,console.warn("THREE.BufferGeometry.merge(): Overwriting original geometry, starting at offset=0. Use BufferGeometryUtils.mergeBufferGeometries() for lossless merge."));var n=this.attributes;for(var r in n)if(void 0!==e.attributes[r])for(var i=n[r].array,a=e.attributes[r],o=a.array,s=a.itemSize*t,l=Math.min(o.length,i.length-s),u=0,c=s;u<l;u++,c++)i[c]=o[u];return this}console.error("THREE.BufferGeometry.merge(): geometry not an instance of THREE.BufferGeometry.",e)}},{key:"normalizeNormals",value:function(){for(var e=this.attributes.normal,t=0,n=e.count;t<n;t++)Bn.fromBufferAttribute(e,t),Bn.normalize(),e.setXYZ(t,Bn.x,Bn.y,Bn.z)}},{key:"toNonIndexed",value:function(){function e(e,t){for(var n=e.array,r=e.itemSize,i=e.normalized,a=new n.constructor(t.length*r),o=0,s=0,l=0,u=t.length;l<u;l++){o=e.isInterleavedBufferAttribute?t[l]*e.data.stride+e.offset:t[l]*r;for(var c=0;c<r;c++)a[s++]=n[o++]}return new yn(a,r,i)}if(null===this.index)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;var t=new n,r=this.index.array,i=this.attributes;for(var a in i){var o=e(i[a],r);t.setAttribute(a,o)}var s=this.morphAttributes;for(var l in s){for(var u=[],c=s[l],h=0,d=c.length;h<d;h++){var f=e(c[h],r);u.push(f)}t.morphAttributes[l]=u}t.morphTargetsRelative=this.morphTargetsRelative;for(var p=this.groups,v=0,m=p.length;v<m;v++){var g=p[v];t.addGroup(g.start,g.count,g.materialIndex)}return t}},{key:"toJSON",value:function(){var e={metadata:{version:4.5,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,""!==this.name&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),void 0!==this.parameters){var t=this.parameters;for(var n in t)void 0!==t[n]&&(e[n]=t[n]);return e}e.data={attributes:{}};var r=this.index;null!==r&&(e.data.index={type:r.array.constructor.name,array:Array.prototype.slice.call(r.array)});var i=this.attributes;for(var a in i){var o=i[a];e.data.attributes[a]=o.toJSON(e.data)}var s={},l=!1;for(var u in this.morphAttributes){for(var c=this.morphAttributes[u],h=[],d=0,f=c.length;d<f;d++){var p=c[d];h.push(p.toJSON(e.data))}h.length>0&&(s[u]=h,l=!0)}l&&(e.data.morphAttributes=s,e.data.morphTargetsRelative=this.morphTargetsRelative);var v=this.groups;v.length>0&&(e.data.groups=JSON.parse(JSON.stringify(v)));var m=this.boundingSphere;return null!==m&&(e.data.boundingSphere={center:m.center.toArray(),radius:m.radius}),e}},{key:"clone",value:function(){return(new n).copy(this)}},{key:"copy",value:function(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;var t={};this.name=e.name;var n=e.index;null!==n&&this.setIndex(n.clone(t));var r=e.attributes;for(var i in r){var a=r[i];this.setAttribute(i,a.clone(t))}var o=e.morphAttributes;for(var s in o){for(var l=[],u=o[s],c=0,h=u.length;c<h;c++)l.push(u[c].clone(t));this.morphAttributes[s]=l}this.morphTargetsRelative=e.morphTargetsRelative;for(var d=e.groups,f=0,p=d.length;f<p;f++){var v=d[f];this.addGroup(v.start,v.count,v.materialIndex)}var m=e.boundingBox;null!==m&&(this.boundingBox=m.clone());var g=e.boundingSphere;return null!==g&&(this.boundingSphere=g.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,this}},{key:"dispose",value:function(){this.dispatchEvent({type:"dispose"})}}]),n}(xe);zn.prototype.isBufferGeometry=!0;var Hn=new Tt,Gn=new wt,Vn=new pt,Wn=new qe,jn=new qe,qn=new qe,Xn=new qe,Yn=new qe,Kn=new qe,Zn=new qe,Jn=new qe,Qn=new qe,$n=new Ie,er=new Ie,tr=new Ie,nr=new qe,rr=new qe,ir=function(e){(0,d.default)(n,e);var t=b(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new zn,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new mn;return(0,v.default)(this,n),(e=t.call(this)).type="Mesh",e.geometry=r,e.material=i,e.updateMorphTargets(),e}return(0,m.default)(n,[{key:"copy",value:function(e){return(0,u.default)((0,p.default)(n.prototype),"copy",this).call(this,e),void 0!==e.morphTargetInfluences&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),void 0!==e.morphTargetDictionary&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=e.material,this.geometry=e.geometry,this}},{key:"updateMorphTargets",value:function(){var e=this.geometry;if(e.isBufferGeometry){var t=e.morphAttributes,n=Object.keys(t);if(n.length>0){var r=t[n[0]];if(void 0!==r){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(var i=0,a=r.length;i<a;i++){var o=r[i].name||String(i);this.morphTargetInfluences.push(0),this.morphTargetDictionary[o]=i}}}}else{var s=e.morphTargets;void 0!==s&&s.length>0&&console.error("THREE.Mesh.updateMorphTargets() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}}},{key:"raycast",value:function(e,t){var n,r=this.geometry,i=this.material,a=this.matrixWorld;if(void 0!==i&&(null===r.boundingSphere&&r.computeBoundingSphere(),Vn.copy(r.boundingSphere),Vn.applyMatrix4(a),!1!==e.ray.intersectsSphere(Vn)&&(Hn.copy(a).invert(),Gn.copy(e.ray).applyMatrix4(Hn),null===r.boundingBox||!1!==Gn.intersectsBox(r.boundingBox))))if(r.isBufferGeometry){var o=r.index,s=r.attributes.position,l=r.morphAttributes.position,u=r.morphTargetsRelative,c=r.attributes.uv,h=r.attributes.uv2,d=r.groups,f=r.drawRange;if(null!==o)if(Array.isArray(i))for(var p=0,v=d.length;p<v;p++)for(var m=d[p],g=i[m.materialIndex],_=Math.max(m.start,f.start),y=Math.min(m.start+m.count,f.start+f.count);_<y;_+=3){var x=o.getX(_),b=o.getX(_+1),w=o.getX(_+2);(n=ar(this,g,e,Gn,s,l,u,c,h,x,b,w))&&(n.faceIndex=Math.floor(_/3),n.face.materialIndex=m.materialIndex,t.push(n))}else for(var T=Math.max(0,f.start),M=Math.min(o.count,f.start+f.count);T<M;T+=3){var S=o.getX(T),E=o.getX(T+1),A=o.getX(T+2);(n=ar(this,i,e,Gn,s,l,u,c,h,S,E,A))&&(n.faceIndex=Math.floor(T/3),t.push(n))}else if(void 0!==s)if(Array.isArray(i))for(var L=0,C=d.length;L<C;L++)for(var R=d[L],k=i[R.materialIndex],P=Math.max(R.start,f.start),D=Math.min(R.start+R.count,f.start+f.count);P<D;P+=3)(n=ar(this,k,e,Gn,s,l,u,c,h,P,P+1,P+2))&&(n.faceIndex=Math.floor(P/3),n.face.materialIndex=R.materialIndex,t.push(n));else for(var I=Math.max(0,f.start),O=Math.min(s.count,f.start+f.count);I<O;I+=3)(n=ar(this,i,e,Gn,s,l,u,c,h,I,I+1,I+2))&&(n.faceIndex=Math.floor(I/3),t.push(n))}else r.isGeometry&&console.error("THREE.Mesh.raycast() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}}]),n}(Yt);function ar(e,t,n,r,i,a,o,s,l,u,c,h){Wn.fromBufferAttribute(i,u),jn.fromBufferAttribute(i,c),qn.fromBufferAttribute(i,h);var d=e.morphTargetInfluences;if(a&&d){Zn.set(0,0,0),Jn.set(0,0,0),Qn.set(0,0,0);for(var f=0,p=a.length;f<p;f++){var v=d[f],m=a[f];0!==v&&(Xn.fromBufferAttribute(m,u),Yn.fromBufferAttribute(m,c),Kn.fromBufferAttribute(m,h),o?(Zn.addScaledVector(Xn,v),Jn.addScaledVector(Yn,v),Qn.addScaledVector(Kn,v)):(Zn.addScaledVector(Xn.sub(Wn),v),Jn.addScaledVector(Yn.sub(jn),v),Qn.addScaledVector(Kn.sub(qn),v)))}Wn.add(Zn),jn.add(Jn),qn.add(Qn)}e.isSkinnedMesh&&(e.boneTransform(u,Wn),e.boneTransform(c,jn),e.boneTransform(h,qn));var g=function(e,t,n,r,i,a,o,s){if(null===(1===t.side?r.intersectTriangle(o,a,i,!0,s):r.intersectTriangle(i,a,o,2!==t.side,s)))return null;rr.copy(s),rr.applyMatrix4(e.matrixWorld);var l=n.ray.origin.distanceTo(rr);return l<n.near||l>n.far?null:{distance:l,point:rr.clone(),object:e}}(e,t,n,r,Wn,jn,qn,nr);if(g){s&&($n.fromBufferAttribute(s,u),er.fromBufferAttribute(s,c),tr.fromBufferAttribute(s,h),g.uv=on.getUV(nr,Wn,jn,qn,$n,er,tr,new Ie)),l&&($n.fromBufferAttribute(l,u),er.fromBufferAttribute(l,c),tr.fromBufferAttribute(l,h),g.uv2=on.getUV(nr,Wn,jn,qn,$n,er,tr,new Ie));var _={a:u,b:c,c:h,normal:new qe,materialIndex:0};on.getNormal(Wn,jn,qn,_.normal),g.face=_}return g}ir.prototype.isMesh=!0;var or=function(e){(0,d.default)(n,e);var t=b(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1,l=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1;(0,v.default)(this,n),(e=t.call(this)).type="BoxGeometry",e.parameters={width:r,height:i,depth:a,widthSegments:o,heightSegments:s,depthSegments:l};var u=(0,h.default)(e);o=Math.floor(o),s=Math.floor(s),l=Math.floor(l);var c=[],d=[],f=[],p=[],m=0,g=0;function _(e,t,n,r,i,a,o,s,l,h,v){for(var _=a/l,y=o/h,x=a/2,b=o/2,w=s/2,T=l+1,M=h+1,S=0,E=0,A=new qe,L=0;L<M;L++)for(var C=L*y-b,R=0;R<T;R++){var k=R*_-x;A[e]=k*r,A[t]=C*i,A[n]=w,d.push(A.x,A.y,A.z),A[e]=0,A[t]=0,A[n]=s>0?1:-1,f.push(A.x,A.y,A.z),p.push(R/l),p.push(1-L/h),S+=1}for(var P=0;P<h;P++)for(var D=0;D<l;D++){var I=m+D+T*P,O=m+D+T*(P+1),F=m+(D+1)+T*(P+1),N=m+(D+1)+T*P;c.push(I,O,N),c.push(O,F,N),E+=6}u.addGroup(g,E,v),g+=E,m+=S}return _("z","y","x",-1,-1,a,i,r,l,s,0),_("z","y","x",1,-1,a,i,-r,l,s,1),_("x","z","y",1,1,r,a,i,o,l,2),_("x","z","y",1,-1,r,a,-i,o,l,3),_("x","y","z",1,-1,r,i,a,o,s,4),_("x","y","z",-1,-1,r,i,-a,o,s,5),e.setIndex(c),e.setAttribute("position",new Ln(d,3)),e.setAttribute("normal",new Ln(f,3)),e.setAttribute("uv",new Ln(p,2)),e}return(0,m.default)(n,null,[{key:"fromJSON",value:function(e){return new n(e.width,e.height,e.depth,e.widthSegments,e.heightSegments,e.depthSegments)}}]),n}(zn);function sr(e){var t={};for(var n in e)for(var r in t[n]={},e[n]){var i=e[n][r];i&&(i.isColor||i.isMatrix3||i.isMatrix4||i.isVector2||i.isVector3||i.isVector4||i.isTexture||i.isQuaternion)?t[n][r]=i.clone():Array.isArray(i)?t[n][r]=i.slice():t[n][r]=i}return t}function lr(e){for(var t={},n=0;n<e.length;n++){var r=sr(e[n]);for(var i in r)t[i]=r[i]}return t}var ur={clone:sr,merge:lr},cr=function(e){(0,d.default)(n,e);var t=b(n);function n(e){var r;return(0,v.default)(this,n),(r=t.call(this)).type="ShaderMaterial",r.defines={},r.uniforms={},r.vertexShader="void main() {\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",r.fragmentShader="void main() {\n\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}",r.linewidth=1,r.wireframe=!1,r.wireframeLinewidth=1,r.fog=!1,r.lights=!1,r.clipping=!1,r.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},r.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},r.index0AttributeName=void 0,r.uniformsNeedUpdate=!1,r.glslVersion=null,void 0!==e&&(void 0!==e.attributes&&console.error("THREE.ShaderMaterial: attributes should now be defined in THREE.BufferGeometry instead."),r.setValues(e)),r}return(0,m.default)(n,[{key:"copy",value:function(e){return(0,u.default)((0,p.default)(n.prototype),"copy",this).call(this,e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=sr(e.uniforms),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.lights=e.lights,this.clipping=e.clipping,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this}},{key:"toJSON",value:function(e){var t=(0,u.default)((0,p.default)(n.prototype),"toJSON",this).call(this,e);for(var r in t.glslVersion=this.glslVersion,t.uniforms={},this.uniforms){var i=this.uniforms[r].value;i&&i.isTexture?t.uniforms[r]={type:"t",value:i.toJSON(e).uuid}:i&&i.isColor?t.uniforms[r]={type:"c",value:i.getHex()}:i&&i.isVector2?t.uniforms[r]={type:"v2",value:i.toArray()}:i&&i.isVector3?t.uniforms[r]={type:"v3",value:i.toArray()}:i&&i.isVector4?t.uniforms[r]={type:"v4",value:i.toArray()}:i&&i.isMatrix3?t.uniforms[r]={type:"m3",value:i.toArray()}:i&&i.isMatrix4?t.uniforms[r]={type:"m4",value:i.toArray()}:t.uniforms[r]={value:i}}Object.keys(this.defines).length>0&&(t.defines=this.defines),t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader;var a={};for(var o in this.extensions)!0===this.extensions[o]&&(a[o]=!0);return Object.keys(a).length>0&&(t.extensions=a),t}}]),n}(ln);cr.prototype.isShaderMaterial=!0;var hr=function(e){(0,d.default)(n,e);var t=b(n);function n(){var e;return(0,v.default)(this,n),(e=t.call(this)).type="Camera",e.matrixWorldInverse=new Tt,e.projectionMatrix=new Tt,e.projectionMatrixInverse=new Tt,e}return(0,m.default)(n,[{key:"copy",value:function(e,t){return(0,u.default)((0,p.default)(n.prototype),"copy",this).call(this,e,t),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this}},{key:"getWorldDirection",value:function(e){this.updateWorldMatrix(!0,!1);var t=this.matrixWorld.elements;return e.set(-t[8],-t[9],-t[10]).normalize()}},{key:"updateMatrixWorld",value:function(e){(0,u.default)((0,p.default)(n.prototype),"updateMatrixWorld",this).call(this,e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}},{key:"updateWorldMatrix",value:function(e,t){(0,u.default)((0,p.default)(n.prototype),"updateWorldMatrix",this).call(this,e,t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}},{key:"clone",value:function(){return(new this.constructor).copy(this)}}]),n}(Yt);hr.prototype.isCamera=!0;var dr=function(e){(0,d.default)(n,e);var t=b(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:50,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.1,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2e3;return(0,v.default)(this,n),(e=t.call(this)).type="PerspectiveCamera",e.fov=r,e.zoom=1,e.near=a,e.far=o,e.focus=10,e.aspect=i,e.view=null,e.filmGauge=35,e.filmOffset=0,e.updateProjectionMatrix(),e}return(0,m.default)(n,[{key:"copy",value:function(e,t){return(0,u.default)((0,p.default)(n.prototype),"copy",this).call(this,e,t),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=null===e.view?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this}},{key:"setFocalLength",value:function(e){var t=.5*this.getFilmHeight()/e;this.fov=2*Se*Math.atan(t),this.updateProjectionMatrix()}},{key:"getFocalLength",value:function(){var e=Math.tan(.5*Me*this.fov);return.5*this.getFilmHeight()/e}},{key:"getEffectiveFOV",value:function(){return 2*Se*Math.atan(Math.tan(.5*Me*this.fov)/this.zoom)}},{key:"getFilmWidth",value:function(){return this.filmGauge*Math.min(this.aspect,1)}},{key:"getFilmHeight",value:function(){return this.filmGauge/Math.max(this.aspect,1)}},{key:"setViewOffset",value:function(e,t,n,r,i,a){this.aspect=e/t,null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=n,this.view.offsetY=r,this.view.width=i,this.view.height=a,this.updateProjectionMatrix()}},{key:"clearViewOffset",value:function(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}},{key:"updateProjectionMatrix",value:function(){var e=this.near,t=e*Math.tan(.5*Me*this.fov)/this.zoom,n=2*t,r=this.aspect*n,i=-.5*r,a=this.view;if(null!==this.view&&this.view.enabled){var o=a.fullWidth,s=a.fullHeight;i+=a.offsetX*r/o,t-=a.offsetY*n/s,r*=a.width/o,n*=a.height/s}var l=this.filmOffset;0!==l&&(i+=e*l/this.getFilmWidth()),this.projectionMatrix.makePerspective(i,i+r,t,t-n,e,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}},{key:"toJSON",value:function(e){var t=(0,u.default)((0,p.default)(n.prototype),"toJSON",this).call(this,e);return t.object.fov=this.fov,t.object.zoom=this.zoom,t.object.near=this.near,t.object.far=this.far,t.object.focus=this.focus,t.object.aspect=this.aspect,null!==this.view&&(t.object.view=Object.assign({},this.view)),t.object.filmGauge=this.filmGauge,t.object.filmOffset=this.filmOffset,t}}]),n}(hr);dr.prototype.isPerspectiveCamera=!0;var fr=90,pr=function(e){(0,d.default)(n,e);var t=b(n);function n(e,r,i){var a;if((0,v.default)(this,n),(a=t.call(this)).type="CubeCamera",!0!==i.isWebGLCubeRenderTarget)return console.error("THREE.CubeCamera: The constructor now expects an instance of WebGLCubeRenderTarget as third parameter."),(0,f.default)(a);a.renderTarget=i;var o=new dr(fr,1,e,r);o.layers=a.layers,o.up.set(0,-1,0),o.lookAt(new qe(1,0,0)),a.add(o);var s=new dr(fr,1,e,r);s.layers=a.layers,s.up.set(0,-1,0),s.lookAt(new qe(-1,0,0)),a.add(s);var l=new dr(fr,1,e,r);l.layers=a.layers,l.up.set(0,0,1),l.lookAt(new qe(0,1,0)),a.add(l);var u=new dr(fr,1,e,r);u.layers=a.layers,u.up.set(0,0,-1),u.lookAt(new qe(0,-1,0)),a.add(u);var c=new dr(fr,1,e,r);c.layers=a.layers,c.up.set(0,-1,0),c.lookAt(new qe(0,0,1)),a.add(c);var h=new dr(fr,1,e,r);return h.layers=a.layers,h.up.set(0,-1,0),h.lookAt(new qe(0,0,-1)),a.add(h),a}return(0,m.default)(n,[{key:"update",value:function(e,t){null===this.parent&&this.updateMatrixWorld();var n=this.renderTarget,r=(0,l.default)(this.children,6),i=r[0],a=r[1],o=r[2],s=r[3],u=r[4],c=r[5],h=e.xr.enabled,d=e.getRenderTarget();e.xr.enabled=!1;var f=n.texture.generateMipmaps;n.texture.generateMipmaps=!1,e.setRenderTarget(n,0),e.render(t,i),e.setRenderTarget(n,1),e.render(t,a),e.setRenderTarget(n,2),e.render(t,o),e.setRenderTarget(n,3),e.render(t,s),e.setRenderTarget(n,4),e.render(t,u),n.texture.generateMipmaps=f,e.setRenderTarget(n,5),e.render(t,c),e.setRenderTarget(d),e.xr.enabled=h}}]),n}(Yt),vr=function(e){(0,d.default)(n,e);var t=b(n);function n(e,r,i,o,s,l,u,c,h,d){var f;return(0,v.default)(this,n),e=void 0!==e?e:[],r=void 0!==r?r:a,u=void 0!==u?u:z,(f=t.call(this,e,r,i,o,s,l,u,c,h,d)).flipY=!1,f}return(0,m.default)(n,[{key:"images",get:function(){return this.image},set:function(e){this.image=e}}]),n}(Be);vr.prototype.isCubeTexture=!0;var mr=function(e){(0,d.default)(n,e);var t=b(n);function n(e,r,i){var a;return(0,v.default)(this,n),Number.isInteger(r)&&(console.warn("THREE.WebGLCubeRenderTarget: constructor signature is now WebGLCubeRenderTarget( size, options )"),r=i),a=t.call(this,e,e,r),r=r||{},a.texture=new vr(void 0,r.mapping,r.wrapS,r.wrapT,r.magFilter,r.minFilter,r.format,r.type,r.anisotropy,r.encoding),a.texture.isRenderTargetTexture=!0,a.texture.generateMipmaps=void 0!==r.generateMipmaps&&r.generateMipmaps,a.texture.minFilter=void 0!==r.minFilter?r.minFilter:k,a.texture._needsFlipEnvMap=!1,a}return(0,m.default)(n,[{key:"fromEquirectangularTexture",value:function(e,t){this.texture.type=t.type,this.texture.format=H,this.texture.encoding=t.encoding,this.texture.generateMipmaps=t.generateMipmaps,this.texture.minFilter=t.minFilter,this.texture.magFilter=t.magFilter;var n={tEquirect:{value:null}},r="\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\tvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\n\t\t\t\t\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n\n\t\t\t\t}\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvWorldDirection = transformDirection( position, modelMatrix );\n\n\t\t\t\t\t#include <begin_vertex>\n\t\t\t\t\t#include <project_vertex>\n\n\t\t\t\t}\n\t\t\t",i="\n\n\t\t\t\tuniform sampler2D tEquirect;\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\t#include <common>\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvec3 direction = normalize( vWorldDirection );\n\n\t\t\t\t\tvec2 sampleUV = equirectUv( direction );\n\n\t\t\t\t\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\n\t\t\t\t}\n\t\t\t",a=new or(5,5,5),o=new cr({name:"CubemapFromEquirect",uniforms:sr(n),vertexShader:r,fragmentShader:i,side:1,blending:0});o.uniforms.tEquirect.value=t;var s=new ir(a,o),l=t.minFilter;return t.minFilter===D&&(t.minFilter=k),new pr(1,10,this).update(e,s),t.minFilter=l,s.geometry.dispose(),s.material.dispose(),this}},{key:"clear",value:function(e,t,n,r){for(var i=e.getRenderTarget(),a=0;a<6;a++)e.setRenderTarget(this,a),e.clear(t,n,r);e.setRenderTarget(i)}}]),n}(Ge);mr.prototype.isWebGLCubeRenderTarget=!0;var gr=new qe,_r=new qe,yr=new Fe,xr=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new qe(1,0,0),n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;(0,v.default)(this,e),this.normal=t,this.constant=n}return(0,m.default)(e,[{key:"set",value:function(e,t){return this.normal.copy(e),this.constant=t,this}},{key:"setComponents",value:function(e,t,n,r){return this.normal.set(e,t,n),this.constant=r,this}},{key:"setFromNormalAndCoplanarPoint",value:function(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this}},{key:"setFromCoplanarPoints",value:function(e,t,n){var r=gr.subVectors(n,t).cross(_r.subVectors(e,t)).normalize();return this.setFromNormalAndCoplanarPoint(r,e),this}},{key:"copy",value:function(e){return this.normal.copy(e.normal),this.constant=e.constant,this}},{key:"normalize",value:function(){var e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}},{key:"negate",value:function(){return this.constant*=-1,this.normal.negate(),this}},{key:"distanceToPoint",value:function(e){return this.normal.dot(e)+this.constant}},{key:"distanceToSphere",value:function(e){return this.distanceToPoint(e.center)-e.radius}},{key:"projectPoint",value:function(e,t){return t.copy(this.normal).multiplyScalar(-this.distanceToPoint(e)).add(e)}},{key:"intersectLine",value:function(e,t){var n=e.delta(gr),r=this.normal.dot(n);if(0===r)return 0===this.distanceToPoint(e.start)?t.copy(e.start):null;var i=-(e.start.dot(this.normal)+this.constant)/r;return i<0||i>1?null:t.copy(n).multiplyScalar(i).add(e.start)}},{key:"intersectsLine",value:function(e){var t=this.distanceToPoint(e.start),n=this.distanceToPoint(e.end);return t<0&&n>0||n<0&&t>0}},{key:"intersectsBox",value:function(e){return e.intersectsPlane(this)}},{key:"intersectsSphere",value:function(e){return e.intersectsPlane(this)}},{key:"coplanarPoint",value:function(e){return e.copy(this.normal).multiplyScalar(-this.constant)}},{key:"applyMatrix4",value:function(e,t){var n=t||yr.getNormalMatrix(e),r=this.coplanarPoint(gr).applyMatrix4(e),i=this.normal.applyMatrix3(n).normalize();return this.constant=-r.dot(i),this}},{key:"translate",value:function(e){return this.constant-=e.dot(this.normal),this}},{key:"equals",value:function(e){return e.normal.equals(this.normal)&&e.constant===this.constant}},{key:"clone",value:function(){return(new this.constructor).copy(this)}}]),e}();xr.prototype.isPlane=!0;var br=new pt,wr=new qe,Tr=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new xr,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new xr,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new xr,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:new xr,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:new xr,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:new xr;(0,v.default)(this,e),this.planes=[t,n,r,i,a,o]}return(0,m.default)(e,[{key:"set",value:function(e,t,n,r,i,a){var o=this.planes;return o[0].copy(e),o[1].copy(t),o[2].copy(n),o[3].copy(r),o[4].copy(i),o[5].copy(a),this}},{key:"copy",value:function(e){for(var t=this.planes,n=0;n<6;n++)t[n].copy(e.planes[n]);return this}},{key:"setFromProjectionMatrix",value:function(e){var t=this.planes,n=e.elements,r=n[0],i=n[1],a=n[2],o=n[3],s=n[4],l=n[5],u=n[6],c=n[7],h=n[8],d=n[9],f=n[10],p=n[11],v=n[12],m=n[13],g=n[14],_=n[15];return t[0].setComponents(o-r,c-s,p-h,_-v).normalize(),t[1].setComponents(o+r,c+s,p+h,_+v).normalize(),t[2].setComponents(o+i,c+l,p+d,_+m).normalize(),t[3].setComponents(o-i,c-l,p-d,_-m).normalize(),t[4].setComponents(o-a,c-u,p-f,_-g).normalize(),t[5].setComponents(o+a,c+u,p+f,_+g).normalize(),this}},{key:"intersectsObject",value:function(e){var t=e.geometry;return null===t.boundingSphere&&t.computeBoundingSphere(),br.copy(t.boundingSphere).applyMatrix4(e.matrixWorld),this.intersectsSphere(br)}},{key:"intersectsSprite",value:function(e){return br.center.set(0,0,0),br.radius=.7071067811865476,br.applyMatrix4(e.matrixWorld),this.intersectsSphere(br)}},{key:"intersectsSphere",value:function(e){for(var t=this.planes,n=e.center,r=-e.radius,i=0;i<6;i++)if(t[i].distanceToPoint(n)<r)return!1;return!0}},{key:"intersectsBox",value:function(e){for(var t=this.planes,n=0;n<6;n++){var r=t[n];if(wr.x=r.normal.x>0?e.max.x:e.min.x,wr.y=r.normal.y>0?e.max.y:e.min.y,wr.z=r.normal.z>0?e.max.z:e.min.z,r.distanceToPoint(wr)<0)return!1}return!0}},{key:"containsPoint",value:function(e){for(var t=this.planes,n=0;n<6;n++)if(t[n].distanceToPoint(e)<0)return!1;return!0}},{key:"clone",value:function(){return(new this.constructor).copy(this)}}]),e}();function Mr(){var e=null,t=!1,n=null,r=null;function i(t,a){n(t,a),r=e.requestAnimationFrame(i)}return{start:function(){!0!==t&&null!==n&&(r=e.requestAnimationFrame(i),t=!0)},stop:function(){e.cancelAnimationFrame(r),t=!1},setAnimationLoop:function(e){n=e},setContext:function(t){e=t}}}function Sr(e,t){var n=t.isWebGL2,r=new WeakMap;return{get:function(e){return e.isInterleavedBufferAttribute&&(e=e.data),r.get(e)},remove:function(t){t.isInterleavedBufferAttribute&&(t=t.data);var n=r.get(t);n&&(e.deleteBuffer(n.buffer),r.delete(t))},update:function(t,i){if(t.isGLBufferAttribute){var a=r.get(t);(!a||a.version<t.version)&&r.set(t,{buffer:t.buffer,type:t.type,bytesPerElement:t.elementSize,version:t.version})}else{t.isInterleavedBufferAttribute&&(t=t.data);var o=r.get(t);void 0===o?r.set(t,function(t,r){var i=t.array,a=t.usage,o=e.createBuffer();e.bindBuffer(r,o),e.bufferData(r,i,a),t.onUploadCallback();var s=e.FLOAT;return i instanceof Float32Array?s=e.FLOAT:i instanceof Float64Array?console.warn("THREE.WebGLAttributes: Unsupported data buffer format: Float64Array."):i instanceof Uint16Array?t.isFloat16BufferAttribute?n?s=e.HALF_FLOAT:console.warn("THREE.WebGLAttributes: Usage of Float16BufferAttribute requires WebGL2."):s=e.UNSIGNED_SHORT:i instanceof Int16Array?s=e.SHORT:i instanceof Uint32Array?s=e.UNSIGNED_INT:i instanceof Int32Array?s=e.INT:i instanceof Int8Array?s=e.BYTE:(i instanceof Uint8Array||i instanceof Uint8ClampedArray)&&(s=e.UNSIGNED_BYTE),{buffer:o,type:s,bytesPerElement:i.BYTES_PER_ELEMENT,version:t.version}}(t,i)):o.version<t.version&&(function(t,r,i){var a=r.array,o=r.updateRange;e.bindBuffer(i,t),-1===o.count?e.bufferSubData(i,0,a):(n?e.bufferSubData(i,o.offset*a.BYTES_PER_ELEMENT,a,o.offset,o.count):e.bufferSubData(i,o.offset*a.BYTES_PER_ELEMENT,a.subarray(o.offset,o.offset+o.count)),o.count=-1)}(o.buffer,t,i),o.version=t.version)}}}}var Er=function(e){(0,d.default)(n,e);var t=b(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;(0,v.default)(this,n),(e=t.call(this)).type="PlaneGeometry",e.parameters={width:r,height:i,widthSegments:a,heightSegments:o};for(var s=r/2,l=i/2,u=Math.floor(a),c=Math.floor(o),h=u+1,d=c+1,f=r/u,p=i/c,m=[],g=[],_=[],y=[],x=0;x<d;x++)for(var b=x*p-l,w=0;w<h;w++){var T=w*f-s;g.push(T,-b,0),_.push(0,0,1),y.push(w/u),y.push(1-x/c)}for(var M=0;M<c;M++)for(var S=0;S<u;S++){var E=S+h*M,A=S+h*(M+1),L=S+1+h*(M+1),C=S+1+h*M;m.push(E,A,C),m.push(A,L,C)}return e.setIndex(m),e.setAttribute("position",new Ln(g,3)),e.setAttribute("normal",new Ln(_,3)),e.setAttribute("uv",new Ln(y,2)),e}return(0,m.default)(n,null,[{key:"fromJSON",value:function(e){return new n(e.width,e.height,e.widthSegments,e.heightSegments)}}]),n}(zn),Ar={alphamap_fragment:"#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, vUv ).g;\n#endif",alphamap_pars_fragment:"#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",alphatest_fragment:"#ifdef ALPHATEST\n\tif ( diffuseColor.a < ALPHATEST ) discard;\n#endif",aomap_fragment:"#ifdef USE_AOMAP\n\tfloat ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;\n\treflectedLight.indirectDiffuse *= ambientOcclusion;\n\t#if defined( USE_ENVMAP ) && defined( STANDARD )\n\t\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\t\treflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.specularRoughness );\n\t#endif\n#endif",aomap_pars_fragment:"#ifdef USE_AOMAP\n\tuniform sampler2D aoMap;\n\tuniform float aoMapIntensity;\n#endif",begin_vertex:"vec3 transformed = vec3( position );",beginnormal_vertex:"vec3 objectNormal = vec3( normal );\n#ifdef USE_TANGENT\n\tvec3 objectTangent = vec3( tangent.xyz );\n#endif",bsdfs:"vec2 integrateSpecularBRDF( const in float dotNV, const in float roughness ) {\n\tconst vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );\n\tconst vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );\n\tvec4 r = roughness * c0 + c1;\n\tfloat a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;\n\treturn vec2( -1.04, 1.04 ) * a004 + r.zw;\n}\nfloat punctualLightIntensityToIrradianceFactor( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {\n#if defined ( PHYSICALLY_CORRECT_LIGHTS )\n\tfloat distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );\n\tif( cutoffDistance > 0.0 ) {\n\t\tdistanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );\n\t}\n\treturn distanceFalloff;\n#else\n\tif( cutoffDistance > 0.0 && decayExponent > 0.0 ) {\n\t\treturn pow( saturate( -lightDistance / cutoffDistance + 1.0 ), decayExponent );\n\t}\n\treturn 1.0;\n#endif\n}\nvec3 BRDF_Diffuse_Lambert( const in vec3 diffuseColor ) {\n\treturn RECIPROCAL_PI * diffuseColor;\n}\nvec3 F_Schlick( const in vec3 f0, const in vec3 f90, const in float dotVH ) {\n\tfloat fresnel = exp2( ( -5.55473 * dotVH - 6.98316 ) * dotVH );\n\treturn ( f90 - f0 ) * fresnel + f0;\n}\nvec3 F_Schlick_RoughnessDependent( const in vec3 F0, const in float dotNV, const in float roughness ) {\n\tfloat fresnel = exp2( ( -5.55473 * dotNV - 6.98316 ) * dotNV );\n\tvec3 Fr = max( vec3( 1.0 - roughness ), F0 ) - F0;\n\treturn Fr * fresnel + F0;\n}\nfloat G_GGX_Smith( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gl = dotNL + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\tfloat gv = dotNV + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\treturn 1.0 / ( gl * gv );\n}\nfloat G_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\tfloat gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\treturn 0.5 / max( gv + gl, EPSILON );\n}\nfloat D_GGX( const in float alpha, const in float dotNH ) {\n\tfloat a2 = pow2( alpha );\n\tfloat denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;\n\treturn RECIPROCAL_PI * a2 / pow2( denom );\n}\nvec3 BRDF_Specular_GGX( const in IncidentLight incidentLight, const in vec3 viewDir, const in vec3 normal, const in vec3 f0, const in vec3 f90, const in float roughness ) {\n\tfloat alpha = pow2( roughness );\n\tvec3 halfDir = normalize( incidentLight.direction + viewDir );\n\tfloat dotNL = saturate( dot( normal, incidentLight.direction ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotLH = saturate( dot( incidentLight.direction, halfDir ) );\n\tvec3 F = F_Schlick( f0, f90, dotLH );\n\tfloat G = G_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\tfloat D = D_GGX( alpha, dotNH );\n\treturn F * ( G * D );\n}\nvec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {\n\tconst float LUT_SIZE = 64.0;\n\tconst float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;\n\tconst float LUT_BIAS = 0.5 / LUT_SIZE;\n\tfloat dotNV = saturate( dot( N, V ) );\n\tvec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );\n\tuv = uv * LUT_SCALE + LUT_BIAS;\n\treturn uv;\n}\nfloat LTC_ClippedSphereFormFactor( const in vec3 f ) {\n\tfloat l = length( f );\n\treturn max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );\n}\nvec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {\n\tfloat x = dot( v1, v2 );\n\tfloat y = abs( x );\n\tfloat a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;\n\tfloat b = 3.4175940 + ( 4.1616724 + y ) * y;\n\tfloat v = a / b;\n\tfloat theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;\n\treturn cross( v1, v2 ) * theta_sintheta;\n}\nvec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {\n\tvec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];\n\tvec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];\n\tvec3 lightNormal = cross( v1, v2 );\n\tif( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );\n\tvec3 T1, T2;\n\tT1 = normalize( V - N * dot( V, N ) );\n\tT2 = - cross( N, T1 );\n\tmat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );\n\tvec3 coords[ 4 ];\n\tcoords[ 0 ] = mat * ( rectCoords[ 0 ] - P );\n\tcoords[ 1 ] = mat * ( rectCoords[ 1 ] - P );\n\tcoords[ 2 ] = mat * ( rectCoords[ 2 ] - P );\n\tcoords[ 3 ] = mat * ( rectCoords[ 3 ] - P );\n\tcoords[ 0 ] = normalize( coords[ 0 ] );\n\tcoords[ 1 ] = normalize( coords[ 1 ] );\n\tcoords[ 2 ] = normalize( coords[ 2 ] );\n\tcoords[ 3 ] = normalize( coords[ 3 ] );\n\tvec3 vectorFormFactor = vec3( 0.0 );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );\n\tfloat result = LTC_ClippedSphereFormFactor( vectorFormFactor );\n\treturn vec3( result );\n}\nvec3 BRDF_Specular_GGX_Environment( const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float roughness ) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tvec2 brdf = integrateSpecularBRDF( dotNV, roughness );\n\treturn specularColor * brdf.x + brdf.y;\n}\nvoid BRDF_Specular_Multiscattering_Environment( const in GeometricContext geometry, const in vec3 specularColor, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\tvec3 F = F_Schlick_RoughnessDependent( specularColor, dotNV, roughness );\n\tvec2 brdf = integrateSpecularBRDF( dotNV, roughness );\n\tvec3 FssEss = F * brdf.x + brdf.y;\n\tfloat Ess = brdf.x + brdf.y;\n\tfloat Ems = 1.0 - Ess;\n\tvec3 Favg = specularColor + ( 1.0 - specularColor ) * 0.047619;\tvec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );\n\tsingleScatter += FssEss;\n\tmultiScatter += Fms * Ems;\n}\nfloat G_BlinnPhong_Implicit( ) {\n\treturn 0.25;\n}\nfloat D_BlinnPhong( const in float shininess, const in float dotNH ) {\n\treturn RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\n}\nvec3 BRDF_Specular_BlinnPhong( const in IncidentLight incidentLight, const in GeometricContext geometry, const in vec3 specularColor, const in float shininess ) {\n\tvec3 halfDir = normalize( incidentLight.direction + geometry.viewDir );\n\tfloat dotNH = saturate( dot( geometry.normal, halfDir ) );\n\tfloat dotLH = saturate( dot( incidentLight.direction, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, vec3( 1.0 ), dotLH );\n\tfloat G = G_BlinnPhong_Implicit( );\n\tfloat D = D_BlinnPhong( shininess, dotNH );\n\treturn F * ( G * D );\n}\nfloat GGXRoughnessToBlinnExponent( const in float ggxRoughness ) {\n\treturn ( 2.0 / pow2( ggxRoughness + 0.0001 ) - 2.0 );\n}\nfloat BlinnExponentToGGXRoughness( const in float blinnExponent ) {\n\treturn sqrt( 2.0 / ( blinnExponent + 2.0 ) );\n}\n#if defined( USE_SHEEN )\nfloat D_Charlie(float roughness, float NoH) {\n\tfloat invAlpha = 1.0 / roughness;\n\tfloat cos2h = NoH * NoH;\n\tfloat sin2h = max(1.0 - cos2h, 0.0078125);\treturn (2.0 + invAlpha) * pow(sin2h, invAlpha * 0.5) / (2.0 * PI);\n}\nfloat V_Neubelt(float NoV, float NoL) {\n\treturn saturate(1.0 / (4.0 * (NoL + NoV - NoL * NoV)));\n}\nvec3 BRDF_Specular_Sheen( const in float roughness, const in vec3 L, const in GeometricContext geometry, vec3 specularColor ) {\n\tvec3 N = geometry.normal;\n\tvec3 V = geometry.viewDir;\n\tvec3 H = normalize( V + L );\n\tfloat dotNH = saturate( dot( N, H ) );\n\treturn specularColor * D_Charlie( roughness, dotNH ) * V_Neubelt( dot(N, V), dot(N, L) );\n}\n#endif",bumpmap_pars_fragment:"#ifdef USE_BUMPMAP\n\tuniform sampler2D bumpMap;\n\tuniform float bumpScale;\n\tvec2 dHdxy_fwd() {\n\t\tvec2 dSTdx = dFdx( vUv );\n\t\tvec2 dSTdy = dFdy( vUv );\n\t\tfloat Hll = bumpScale * texture2D( bumpMap, vUv ).x;\n\t\tfloat dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;\n\t\tfloat dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;\n\t\treturn vec2( dBx, dBy );\n\t}\n\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {\n\t\tvec3 vSigmaX = vec3( dFdx( surf_pos.x ), dFdx( surf_pos.y ), dFdx( surf_pos.z ) );\n\t\tvec3 vSigmaY = vec3( dFdy( surf_pos.x ), dFdy( surf_pos.y ), dFdy( surf_pos.z ) );\n\t\tvec3 vN = surf_norm;\n\t\tvec3 R1 = cross( vSigmaY, vN );\n\t\tvec3 R2 = cross( vN, vSigmaX );\n\t\tfloat fDet = dot( vSigmaX, R1 ) * faceDirection;\n\t\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n\t\treturn normalize( abs( fDet ) * surf_norm - vGrad );\n\t}\n#endif",clipping_planes_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvec4 plane;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {\n\t\tplane = clippingPlanes[ i ];\n\t\tif ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;\n\t}\n\t#pragma unroll_loop_end\n\t#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n\t\tbool clipped = true;\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n\t\t\tplane = clippingPlanes[ i ];\n\t\t\tclipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t\tif ( clipped ) discard;\n\t#endif\n#endif",clipping_planes_pars_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n\tuniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];\n#endif",clipping_planes_pars_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n#endif",clipping_planes_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvClipPosition = - mvPosition.xyz;\n#endif",color_fragment:"#if defined( USE_COLOR_ALPHA )\n\tdiffuseColor *= vColor;\n#elif defined( USE_COLOR )\n\tdiffuseColor.rgb *= vColor;\n#endif",color_pars_fragment:"#if defined( USE_COLOR_ALPHA )\n\tvarying vec4 vColor;\n#elif defined( USE_COLOR )\n\tvarying vec3 vColor;\n#endif",color_pars_vertex:"#if defined( USE_COLOR_ALPHA )\n\tvarying vec4 vColor;\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )\n\tvarying vec3 vColor;\n#endif",color_vertex:"#if defined( USE_COLOR_ALPHA )\n\tvColor = vec4( 1.0 );\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )\n\tvColor = vec3( 1.0 );\n#endif\n#ifdef USE_COLOR\n\tvColor *= color;\n#endif\n#ifdef USE_INSTANCING_COLOR\n\tvColor.xyz *= instanceColor.xyz;\n#endif",common:"#define PI 3.141592653589793\n#define PI2 6.283185307179586\n#define PI_HALF 1.5707963267948966\n#define RECIPROCAL_PI 0.3183098861837907\n#define RECIPROCAL_PI2 0.15915494309189535\n#define EPSILON 1e-6\n#ifndef saturate\n#define saturate(a) clamp( a, 0.0, 1.0 )\n#endif\n#define whiteComplement(a) ( 1.0 - saturate( a ) )\nfloat pow2( const in float x ) { return x*x; }\nfloat pow3( const in float x ) { return x*x*x; }\nfloat pow4( const in float x ) { float x2 = x*x; return x2*x2; }\nfloat average( const in vec3 color ) { return dot( color, vec3( 0.3333 ) ); }\nhighp float rand( const in vec2 uv ) {\n\tconst highp float a = 12.9898, b = 78.233, c = 43758.5453;\n\thighp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );\n\treturn fract(sin(sn) * c);\n}\n#ifdef HIGH_PRECISION\n\tfloat precisionSafeLength( vec3 v ) { return length( v ); }\n#else\n\tfloat max3( vec3 v ) { return max( max( v.x, v.y ), v.z ); }\n\tfloat precisionSafeLength( vec3 v ) {\n\t\tfloat maxComponent = max3( abs( v ) );\n\t\treturn length( v / maxComponent ) * maxComponent;\n\t}\n#endif\nstruct IncidentLight {\n\tvec3 color;\n\tvec3 direction;\n\tbool visible;\n};\nstruct ReflectedLight {\n\tvec3 directDiffuse;\n\tvec3 directSpecular;\n\tvec3 indirectDiffuse;\n\tvec3 indirectSpecular;\n};\nstruct GeometricContext {\n\tvec3 position;\n\tvec3 normal;\n\tvec3 viewDir;\n#ifdef CLEARCOAT\n\tvec3 clearcoatNormal;\n#endif\n};\nvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n}\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\n}\nvec3 projectOnPlane(in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\tfloat distance = dot( planeNormal, point - pointOnPlane );\n\treturn - distance * planeNormal + point;\n}\nfloat sideOfPlane( in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\treturn sign( dot( point - pointOnPlane, planeNormal ) );\n}\nvec3 linePlaneIntersect( in vec3 pointOnLine, in vec3 lineDirection, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\treturn lineDirection * ( dot( planeNormal, pointOnPlane - pointOnLine ) / dot( planeNormal, lineDirection ) ) + pointOnLine;\n}\nmat3 transposeMat3( const in mat3 m ) {\n\tmat3 tmp;\n\ttmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );\n\ttmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );\n\ttmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );\n\treturn tmp;\n}\nfloat linearToRelativeLuminance( const in vec3 color ) {\n\tvec3 weights = vec3( 0.2126, 0.7152, 0.0722 );\n\treturn dot( weights, color.rgb );\n}\nbool isPerspectiveMatrix( mat4 m ) {\n\treturn m[ 2 ][ 3 ] == - 1.0;\n}\nvec2 equirectUv( in vec3 dir ) {\n\tfloat u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;\n\tfloat v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\treturn vec2( u, v );\n}",cube_uv_reflection_fragment:"#ifdef ENVMAP_TYPE_CUBE_UV\n\t#define cubeUV_maxMipLevel 8.0\n\t#define cubeUV_minMipLevel 4.0\n\t#define cubeUV_maxTileSize 256.0\n\t#define cubeUV_minTileSize 16.0\n\tfloat getFace( vec3 direction ) {\n\t\tvec3 absDirection = abs( direction );\n\t\tfloat face = - 1.0;\n\t\tif ( absDirection.x > absDirection.z ) {\n\t\t\tif ( absDirection.x > absDirection.y )\n\t\t\t\tface = direction.x > 0.0 ? 0.0 : 3.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t} else {\n\t\t\tif ( absDirection.z > absDirection.y )\n\t\t\t\tface = direction.z > 0.0 ? 2.0 : 5.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t}\n\t\treturn face;\n\t}\n\tvec2 getUV( vec3 direction, float face ) {\n\t\tvec2 uv;\n\t\tif ( face == 0.0 ) {\n\t\t\tuv = vec2( direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 1.0 ) {\n\t\t\tuv = vec2( - direction.x, - direction.z ) / abs( direction.y );\n\t\t} else if ( face == 2.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.y ) / abs( direction.z );\n\t\t} else if ( face == 3.0 ) {\n\t\t\tuv = vec2( - direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 4.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.z ) / abs( direction.y );\n\t\t} else {\n\t\t\tuv = vec2( direction.x, direction.y ) / abs( direction.z );\n\t\t}\n\t\treturn 0.5 * ( uv + 1.0 );\n\t}\n\tvec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {\n\t\tfloat face = getFace( direction );\n\t\tfloat filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );\n\t\tmipInt = max( mipInt, cubeUV_minMipLevel );\n\t\tfloat faceSize = exp2( mipInt );\n\t\tfloat texelSize = 1.0 / ( 3.0 * cubeUV_maxTileSize );\n\t\tvec2 uv = getUV( direction, face ) * ( faceSize - 1.0 );\n\t\tvec2 f = fract( uv );\n\t\tuv += 0.5 - f;\n\t\tif ( face > 2.0 ) {\n\t\t\tuv.y += faceSize;\n\t\t\tface -= 3.0;\n\t\t}\n\t\tuv.x += face * faceSize;\n\t\tif ( mipInt < cubeUV_maxMipLevel ) {\n\t\t\tuv.y += 2.0 * cubeUV_maxTileSize;\n\t\t}\n\t\tuv.y += filterInt * 2.0 * cubeUV_minTileSize;\n\t\tuv.x += 3.0 * max( 0.0, cubeUV_maxTileSize - 2.0 * faceSize );\n\t\tuv *= texelSize;\n\t\tvec3 tl = envMapTexelToLinear( texture2D( envMap, uv ) ).rgb;\n\t\tuv.x += texelSize;\n\t\tvec3 tr = envMapTexelToLinear( texture2D( envMap, uv ) ).rgb;\n\t\tuv.y += texelSize;\n\t\tvec3 br = envMapTexelToLinear( texture2D( envMap, uv ) ).rgb;\n\t\tuv.x -= texelSize;\n\t\tvec3 bl = envMapTexelToLinear( texture2D( envMap, uv ) ).rgb;\n\t\tvec3 tm = mix( tl, tr, f.x );\n\t\tvec3 bm = mix( bl, br, f.x );\n\t\treturn mix( tm, bm, f.y );\n\t}\n\t#define r0 1.0\n\t#define v0 0.339\n\t#define m0 - 2.0\n\t#define r1 0.8\n\t#define v1 0.276\n\t#define m1 - 1.0\n\t#define r4 0.4\n\t#define v4 0.046\n\t#define m4 2.0\n\t#define r5 0.305\n\t#define v5 0.016\n\t#define m5 3.0\n\t#define r6 0.21\n\t#define v6 0.0038\n\t#define m6 4.0\n\tfloat roughnessToMip( float roughness ) {\n\t\tfloat mip = 0.0;\n\t\tif ( roughness >= r1 ) {\n\t\t\tmip = ( r0 - roughness ) * ( m1 - m0 ) / ( r0 - r1 ) + m0;\n\t\t} else if ( roughness >= r4 ) {\n\t\t\tmip = ( r1 - roughness ) * ( m4 - m1 ) / ( r1 - r4 ) + m1;\n\t\t} else if ( roughness >= r5 ) {\n\t\t\tmip = ( r4 - roughness ) * ( m5 - m4 ) / ( r4 - r5 ) + m4;\n\t\t} else if ( roughness >= r6 ) {\n\t\t\tmip = ( r5 - roughness ) * ( m6 - m5 ) / ( r5 - r6 ) + m5;\n\t\t} else {\n\t\t\tmip = - 2.0 * log2( 1.16 * roughness );\t\t}\n\t\treturn mip;\n\t}\n\tvec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {\n\t\tfloat mip = clamp( roughnessToMip( roughness ), m0, cubeUV_maxMipLevel );\n\t\tfloat mipF = fract( mip );\n\t\tfloat mipInt = floor( mip );\n\t\tvec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );\n\t\tif ( mipF == 0.0 ) {\n\t\t\treturn vec4( color0, 1.0 );\n\t\t} else {\n\t\t\tvec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );\n\t\t\treturn vec4( mix( color0, color1, mipF ), 1.0 );\n\t\t}\n\t}\n#endif",defaultnormal_vertex:"vec3 transformedNormal = objectNormal;\n#ifdef USE_INSTANCING\n\tmat3 m = mat3( instanceMatrix );\n\ttransformedNormal /= vec3( dot( m[ 0 ], m[ 0 ] ), dot( m[ 1 ], m[ 1 ] ), dot( m[ 2 ], m[ 2 ] ) );\n\ttransformedNormal = m * transformedNormal;\n#endif\ntransformedNormal = normalMatrix * transformedNormal;\n#ifdef FLIP_SIDED\n\ttransformedNormal = - transformedNormal;\n#endif\n#ifdef USE_TANGENT\n\tvec3 transformedTangent = ( modelViewMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#ifdef FLIP_SIDED\n\t\ttransformedTangent = - transformedTangent;\n\t#endif\n#endif",displacementmap_pars_vertex:"#ifdef USE_DISPLACEMENTMAP\n\tuniform sampler2D displacementMap;\n\tuniform float displacementScale;\n\tuniform float displacementBias;\n#endif",displacementmap_vertex:"#ifdef USE_DISPLACEMENTMAP\n\ttransformed += normalize( objectNormal ) * ( texture2D( displacementMap, vUv ).x * displacementScale + displacementBias );\n#endif",emissivemap_fragment:"#ifdef USE_EMISSIVEMAP\n\tvec4 emissiveColor = texture2D( emissiveMap, vUv );\n\temissiveColor.rgb = emissiveMapTexelToLinear( emissiveColor ).rgb;\n\ttotalEmissiveRadiance *= emissiveColor.rgb;\n#endif",emissivemap_pars_fragment:"#ifdef USE_EMISSIVEMAP\n\tuniform sampler2D emissiveMap;\n#endif",encodings_fragment:"gl_FragColor = linearToOutputTexel( gl_FragColor );",encodings_pars_fragment:"\nvec4 LinearToLinear( in vec4 value ) {\n\treturn value;\n}\nvec4 GammaToLinear( in vec4 value, in float gammaFactor ) {\n\treturn vec4( pow( value.rgb, vec3( gammaFactor ) ), value.a );\n}\nvec4 LinearToGamma( in vec4 value, in float gammaFactor ) {\n\treturn vec4( pow( value.rgb, vec3( 1.0 / gammaFactor ) ), value.a );\n}\nvec4 sRGBToLinear( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.a );\n}\nvec4 LinearTosRGB( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );\n}\nvec4 RGBEToLinear( in vec4 value ) {\n\treturn vec4( value.rgb * exp2( value.a * 255.0 - 128.0 ), 1.0 );\n}\nvec4 LinearToRGBE( in vec4 value ) {\n\tfloat maxComponent = max( max( value.r, value.g ), value.b );\n\tfloat fExp = clamp( ceil( log2( maxComponent ) ), -128.0, 127.0 );\n\treturn vec4( value.rgb / exp2( fExp ), ( fExp + 128.0 ) / 255.0 );\n}\nvec4 RGBMToLinear( in vec4 value, in float maxRange ) {\n\treturn vec4( value.rgb * value.a * maxRange, 1.0 );\n}\nvec4 LinearToRGBM( in vec4 value, in float maxRange ) {\n\tfloat maxRGB = max( value.r, max( value.g, value.b ) );\n\tfloat M = clamp( maxRGB / maxRange, 0.0, 1.0 );\n\tM = ceil( M * 255.0 ) / 255.0;\n\treturn vec4( value.rgb / ( M * maxRange ), M );\n}\nvec4 RGBDToLinear( in vec4 value, in float maxRange ) {\n\treturn vec4( value.rgb * ( ( maxRange / 255.0 ) / value.a ), 1.0 );\n}\nvec4 LinearToRGBD( in vec4 value, in float maxRange ) {\n\tfloat maxRGB = max( value.r, max( value.g, value.b ) );\n\tfloat D = max( maxRange / maxRGB, 1.0 );\n\tD = clamp( floor( D ) / 255.0, 0.0, 1.0 );\n\treturn vec4( value.rgb * ( D * ( 255.0 / maxRange ) ), D );\n}\nconst mat3 cLogLuvM = mat3( 0.2209, 0.3390, 0.4184, 0.1138, 0.6780, 0.7319, 0.0102, 0.1130, 0.2969 );\nvec4 LinearToLogLuv( in vec4 value ) {\n\tvec3 Xp_Y_XYZp = cLogLuvM * value.rgb;\n\tXp_Y_XYZp = max( Xp_Y_XYZp, vec3( 1e-6, 1e-6, 1e-6 ) );\n\tvec4 vResult;\n\tvResult.xy = Xp_Y_XYZp.xy / Xp_Y_XYZp.z;\n\tfloat Le = 2.0 * log2(Xp_Y_XYZp.y) + 127.0;\n\tvResult.w = fract( Le );\n\tvResult.z = ( Le - ( floor( vResult.w * 255.0 ) ) / 255.0 ) / 255.0;\n\treturn vResult;\n}\nconst mat3 cLogLuvInverseM = mat3( 6.0014, -2.7008, -1.7996, -1.3320, 3.1029, -5.7721, 0.3008, -1.0882, 5.6268 );\nvec4 LogLuvToLinear( in vec4 value ) {\n\tfloat Le = value.z * 255.0 + value.w;\n\tvec3 Xp_Y_XYZp;\n\tXp_Y_XYZp.y = exp2( ( Le - 127.0 ) / 2.0 );\n\tXp_Y_XYZp.z = Xp_Y_XYZp.y / value.y;\n\tXp_Y_XYZp.x = value.x * Xp_Y_XYZp.z;\n\tvec3 vRGB = cLogLuvInverseM * Xp_Y_XYZp.rgb;\n\treturn vec4( max( vRGB, 0.0 ), 1.0 );\n}",envmap_fragment:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvec3 cameraToFrag;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToFrag = normalize( vWorldPosition - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( cameraToFrag, worldNormal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );\n\t\t#endif\n\t#else\n\t\tvec3 reflectVec = vReflect;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\tvec4 envColor = textureCubeUV( envMap, reflectVec, 0.0 );\n\t#else\n\t\tvec4 envColor = vec4( 0.0 );\n\t#endif\n\t#ifndef ENVMAP_TYPE_CUBE_UV\n\t\tenvColor = envMapTexelToLinear( envColor );\n\t#endif\n\t#ifdef ENVMAP_BLENDING_MULTIPLY\n\t\toutgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_MIX )\n\t\toutgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_ADD )\n\t\toutgoingLight += envColor.xyz * specularStrength * reflectivity;\n\t#endif\n#endif",envmap_common_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float envMapIntensity;\n\tuniform float flipEnvMap;\n\tuniform int maxMipLevel;\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tuniform samplerCube envMap;\n\t#else\n\t\tuniform sampler2D envMap;\n\t#endif\n\t\n#endif",envmap_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float reflectivity;\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\tvarying vec3 vWorldPosition;\n\t\tuniform float refractionRatio;\n\t#else\n\t\tvarying vec3 vReflect;\n\t#endif\n#endif",envmap_pars_vertex:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) ||defined( PHONG )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\t\n\t\tvarying vec3 vWorldPosition;\n\t#else\n\t\tvarying vec3 vReflect;\n\t\tuniform float refractionRatio;\n\t#endif\n#endif",envmap_physical_pars_fragment:"#if defined( USE_ENVMAP )\n\t#ifdef ENVMAP_MODE_REFRACTION\n\t\tuniform float refractionRatio;\n\t#endif\n\tvec3 getLightProbeIndirectIrradiance( const in GeometricContext geometry, const in int maxMIPLevel ) {\n\t\tvec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );\n\t\t#ifdef ENVMAP_TYPE_CUBE\n\t\t\tvec3 queryVec = vec3( flipEnvMap * worldNormal.x, worldNormal.yz );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = textureCubeLodEXT( envMap, queryVec, float( maxMIPLevel ) );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = textureCube( envMap, queryVec, float( maxMIPLevel ) );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );\n\t\t#else\n\t\t\tvec4 envMapColor = vec4( 0.0 );\n\t\t#endif\n\t\treturn PI * envMapColor.rgb * envMapIntensity;\n\t}\n\tfloat getSpecularMIPLevel( const in float roughness, const in int maxMIPLevel ) {\n\t\tfloat maxMIPLevelScalar = float( maxMIPLevel );\n\t\tfloat sigma = PI * roughness * roughness / ( 1.0 + roughness );\n\t\tfloat desiredMIPLevel = maxMIPLevelScalar + log2( sigma );\n\t\treturn clamp( desiredMIPLevel, 0.0, maxMIPLevelScalar );\n\t}\n\tvec3 getLightProbeIndirectRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in int maxMIPLevel ) {\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( -viewDir, normal );\n\t\t\treflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( -viewDir, normal, refractionRatio );\n\t\t#endif\n\t\treflectVec = inverseTransformDirection( reflectVec, viewMatrix );\n\t\tfloat specularMIPLevel = getSpecularMIPLevel( roughness, maxMIPLevel );\n\t\t#ifdef ENVMAP_TYPE_CUBE\n\t\t\tvec3 queryReflectVec = vec3( flipEnvMap * reflectVec.x, reflectVec.yz );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = textureCubeLodEXT( envMap, queryReflectVec, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = textureCube( envMap, queryReflectVec, specularMIPLevel );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );\n\t\t#endif\n\t\treturn envMapColor.rgb * envMapIntensity;\n\t}\n#endif",envmap_vertex:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvWorldPosition = worldPosition.xyz;\n\t#else\n\t\tvec3 cameraToVertex;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvReflect = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#endif\n#endif",fog_vertex:"#ifdef USE_FOG\n\tfogDepth = - mvPosition.z;\n#endif",fog_pars_vertex:"#ifdef USE_FOG\n\tvarying float fogDepth;\n#endif",fog_fragment:"#ifdef USE_FOG\n\t#ifdef FOG_EXP2\n\t\tfloat fogFactor = 1.0 - exp( - fogDensity * fogDensity * fogDepth * fogDepth );\n\t#else\n\t\tfloat fogFactor = smoothstep( fogNear, fogFar, fogDepth );\n\t#endif\n\tgl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );\n#endif",fog_pars_fragment:"#ifdef USE_FOG\n\tuniform vec3 fogColor;\n\tvarying float fogDepth;\n\t#ifdef FOG_EXP2\n\t\tuniform float fogDensity;\n\t#else\n\t\tuniform float fogNear;\n\t\tuniform float fogFar;\n\t#endif\n#endif",gradientmap_pars_fragment:"#ifdef USE_GRADIENTMAP\n\tuniform sampler2D gradientMap;\n#endif\nvec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {\n\tfloat dotNL = dot( normal, lightDirection );\n\tvec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );\n\t#ifdef USE_GRADIENTMAP\n\t\treturn texture2D( gradientMap, coord ).rgb;\n\t#else\n\t\treturn ( coord.x < 0.7 ) ? vec3( 0.7 ) : vec3( 1.0 );\n\t#endif\n}",lightmap_fragment:"#ifdef USE_LIGHTMAP\n\tvec4 lightMapTexel= texture2D( lightMap, vUv2 );\n\treflectedLight.indirectDiffuse += PI * lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;\n#endif",lightmap_pars_fragment:"#ifdef USE_LIGHTMAP\n\tuniform sampler2D lightMap;\n\tuniform float lightMapIntensity;\n#endif",lights_lambert_vertex:"vec3 diffuse = vec3( 1.0 );\nGeometricContext geometry;\ngeometry.position = mvPosition.xyz;\ngeometry.normal = normalize( transformedNormal );\ngeometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( -mvPosition.xyz );\nGeometricContext backGeometry;\nbackGeometry.position = geometry.position;\nbackGeometry.normal = -geometry.normal;\nbackGeometry.viewDir = geometry.viewDir;\nvLightFront = vec3( 0.0 );\nvIndirectFront = vec3( 0.0 );\n#ifdef DOUBLE_SIDED\n\tvLightBack = vec3( 0.0 );\n\tvIndirectBack = vec3( 0.0 );\n#endif\nIncidentLight directLight;\nfloat dotNL;\nvec3 directLightColor_Diffuse;\nvIndirectFront += getAmbientLightIrradiance( ambientLightColor );\nvIndirectFront += getLightProbeIrradiance( lightProbe, geometry );\n#ifdef DOUBLE_SIDED\n\tvIndirectBack += getAmbientLightIrradiance( ambientLightColor );\n\tvIndirectBack += getLightProbeIrradiance( lightProbe, backGeometry );\n#endif\n#if NUM_POINT_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tgetPointDirectLightIrradiance( pointLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tgetSpotDirectLightIrradiance( spotLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if NUM_DIR_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tgetDirectionalDirectLightIrradiance( directionalLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\tvIndirectFront += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvIndirectBack += getHemisphereLightIrradiance( hemisphereLights[ i ], backGeometry );\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif",lights_pars_begin:"uniform bool receiveShadow;\nuniform vec3 ambientLightColor;\nuniform vec3 lightProbe[ 9 ];\nvec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {\n\tfloat x = normal.x, y = normal.y, z = normal.z;\n\tvec3 result = shCoefficients[ 0 ] * 0.886227;\n\tresult += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;\n\tresult += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;\n\tresult += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;\n\tresult += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;\n\tresult += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;\n\tresult += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );\n\tresult += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;\n\tresult += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );\n\treturn result;\n}\nvec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in GeometricContext geometry ) {\n\tvec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );\n\tvec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );\n\treturn irradiance;\n}\nvec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {\n\tvec3 irradiance = ambientLightColor;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\treturn irradiance;\n}\n#if NUM_DIR_LIGHTS > 0\n\tstruct DirectionalLight {\n\t\tvec3 direction;\n\t\tvec3 color;\n\t};\n\tuniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];\n\tvoid getDirectionalDirectLightIrradiance( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight directLight ) {\n\t\tdirectLight.color = directionalLight.color;\n\t\tdirectLight.direction = directionalLight.direction;\n\t\tdirectLight.visible = true;\n\t}\n#endif\n#if NUM_POINT_LIGHTS > 0\n\tstruct PointLight {\n\t\tvec3 position;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t};\n\tuniform PointLight pointLights[ NUM_POINT_LIGHTS ];\n\tvoid getPointDirectLightIrradiance( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight directLight ) {\n\t\tvec3 lVector = pointLight.position - geometry.position;\n\t\tdirectLight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tdirectLight.color = pointLight.color;\n\t\tdirectLight.color *= punctualLightIntensityToIrradianceFactor( lightDistance, pointLight.distance, pointLight.decay );\n\t\tdirectLight.visible = ( directLight.color != vec3( 0.0 ) );\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\tstruct SpotLight {\n\t\tvec3 position;\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tfloat coneCos;\n\t\tfloat penumbraCos;\n\t};\n\tuniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];\n\tvoid getSpotDirectLightIrradiance( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight directLight ) {\n\t\tvec3 lVector = spotLight.position - geometry.position;\n\t\tdirectLight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tfloat angleCos = dot( directLight.direction, spotLight.direction );\n\t\tif ( angleCos > spotLight.coneCos ) {\n\t\t\tfloat spotEffect = smoothstep( spotLight.coneCos, spotLight.penumbraCos, angleCos );\n\t\t\tdirectLight.color = spotLight.color;\n\t\t\tdirectLight.color *= spotEffect * punctualLightIntensityToIrradianceFactor( lightDistance, spotLight.distance, spotLight.decay );\n\t\t\tdirectLight.visible = true;\n\t\t} else {\n\t\t\tdirectLight.color = vec3( 0.0 );\n\t\t\tdirectLight.visible = false;\n\t\t}\n\t}\n#endif\n#if NUM_RECT_AREA_LIGHTS > 0\n\tstruct RectAreaLight {\n\t\tvec3 color;\n\t\tvec3 position;\n\t\tvec3 halfWidth;\n\t\tvec3 halfHeight;\n\t};\n\tuniform sampler2D ltc_1;\tuniform sampler2D ltc_2;\n\tuniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\tstruct HemisphereLight {\n\t\tvec3 direction;\n\t\tvec3 skyColor;\n\t\tvec3 groundColor;\n\t};\n\tuniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];\n\tvec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in GeometricContext geometry ) {\n\t\tfloat dotNL = dot( geometry.normal, hemiLight.direction );\n\t\tfloat hemiDiffuseWeight = 0.5 * dotNL + 0.5;\n\t\tvec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tirradiance *= PI;\n\t\t#endif\n\t\treturn irradiance;\n\t}\n#endif",lights_toon_fragment:"ToonMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;",lights_toon_pars_fragment:"varying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\nstruct ToonMaterial {\n\tvec3 diffuseColor;\n};\nvoid RE_Direct_Toon( const in IncidentLight directLight, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\tvec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\treflectedLight.directDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_Toon\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Toon\n#define Material_LightProbeLOD( material )\t(0)",lights_phong_fragment:"BlinnPhongMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularColor = specular;\nmaterial.specularShininess = shininess;\nmaterial.specularStrength = specularStrength;",lights_phong_pars_fragment:"varying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\nstruct BlinnPhongMaterial {\n\tvec3 diffuseColor;\n\tvec3 specularColor;\n\tfloat specularShininess;\n\tfloat specularStrength;\n};\nvoid RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\treflectedLight.directDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n\treflectedLight.directSpecular += irradiance * BRDF_Specular_BlinnPhong( directLight, geometry, material.specularColor, material.specularShininess ) * material.specularStrength;\n}\nvoid RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_BlinnPhong\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_BlinnPhong\n#define Material_LightProbeLOD( material )\t(0)",lights_physical_fragment:"PhysicalMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );\nvec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );\nfloat geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );\nmaterial.specularRoughness = max( roughnessFactor, 0.0525 );material.specularRoughness += geometryRoughness;\nmaterial.specularRoughness = min( material.specularRoughness, 1.0 );\n#ifdef REFLECTIVITY\n\t#ifdef SPECULAR\n\t\tvec3 specularIntensityFactor = vec3( specularIntensity );\n\t\tvec3 specularTintFactor = specularTint;\n\t\t#ifdef USE_SPECULARINTENSITYMAP\n\t\t\tspecularIntensityFactor *= texture2D( specularIntensityMap, vUv ).a;\n\t\t#endif\n\t\t#ifdef USE_SPECULARTINTMAP\n\t\t\tspecularTintFactor *= specularTintMapTexelToLinear( texture2D( specularTintMap, vUv ) ).rgb;\n\t\t#endif\n\t\tmaterial.specularColorF90 = mix( specularIntensityFactor, vec3( 1.0 ), metalnessFactor );\n\t#else\n\t\tvec3 specularIntensityFactor = vec3( 1.0 );\n\t\tvec3 specularTintFactor = vec3( 1.0 );\n\t\tmaterial.specularColorF90 = vec3( 1.0 );\n\t#endif\n\tmaterial.specularColor = mix( min( vec3( MAXIMUM_SPECULAR_COEFFICIENT * pow2( reflectivity ) ) * specularTintFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );\n#else\n\tmaterial.specularColor = mix( vec3( DEFAULT_SPECULAR_COEFFICIENT ), diffuseColor.rgb, metalnessFactor );\n\tmaterial.specularColorF90 = vec3( 1.0 );\n#endif\n#ifdef CLEARCOAT\n\tmaterial.clearcoat = clearcoat;\n\tmaterial.clearcoatRoughness = clearcoatRoughness;\n\t#ifdef USE_CLEARCOATMAP\n\t\tmaterial.clearcoat *= texture2D( clearcoatMap, vUv ).x;\n\t#endif\n\t#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\t\tmaterial.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vUv ).y;\n\t#endif\n\tmaterial.clearcoat = saturate( material.clearcoat );\tmaterial.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );\n\tmaterial.clearcoatRoughness += geometryRoughness;\n\tmaterial.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );\n#endif\n#ifdef USE_SHEEN\n\tmaterial.sheenColor = sheen;\n#endif",lights_physical_pars_fragment:"struct PhysicalMaterial {\n\tvec3 diffuseColor;\n\tfloat specularRoughness;\n\tvec3 specularColor;\n\tvec3 specularColorF90;\n#ifdef CLEARCOAT\n\tfloat clearcoat;\n\tfloat clearcoatRoughness;\n#endif\n#ifdef USE_SHEEN\n\tvec3 sheenColor;\n#endif\n};\n#define MAXIMUM_SPECULAR_COEFFICIENT 0.16\n#define DEFAULT_SPECULAR_COEFFICIENT 0.04\nfloat clearcoatDHRApprox( const in float roughness, const in float dotNL ) {\n\treturn DEFAULT_SPECULAR_COEFFICIENT + ( 1.0 - DEFAULT_SPECULAR_COEFFICIENT ) * ( pow( 1.0 - dotNL, 5.0 ) * pow( 1.0 - roughness, 2.0 ) );\n}\n#if NUM_RECT_AREA_LIGHTS > 0\n\tvoid RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t\tvec3 normal = geometry.normal;\n\t\tvec3 viewDir = geometry.viewDir;\n\t\tvec3 position = geometry.position;\n\t\tvec3 lightPos = rectAreaLight.position;\n\t\tvec3 halfWidth = rectAreaLight.halfWidth;\n\t\tvec3 halfHeight = rectAreaLight.halfHeight;\n\t\tvec3 lightColor = rectAreaLight.color;\n\t\tfloat roughness = material.specularRoughness;\n\t\tvec3 rectCoords[ 4 ];\n\t\trectCoords[ 0 ] = lightPos + halfWidth - halfHeight;\t\trectCoords[ 1 ] = lightPos - halfWidth - halfHeight;\n\t\trectCoords[ 2 ] = lightPos - halfWidth + halfHeight;\n\t\trectCoords[ 3 ] = lightPos + halfWidth + halfHeight;\n\t\tvec2 uv = LTC_Uv( normal, viewDir, roughness );\n\t\tvec4 t1 = texture2D( ltc_1, uv );\n\t\tvec4 t2 = texture2D( ltc_2, uv );\n\t\tmat3 mInv = mat3(\n\t\t\tvec3( t1.x, 0, t1.y ),\n\t\t\tvec3(\t\t0, 1,\t\t0 ),\n\t\t\tvec3( t1.z, 0, t1.w )\n\t\t);\n\t\tvec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );\n\t\treflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );\n\t\treflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );\n\t}\n#endif\nvoid RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\t#ifdef CLEARCOAT\n\t\tfloat ccDotNL = saturate( dot( geometry.clearcoatNormal, directLight.direction ) );\n\t\tvec3 ccIrradiance = ccDotNL * directLight.color;\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tccIrradiance *= PI;\n\t\t#endif\n\t\tfloat clearcoatDHR = material.clearcoat * clearcoatDHRApprox( material.clearcoatRoughness, ccDotNL );\n\t\treflectedLight.directSpecular += ccIrradiance * material.clearcoat * BRDF_Specular_GGX( directLight, geometry.viewDir, geometry.clearcoatNormal, vec3( DEFAULT_SPECULAR_COEFFICIENT ), vec3( 1.0 ), material.clearcoatRoughness );\n\t#else\n\t\tfloat clearcoatDHR = 0.0;\n\t#endif\n\t#ifdef USE_SHEEN\n\t\treflectedLight.directSpecular += ( 1.0 - clearcoatDHR ) * irradiance * BRDF_Specular_Sheen(\n\t\t\tmaterial.specularRoughness,\n\t\t\tdirectLight.direction,\n\t\t\tgeometry,\n\t\t\tmaterial.sheenColor\n\t\t);\n\t#else\n\t\treflectedLight.directSpecular += ( 1.0 - clearcoatDHR ) * irradiance * BRDF_Specular_GGX( directLight, geometry.viewDir, geometry.normal, material.specularColor, material.specularColorF90, material.specularRoughness);\n\t#endif\n\treflectedLight.directDiffuse += ( 1.0 - clearcoatDHR ) * irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {\n\t#ifdef CLEARCOAT\n\t\tfloat ccDotNV = saturate( dot( geometry.clearcoatNormal, geometry.viewDir ) );\n\t\treflectedLight.indirectSpecular += clearcoatRadiance * material.clearcoat * BRDF_Specular_GGX_Environment( geometry.viewDir, geometry.clearcoatNormal, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearcoatRoughness );\n\t\tfloat ccDotNL = ccDotNV;\n\t\tfloat clearcoatDHR = material.clearcoat * clearcoatDHRApprox( material.clearcoatRoughness, ccDotNL );\n\t#else\n\t\tfloat clearcoatDHR = 0.0;\n\t#endif\n\tfloat clearcoatInv = 1.0 - clearcoatDHR;\n\tvec3 singleScattering = vec3( 0.0 );\n\tvec3 multiScattering = vec3( 0.0 );\n\tvec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;\n\tBRDF_Specular_Multiscattering_Environment( geometry, material.specularColor, material.specularRoughness, singleScattering, multiScattering );\n\tvec3 diffuse = material.diffuseColor * ( 1.0 - ( singleScattering + multiScattering ) );\n\treflectedLight.indirectSpecular += clearcoatInv * radiance * singleScattering;\n\treflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;\n\treflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;\n}\n#define RE_Direct\t\t\t\tRE_Direct_Physical\n#define RE_Direct_RectArea\t\tRE_Direct_RectArea_Physical\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Physical\n#define RE_IndirectSpecular\t\tRE_IndirectSpecular_Physical\nfloat computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {\n\treturn saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );\n}",lights_fragment_begin:"\nGeometricContext geometry;\ngeometry.position = - vViewPosition;\ngeometry.normal = normal;\ngeometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );\n#ifdef CLEARCOAT\n\tgeometry.clearcoatNormal = clearcoatNormal;\n#endif\nIncidentLight directLight;\n#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )\n\tPointLight pointLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tgetPointDirectLightIrradiance( pointLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )\n\t\tpointLightShadow = pointLightShadows[ i ];\n\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\n\tSpotLight spotLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tgetSpotDirectLightIrradiance( spotLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\tspotLightShadow = spotLightShadows[ i ];\n\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )\n\tDirectionalLight directionalLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tgetDirectionalDirectLightIrradiance( directionalLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )\n\t\tdirectionalLightShadow = directionalLightShadows[ i ];\n\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )\n\tRectAreaLight rectAreaLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {\n\t\trectAreaLight = rectAreaLights[ i ];\n\t\tRE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if defined( RE_IndirectDiffuse )\n\tvec3 iblIrradiance = vec3( 0.0 );\n\tvec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\n\tirradiance += getLightProbeIrradiance( lightProbe, geometry );\n\t#if ( NUM_HEMI_LIGHTS > 0 )\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\t\tirradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n#endif\n#if defined( RE_IndirectSpecular )\n\tvec3 radiance = vec3( 0.0 );\n\tvec3 clearcoatRadiance = vec3( 0.0 );\n#endif",lights_fragment_maps:"#if defined( RE_IndirectDiffuse )\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel= texture2D( lightMap, vUv2 );\n\t\tvec3 lightMapIrradiance = lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tlightMapIrradiance *= PI;\n\t\t#endif\n\t\tirradiance += lightMapIrradiance;\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )\n\t\tiblIrradiance += getLightProbeIndirectIrradiance( geometry, maxMipLevel );\n\t#endif\n#endif\n#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )\n\tradiance += getLightProbeIndirectRadiance( geometry.viewDir, geometry.normal, material.specularRoughness, maxMipLevel );\n\t#ifdef CLEARCOAT\n\t\tclearcoatRadiance += getLightProbeIndirectRadiance( geometry.viewDir, geometry.clearcoatNormal, material.clearcoatRoughness, maxMipLevel );\n\t#endif\n#endif",lights_fragment_end:"#if defined( RE_IndirectDiffuse )\n\tRE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );\n#endif\n#if defined( RE_IndirectSpecular )\n\tRE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometry, material, reflectedLight );\n#endif",logdepthbuf_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tgl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;\n#endif",logdepthbuf_pars_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tuniform float logDepthBufFC;\n\tvarying float vFragDepth;\n\tvarying float vIsPerspective;\n#endif",logdepthbuf_pars_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvarying float vFragDepth;\n\t\tvarying float vIsPerspective;\n\t#else\n\t\tuniform float logDepthBufFC;\n\t#endif\n#endif",logdepthbuf_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvFragDepth = 1.0 + gl_Position.w;\n\t\tvIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );\n\t#else\n\t\tif ( isPerspectiveMatrix( projectionMatrix ) ) {\n\t\t\tgl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;\n\t\t\tgl_Position.z *= gl_Position.w;\n\t\t}\n\t#endif\n#endif",map_fragment:"#ifdef USE_MAP\n\tvec4 texelColor = texture2D( map, vUv );\n\ttexelColor = mapTexelToLinear( texelColor );\n\tdiffuseColor *= texelColor;\n#endif",map_pars_fragment:"#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif",map_particle_fragment:"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\tvec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;\n#endif\n#ifdef USE_MAP\n\tvec4 mapTexel = texture2D( map, uv );\n\tdiffuseColor *= mapTexelToLinear( mapTexel );\n#endif\n#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, uv ).g;\n#endif",map_particle_pars_fragment:"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\tuniform mat3 uvTransform;\n#endif\n#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif\n#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",metalnessmap_fragment:"float metalnessFactor = metalness;\n#ifdef USE_METALNESSMAP\n\tvec4 texelMetalness = texture2D( metalnessMap, vUv );\n\tmetalnessFactor *= texelMetalness.b;\n#endif",metalnessmap_pars_fragment:"#ifdef USE_METALNESSMAP\n\tuniform sampler2D metalnessMap;\n#endif",morphnormal_vertex:"#ifdef USE_MORPHNORMALS\n\tobjectNormal *= morphTargetBaseInfluence;\n\tobjectNormal += morphNormal0 * morphTargetInfluences[ 0 ];\n\tobjectNormal += morphNormal1 * morphTargetInfluences[ 1 ];\n\tobjectNormal += morphNormal2 * morphTargetInfluences[ 2 ];\n\tobjectNormal += morphNormal3 * morphTargetInfluences[ 3 ];\n#endif",morphtarget_pars_vertex:"#ifdef USE_MORPHTARGETS\n\tuniform float morphTargetBaseInfluence;\n\t#ifndef USE_MORPHNORMALS\n\t\tuniform float morphTargetInfluences[ 8 ];\n\t#else\n\t\tuniform float morphTargetInfluences[ 4 ];\n\t#endif\n#endif",morphtarget_vertex:"#ifdef USE_MORPHTARGETS\n\ttransformed *= morphTargetBaseInfluence;\n\ttransformed += morphTarget0 * morphTargetInfluences[ 0 ];\n\ttransformed += morphTarget1 * morphTargetInfluences[ 1 ];\n\ttransformed += morphTarget2 * morphTargetInfluences[ 2 ];\n\ttransformed += morphTarget3 * morphTargetInfluences[ 3 ];\n\t#ifndef USE_MORPHNORMALS\n\t\ttransformed += morphTarget4 * morphTargetInfluences[ 4 ];\n\t\ttransformed += morphTarget5 * morphTargetInfluences[ 5 ];\n\t\ttransformed += morphTarget6 * morphTargetInfluences[ 6 ];\n\t\ttransformed += morphTarget7 * morphTargetInfluences[ 7 ];\n\t#endif\n#endif",normal_fragment_begin:"float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;\n#ifdef FLAT_SHADED\n\tvec3 fdx = vec3( dFdx( vViewPosition.x ), dFdx( vViewPosition.y ), dFdx( vViewPosition.z ) );\n\tvec3 fdy = vec3( dFdy( vViewPosition.x ), dFdy( vViewPosition.y ), dFdy( vViewPosition.z ) );\n\tvec3 normal = normalize( cross( fdx, fdy ) );\n#else\n\tvec3 normal = normalize( vNormal );\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * faceDirection;\n\t#endif\n\t#ifdef USE_TANGENT\n\t\tvec3 tangent = normalize( vTangent );\n\t\tvec3 bitangent = normalize( vBitangent );\n\t\t#ifdef DOUBLE_SIDED\n\t\t\ttangent = tangent * faceDirection;\n\t\t\tbitangent = bitangent * faceDirection;\n\t\t#endif\n\t\t#if defined( TANGENTSPACE_NORMALMAP ) || defined( USE_CLEARCOAT_NORMALMAP )\n\t\t\tmat3 vTBN = mat3( tangent, bitangent, normal );\n\t\t#endif\n\t#endif\n#endif\nvec3 geometryNormal = normal;",normal_fragment_maps:"#ifdef OBJECTSPACE_NORMALMAP\n\tnormal = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\t#ifdef FLIP_SIDED\n\t\tnormal = - normal;\n\t#endif\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * faceDirection;\n\t#endif\n\tnormal = normalize( normalMatrix * normal );\n#elif defined( TANGENTSPACE_NORMALMAP )\n\tvec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\tmapN.xy *= normalScale;\n\t#ifdef USE_TANGENT\n\t\tnormal = normalize( vTBN * mapN );\n\t#else\n\t\tnormal = perturbNormal2Arb( -vViewPosition, normal, mapN, faceDirection );\n\t#endif\n#elif defined( USE_BUMPMAP )\n\tnormal = perturbNormalArb( -vViewPosition, normal, dHdxy_fwd(), faceDirection );\n#endif",normalmap_pars_fragment:"#ifdef USE_NORMALMAP\n\tuniform sampler2D normalMap;\n\tuniform vec2 normalScale;\n#endif\n#ifdef OBJECTSPACE_NORMALMAP\n\tuniform mat3 normalMatrix;\n#endif\n#if ! defined ( USE_TANGENT ) && ( defined ( TANGENTSPACE_NORMALMAP ) || defined ( USE_CLEARCOAT_NORMALMAP ) )\n\tvec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm, vec3 mapN, float faceDirection ) {\n\t\tvec3 q0 = vec3( dFdx( eye_pos.x ), dFdx( eye_pos.y ), dFdx( eye_pos.z ) );\n\t\tvec3 q1 = vec3( dFdy( eye_pos.x ), dFdy( eye_pos.y ), dFdy( eye_pos.z ) );\n\t\tvec2 st0 = dFdx( vUv.st );\n\t\tvec2 st1 = dFdy( vUv.st );\n\t\tvec3 N = surf_norm;\n\t\tvec3 q1perp = cross( q1, N );\n\t\tvec3 q0perp = cross( N, q0 );\n\t\tvec3 T = q1perp * st0.x + q0perp * st1.x;\n\t\tvec3 B = q1perp * st0.y + q0perp * st1.y;\n\t\tfloat det = max( dot( T, T ), dot( B, B ) );\n\t\tfloat scale = ( det == 0.0 ) ? 0.0 : faceDirection * inversesqrt( det );\n\t\treturn normalize( T * ( mapN.x * scale ) + B * ( mapN.y * scale ) + N * mapN.z );\n\t}\n#endif",clearcoat_normal_fragment_begin:"#ifdef CLEARCOAT\n\tvec3 clearcoatNormal = geometryNormal;\n#endif",clearcoat_normal_fragment_maps:"#ifdef USE_CLEARCOAT_NORMALMAP\n\tvec3 clearcoatMapN = texture2D( clearcoatNormalMap, vUv ).xyz * 2.0 - 1.0;\n\tclearcoatMapN.xy *= clearcoatNormalScale;\n\t#ifdef USE_TANGENT\n\t\tclearcoatNormal = normalize( vTBN * clearcoatMapN );\n\t#else\n\t\tclearcoatNormal = perturbNormal2Arb( - vViewPosition, clearcoatNormal, clearcoatMapN, faceDirection );\n\t#endif\n#endif",clearcoat_pars_fragment:"#ifdef USE_CLEARCOATMAP\n\tuniform sampler2D clearcoatMap;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tuniform sampler2D clearcoatRoughnessMap;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tuniform sampler2D clearcoatNormalMap;\n\tuniform vec2 clearcoatNormalScale;\n#endif",packing:"vec3 packNormalToRGB( const in vec3 normal ) {\n\treturn normalize( normal ) * 0.5 + 0.5;\n}\nvec3 unpackRGBToNormal( const in vec3 rgb ) {\n\treturn 2.0 * rgb.xyz - 1.0;\n}\nconst float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;\nconst vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256., 256. );\nconst vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );\nconst float ShiftRight8 = 1. / 256.;\nvec4 packDepthToRGBA( const in float v ) {\n\tvec4 r = vec4( fract( v * PackFactors ), v );\n\tr.yzw -= r.xyz * ShiftRight8;\treturn r * PackUpscale;\n}\nfloat unpackRGBAToDepth( const in vec4 v ) {\n\treturn dot( v, UnpackFactors );\n}\nvec4 pack2HalfToRGBA( vec2 v ) {\n\tvec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ));\n\treturn vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w);\n}\nvec2 unpackRGBATo2Half( vec4 v ) {\n\treturn vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );\n}\nfloat viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( viewZ + near ) / ( near - far );\n}\nfloat orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {\n\treturn linearClipZ * ( near - far ) - near;\n}\nfloat viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn (( near + viewZ ) * far ) / (( far - near ) * viewZ );\n}\nfloat perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {\n\treturn ( near * far ) / ( ( far - near ) * invClipZ - far );\n}",premultiplied_alpha_fragment:"#ifdef PREMULTIPLIED_ALPHA\n\tgl_FragColor.rgb *= gl_FragColor.a;\n#endif",project_vertex:"vec4 mvPosition = vec4( transformed, 1.0 );\n#ifdef USE_INSTANCING\n\tmvPosition = instanceMatrix * mvPosition;\n#endif\nmvPosition = modelViewMatrix * mvPosition;\ngl_Position = projectionMatrix * mvPosition;",dithering_fragment:"#ifdef DITHERING\n\tgl_FragColor.rgb = dithering( gl_FragColor.rgb );\n#endif",dithering_pars_fragment:"#ifdef DITHERING\n\tvec3 dithering( vec3 color ) {\n\t\tfloat grid_position = rand( gl_FragCoord.xy );\n\t\tvec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );\n\t\tdither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );\n\t\treturn color + dither_shift_RGB;\n\t}\n#endif",roughnessmap_fragment:"float roughnessFactor = roughness;\n#ifdef USE_ROUGHNESSMAP\n\tvec4 texelRoughness = texture2D( roughnessMap, vUv );\n\troughnessFactor *= texelRoughness.g;\n#endif",roughnessmap_pars_fragment:"#ifdef USE_ROUGHNESSMAP\n\tuniform sampler2D roughnessMap;\n#endif",shadowmap_pars_fragment:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n\tfloat texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\n\t\treturn step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );\n\t}\n\tvec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {\n\t\treturn unpackRGBATo2Half( texture2D( shadow, uv ) );\n\t}\n\tfloat VSMShadow (sampler2D shadow, vec2 uv, float compare ){\n\t\tfloat occlusion = 1.0;\n\t\tvec2 distribution = texture2DDistribution( shadow, uv );\n\t\tfloat hard_shadow = step( compare , distribution.x );\n\t\tif (hard_shadow != 1.0 ) {\n\t\t\tfloat distance = compare - distribution.x ;\n\t\t\tfloat variance = max( 0.00000, distribution.y * distribution.y );\n\t\t\tfloat softness_probability = variance / (variance + distance * distance );\t\t\tsoftness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );\t\t\tocclusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );\n\t\t}\n\t\treturn occlusion;\n\t}\n\tfloat getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\t\tfloat shadow = 1.0;\n\t\tshadowCoord.xyz /= shadowCoord.w;\n\t\tshadowCoord.z += shadowBias;\n\t\tbvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );\n\t\tbool inFrustum = all( inFrustumVec );\n\t\tbvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );\n\t\tbool frustumTest = all( frustumTestVec );\n\t\tif ( frustumTest ) {\n\t\t#if defined( SHADOWMAP_TYPE_PCF )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\tfloat dx2 = dx0 / 2.0;\n\t\t\tfloat dy2 = dy0 / 2.0;\n\t\t\tfloat dx3 = dx1 / 2.0;\n\t\t\tfloat dy3 = dy1 / 2.0;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 17.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx = texelSize.x;\n\t\t\tfloat dy = texelSize.y;\n\t\t\tvec2 uv = shadowCoord.xy;\n\t\t\tvec2 f = fract( uv * shadowMapSize + 0.5 );\n\t\t\tuv -= f * texelSize;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, uv, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ), \n\t\t\t\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t\t\tf.x ),\n\t\t\t\t\t mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ), \n\t\t\t\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t\t\tf.x ),\n\t\t\t\t\t f.y )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_VSM )\n\t\t\tshadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#else\n\t\t\tshadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#endif\n\t\t}\n\t\treturn shadow;\n\t}\n\tvec2 cubeToUV( vec3 v, float texelSizeY ) {\n\t\tvec3 absV = abs( v );\n\t\tfloat scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );\n\t\tabsV *= scaleToCube;\n\t\tv *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );\n\t\tvec2 planar = v.xy;\n\t\tfloat almostATexel = 1.5 * texelSizeY;\n\t\tfloat almostOne = 1.0 - almostATexel;\n\t\tif ( absV.z >= almostOne ) {\n\t\t\tif ( v.z > 0.0 )\n\t\t\t\tplanar.x = 4.0 - v.x;\n\t\t} else if ( absV.x >= almostOne ) {\n\t\t\tfloat signX = sign( v.x );\n\t\t\tplanar.x = v.z * signX + 2.0 * signX;\n\t\t} else if ( absV.y >= almostOne ) {\n\t\t\tfloat signY = sign( v.y );\n\t\t\tplanar.x = v.x + 2.0 * signY + 2.0;\n\t\t\tplanar.y = v.z * signY - 2.0;\n\t\t}\n\t\treturn vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\n\t}\n\tfloat getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {\n\t\tvec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );\n\t\tvec3 lightToPosition = shadowCoord.xyz;\n\t\tfloat dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );\t\tdp += shadowBias;\n\t\tvec3 bd3D = normalize( lightToPosition );\n\t\t#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )\n\t\t\tvec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;\n\t\t\treturn (\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#else\n\t\t\treturn texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );\n\t\t#endif\n\t}\n#endif",shadowmap_pars_vertex:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tuniform mat4 spotShadowMatrix[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n#endif",shadowmap_vertex:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0 || NUM_SPOT_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0\n\t\tvec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\tvec4 shadowWorldPosition;\n\t#endif\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );\n\t\tvDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias, 0 );\n\t\tvSpotShadowCoord[ i ] = spotShadowMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );\n\t\tvPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n#endif",shadowmask_pars_fragment:"float getShadowMask() {\n\tfloat shadow = 1.0;\n\t#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\tdirectionalLight = directionalLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n\t\tspotLight = spotLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\tpointLight = pointLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#endif\n\treturn shadow;\n}",skinbase_vertex:"#ifdef USE_SKINNING\n\tmat4 boneMatX = getBoneMatrix( skinIndex.x );\n\tmat4 boneMatY = getBoneMatrix( skinIndex.y );\n\tmat4 boneMatZ = getBoneMatrix( skinIndex.z );\n\tmat4 boneMatW = getBoneMatrix( skinIndex.w );\n#endif",skinning_pars_vertex:"#ifdef USE_SKINNING\n\tuniform mat4 bindMatrix;\n\tuniform mat4 bindMatrixInverse;\n\t#ifdef BONE_TEXTURE\n\t\tuniform highp sampler2D boneTexture;\n\t\tuniform int boneTextureSize;\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tfloat j = i * 4.0;\n\t\t\tfloat x = mod( j, float( boneTextureSize ) );\n\t\t\tfloat y = floor( j / float( boneTextureSize ) );\n\t\t\tfloat dx = 1.0 / float( boneTextureSize );\n\t\t\tfloat dy = 1.0 / float( boneTextureSize );\n\t\t\ty = dy * ( y + 0.5 );\n\t\t\tvec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );\n\t\t\tvec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );\n\t\t\tvec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );\n\t\t\tvec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );\n\t\t\tmat4 bone = mat4( v1, v2, v3, v4 );\n\t\t\treturn bone;\n\t\t}\n\t#else\n\t\tuniform mat4 boneMatrices[ MAX_BONES ];\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tmat4 bone = boneMatrices[ int(i) ];\n\t\t\treturn bone;\n\t\t}\n\t#endif\n#endif",skinning_vertex:"#ifdef USE_SKINNING\n\tvec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\n\tvec4 skinned = vec4( 0.0 );\n\tskinned += boneMatX * skinVertex * skinWeight.x;\n\tskinned += boneMatY * skinVertex * skinWeight.y;\n\tskinned += boneMatZ * skinVertex * skinWeight.z;\n\tskinned += boneMatW * skinVertex * skinWeight.w;\n\ttransformed = ( bindMatrixInverse * skinned ).xyz;\n#endif",skinnormal_vertex:"#ifdef USE_SKINNING\n\tmat4 skinMatrix = mat4( 0.0 );\n\tskinMatrix += skinWeight.x * boneMatX;\n\tskinMatrix += skinWeight.y * boneMatY;\n\tskinMatrix += skinWeight.z * boneMatZ;\n\tskinMatrix += skinWeight.w * boneMatW;\n\tskinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;\n\tobjectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\n\t#ifdef USE_TANGENT\n\t\tobjectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#endif\n#endif",specularmap_fragment:"float specularStrength;\n#ifdef USE_SPECULARMAP\n\tvec4 texelSpecular = texture2D( specularMap, vUv );\n\tspecularStrength = texelSpecular.r;\n#else\n\tspecularStrength = 1.0;\n#endif",specularmap_pars_fragment:"#ifdef USE_SPECULARMAP\n\tuniform sampler2D specularMap;\n#endif",tonemapping_fragment:"#if defined( TONE_MAPPING )\n\tgl_FragColor.rgb = toneMapping( gl_FragColor.rgb );\n#endif",tonemapping_pars_fragment:"#ifndef saturate\n#define saturate(a) clamp( a, 0.0, 1.0 )\n#endif\nuniform float toneMappingExposure;\nvec3 LinearToneMapping( vec3 color ) {\n\treturn toneMappingExposure * color;\n}\nvec3 ReinhardToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( color / ( vec3( 1.0 ) + color ) );\n}\nvec3 OptimizedCineonToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\tcolor = max( vec3( 0.0 ), color - 0.004 );\n\treturn pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );\n}\nvec3 RRTAndODTFit( vec3 v ) {\n\tvec3 a = v * ( v + 0.0245786 ) - 0.000090537;\n\tvec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;\n\treturn a / b;\n}\nvec3 ACESFilmicToneMapping( vec3 color ) {\n\tconst mat3 ACESInputMat = mat3(\n\t\tvec3( 0.59719, 0.07600, 0.02840 ),\t\tvec3( 0.35458, 0.90834, 0.13383 ),\n\t\tvec3( 0.04823, 0.01566, 0.83777 )\n\t);\n\tconst mat3 ACESOutputMat = mat3(\n\t\tvec3(\t1.60475, -0.10208, -0.00327 ),\t\tvec3( -0.53108,\t1.10813, -0.07276 ),\n\t\tvec3( -0.07367, -0.00605,\t1.07602 )\n\t);\n\tcolor *= toneMappingExposure / 0.6;\n\tcolor = ACESInputMat * color;\n\tcolor = RRTAndODTFit( color );\n\tcolor = ACESOutputMat * color;\n\treturn saturate( color );\n}\nvec3 CustomToneMapping( vec3 color ) { return color; }",transmission_fragment:"#ifdef USE_TRANSMISSION\n\tfloat transmissionFactor = transmission;\n\tfloat thicknessFactor = thickness;\n\t#ifdef USE_TRANSMISSIONMAP\n\t\ttransmissionFactor *= texture2D( transmissionMap, vUv ).r;\n\t#endif\n\t#ifdef USE_THICKNESSMAP\n\t\tthicknessFactor *= texture2D( thicknessMap, vUv ).g;\n\t#endif\n\tvec3 pos = vWorldPosition.xyz / vWorldPosition.w;\n\tvec3 v = normalize( cameraPosition - pos );\n\tvec3 n = inverseTransformDirection( normal, viewMatrix );\n\tfloat ior = ( 1.0 + 0.4 * reflectivity ) / ( 1.0 - 0.4 * reflectivity );\n\tvec3 transmission = transmissionFactor * getIBLVolumeRefraction(\n\t\tn, v, roughnessFactor, material.diffuseColor, material.specularColor,\n\t\tpos, modelMatrix, viewMatrix, projectionMatrix, ior, thicknessFactor,\n\t\tattenuationTint, attenuationDistance );\n\ttotalDiffuse = mix( totalDiffuse, transmission, transmissionFactor );\n#endif",transmission_pars_fragment:"#ifdef USE_TRANSMISSION\n\t#ifdef USE_TRANSMISSIONMAP\n\t\tuniform sampler2D transmissionMap;\n\t#endif\n\t#ifdef USE_THICKNESSMAP\n\t\tuniform sampler2D thicknessMap;\n\t#endif\n\tuniform vec2 transmissionSamplerSize;\n\tuniform sampler2D transmissionSamplerMap;\n\tuniform mat4 modelMatrix;\n\tuniform mat4 projectionMatrix;\n\tvarying vec4 vWorldPosition;\n\tvec3 getVolumeTransmissionRay(vec3 n, vec3 v, float thickness, float ior, mat4 modelMatrix) {\n\t\tvec3 refractionVector = refract(-v, normalize(n), 1.0 / ior);\n\t\tvec3 modelScale;\n\t\tmodelScale.x = length(vec3(modelMatrix[0].xyz));\n\t\tmodelScale.y = length(vec3(modelMatrix[1].xyz));\n\t\tmodelScale.z = length(vec3(modelMatrix[2].xyz));\n\t\treturn normalize(refractionVector) * thickness * modelScale;\n\t}\n\tfloat applyIorToRoughness(float roughness, float ior) {\n\t\treturn roughness * clamp(ior * 2.0 - 2.0, 0.0, 1.0);\n\t}\n\tvec3 getTransmissionSample(vec2 fragCoord, float roughness, float ior) {\n\t\tfloat framebufferLod = log2(transmissionSamplerSize.x) * applyIorToRoughness(roughness, ior);\n\t\treturn texture2DLodEXT(transmissionSamplerMap, fragCoord.xy, framebufferLod).rgb;\n\t}\n\tvec3 applyVolumeAttenuation(vec3 radiance, float transmissionDistance, vec3 attenuationColor, float attenuationDistance) {\n\t\tif (attenuationDistance == 0.0) {\n\t\t\treturn radiance;\n\t\t} else {\n\t\t\tvec3 attenuationCoefficient = -log(attenuationColor) / attenuationDistance;\n\t\t\tvec3 transmittance = exp(-attenuationCoefficient * transmissionDistance);\t\t\treturn transmittance * radiance;\n\t\t}\n\t}\n\tvec3 getIBLVolumeRefraction(vec3 n, vec3 v, float perceptualRoughness, vec3 baseColor, vec3 specularColor,\n\t\tvec3 position, mat4 modelMatrix, mat4 viewMatrix, mat4 projMatrix, float ior, float thickness,\n\t\tvec3 attenuationColor, float attenuationDistance) {\n\t\tvec3 transmissionRay = getVolumeTransmissionRay(n, v, thickness, ior, modelMatrix);\n\t\tvec3 refractedRayExit = position + transmissionRay;\n\t\tvec4 ndcPos = projMatrix * viewMatrix * vec4(refractedRayExit, 1.0);\n\t\tvec2 refractionCoords = ndcPos.xy / ndcPos.w;\n\t\trefractionCoords += 1.0;\n\t\trefractionCoords /= 2.0;\n\t\tvec3 transmittedLight = getTransmissionSample(refractionCoords, perceptualRoughness, ior);\n\t\tvec3 attenuatedColor = applyVolumeAttenuation(transmittedLight, length(transmissionRay), attenuationColor, attenuationDistance);\n\t\treturn (1.0 - specularColor) * attenuatedColor * baseColor;\n\t}\n#endif",uv_pars_fragment:"#if ( defined( USE_UV ) && ! defined( UVS_VERTEX_ONLY ) )\n\tvarying vec2 vUv;\n#endif",uv_pars_vertex:"#ifdef USE_UV\n\t#ifdef UVS_VERTEX_ONLY\n\t\tvec2 vUv;\n\t#else\n\t\tvarying vec2 vUv;\n\t#endif\n\tuniform mat3 uvTransform;\n#endif",uv_vertex:"#ifdef USE_UV\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n#endif",uv2_pars_fragment:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvarying vec2 vUv2;\n#endif",uv2_pars_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tattribute vec2 uv2;\n\tvarying vec2 vUv2;\n\tuniform mat3 uv2Transform;\n#endif",uv2_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvUv2 = ( uv2Transform * vec3( uv2, 1 ) ).xy;\n#endif",worldpos_vertex:"#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION )\n\tvec4 worldPosition = vec4( transformed, 1.0 );\n\t#ifdef USE_INSTANCING\n\t\tworldPosition = instanceMatrix * worldPosition;\n\t#endif\n\tworldPosition = modelMatrix * worldPosition;\n#endif",background_frag:"uniform sampler2D t2D;\nvarying vec2 vUv;\nvoid main() {\n\tvec4 texColor = texture2D( t2D, vUv );\n\tgl_FragColor = mapTexelToLinear( texColor );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",background_vert:"varying vec2 vUv;\nuniform mat3 uvTransform;\nvoid main() {\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n\tgl_Position = vec4( position.xy, 1.0, 1.0 );\n}",cube_frag:"#include <envmap_common_pars_fragment>\nuniform float opacity;\nvarying vec3 vWorldDirection;\n#include <cube_uv_reflection_fragment>\nvoid main() {\n\tvec3 vReflect = vWorldDirection;\n\t#include <envmap_fragment>\n\tgl_FragColor = envColor;\n\tgl_FragColor.a *= opacity;\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",cube_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}",depth_frag:"#if DEPTH_PACKING == 3200\n\tuniform float opacity;\n#endif\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#if DEPTH_PACKING == 3200\n\t\tdiffuseColor.a = opacity;\n\t#endif\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <logdepthbuf_fragment>\n\tfloat fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;\n\t#if DEPTH_PACKING == 3200\n\t\tgl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );\n\t#elif DEPTH_PACKING == 3201\n\t\tgl_FragColor = packDepthToRGBA( fragCoordZ );\n\t#endif\n}",depth_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvHighPrecisionZW = gl_Position.zw;\n}",distanceRGBA_frag:"#define DISTANCE\nuniform vec3 referencePosition;\nuniform float nearDistance;\nuniform float farDistance;\nvarying vec3 vWorldPosition;\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main () {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\tfloat dist = length( vWorldPosition - referencePosition );\n\tdist = ( dist - nearDistance ) / ( farDistance - nearDistance );\n\tdist = saturate( dist );\n\tgl_FragColor = packDepthToRGBA( dist );\n}",distanceRGBA_vert:"#define DISTANCE\nvarying vec3 vWorldPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\tvWorldPosition = worldPosition.xyz;\n}",equirect_frag:"uniform sampler2D tEquirect;\nvarying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvec3 direction = normalize( vWorldDirection );\n\tvec2 sampleUV = equirectUv( direction );\n\tvec4 texColor = texture2D( tEquirect, sampleUV );\n\tgl_FragColor = mapTexelToLinear( texColor );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",equirect_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n}",linedashed_frag:"uniform vec3 diffuse;\nuniform float opacity;\nuniform float dashSize;\nuniform float totalSize;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tif ( mod( vLineDistance, totalSize ) > dashSize ) {\n\t\tdiscard;\n\t}\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <color_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",linedashed_vert:"uniform float scale;\nattribute float lineDistance;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\tvLineDistance = scale * lineDistance;\n\t#include <color_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",meshbasic_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <fog_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\t#ifdef USE_LIGHTMAP\n\t\n\t\tvec4 lightMapTexel= texture2D( lightMap, vUv2 );\n\t\treflectedLight.indirectDiffuse += lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;\n\t#else\n\t\treflectedLight.indirectDiffuse += vec3( 1.0 );\n\t#endif\n\t#include <aomap_fragment>\n\treflectedLight.indirectDiffuse *= diffuseColor.rgb;\n\tvec3 outgoingLight = reflectedLight.indirectDiffuse;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshbasic_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinbase_vertex>\n\t\t#include <skinnormal_vertex>\n\t\t#include <defaultnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <fog_vertex>\n}",meshlambert_frag:"uniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\nvarying vec3 vLightFront;\nvarying vec3 vIndirectFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n\tvarying vec3 vIndirectBack;\n#endif\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <fog_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <emissivemap_fragment>\n\t#ifdef DOUBLE_SIDED\n\t\treflectedLight.indirectDiffuse += ( gl_FrontFacing ) ? vIndirectFront : vIndirectBack;\n\t#else\n\t\treflectedLight.indirectDiffuse += vIndirectFront;\n\t#endif\n\t#include <lightmap_fragment>\n\treflectedLight.indirectDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb );\n\t#ifdef DOUBLE_SIDED\n\t\treflectedLight.directDiffuse = ( gl_FrontFacing ) ? vLightFront : vLightBack;\n\t#else\n\t\treflectedLight.directDiffuse = vLightFront;\n\t#endif\n\treflectedLight.directDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb ) * getShadowMask();\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshlambert_vert:"#define LAMBERT\nvarying vec3 vLightFront;\nvarying vec3 vIndirectFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n\tvarying vec3 vIndirectBack;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <lights_lambert_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshmatcap_frag:"#define MATCAP\nuniform vec3 diffuse;\nuniform float opacity;\nuniform sampler2D matcap;\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tvec3 viewDir = normalize( vViewPosition );\n\tvec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );\n\tvec3 y = cross( viewDir, x );\n\tvec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;\n\t#ifdef USE_MATCAP\n\t\tvec4 matcapColor = texture2D( matcap, uv );\n\t\tmatcapColor = matcapTexelToLinear( matcapColor );\n\t#else\n\t\tvec4 matcapColor = vec4( 1.0 );\n\t#endif\n\tvec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshmatcap_vert:"#define MATCAP\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <color_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#ifndef FLAT_SHADED\n\t\tvNormal = normalize( transformedNormal );\n\t\t#ifdef USE_TANGENT\n\t\t\tvTangent = normalize( transformedTangent );\n\t\t\tvBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n\t\t#endif\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n\tvViewPosition = - mvPosition.xyz;\n}",meshtoon_frag:"#define TOON\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <gradientmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <lights_toon_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_toon_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshtoon_vert:"#define TOON\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshphong_frag:"#define PHONG\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <lights_phong_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_phong_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshphong_vert:"#define PHONG\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshphysical_frag:"#define STANDARD\n#ifdef PHYSICAL\n\t#define REFLECTIVITY\n\t#define CLEARCOAT\n\t#define SPECULAR\n#endif\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n#ifdef USE_TRANSMISSION\n\tuniform float transmission;\n\tuniform float thickness;\n\tuniform float attenuationDistance;\n\tuniform vec3 attenuationTint;\n#endif\n#ifdef REFLECTIVITY\n\tuniform float reflectivity;\n#endif\n#ifdef SPECULAR\n\tuniform float specularIntensity;\n\tuniform vec3 specularTint;\n\t#ifdef USE_SPECULARINTENSITYMAP\n\t\tuniform sampler2D specularIntensityMap;\n\t#endif\n\t#ifdef USE_SPECULARTINTMAP\n\t\tuniform sampler2D specularTintMap;\n\t#endif\n#endif\n#ifdef CLEARCOAT\n\tuniform float clearcoat;\n\tuniform float clearcoatRoughness;\n#endif\n#ifdef USE_SHEEN\n\tuniform vec3 sheen;\n#endif\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <bsdfs>\n#include <transmission_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_physical_pars_fragment>\n#include <fog_pars_fragment>\n#include <lights_pars_begin>\n#include <lights_physical_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <clearcoat_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <roughnessmap_fragment>\n\t#include <metalnessmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <clearcoat_normal_fragment_begin>\n\t#include <clearcoat_normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_physical_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;\n\tvec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;\n\t#include <transmission_fragment>\n\tvec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshphysical_vert:"#define STANDARD\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif\n#ifdef USE_TRANSMISSION\n\tvarying vec4 vWorldPosition;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n\t#ifdef USE_TANGENT\n\t\tvTangent = normalize( transformedTangent );\n\t\tvBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n\t#endif\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n#ifdef USE_TRANSMISSION\n\tvWorldPosition = worldPosition;\n#endif\n}",normal_frag:"#define NORMAL\nuniform float opacity;\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvarying vec3 vViewPosition;\n#endif\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif\n#include <packing>\n#include <uv_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\t#include <logdepthbuf_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tgl_FragColor = vec4( packNormalToRGB( normal ), opacity );\n}",normal_vert:"#define NORMAL\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvarying vec3 vViewPosition;\n#endif\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n\t#ifdef USE_TANGENT\n\t\tvTangent = normalize( transformedTangent );\n\t\tvBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n\t#endif\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n}",points_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <color_pars_fragment>\n#include <map_particle_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_particle_fragment>\n\t#include <color_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",points_vert:"uniform float size;\nuniform float scale;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <color_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\tgl_PointSize = size;\n\t#ifdef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );\n\t#endif\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <fog_vertex>\n}",shadow_frag:"uniform vec3 color;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\nvoid main() {\n\tgl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}",shadow_vert:"#include <common>\n#include <fog_pars_vertex>\n#include <shadowmap_pars_vertex>\nvoid main() {\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",sprite_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}",sprite_vert:"uniform float rotation;\nuniform vec2 center;\n#include <common>\n#include <uv_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\tvec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );\n\tvec2 scale;\n\tscale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );\n\tscale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );\n\t#ifndef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) scale *= - mvPosition.z;\n\t#endif\n\tvec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;\n\tvec2 rotatedPosition;\n\trotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;\n\trotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;\n\tmvPosition.xy += rotatedPosition;\n\tgl_Position = projectionMatrix * mvPosition;\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}"},Lr={common:{diffuse:{value:new vn(16777215)},opacity:{value:1},map:{value:null},uvTransform:{value:new Fe},uv2Transform:{value:new Fe},alphaMap:{value:null}},specularmap:{specularMap:{value:null}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},refractionRatio:{value:.98},maxMipLevel:{value:0}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1}},emissivemap:{emissiveMap:{value:null}},bumpmap:{bumpMap:{value:null},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalScale:{value:new Ie(1,1)}},displacementmap:{displacementMap:{value:null},displacementScale:{value:1},displacementBias:{value:0}},roughnessmap:{roughnessMap:{value:null}},metalnessmap:{metalnessMap:{value:null}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new vn(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotShadowMap:{value:[]},spotShadowMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new vn(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},uvTransform:{value:new Fe}},sprite:{diffuse:{value:new vn(16777215)},opacity:{value:1},center:{value:new Ie(.5,.5)},rotation:{value:0},map:{value:null},alphaMap:{value:null},uvTransform:{value:new Fe}}},Cr={basic:{uniforms:lr([Lr.common,Lr.specularmap,Lr.envmap,Lr.aomap,Lr.lightmap,Lr.fog]),vertexShader:Ar.meshbasic_vert,fragmentShader:Ar.meshbasic_frag},lambert:{uniforms:lr([Lr.common,Lr.specularmap,Lr.envmap,Lr.aomap,Lr.lightmap,Lr.emissivemap,Lr.fog,Lr.lights,{emissive:{value:new vn(0)}}]),vertexShader:Ar.meshlambert_vert,fragmentShader:Ar.meshlambert_frag},phong:{uniforms:lr([Lr.common,Lr.specularmap,Lr.envmap,Lr.aomap,Lr.lightmap,Lr.emissivemap,Lr.bumpmap,Lr.normalmap,Lr.displacementmap,Lr.fog,Lr.lights,{emissive:{value:new vn(0)},specular:{value:new vn(1118481)},shininess:{value:30}}]),vertexShader:Ar.meshphong_vert,fragmentShader:Ar.meshphong_frag},standard:{uniforms:lr([Lr.common,Lr.envmap,Lr.aomap,Lr.lightmap,Lr.emissivemap,Lr.bumpmap,Lr.normalmap,Lr.displacementmap,Lr.roughnessmap,Lr.metalnessmap,Lr.fog,Lr.lights,{emissive:{value:new vn(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:Ar.meshphysical_vert,fragmentShader:Ar.meshphysical_frag},toon:{uniforms:lr([Lr.common,Lr.aomap,Lr.lightmap,Lr.emissivemap,Lr.bumpmap,Lr.normalmap,Lr.displacementmap,Lr.gradientmap,Lr.fog,Lr.lights,{emissive:{value:new vn(0)}}]),vertexShader:Ar.meshtoon_vert,fragmentShader:Ar.meshtoon_frag},matcap:{uniforms:lr([Lr.common,Lr.bumpmap,Lr.normalmap,Lr.displacementmap,Lr.fog,{matcap:{value:null}}]),vertexShader:Ar.meshmatcap_vert,fragmentShader:Ar.meshmatcap_frag},points:{uniforms:lr([Lr.points,Lr.fog]),vertexShader:Ar.points_vert,fragmentShader:Ar.points_frag},dashed:{uniforms:lr([Lr.common,Lr.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:Ar.linedashed_vert,fragmentShader:Ar.linedashed_frag},depth:{uniforms:lr([Lr.common,Lr.displacementmap]),vertexShader:Ar.depth_vert,fragmentShader:Ar.depth_frag},normal:{uniforms:lr([Lr.common,Lr.bumpmap,Lr.normalmap,Lr.displacementmap,{opacity:{value:1}}]),vertexShader:Ar.normal_vert,fragmentShader:Ar.normal_frag},sprite:{uniforms:lr([Lr.sprite,Lr.fog]),vertexShader:Ar.sprite_vert,fragmentShader:Ar.sprite_frag},background:{uniforms:{uvTransform:{value:new Fe},t2D:{value:null}},vertexShader:Ar.background_vert,fragmentShader:Ar.background_frag},cube:{uniforms:lr([Lr.envmap,{opacity:{value:1}}]),vertexShader:Ar.cube_vert,fragmentShader:Ar.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:Ar.equirect_vert,fragmentShader:Ar.equirect_frag},distanceRGBA:{uniforms:lr([Lr.common,Lr.displacementmap,{referencePosition:{value:new qe},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:Ar.distanceRGBA_vert,fragmentShader:Ar.distanceRGBA_frag},shadow:{uniforms:lr([Lr.lights,Lr.fog,{color:{value:new vn(0)},opacity:{value:1}}]),vertexShader:Ar.shadow_vert,fragmentShader:Ar.shadow_frag}};function Rr(e,t,n,r,i){var a,o,s=new vn(0),l=0,u=null,c=0,h=null;function d(e,t){n.buffers.color.setClear(e.r,e.g,e.b,t,i)}return{getClearColor:function(){return s},setClearColor:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;s.set(e),d(s,l=t)},getClearAlpha:function(){return l},setClearAlpha:function(e){d(s,l=e)},render:function(n,i){var f=!1,p=!0===i.isScene?i.background:null;p&&p.isTexture&&(p=t.get(p));var v=e.xr,m=v.getSession&&v.getSession();m&&"additive"===m.environmentBlendMode&&(p=null),null===p?d(s,l):p&&p.isColor&&(d(p,1),f=!0),(e.autoClear||f)&&e.clear(e.autoClearColor,e.autoClearDepth,e.autoClearStencil),p&&(p.isCubeTexture||p.mapping===T)?(void 0===o&&((o=new ir(new or(1,1,1),new cr({name:"BackgroundCubeMaterial",uniforms:sr(Cr.cube.uniforms),vertexShader:Cr.cube.vertexShader,fragmentShader:Cr.cube.fragmentShader,side:1,depthTest:!1,depthWrite:!1,fog:!1}))).geometry.deleteAttribute("normal"),o.geometry.deleteAttribute("uv"),o.onBeforeRender=function(e,t,n){this.matrixWorld.copyPosition(n.matrixWorld)},Object.defineProperty(o.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),r.update(o)),o.material.uniforms.envMap.value=p,o.material.uniforms.flipEnvMap.value=p.isCubeTexture&&!1===p.isRenderTargetTexture?-1:1,u===p&&c===p.version&&h===e.toneMapping||(o.material.needsUpdate=!0,u=p,c=p.version,h=e.toneMapping),n.unshift(o,o.geometry,o.material,0,0,null)):p&&p.isTexture&&(void 0===a&&((a=new ir(new Er(2,2),new cr({name:"BackgroundMaterial",uniforms:sr(Cr.background.uniforms),vertexShader:Cr.background.vertexShader,fragmentShader:Cr.background.fragmentShader,side:0,depthTest:!1,depthWrite:!1,fog:!1}))).geometry.deleteAttribute("normal"),Object.defineProperty(a.material,"map",{get:function(){return this.uniforms.t2D.value}}),r.update(a)),a.material.uniforms.t2D.value=p,!0===p.matrixAutoUpdate&&p.updateMatrix(),a.material.uniforms.uvTransform.value.copy(p.matrix),u===p&&c===p.version&&h===e.toneMapping||(a.material.needsUpdate=!0,u=p,c=p.version,h=e.toneMapping),n.unshift(a,a.geometry,a.material,0,0,null))}}}function kr(e,t,n,r){var i=e.getParameter(e.MAX_VERTEX_ATTRIBS),a=r.isWebGL2?null:t.get("OES_vertex_array_object"),o=r.isWebGL2||null!==a,s={},l=d(null),u=l;function c(t){return r.isWebGL2?e.bindVertexArray(t):a.bindVertexArrayOES(t)}function h(t){return r.isWebGL2?e.deleteVertexArray(t):a.deleteVertexArrayOES(t)}function d(e){for(var t=[],n=[],r=[],a=0;a<i;a++)t[a]=0,n[a]=0,r[a]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:t,enabledAttributes:n,attributeDivisors:r,object:e,attributes:{},index:null}}function f(){for(var e=u.newAttributes,t=0,n=e.length;t<n;t++)e[t]=0}function p(e){v(e,0)}function v(n,i){var a=u.newAttributes,o=u.enabledAttributes,s=u.attributeDivisors;a[n]=1,0===o[n]&&(e.enableVertexAttribArray(n),o[n]=1),s[n]!==i&&((r.isWebGL2?e:t.get("ANGLE_instanced_arrays"))[r.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](n,i),s[n]=i)}function m(){for(var t=u.newAttributes,n=u.enabledAttributes,r=0,i=n.length;r<i;r++)n[r]!==t[r]&&(e.disableVertexAttribArray(r),n[r]=0)}function g(t,n,i,a,o,s){!0!==r.isWebGL2||i!==e.INT&&i!==e.UNSIGNED_INT?e.vertexAttribPointer(t,n,i,a,o,s):e.vertexAttribIPointer(t,n,i,o,s)}function _(){y(),u!==l&&c((u=l).object)}function y(){l.geometry=null,l.program=null,l.wireframe=!1}return{setup:function(i,l,h,_,y){var x=!1;if(o){var b=function(t,n,i){var o=!0===i.wireframe,l=s[t.id];void 0===l&&(l={},s[t.id]=l);var u=l[n.id];void 0===u&&(u={},l[n.id]=u);var c=u[o];return void 0===c&&(c=d(r.isWebGL2?e.createVertexArray():a.createVertexArrayOES()),u[o]=c),c}(_,h,l);u!==b&&c((u=b).object),x=function(e,t){var n=u.attributes,r=e.attributes,i=0;for(var a in r){var o=n[a],s=r[a];if(void 0===o)return!0;if(o.attribute!==s)return!0;if(o.data!==s.data)return!0;i++}return u.attributesNum!==i||u.index!==t}(_,y),x&&function(e,t){var n={},r=e.attributes,i=0;for(var a in r){var o=r[a],s={};s.attribute=o,o.data&&(s.data=o.data),n[a]=s,i++}u.attributes=n,u.attributesNum=i,u.index=t}(_,y)}else{var w=!0===l.wireframe;u.geometry===_.id&&u.program===h.id&&u.wireframe===w||(u.geometry=_.id,u.program=h.id,u.wireframe=w,x=!0)}!0===i.isInstancedMesh&&(x=!0),null!==y&&n.update(y,e.ELEMENT_ARRAY_BUFFER),x&&(function(i,a,o,s){if(!1!==r.isWebGL2||!i.isInstancedMesh&&!s.isInstancedBufferGeometry||null!==t.get("ANGLE_instanced_arrays")){f();var l=s.attributes,u=o.getAttributes(),c=a.defaultAttributeValues;for(var h in u){var d=u[h];if(d>=0){var _=l[h];if(void 0!==_){var y=_.normalized,x=_.itemSize,b=n.get(_);if(void 0===b)continue;var w=b.buffer,T=b.type,M=b.bytesPerElement;if(_.isInterleavedBufferAttribute){var S=_.data,E=S.stride,A=_.offset;S&&S.isInstancedInterleavedBuffer?(v(d,S.meshPerAttribute),void 0===s._maxInstanceCount&&(s._maxInstanceCount=S.meshPerAttribute*S.count)):p(d),e.bindBuffer(e.ARRAY_BUFFER,w),g(d,x,T,y,E*M,A*M)}else _.isInstancedBufferAttribute?(v(d,_.meshPerAttribute),void 0===s._maxInstanceCount&&(s._maxInstanceCount=_.meshPerAttribute*_.count)):p(d),e.bindBuffer(e.ARRAY_BUFFER,w),g(d,x,T,y,0,0)}else if("instanceMatrix"===h){var L=n.get(i.instanceMatrix);if(void 0===L)continue;var C=L.buffer,R=L.type;v(d+0,1),v(d+1,1),v(d+2,1),v(d+3,1),e.bindBuffer(e.ARRAY_BUFFER,C),e.vertexAttribPointer(d+0,4,R,!1,64,0),e.vertexAttribPointer(d+1,4,R,!1,64,16),e.vertexAttribPointer(d+2,4,R,!1,64,32),e.vertexAttribPointer(d+3,4,R,!1,64,48)}else if("instanceColor"===h){var k=n.get(i.instanceColor);if(void 0===k)continue;var P=k.buffer,D=k.type;v(d,1),e.bindBuffer(e.ARRAY_BUFFER,P),e.vertexAttribPointer(d,3,D,!1,12,0)}else if(void 0!==c){var I=c[h];if(void 0!==I)switch(I.length){case 2:e.vertexAttrib2fv(d,I);break;case 3:e.vertexAttrib3fv(d,I);break;case 4:e.vertexAttrib4fv(d,I);break;default:e.vertexAttrib1fv(d,I)}}}}m()}}(i,l,h,_),null!==y&&e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,n.get(y).buffer))},reset:_,resetDefaultState:y,dispose:function(){for(var e in _(),s){var t=s[e];for(var n in t){var r=t[n];for(var i in r)h(r[i].object),delete r[i];delete t[n]}delete s[e]}},releaseStatesOfGeometry:function(e){if(void 0!==s[e.id]){var t=s[e.id];for(var n in t){var r=t[n];for(var i in r)h(r[i].object),delete r[i];delete t[n]}delete s[e.id]}},releaseStatesOfProgram:function(e){for(var t in s){var n=s[t];if(void 0!==n[e.id]){var r=n[e.id];for(var i in r)h(r[i].object),delete r[i];delete n[e.id]}}},initAttributes:f,enableAttribute:p,disableUnusedAttributes:m}}function Pr(e,t,n,r){var i,a=r.isWebGL2;this.setMode=function(e){i=e},this.render=function(t,r){e.drawArrays(i,t,r),n.update(r,i,1)},this.renderInstances=function(r,o,s){if(0!==s){var l,u;if(a)l=e,u="drawArraysInstanced";else if(u="drawArraysInstancedANGLE",null===(l=t.get("ANGLE_instanced_arrays")))return void console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");l[u](i,r,o,s),n.update(o,i,s)}}}function Dr(e,t,n){var r;function i(t){if("highp"===t){if(e.getShaderPrecisionFormat(e.VERTEX_SHADER,e.HIGH_FLOAT).precision>0&&e.getShaderPrecisionFormat(e.FRAGMENT_SHADER,e.HIGH_FLOAT).precision>0)return"highp";t="mediump"}return"mediump"===t&&e.getShaderPrecisionFormat(e.VERTEX_SHADER,e.MEDIUM_FLOAT).precision>0&&e.getShaderPrecisionFormat(e.FRAGMENT_SHADER,e.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}var a="undefined"!=typeof WebGL2RenderingContext&&e instanceof WebGL2RenderingContext||"undefined"!=typeof WebGL2ComputeRenderingContext&&e instanceof WebGL2ComputeRenderingContext,o=void 0!==n.precision?n.precision:"highp",s=i(o);s!==o&&(console.warn("THREE.WebGLRenderer:",o,"not supported, using",s,"instead."),o=s);var l=a||t.has("WEBGL_draw_buffers"),u=!0===n.logarithmicDepthBuffer,c=e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS),h=e.getParameter(e.MAX_VERTEX_TEXTURE_IMAGE_UNITS),d=e.getParameter(e.MAX_TEXTURE_SIZE),f=e.getParameter(e.MAX_CUBE_MAP_TEXTURE_SIZE),p=e.getParameter(e.MAX_VERTEX_ATTRIBS),v=e.getParameter(e.MAX_VERTEX_UNIFORM_VECTORS),m=e.getParameter(e.MAX_VARYING_VECTORS),g=e.getParameter(e.MAX_FRAGMENT_UNIFORM_VECTORS),_=h>0,y=a||t.has("OES_texture_float");return{isWebGL2:a,drawBuffers:l,getMaxAnisotropy:function(){if(void 0!==r)return r;if(!0===t.has("EXT_texture_filter_anisotropic")){var n=t.get("EXT_texture_filter_anisotropic");r=e.getParameter(n.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else r=0;return r},getMaxPrecision:i,precision:o,logarithmicDepthBuffer:u,maxTextures:c,maxVertexTextures:h,maxTextureSize:d,maxCubemapSize:f,maxAttributes:p,maxVertexUniforms:v,maxVaryings:m,maxFragmentUniforms:g,vertexTextures:_,floatFragmentTextures:y,floatVertexTextures:_&&y,maxSamples:a?e.getParameter(e.MAX_SAMPLES):0}}function Ir(e){var t=this,n=null,r=0,i=!1,a=!1,o=new xr,s=new Fe,l={value:null,needsUpdate:!1};function u(){l.value!==n&&(l.value=n,l.needsUpdate=r>0),t.numPlanes=r,t.numIntersection=0}function c(e,n,r,i){var a=null!==e?e.length:0,u=null;if(0!==a){if(u=l.value,!0!==i||null===u){var c=r+4*a,h=n.matrixWorldInverse;s.getNormalMatrix(h),(null===u||u.length<c)&&(u=new Float32Array(c));for(var d=0,f=r;d!==a;++d,f+=4)o.copy(e[d]).applyMatrix4(h,s),o.normal.toArray(u,f),u[f+3]=o.constant}l.value=u,l.needsUpdate=!0}return t.numPlanes=a,t.numIntersection=0,u}this.uniform=l,this.numPlanes=0,this.numIntersection=0,this.init=function(e,t,a){var o=0!==e.length||t||0!==r||i;return i=t,n=c(e,a,0),r=e.length,o},this.beginShadows=function(){a=!0,c(null)},this.endShadows=function(){a=!1,u()},this.setState=function(t,o,s){var h=t.clippingPlanes,d=t.clipIntersection,f=t.clipShadows,p=e.get(t);if(!i||null===h||0===h.length||a&&!f)a?c(null):u();else{var v=a?0:r,m=4*v,g=p.clippingState||null;l.value=g,g=c(h,o,m,s);for(var _=0;_!==m;++_)g[_]=n[_];p.clippingState=g,this.numIntersection=d?this.numPlanes:0,this.numPlanes+=v}}}function Or(e){var t=new WeakMap;function n(e,t){return t===y?e.mapping=a:t===w&&(e.mapping=g),e}function r(e){var n=e.target;n.removeEventListener("dispose",r);var i=t.get(n);void 0!==i&&(t.delete(n),i.dispose())}return{get:function(i){if(i&&i.isTexture&&!1===i.isRenderTargetTexture){var a=i.mapping;if(a===y||a===w){if(t.has(i))return n(t.get(i).texture,i.mapping);var o=i.image;if(o&&o.height>0){var s=e.getRenderTarget(),l=new mr(o.height/2);return l.fromEquirectangularTexture(e,i),t.set(i,l),e.setRenderTarget(s),i.addEventListener("dispose",r),n(l.texture,i.mapping)}return null}}return i},dispose:function(){t=new WeakMap}}}Cr.physical={uniforms:lr([Cr.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatNormalScale:{value:new Ie(1,1)},clearcoatNormalMap:{value:null},sheen:{value:new vn(0)},transmission:{value:0},transmissionMap:{value:null},transmissionSamplerSize:{value:new Ie},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},attenuationDistance:{value:0},attenuationTint:{value:new vn(0)},specularIntensity:{value:0},specularIntensityMap:{value:null},specularTint:{value:new vn(1,1,1)},specularTintMap:{value:null}}]),vertexShader:Ar.meshphysical_vert,fragmentShader:Ar.meshphysical_frag};var Fr=function(e){(0,d.default)(n,e);var t=b(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:-1,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:.1,l=arguments.length>5&&void 0!==arguments[5]?arguments[5]:2e3;return(0,v.default)(this,n),(e=t.call(this)).type="OrthographicCamera",e.zoom=1,e.view=null,e.left=r,e.right=i,e.top=a,e.bottom=o,e.near=s,e.far=l,e.updateProjectionMatrix(),e}return(0,m.default)(n,[{key:"copy",value:function(e,t){return(0,u.default)((0,p.default)(n.prototype),"copy",this).call(this,e,t),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=null===e.view?null:Object.assign({},e.view),this}},{key:"setViewOffset",value:function(e,t,n,r,i,a){null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=n,this.view.offsetY=r,this.view.width=i,this.view.height=a,this.updateProjectionMatrix()}},{key:"clearViewOffset",value:function(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}},{key:"updateProjectionMatrix",value:function(){var e=(this.right-this.left)/(2*this.zoom),t=(this.top-this.bottom)/(2*this.zoom),n=(this.right+this.left)/2,r=(this.top+this.bottom)/2,i=n-e,a=n+e,o=r+t,s=r-t;if(null!==this.view&&this.view.enabled){var l=(this.right-this.left)/this.view.fullWidth/this.zoom,u=(this.top-this.bottom)/this.view.fullHeight/this.zoom;a=(i+=l*this.view.offsetX)+l*this.view.width,s=(o-=u*this.view.offsetY)-u*this.view.height}this.projectionMatrix.makeOrthographic(i,a,o,s,this.near,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}},{key:"toJSON",value:function(e){var t=(0,u.default)((0,p.default)(n.prototype),"toJSON",this).call(this,e);return t.object.zoom=this.zoom,t.object.left=this.left,t.object.right=this.right,t.object.top=this.top,t.object.bottom=this.bottom,t.object.near=this.near,t.object.far=this.far,null!==this.view&&(t.object.view=Object.assign({},this.view)),t}}]),n}(hr);Fr.prototype.isOrthographicCamera=!0;var Nr=function(e){(0,d.default)(n,e);var t=b(n);function n(e){var r;return(0,v.default)(this,n),(r=t.call(this,e)).type="RawShaderMaterial",r}return(0,m.default)(n)}(cr);Nr.prototype.isRawShaderMaterial=!0;var Ur=Math.pow(2,8),Br=[.125,.215,.35,.446,.526,.582],zr=5+Br.length,Hr=20,Gr=(t={},(0,c.default)(t,ue,0),(0,c.default)(t,ce,1),(0,c.default)(t,de,2),(0,c.default)(t,fe,3),(0,c.default)(t,pe,4),(0,c.default)(t,ve,5),(0,c.default)(t,he,6),t),Vr=new mn({side:1,depthWrite:!1,depthTest:!1}),Wr=new ir(new or,Vr),jr=new Fr,qr=ii(),Xr=qr._lodPlanes,Yr=qr._sizeLods,Kr=qr._sigmas,Zr=new vn,Jr=null,Qr=(1+Math.sqrt(5))/2,$r=1/Qr,ei=[new qe(1,1,1),new qe(-1,1,1),new qe(1,1,-1),new qe(-1,1,-1),new qe(0,Qr,$r),new qe(0,Qr,-$r),new qe($r,0,Qr),new qe(-$r,0,Qr),new qe(Qr,$r,0),new qe(-Qr,$r,0)];function ti(e){var t=Math.max(e.r,e.g,e.b),n=Math.min(Math.max(Math.ceil(Math.log2(t)),-128),127);return e.multiplyScalar(Math.pow(2,-n)),(n+128)/255}var ni=function(){function e(t){var n,r,i;(0,v.default)(this,e),this._renderer=t,this._pingPongRenderTarget=null,this._blurMaterial=(n=Hr,r=new Float32Array(n),i=new qe(0,1,0),new Nr({name:"SphericalGaussianBlur",defines:{n:n},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:r},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:i},inputEncoding:{value:Gr[3e3]},outputEncoding:{value:Gr[3e3]}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute vec3 position;\n\t\tattribute vec2 uv;\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\t\t\tuniform int samples;\n\t\t\tuniform float weights[ n ];\n\t\t\tuniform bool latitudinal;\n\t\t\tuniform float dTheta;\n\t\t\tuniform float mipInt;\n\t\t\tuniform vec3 poleAxis;\n\n\t\t\t".concat("\n\n\t\tuniform int inputEncoding;\n\t\tuniform int outputEncoding;\n\n\t\t#include <encodings_pars_fragment>\n\n\t\tvec4 inputTexelToLinear( vec4 value ) {\n\n\t\t\tif ( inputEncoding == 0 ) {\n\n\t\t\t\treturn value;\n\n\t\t\t} else if ( inputEncoding == 1 ) {\n\n\t\t\t\treturn sRGBToLinear( value );\n\n\t\t\t} else if ( inputEncoding == 2 ) {\n\n\t\t\t\treturn RGBEToLinear( value );\n\n\t\t\t} else if ( inputEncoding == 3 ) {\n\n\t\t\t\treturn RGBMToLinear( value, 7.0 );\n\n\t\t\t} else if ( inputEncoding == 4 ) {\n\n\t\t\t\treturn RGBMToLinear( value, 16.0 );\n\n\t\t\t} else if ( inputEncoding == 5 ) {\n\n\t\t\t\treturn RGBDToLinear( value, 256.0 );\n\n\t\t\t} else {\n\n\t\t\t\treturn GammaToLinear( value, 2.2 );\n\n\t\t\t}\n\n\t\t}\n\n\t\tvec4 linearToOutputTexel( vec4 value ) {\n\n\t\t\tif ( outputEncoding == 0 ) {\n\n\t\t\t\treturn value;\n\n\t\t\t} else if ( outputEncoding == 1 ) {\n\n\t\t\t\treturn LinearTosRGB( value );\n\n\t\t\t} else if ( outputEncoding == 2 ) {\n\n\t\t\t\treturn LinearToRGBE( value );\n\n\t\t\t} else if ( outputEncoding == 3 ) {\n\n\t\t\t\treturn LinearToRGBM( value, 7.0 );\n\n\t\t\t} else if ( outputEncoding == 4 ) {\n\n\t\t\t\treturn LinearToRGBM( value, 16.0 );\n\n\t\t\t} else if ( outputEncoding == 5 ) {\n\n\t\t\t\treturn LinearToRGBD( value, 256.0 );\n\n\t\t\t} else {\n\n\t\t\t\treturn LinearToGamma( value, 2.2 );\n\n\t\t\t}\n\n\t\t}\n\n\t\tvec4 envMapTexelToLinear( vec4 color ) {\n\n\t\t\treturn inputTexelToLinear( color );\n\n\t\t}\n\t","\n\n\t\t\t#define ENVMAP_TYPE_CUBE_UV\n\t\t\t#include <cube_uv_reflection_fragment>\n\n\t\t\tvec3 getSample( float theta, vec3 axis ) {\n\n\t\t\t\tfloat cosTheta = cos( theta );\n\t\t\t\t// Rodrigues' axis-angle rotation\n\t\t\t\tvec3 sampleDirection = vOutputDirection * cosTheta\n\t\t\t\t\t+ cross( axis, vOutputDirection ) * sin( theta )\n\t\t\t\t\t+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );\n\n\t\t\t\treturn bilinearCubeUV( envMap, sampleDirection, mipInt );\n\n\t\t\t}\n\n\t\t\tvoid main() {\n\n\t\t\t\tvec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );\n\n\t\t\t\tif ( all( equal( axis, vec3( 0.0 ) ) ) ) {\n\n\t\t\t\t\taxis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );\n\n\t\t\t\t}\n\n\t\t\t\taxis = normalize( axis );\n\n\t\t\t\tgl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\t\t\t\tgl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );\n\n\t\t\t\tfor ( int i = 1; i < n; i++ ) {\n\n\t\t\t\t\tif ( i >= samples ) {\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tfloat theta = dTheta * float( i );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( theta, axis );\n\n\t\t\t\t}\n\n\t\t\t\tgl_FragColor = linearToOutputTexel( gl_FragColor );\n\n\t\t\t}\n\t\t"),blending:0,depthTest:!1,depthWrite:!1})),this._equirectShader=null,this._cubemapShader=null,this._compileMaterial(this._blurMaterial)}return(0,m.default)(e,[{key:"fromScene",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:100;Jr=this._renderer.getRenderTarget();var i=this._allocateTargets();return this._sceneToCubeUV(e,n,r,i),t>0&&this._blur(i,0,0,t),this._applyPMREM(i),this._cleanup(i),i}},{key:"fromEquirectangular",value:function(e){return this._fromTexture(e)}},{key:"fromCubemap",value:function(e){return this._fromTexture(e)}},{key:"compileCubemapShader",value:function(){null===this._cubemapShader&&(this._cubemapShader=li(),this._compileMaterial(this._cubemapShader))}},{key:"compileEquirectangularShader",value:function(){null===this._equirectShader&&(this._equirectShader=si(),this._compileMaterial(this._equirectShader))}},{key:"dispose",value:function(){this._blurMaterial.dispose(),null!==this._cubemapShader&&this._cubemapShader.dispose(),null!==this._equirectShader&&this._equirectShader.dispose();for(var e=0;e<Xr.length;e++)Xr[e].dispose()}},{key:"_cleanup",value:function(e){this._pingPongRenderTarget.dispose(),this._renderer.setRenderTarget(Jr),e.scissorTest=!1,oi(e,0,0,e.width,e.height)}},{key:"_fromTexture",value:function(e){Jr=this._renderer.getRenderTarget();var t=this._allocateTargets(e);return this._textureToCubeUV(e,t),this._applyPMREM(t),this._cleanup(t),t}},{key:"_allocateTargets",value:function(e){var t={magFilter:L,minFilter:L,generateMipmaps:!1,type:I,format:1023,encoding:ri(e)?e.encoding:de,depthBuffer:!1},n=ai(t);return n.depthBuffer=!e,this._pingPongRenderTarget=ai(t),n}},{key:"_compileMaterial",value:function(e){var t=new ir(Xr[0],e);this._renderer.compile(t,jr)}},{key:"_sceneToCubeUV",value:function(e,t,n,r){var i=new dr(90,1,t,n),a=[1,-1,1,1,1,1],o=[1,1,1,-1,-1,-1],s=this._renderer,l=s.autoClear,u=s.outputEncoding,c=s.toneMapping;s.getClearColor(Zr),s.toneMapping=0,s.outputEncoding=ue,s.autoClear=!1;var h=!1,d=e.background;if(d){if(d.isColor){Vr.color.copy(d).convertSRGBToLinear(),e.background=null;var f=ti(Vr.color);Vr.opacity=f,h=!0}}else{Vr.color.copy(Zr).convertSRGBToLinear();var p=ti(Vr.color);Vr.opacity=p,h=!0}for(var v=0;v<6;v++){var m=v%3;0==m?(i.up.set(0,a[v],0),i.lookAt(o[v],0,0)):1==m?(i.up.set(0,0,a[v]),i.lookAt(0,o[v],0)):(i.up.set(0,a[v],0),i.lookAt(0,0,o[v])),oi(r,m*Ur,v>2?Ur:0,Ur,Ur),s.setRenderTarget(r),h&&s.render(Wr,i),s.render(e,i)}s.toneMapping=c,s.outputEncoding=u,s.autoClear=l}},{key:"_textureToCubeUV",value:function(e,t){var n=this._renderer;e.isCubeTexture?null==this._cubemapShader&&(this._cubemapShader=li()):null==this._equirectShader&&(this._equirectShader=si());var r=e.isCubeTexture?this._cubemapShader:this._equirectShader,i=new ir(Xr[0],r),a=r.uniforms;a.envMap.value=e,e.isCubeTexture||a.texelSize.value.set(1/e.image.width,1/e.image.height),a.inputEncoding.value=Gr[e.encoding],a.outputEncoding.value=Gr[t.texture.encoding],oi(t,0,0,3*Ur,2*Ur),n.setRenderTarget(t),n.render(i,jr)}},{key:"_applyPMREM",value:function(e){var t=this._renderer,n=t.autoClear;t.autoClear=!1;for(var r=1;r<zr;r++){var i=Math.sqrt(Kr[r]*Kr[r]-Kr[r-1]*Kr[r-1]),a=ei[(r-1)%ei.length];this._blur(e,r-1,r,i,a)}t.autoClear=n}},{key:"_blur",value:function(e,t,n,r,i){var a=this._pingPongRenderTarget;this._halfBlur(e,a,t,n,r,"latitudinal",i),this._halfBlur(a,e,n,n,r,"longitudinal",i)}},{key:"_halfBlur",value:function(e,t,n,r,i,a,o){var s=this._renderer,l=this._blurMaterial;"latitudinal"!==a&&"longitudinal"!==a&&console.error("blur direction must be either latitudinal or longitudinal!");var u=new ir(Xr[r],l),c=l.uniforms,h=Yr[n]-1,d=isFinite(i)?Math.PI/(2*h):2*Math.PI/39,f=i/d,p=isFinite(i)?1+Math.floor(3*f):Hr;p>Hr&&console.warn("sigmaRadians, ".concat(i,", is too large and will clip, as it requested ").concat(p," samples when the maximum is set to ").concat(Hr));for(var v=[],m=0,g=0;g<Hr;++g){var _=g/f,y=Math.exp(-_*_/2);v.push(y),0==g?m+=y:g<p&&(m+=2*y)}for(var x=0;x<v.length;x++)v[x]=v[x]/m;c.envMap.value=e.texture,c.samples.value=p,c.weights.value=v,c.latitudinal.value="latitudinal"===a,o&&(c.poleAxis.value=o),c.dTheta.value=d,c.mipInt.value=8-n,c.inputEncoding.value=Gr[e.texture.encoding],c.outputEncoding.value=Gr[e.texture.encoding];var b=Yr[r];oi(t,3*Math.max(0,Ur-2*b),(0===r?0:2*Ur)+2*b*(r>4?r-8+4:0),3*b,2*b),s.setRenderTarget(t),s.render(u,jr)}}]),e}();function ri(e){return void 0!==e&&e.type===I&&(e.encoding===ue||e.encoding===ce||e.encoding===he)}function ii(){for(var e=[],t=[],n=[],r=8,i=0;i<zr;i++){var a=Math.pow(2,r);t.push(a);var o=1/a;i>4?o=Br[i-8+4-1]:0==i&&(o=0),n.push(o);for(var s=1/(a-1),l=-s/2,u=1+s/2,c=[l,l,u,l,u,u,l,l,u,u,l,u],h=new Float32Array(108),d=new Float32Array(72),f=new Float32Array(36),p=0;p<6;p++){var v=p%3*2/3-1,m=p>2?0:-1,g=[v,m,0,v+2/3,m,0,v+2/3,m+1,0,v,m,0,v+2/3,m+1,0,v,m+1,0];h.set(g,18*p),d.set(c,12*p);var _=[p,p,p,p,p,p];f.set(_,6*p)}var y=new zn;y.setAttribute("position",new yn(h,3)),y.setAttribute("uv",new yn(d,2)),y.setAttribute("faceIndex",new yn(f,1)),e.push(y),r>4&&r--}return{_lodPlanes:e,_sizeLods:t,_sigmas:n}}function ai(e){var t=new Ge(3*Ur,3*Ur,e);return t.texture.mapping=T,t.texture.name="PMREM.cubeUv",t.scissorTest=!0,t}function oi(e,t,n,r,i){e.viewport.set(t,n,r,i),e.scissor.set(t,n,r,i)}function si(){var e=new Ie(1,1);return new Nr({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null},texelSize:{value:e},inputEncoding:{value:Gr[3e3]},outputEncoding:{value:Gr[3e3]}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute vec3 position;\n\t\tattribute vec2 uv;\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\t\t\tuniform vec2 texelSize;\n\n\t\t\t".concat("\n\n\t\tuniform int inputEncoding;\n\t\tuniform int outputEncoding;\n\n\t\t#include <encodings_pars_fragment>\n\n\t\tvec4 inputTexelToLinear( vec4 value ) {\n\n\t\t\tif ( inputEncoding == 0 ) {\n\n\t\t\t\treturn value;\n\n\t\t\t} else if ( inputEncoding == 1 ) {\n\n\t\t\t\treturn sRGBToLinear( value );\n\n\t\t\t} else if ( inputEncoding == 2 ) {\n\n\t\t\t\treturn RGBEToLinear( value );\n\n\t\t\t} else if ( inputEncoding == 3 ) {\n\n\t\t\t\treturn RGBMToLinear( value, 7.0 );\n\n\t\t\t} else if ( inputEncoding == 4 ) {\n\n\t\t\t\treturn RGBMToLinear( value, 16.0 );\n\n\t\t\t} else if ( inputEncoding == 5 ) {\n\n\t\t\t\treturn RGBDToLinear( value, 256.0 );\n\n\t\t\t} else {\n\n\t\t\t\treturn GammaToLinear( value, 2.2 );\n\n\t\t\t}\n\n\t\t}\n\n\t\tvec4 linearToOutputTexel( vec4 value ) {\n\n\t\t\tif ( outputEncoding == 0 ) {\n\n\t\t\t\treturn value;\n\n\t\t\t} else if ( outputEncoding == 1 ) {\n\n\t\t\t\treturn LinearTosRGB( value );\n\n\t\t\t} else if ( outputEncoding == 2 ) {\n\n\t\t\t\treturn LinearToRGBE( value );\n\n\t\t\t} else if ( outputEncoding == 3 ) {\n\n\t\t\t\treturn LinearToRGBM( value, 7.0 );\n\n\t\t\t} else if ( outputEncoding == 4 ) {\n\n\t\t\t\treturn LinearToRGBM( value, 16.0 );\n\n\t\t\t} else if ( outputEncoding == 5 ) {\n\n\t\t\t\treturn LinearToRGBD( value, 256.0 );\n\n\t\t\t} else {\n\n\t\t\t\treturn LinearToGamma( value, 2.2 );\n\n\t\t\t}\n\n\t\t}\n\n\t\tvec4 envMapTexelToLinear( vec4 color ) {\n\n\t\t\treturn inputTexelToLinear( color );\n\n\t\t}\n\t","\n\n\t\t\t#include <common>\n\n\t\t\tvoid main() {\n\n\t\t\t\tgl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\n\t\t\t\tvec3 outputDirection = normalize( vOutputDirection );\n\t\t\t\tvec2 uv = equirectUv( outputDirection );\n\n\t\t\t\tvec2 f = fract( uv / texelSize - 0.5 );\n\t\t\t\tuv -= f * texelSize;\n\t\t\t\tvec3 tl = envMapTexelToLinear( texture2D ( envMap, uv ) ).rgb;\n\t\t\t\tuv.x += texelSize.x;\n\t\t\t\tvec3 tr = envMapTexelToLinear( texture2D ( envMap, uv ) ).rgb;\n\t\t\t\tuv.y += texelSize.y;\n\t\t\t\tvec3 br = envMapTexelToLinear( texture2D ( envMap, uv ) ).rgb;\n\t\t\t\tuv.x -= texelSize.x;\n\t\t\t\tvec3 bl = envMapTexelToLinear( texture2D ( envMap, uv ) ).rgb;\n\n\t\t\t\tvec3 tm = mix( tl, tr, f.x );\n\t\t\t\tvec3 bm = mix( bl, br, f.x );\n\t\t\t\tgl_FragColor.rgb = mix( tm, bm, f.y );\n\n\t\t\t\tgl_FragColor = linearToOutputTexel( gl_FragColor );\n\n\t\t\t}\n\t\t"),blending:0,depthTest:!1,depthWrite:!1})}function li(){return new Nr({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},inputEncoding:{value:Gr[3e3]},outputEncoding:{value:Gr[3e3]}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute vec3 position;\n\t\tattribute vec2 uv;\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform samplerCube envMap;\n\n\t\t\t".concat("\n\n\t\tuniform int inputEncoding;\n\t\tuniform int outputEncoding;\n\n\t\t#include <encodings_pars_fragment>\n\n\t\tvec4 inputTexelToLinear( vec4 value ) {\n\n\t\t\tif ( inputEncoding == 0 ) {\n\n\t\t\t\treturn value;\n\n\t\t\t} else if ( inputEncoding == 1 ) {\n\n\t\t\t\treturn sRGBToLinear( value );\n\n\t\t\t} else if ( inputEncoding == 2 ) {\n\n\t\t\t\treturn RGBEToLinear( value );\n\n\t\t\t} else if ( inputEncoding == 3 ) {\n\n\t\t\t\treturn RGBMToLinear( value, 7.0 );\n\n\t\t\t} else if ( inputEncoding == 4 ) {\n\n\t\t\t\treturn RGBMToLinear( value, 16.0 );\n\n\t\t\t} else if ( inputEncoding == 5 ) {\n\n\t\t\t\treturn RGBDToLinear( value, 256.0 );\n\n\t\t\t} else {\n\n\t\t\t\treturn GammaToLinear( value, 2.2 );\n\n\t\t\t}\n\n\t\t}\n\n\t\tvec4 linearToOutputTexel( vec4 value ) {\n\n\t\t\tif ( outputEncoding == 0 ) {\n\n\t\t\t\treturn value;\n\n\t\t\t} else if ( outputEncoding == 1 ) {\n\n\t\t\t\treturn LinearTosRGB( value );\n\n\t\t\t} else if ( outputEncoding == 2 ) {\n\n\t\t\t\treturn LinearToRGBE( value );\n\n\t\t\t} else if ( outputEncoding == 3 ) {\n\n\t\t\t\treturn LinearToRGBM( value, 7.0 );\n\n\t\t\t} else if ( outputEncoding == 4 ) {\n\n\t\t\t\treturn LinearToRGBM( value, 16.0 );\n\n\t\t\t} else if ( outputEncoding == 5 ) {\n\n\t\t\t\treturn LinearToRGBD( value, 256.0 );\n\n\t\t\t} else {\n\n\t\t\t\treturn LinearToGamma( value, 2.2 );\n\n\t\t\t}\n\n\t\t}\n\n\t\tvec4 envMapTexelToLinear( vec4 color ) {\n\n\t\t\treturn inputTexelToLinear( color );\n\n\t\t}\n\t","\n\n\t\t\tvoid main() {\n\n\t\t\t\tgl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\t\t\t\tgl_FragColor.rgb = envMapTexelToLinear( textureCube( envMap, vec3( - vOutputDirection.x, vOutputDirection.yz ) ) ).rgb;\n\t\t\t\tgl_FragColor = linearToOutputTexel( gl_FragColor );\n\n\t\t\t}\n\t\t"),blending:0,depthTest:!1,depthWrite:!1})}function ui(e){var t=new WeakMap,n=null;function r(e){var n=e.target;n.removeEventListener("dispose",r);var i=t.get(n);void 0!==i&&(i.delete(n),i.dispose())}return{get:function(i){if(i&&i.isTexture&&!1===i.isRenderTargetTexture){var o=i.mapping,s=o===y||o===w,l=o===a||o===g;if(s||l){if(t.has(i))return t.get(i).texture;var u=i.image;if(s&&u&&u.height>0||l&&u&&function(e){for(var t=0,n=6,r=0;r<n;r++)void 0!==e[r]&&t++;return t===n}(u)){var c=e.getRenderTarget();null===n&&(n=new ni(e));var h=s?n.fromEquirectangular(i):n.fromCubemap(i);return t.set(i,h),e.setRenderTarget(c),i.addEventListener("dispose",r),h.texture}return null}}return i},dispose:function(){t=new WeakMap,null!==n&&(n.dispose(),n=null)}}}function ci(e){var t={};function n(n){if(void 0!==t[n])return t[n];var r;switch(n){case"WEBGL_depth_texture":r=e.getExtension("WEBGL_depth_texture")||e.getExtension("MOZ_WEBGL_depth_texture")||e.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":r=e.getExtension("EXT_texture_filter_anisotropic")||e.getExtension("MOZ_EXT_texture_filter_anisotropic")||e.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":r=e.getExtension("WEBGL_compressed_texture_s3tc")||e.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":r=e.getExtension("WEBGL_compressed_texture_pvrtc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:r=e.getExtension(n)}return t[n]=r,r}return{has:function(e){return null!==n(e)},init:function(e){e.isWebGL2?n("EXT_color_buffer_float"):(n("WEBGL_depth_texture"),n("OES_texture_float"),n("OES_texture_half_float"),n("OES_texture_half_float_linear"),n("OES_standard_derivatives"),n("OES_element_index_uint"),n("OES_vertex_array_object"),n("ANGLE_instanced_arrays")),n("OES_texture_float_linear"),n("EXT_color_buffer_half_float")},get:function(e){var t=n(e);return null===t&&console.warn("THREE.WebGLRenderer: "+e+" extension not supported."),t}}}function hi(e,t,n,r){var i={},a=new WeakMap;function o(e){var s=e.target;for(var l in null!==s.index&&t.remove(s.index),s.attributes)t.remove(s.attributes[l]);s.removeEventListener("dispose",o),delete i[s.id];var u=a.get(s);u&&(t.remove(u),a.delete(s)),r.releaseStatesOfGeometry(s),!0===s.isInstancedBufferGeometry&&delete s._maxInstanceCount,n.memory.geometries--}function s(e){var n=[],r=e.index,i=e.attributes.position,o=0;if(null!==r){var s=r.array;o=r.version;for(var l=0,u=s.length;l<u;l+=3){var c=s[l+0],h=s[l+1],d=s[l+2];n.push(c,h,h,d,d,c)}}else{var f=i.array;o=i.version;for(var p=0,v=f.length/3-1;p<v;p+=3){var m=p+0,g=p+1,_=p+2;n.push(m,g,g,_,_,m)}}var y=new(Rn(n)>65535?En:Mn)(n,1);y.version=o;var x=a.get(e);x&&t.remove(x),a.set(e,y)}return{get:function(e,t){return!0===i[t.id]||(t.addEventListener("dispose",o),i[t.id]=!0,n.memory.geometries++),t},update:function(n){var r=n.attributes;for(var i in r)t.update(r[i],e.ARRAY_BUFFER);var a=n.morphAttributes;for(var o in a)for(var s=a[o],l=0,u=s.length;l<u;l++)t.update(s[l],e.ARRAY_BUFFER)},getWireframeAttribute:function(e){var t=a.get(e);if(t){var n=e.index;null!==n&&t.version<n.version&&s(e)}else s(e);return a.get(e)}}}function di(e,t,n,r){var i,a,o,s=r.isWebGL2;this.setMode=function(e){i=e},this.setIndex=function(e){a=e.type,o=e.bytesPerElement},this.render=function(t,r){e.drawElements(i,r,a,t*o),n.update(r,i,1)},this.renderInstances=function(r,l,u){if(0!==u){var c,h;if(s)c=e,h="drawElementsInstanced";else if(h="drawElementsInstancedANGLE",null===(c=t.get("ANGLE_instanced_arrays")))return void console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");c[h](i,l,a,r*o,u),n.update(l,i,u)}}}function fi(e){var t={frame:0,calls:0,triangles:0,points:0,lines:0};return{memory:{geometries:0,textures:0},render:t,programs:null,autoReset:!0,reset:function(){t.frame++,t.calls=0,t.triangles=0,t.points=0,t.lines=0},update:function(n,r,i){switch(t.calls++,r){case e.TRIANGLES:t.triangles+=i*(n/3);break;case e.LINES:t.lines+=i*(n/2);break;case e.LINE_STRIP:t.lines+=i*(n-1);break;case e.LINE_LOOP:t.lines+=i*n;break;case e.POINTS:t.points+=i*n;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",r)}}}}function pi(e,t){return e[0]-t[0]}function vi(e,t){return Math.abs(t[1])-Math.abs(e[1])}function mi(e){for(var t={},n=new Float32Array(8),r=[],i=0;i<8;i++)r[i]=[i,0];return{update:function(i,a,o,s){var l=i.morphTargetInfluences,u=void 0===l?0:l.length,c=t[a.id];if(void 0===c||c.length!==u){c=[];for(var h=0;h<u;h++)c[h]=[h,0];t[a.id]=c}for(var d=0;d<u;d++){var f=c[d];f[0]=d,f[1]=l[d]}c.sort(vi);for(var p=0;p<8;p++)p<u&&c[p][1]?(r[p][0]=c[p][0],r[p][1]=c[p][1]):(r[p][0]=Number.MAX_SAFE_INTEGER,r[p][1]=0);r.sort(pi);for(var v=a.morphAttributes.position,m=a.morphAttributes.normal,g=0,_=0;_<8;_++){var y=r[_],x=y[0],b=y[1];x!==Number.MAX_SAFE_INTEGER&&b?(v&&a.getAttribute("morphTarget"+_)!==v[x]&&a.setAttribute("morphTarget"+_,v[x]),m&&a.getAttribute("morphNormal"+_)!==m[x]&&a.setAttribute("morphNormal"+_,m[x]),n[_]=b,g+=b):(v&&!0===a.hasAttribute("morphTarget"+_)&&a.deleteAttribute("morphTarget"+_),m&&!0===a.hasAttribute("morphNormal"+_)&&a.deleteAttribute("morphNormal"+_),n[_]=0)}var w=a.morphTargetsRelative?1:1-g;s.getUniforms().setValue(e,"morphTargetBaseInfluence",w),s.getUniforms().setValue(e,"morphTargetInfluences",n)}}}function gi(e,t,n,r){var i=new WeakMap;function a(e){var t=e.target;t.removeEventListener("dispose",a),n.remove(t.instanceMatrix),null!==t.instanceColor&&n.remove(t.instanceColor)}return{update:function(o){var s=r.render.frame,l=o.geometry,u=t.get(o,l);return i.get(u)!==s&&(t.update(u),i.set(u,s)),o.isInstancedMesh&&(!1===o.hasEventListener("dispose",a)&&o.addEventListener("dispose",a),n.update(o.instanceMatrix,e.ARRAY_BUFFER),null!==o.instanceColor&&n.update(o.instanceColor,e.ARRAY_BUFFER)),u},dispose:function(){i=new WeakMap}}}var _i=function(e){(0,d.default)(n,e);var t=b(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;return(0,v.default)(this,n),(e=t.call(this,null)).image={data:r,width:i,height:a,depth:o},e.magFilter=L,e.minFilter=L,e.wrapR=E,e.generateMipmaps=!1,e.flipY=!1,e.unpackAlignment=1,e.needsUpdate=!0,e}return(0,m.default)(n)}(Be);_i.prototype.isDataTexture2DArray=!0;var yi=function(e){(0,d.default)(n,e);var t=b(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;return(0,v.default)(this,n),(e=t.call(this,null)).image={data:r,width:i,height:a,depth:o},e.magFilter=L,e.minFilter=L,e.wrapR=E,e.generateMipmaps=!1,e.flipY=!1,e.unpackAlignment=1,e.needsUpdate=!0,e}return(0,m.default)(n)}(Be);yi.prototype.isDataTexture3D=!0;var xi=new Be,bi=new _i,wi=new yi,Ti=new vr,Mi=[],Si=[],Ei=new Float32Array(16),Ai=new Float32Array(9),Li=new Float32Array(4);function Ci(e,t,n){var r=e[0];if(r<=0||r>0)return e;var i=t*n,a=Mi[i];if(void 0===a&&(a=new Float32Array(i),Mi[i]=a),0!==t){r.toArray(a,0);for(var o=1,s=0;o!==t;++o)s+=n,e[o].toArray(a,s)}return a}function Ri(e,t){if(e.length!==t.length)return!1;for(var n=0,r=e.length;n<r;n++)if(e[n]!==t[n])return!1;return!0}function ki(e,t){for(var n=0,r=t.length;n<r;n++)e[n]=t[n]}function Pi(e,t){var n=Si[t];void 0===n&&(n=new Int32Array(t),Si[t]=n);for(var r=0;r!==t;++r)n[r]=e.allocateTextureUnit();return n}function Di(e,t){var n=this.cache;n[0]!==t&&(e.uniform1f(this.addr,t),n[0]=t)}function Ii(e,t){var n=this.cache;if(void 0!==t.x)n[0]===t.x&&n[1]===t.y||(e.uniform2f(this.addr,t.x,t.y),n[0]=t.x,n[1]=t.y);else{if(Ri(n,t))return;e.uniform2fv(this.addr,t),ki(n,t)}}function Oi(e,t){var n=this.cache;if(void 0!==t.x)n[0]===t.x&&n[1]===t.y&&n[2]===t.z||(e.uniform3f(this.addr,t.x,t.y,t.z),n[0]=t.x,n[1]=t.y,n[2]=t.z);else if(void 0!==t.r)n[0]===t.r&&n[1]===t.g&&n[2]===t.b||(e.uniform3f(this.addr,t.r,t.g,t.b),n[0]=t.r,n[1]=t.g,n[2]=t.b);else{if(Ri(n,t))return;e.uniform3fv(this.addr,t),ki(n,t)}}function Fi(e,t){var n=this.cache;if(void 0!==t.x)n[0]===t.x&&n[1]===t.y&&n[2]===t.z&&n[3]===t.w||(e.uniform4f(this.addr,t.x,t.y,t.z,t.w),n[0]=t.x,n[1]=t.y,n[2]=t.z,n[3]=t.w);else{if(Ri(n,t))return;e.uniform4fv(this.addr,t),ki(n,t)}}function Ni(e,t){var n=this.cache,r=t.elements;if(void 0===r){if(Ri(n,t))return;e.uniformMatrix2fv(this.addr,!1,t),ki(n,t)}else{if(Ri(n,r))return;Li.set(r),e.uniformMatrix2fv(this.addr,!1,Li),ki(n,r)}}function Ui(e,t){var n=this.cache,r=t.elements;if(void 0===r){if(Ri(n,t))return;e.uniformMatrix3fv(this.addr,!1,t),ki(n,t)}else{if(Ri(n,r))return;Ai.set(r),e.uniformMatrix3fv(this.addr,!1,Ai),ki(n,r)}}function Bi(e,t){var n=this.cache,r=t.elements;if(void 0===r){if(Ri(n,t))return;e.uniformMatrix4fv(this.addr,!1,t),ki(n,t)}else{if(Ri(n,r))return;Ei.set(r),e.uniformMatrix4fv(this.addr,!1,Ei),ki(n,r)}}function zi(e,t){var n=this.cache;n[0]!==t&&(e.uniform1i(this.addr,t),n[0]=t)}function Hi(e,t){var n=this.cache;Ri(n,t)||(e.uniform2iv(this.addr,t),ki(n,t))}function Gi(e,t){var n=this.cache;Ri(n,t)||(e.uniform3iv(this.addr,t),ki(n,t))}function Vi(e,t){var n=this.cache;Ri(n,t)||(e.uniform4iv(this.addr,t),ki(n,t))}function Wi(e,t){var n=this.cache;n[0]!==t&&(e.uniform1ui(this.addr,t),n[0]=t)}function ji(e,t){var n=this.cache;Ri(n,t)||(e.uniform2uiv(this.addr,t),ki(n,t))}function qi(e,t){var n=this.cache;Ri(n,t)||(e.uniform3uiv(this.addr,t),ki(n,t))}function Xi(e,t){var n=this.cache;Ri(n,t)||(e.uniform4uiv(this.addr,t),ki(n,t))}function Yi(e,t,n){var r=this.cache,i=n.allocateTextureUnit();r[0]!==i&&(e.uniform1i(this.addr,i),r[0]=i),n.safeSetTexture2D(t||xi,i)}function Ki(e,t,n){var r=this.cache,i=n.allocateTextureUnit();r[0]!==i&&(e.uniform1i(this.addr,i),r[0]=i),n.setTexture3D(t||wi,i)}function Zi(e,t,n){var r=this.cache,i=n.allocateTextureUnit();r[0]!==i&&(e.uniform1i(this.addr,i),r[0]=i),n.safeSetTextureCube(t||Ti,i)}function Ji(e,t,n){var r=this.cache,i=n.allocateTextureUnit();r[0]!==i&&(e.uniform1i(this.addr,i),r[0]=i),n.setTexture2DArray(t||bi,i)}function Qi(e,t){e.uniform1fv(this.addr,t)}function $i(e,t){var n=Ci(t,this.size,2);e.uniform2fv(this.addr,n)}function ea(e,t){var n=Ci(t,this.size,3);e.uniform3fv(this.addr,n)}function ta(e,t){var n=Ci(t,this.size,4);e.uniform4fv(this.addr,n)}function na(e,t){var n=Ci(t,this.size,4);e.uniformMatrix2fv(this.addr,!1,n)}function ra(e,t){var n=Ci(t,this.size,9);e.uniformMatrix3fv(this.addr,!1,n)}function ia(e,t){var n=Ci(t,this.size,16);e.uniformMatrix4fv(this.addr,!1,n)}function aa(e,t){e.uniform1iv(this.addr,t)}function oa(e,t){e.uniform2iv(this.addr,t)}function sa(e,t){e.uniform3iv(this.addr,t)}function la(e,t){e.uniform4iv(this.addr,t)}function ua(e,t){e.uniform1uiv(this.addr,t)}function ca(e,t){e.uniform2uiv(this.addr,t)}function ha(e,t){e.uniform3uiv(this.addr,t)}function da(e,t){e.uniform4uiv(this.addr,t)}function fa(e,t,n){var r=t.length,i=Pi(n,r);e.uniform1iv(this.addr,i);for(var a=0;a!==r;++a)n.safeSetTexture2D(t[a]||xi,i[a])}function pa(e,t,n){var r=t.length,i=Pi(n,r);e.uniform1iv(this.addr,i);for(var a=0;a!==r;++a)n.safeSetTextureCube(t[a]||Ti,i[a])}function va(e,t,n){this.id=e,this.addr=n,this.cache=[],this.setValue=function(e){switch(e){case 5126:return Di;case 35664:return Ii;case 35665:return Oi;case 35666:return Fi;case 35674:return Ni;case 35675:return Ui;case 35676:return Bi;case 5124:case 35670:return zi;case 35667:case 35671:return Hi;case 35668:case 35672:return Gi;case 35669:case 35673:return Vi;case 5125:return Wi;case 36294:return ji;case 36295:return qi;case 36296:return Xi;case 35678:case 36198:case 36298:case 36306:case 35682:return Yi;case 35679:case 36299:case 36307:return Ki;case 35680:case 36300:case 36308:case 36293:return Zi;case 36289:case 36303:case 36311:case 36292:return Ji}}(t.type)}function ma(e,t,n){this.id=e,this.addr=n,this.cache=[],this.size=t.size,this.setValue=function(e){switch(e){case 5126:return Qi;case 35664:return $i;case 35665:return ea;case 35666:return ta;case 35674:return na;case 35675:return ra;case 35676:return ia;case 5124:case 35670:return aa;case 35667:case 35671:return oa;case 35668:case 35672:return sa;case 35669:case 35673:return la;case 5125:return ua;case 36294:return ca;case 36295:return ha;case 36296:return da;case 35678:case 36198:case 36298:case 36306:case 35682:return fa;case 35680:case 36300:case 36308:case 36293:return pa}}(t.type)}function ga(e){this.id=e,this.seq=[],this.map={}}ma.prototype.updateCache=function(e){var t=this.cache;e instanceof Float32Array&&t.length!==e.length&&(this.cache=new Float32Array(e.length)),ki(t,e)},ga.prototype.setValue=function(e,t,n){for(var r=this.seq,i=0,a=r.length;i!==a;++i){var o=r[i];o.setValue(e,t[o.id],n)}};var _a=/(\w+)(\])?(\[|\.)?/g;function ya(e,t){e.seq.push(t),e.map[t.id]=t}function xa(e,t,n){var r=e.name,i=r.length;for(_a.lastIndex=0;;){var a=_a.exec(r),o=_a.lastIndex,s=a[1],l="]"===a[2],u=a[3];if(l&&(s|=0),void 0===u||"["===u&&o+2===i){ya(n,void 0===u?new va(s,e,t):new ma(s,e,t));break}var c=n.map[s];void 0===c&&ya(n,c=new ga(s)),n=c}}function ba(e,t){this.seq=[],this.map={};for(var n=e.getProgramParameter(t,e.ACTIVE_UNIFORMS),r=0;r<n;++r){var i=e.getActiveUniform(t,r);xa(i,e.getUniformLocation(t,i.name),this)}}function wa(e,t,n){var r=e.createShader(t);return e.shaderSource(r,n),e.compileShader(r),r}ba.prototype.setValue=function(e,t,n,r){var i=this.map[t];void 0!==i&&i.setValue(e,n,r)},ba.prototype.setOptional=function(e,t,n){var r=t[n];void 0!==r&&this.setValue(e,n,r)},ba.upload=function(e,t,n,r){for(var i=0,a=t.length;i!==a;++i){var o=t[i],s=n[o.id];!1!==s.needsUpdate&&o.setValue(e,s.value,r)}},ba.seqWithValue=function(e,t){for(var n=[],r=0,i=e.length;r!==i;++r){var a=e[r];a.id in t&&n.push(a)}return n};var Ta=0;function Ma(e){switch(e){case ue:return["Linear","( value )"];case ce:return["sRGB","( value )"];case de:return["RGBE","( value )"];case fe:return["RGBM","( value, 7.0 )"];case pe:return["RGBM","( value, 16.0 )"];case ve:return["RGBD","( value, 256.0 )"];case he:return["Gamma","( value, float( GAMMA_FACTOR ) )"];case 3003:return["LogLuv","( value )"];default:return console.warn("THREE.WebGLProgram: Unsupported encoding:",e),["Linear","( value )"]}}function Sa(e,t,n){var r=e.getShaderParameter(t,e.COMPILE_STATUS),i=e.getShaderInfoLog(t).trim();return r&&""===i?"":"THREE.WebGLShader: gl.getShaderInfoLog() "+n+"\n"+i+function(e){for(var t=e.split("\n"),n=0;n<t.length;n++)t[n]=n+1+": "+t[n];return t.join("\n")}(e.getShaderSource(t))}function Ea(e,t){var n=Ma(t);return"vec4 "+e+"( vec4 value ) { return "+n[0]+"ToLinear"+n[1]+"; }"}function Aa(e,t){var n;switch(t){case 1:n="Linear";break;case 2:n="Reinhard";break;case 3:n="OptimizedCineon";break;case 4:n="ACESFilmic";break;case 5:n="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",t),n="Linear"}return"vec3 "+e+"( vec3 color ) { return "+n+"ToneMapping( color ); }"}function La(e){return""!==e}function Ca(e,t){return e.replace(/NUM_DIR_LIGHTS/g,t.numDirLights).replace(/NUM_SPOT_LIGHTS/g,t.numSpotLights).replace(/NUM_RECT_AREA_LIGHTS/g,t.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,t.numPointLights).replace(/NUM_HEMI_LIGHTS/g,t.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,t.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS/g,t.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,t.numPointLightShadows)}function Ra(e,t){return e.replace(/NUM_CLIPPING_PLANES/g,t.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,t.numClippingPlanes-t.numClipIntersection)}var ka=/^[ \t]*#include +<([\w\d./]+)>/gm;function Pa(e){return e.replace(ka,Da)}function Da(e,t){var n=Ar[t];if(void 0===n)throw new Error("Can not resolve #include <"+t+">");return Pa(n)}var Ia=/#pragma unroll_loop[\s]+?for \( int i \= (\d+)\; i < (\d+)\; i \+\+ \) \{([\s\S]+?)(?=\})\}/g,Oa=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function Fa(e){return e.replace(Oa,Ua).replace(Ia,Na)}function Na(e,t,n,r){return console.warn("WebGLProgram: #pragma unroll_loop shader syntax is deprecated. Please use #pragma unroll_loop_start syntax instead."),Ua(0,t,n,r)}function Ua(e,t,n,r){for(var i="",a=parseInt(t);a<parseInt(n);a++)i+=r.replace(/\[\s*i\s*\]/g,"[ "+a+" ]").replace(/UNROLLED_LOOP_INDEX/g,a);return i}function Ba(e){var t="precision "+e.precision+" float;\nprecision "+e.precision+" int;";return"highp"===e.precision?t+="\n#define HIGH_PRECISION":"mediump"===e.precision?t+="\n#define MEDIUM_PRECISION":"lowp"===e.precision&&(t+="\n#define LOW_PRECISION"),t}function za(e,t,n,r){var i,o,s,l,u,c=e.getContext(),h=n.defines,d=n.vertexShader,f=n.fragmentShader,p=function(e){var t="SHADOWMAP_TYPE_BASIC";return 1===e.shadowMapType?t="SHADOWMAP_TYPE_PCF":2===e.shadowMapType?t="SHADOWMAP_TYPE_PCF_SOFT":3===e.shadowMapType&&(t="SHADOWMAP_TYPE_VSM"),t}(n),v=function(e){var t="ENVMAP_TYPE_CUBE";if(e.envMap)switch(e.envMapMode){case a:case g:t="ENVMAP_TYPE_CUBE";break;case T:case M:t="ENVMAP_TYPE_CUBE_UV"}return t}(n),m=function(e){var t="ENVMAP_MODE_REFLECTION";if(e.envMap)switch(e.envMapMode){case g:case M:t="ENVMAP_MODE_REFRACTION"}return t}(n),_=function(e){var t="ENVMAP_BLENDING_NONE";if(e.envMap)switch(e.combine){case 0:t="ENVMAP_BLENDING_MULTIPLY";break;case 1:t="ENVMAP_BLENDING_MIX";break;case 2:t="ENVMAP_BLENDING_ADD"}return t}(n),y=e.gammaFactor>0?e.gammaFactor:1,x=n.isWebGL2?"":function(e){return[e.extensionDerivatives||e.envMapCubeUV||e.bumpMap||e.tangentSpaceNormalMap||e.clearcoatNormalMap||e.flatShading||"physical"===e.shaderID?"#extension GL_OES_standard_derivatives : enable":"",(e.extensionFragDepth||e.logarithmicDepthBuffer)&&e.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",e.extensionDrawBuffers&&e.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(e.extensionShaderTextureLOD||e.envMap||e.transmission>0)&&e.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""].filter(La).join("\n")}(n),b=function(e){var t=[];for(var n in e){var r=e[n];!1!==r&&t.push("#define "+n+" "+r)}return t.join("\n")}(h),w=c.createProgram(),S=n.glslVersion?"#version "+n.glslVersion+"\n":"";n.isRawShaderMaterial?((i=[b].filter(La).join("\n")).length>0&&(i+="\n"),(o=[x,b].filter(La).join("\n")).length>0&&(o+="\n")):(i=[Ba(n),"#define SHADER_NAME "+n.shaderName,b,n.instancing?"#define USE_INSTANCING":"",n.instancingColor?"#define USE_INSTANCING_COLOR":"",n.supportsVertexTextures?"#define VERTEX_TEXTURES":"","#define GAMMA_FACTOR "+y,"#define MAX_BONES "+n.maxBones,n.useFog&&n.fog?"#define USE_FOG":"",n.useFog&&n.fogExp2?"#define FOG_EXP2":"",n.map?"#define USE_MAP":"",n.envMap?"#define USE_ENVMAP":"",n.envMap?"#define "+m:"",n.lightMap?"#define USE_LIGHTMAP":"",n.aoMap?"#define USE_AOMAP":"",n.emissiveMap?"#define USE_EMISSIVEMAP":"",n.bumpMap?"#define USE_BUMPMAP":"",n.normalMap?"#define USE_NORMALMAP":"",n.normalMap&&n.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",n.normalMap&&n.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",n.clearcoatMap?"#define USE_CLEARCOATMAP":"",n.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",n.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",n.displacementMap&&n.supportsVertexTextures?"#define USE_DISPLACEMENTMAP":"",n.specularMap?"#define USE_SPECULARMAP":"",n.specularIntensityMap?"#define USE_SPECULARINTENSITYMAP":"",n.specularTintMap?"#define USE_SPECULARTINTMAP":"",n.roughnessMap?"#define USE_ROUGHNESSMAP":"",n.metalnessMap?"#define USE_METALNESSMAP":"",n.alphaMap?"#define USE_ALPHAMAP":"",n.transmission?"#define USE_TRANSMISSION":"",n.transmissionMap?"#define USE_TRANSMISSIONMAP":"",n.thicknessMap?"#define USE_THICKNESSMAP":"",n.vertexTangents?"#define USE_TANGENT":"",n.vertexColors?"#define USE_COLOR":"",n.vertexAlphas?"#define USE_COLOR_ALPHA":"",n.vertexUvs?"#define USE_UV":"",n.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",n.flatShading?"#define FLAT_SHADED":"",n.skinning?"#define USE_SKINNING":"",n.useVertexTexture?"#define BONE_TEXTURE":"",n.morphTargets?"#define USE_MORPHTARGETS":"",n.morphNormals&&!1===n.flatShading?"#define USE_MORPHNORMALS":"",n.doubleSided?"#define DOUBLE_SIDED":"",n.flipSided?"#define FLIP_SIDED":"",n.shadowMapEnabled?"#define USE_SHADOWMAP":"",n.shadowMapEnabled?"#define "+p:"",n.sizeAttenuation?"#define USE_SIZEATTENUATION":"",n.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",n.logarithmicDepthBuffer&&n.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","\tattribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","\tattribute vec3 instanceColor;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_TANGENT","\tattribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","\tattribute vec4 color;","#elif defined( USE_COLOR )","\tattribute vec3 color;","#endif","#ifdef USE_MORPHTARGETS","\tattribute vec3 morphTarget0;","\tattribute vec3 morphTarget1;","\tattribute vec3 morphTarget2;","\tattribute vec3 morphTarget3;","\t#ifdef USE_MORPHNORMALS","\t\tattribute vec3 morphNormal0;","\t\tattribute vec3 morphNormal1;","\t\tattribute vec3 morphNormal2;","\t\tattribute vec3 morphNormal3;","\t#else","\t\tattribute vec3 morphTarget4;","\t\tattribute vec3 morphTarget5;","\t\tattribute vec3 morphTarget6;","\t\tattribute vec3 morphTarget7;","\t#endif","#endif","#ifdef USE_SKINNING","\tattribute vec4 skinIndex;","\tattribute vec4 skinWeight;","#endif","\n"].filter(La).join("\n"),o=[x,Ba(n),"#define SHADER_NAME "+n.shaderName,b,n.alphaTest?"#define ALPHATEST "+n.alphaTest+(n.alphaTest%1?"":".0"):"","#define GAMMA_FACTOR "+y,n.useFog&&n.fog?"#define USE_FOG":"",n.useFog&&n.fogExp2?"#define FOG_EXP2":"",n.map?"#define USE_MAP":"",n.matcap?"#define USE_MATCAP":"",n.envMap?"#define USE_ENVMAP":"",n.envMap?"#define "+v:"",n.envMap?"#define "+m:"",n.envMap?"#define "+_:"",n.lightMap?"#define USE_LIGHTMAP":"",n.aoMap?"#define USE_AOMAP":"",n.emissiveMap?"#define USE_EMISSIVEMAP":"",n.bumpMap?"#define USE_BUMPMAP":"",n.normalMap?"#define USE_NORMALMAP":"",n.normalMap&&n.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",n.normalMap&&n.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",n.clearcoatMap?"#define USE_CLEARCOATMAP":"",n.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",n.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",n.specularMap?"#define USE_SPECULARMAP":"",n.specularIntensityMap?"#define USE_SPECULARINTENSITYMAP":"",n.specularTintMap?"#define USE_SPECULARTINTMAP":"",n.roughnessMap?"#define USE_ROUGHNESSMAP":"",n.metalnessMap?"#define USE_METALNESSMAP":"",n.alphaMap?"#define USE_ALPHAMAP":"",n.sheen?"#define USE_SHEEN":"",n.transmission?"#define USE_TRANSMISSION":"",n.transmissionMap?"#define USE_TRANSMISSIONMAP":"",n.thicknessMap?"#define USE_THICKNESSMAP":"",n.vertexTangents?"#define USE_TANGENT":"",n.vertexColors||n.instancingColor?"#define USE_COLOR":"",n.vertexAlphas?"#define USE_COLOR_ALPHA":"",n.vertexUvs?"#define USE_UV":"",n.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",n.gradientMap?"#define USE_GRADIENTMAP":"",n.flatShading?"#define FLAT_SHADED":"",n.doubleSided?"#define DOUBLE_SIDED":"",n.flipSided?"#define FLIP_SIDED":"",n.shadowMapEnabled?"#define USE_SHADOWMAP":"",n.shadowMapEnabled?"#define "+p:"",n.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",n.physicallyCorrectLights?"#define PHYSICALLY_CORRECT_LIGHTS":"",n.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",n.logarithmicDepthBuffer&&n.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"",(n.extensionShaderTextureLOD||n.envMap)&&n.rendererExtensionShaderTextureLod?"#define TEXTURE_LOD_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",0!==n.toneMapping?"#define TONE_MAPPING":"",0!==n.toneMapping?Ar.tonemapping_pars_fragment:"",0!==n.toneMapping?Aa("toneMapping",n.toneMapping):"",n.dithering?"#define DITHERING":"",Ar.encodings_pars_fragment,n.map?Ea("mapTexelToLinear",n.mapEncoding):"",n.matcap?Ea("matcapTexelToLinear",n.matcapEncoding):"",n.envMap?Ea("envMapTexelToLinear",n.envMapEncoding):"",n.emissiveMap?Ea("emissiveMapTexelToLinear",n.emissiveMapEncoding):"",n.specularTintMap?Ea("specularTintMapTexelToLinear",n.specularTintMapEncoding):"",n.lightMap?Ea("lightMapTexelToLinear",n.lightMapEncoding):"",(s="linearToOutputTexel",l=n.outputEncoding,u=Ma(l),"vec4 "+s+"( vec4 value ) { return LinearTo"+u[0]+u[1]+"; }"),n.depthPacking?"#define DEPTH_PACKING "+n.depthPacking:"","\n"].filter(La).join("\n")),d=Ra(d=Ca(d=Pa(d),n),n),f=Ra(f=Ca(f=Pa(f),n),n),d=Fa(d),f=Fa(f),n.isWebGL2&&!0!==n.isRawShaderMaterial&&(S="#version 300 es\n",i=["#define attribute in","#define varying out","#define texture2D texture"].join("\n")+"\n"+i,o=["#define varying in",n.glslVersion===ye?"":"out highp vec4 pc_fragColor;",n.glslVersion===ye?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join("\n")+"\n"+o);var E,A,L=S+i+d,C=S+o+f,R=wa(c,c.VERTEX_SHADER,L),k=wa(c,c.FRAGMENT_SHADER,C);if(c.attachShader(w,R),c.attachShader(w,k),void 0!==n.index0AttributeName?c.bindAttribLocation(w,0,n.index0AttributeName):!0===n.morphTargets&&c.bindAttribLocation(w,0,"position"),c.linkProgram(w),e.debug.checkShaderErrors){var P=c.getProgramInfoLog(w).trim(),D=c.getShaderInfoLog(R).trim(),I=c.getShaderInfoLog(k).trim(),O=!0,F=!0;if(!1===c.getProgramParameter(w,c.LINK_STATUS)){O=!1;var N=Sa(c,R,"vertex"),U=Sa(c,k,"fragment");console.error("THREE.WebGLProgram: shader error: ",c.getError(),"gl.VALIDATE_STATUS",c.getProgramParameter(w,c.VALIDATE_STATUS),"gl.getProgramInfoLog",P,N,U)}else""!==P?console.warn("THREE.WebGLProgram: gl.getProgramInfoLog()",P):""!==D&&""!==I||(F=!1);F&&(this.diagnostics={runnable:O,programLog:P,vertexShader:{log:D,prefix:i},fragmentShader:{log:I,prefix:o}})}return c.deleteShader(R),c.deleteShader(k),this.getUniforms=function(){return void 0===E&&(E=new ba(c,w)),E},this.getAttributes=function(){return void 0===A&&(A=function(e,t){for(var n={},r=e.getProgramParameter(t,e.ACTIVE_ATTRIBUTES),i=0;i<r;i++){var a=e.getActiveAttrib(t,i).name;n[a]=e.getAttribLocation(t,a)}return n}(c,w)),A},this.destroy=function(){r.releaseStatesOfProgram(this),c.deleteProgram(w),this.program=void 0},this.name=n.shaderName,this.id=Ta++,this.cacheKey=t,this.usedTimes=1,this.program=w,this.vertexShader=R,this.fragmentShader=k,this}function Ha(e,t,n,r,i,a,o){var s=[],l=i.isWebGL2,u=i.logarithmicDepthBuffer,c=i.floatVertexTextures,h=i.maxVertexUniforms,d=i.vertexTextures,f=i.precision,p={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"},v=["precision","isWebGL2","supportsVertexTextures","outputEncoding","instancing","instancingColor","map","mapEncoding","matcap","matcapEncoding","envMap","envMapMode","envMapEncoding","envMapCubeUV","lightMap","lightMapEncoding","aoMap","emissiveMap","emissiveMapEncoding","bumpMap","normalMap","objectSpaceNormalMap","tangentSpaceNormalMap","clearcoatMap","clearcoatRoughnessMap","clearcoatNormalMap","displacementMap","specularMap","specularIntensityMap","specularTintMap","specularTintMapEncoding","roughnessMap","metalnessMap","gradientMap","alphaMap","combine","vertexColors","vertexAlphas","vertexTangents","vertexUvs","uvsVertexOnly","fog","useFog","fogExp2","flatShading","sizeAttenuation","logarithmicDepthBuffer","skinning","maxBones","useVertexTexture","morphTargets","morphNormals","premultipliedAlpha","numDirLights","numPointLights","numSpotLights","numHemiLights","numRectAreaLights","numDirLightShadows","numPointLightShadows","numSpotLightShadows","shadowMapEnabled","shadowMapType","toneMapping","physicallyCorrectLights","alphaTest","doubleSided","flipSided","numClippingPlanes","numClipIntersection","depthPacking","dithering","sheen","transmission","transmissionMap","thicknessMap"];function m(e){var t;return e&&e.isTexture?t=e.encoding:e&&e.isWebGLRenderTarget?(console.warn("THREE.WebGLPrograms.getTextureEncodingFromMap: don't use render targets as textures. Use their .texture property instead."),t=e.texture.encoding):t=ue,t}return{getParameters:function(a,s,v,g,_){var y,x,b=g.fog,w=a.isMeshStandardMaterial?g.environment:null,S=(a.isMeshStandardMaterial?n:t).get(a.envMap||w),E=p[a.type],A=_.isSkinnedMesh?function(e){var t=e.skeleton.bones;if(c)return 1024;var n=h,r=Math.floor((n-20)/4),i=Math.min(r,t.length);return i<t.length?(console.warn("THREE.WebGLRenderer: Skeleton has "+t.length+" bones. This GPU supports "+i+"."),0):i}(_):0;if(null!==a.precision&&(f=i.getMaxPrecision(a.precision))!==a.precision&&console.warn("THREE.WebGLProgram.getParameters:",a.precision,"not supported, using",f,"instead."),E){var L=Cr[E];y=L.vertexShader,x=L.fragmentShader}else y=a.vertexShader,x=a.fragmentShader;var C=e.getRenderTarget();return{isWebGL2:l,shaderID:E,shaderName:a.type,vertexShader:y,fragmentShader:x,defines:a.defines,isRawShaderMaterial:!0===a.isRawShaderMaterial,glslVersion:a.glslVersion,precision:f,instancing:!0===_.isInstancedMesh,instancingColor:!0===_.isInstancedMesh&&null!==_.instanceColor,supportsVertexTextures:d,outputEncoding:null!==C?m(C.texture):e.outputEncoding,map:!!a.map,mapEncoding:m(a.map),matcap:!!a.matcap,matcapEncoding:m(a.matcap),envMap:!!S,envMapMode:S&&S.mapping,envMapEncoding:m(S),envMapCubeUV:!!S&&(S.mapping===T||S.mapping===M),lightMap:!!a.lightMap,lightMapEncoding:m(a.lightMap),aoMap:!!a.aoMap,emissiveMap:!!a.emissiveMap,emissiveMapEncoding:m(a.emissiveMap),bumpMap:!!a.bumpMap,normalMap:!!a.normalMap,objectSpaceNormalMap:1===a.normalMapType,tangentSpaceNormalMap:0===a.normalMapType,clearcoatMap:!!a.clearcoatMap,clearcoatRoughnessMap:!!a.clearcoatRoughnessMap,clearcoatNormalMap:!!a.clearcoatNormalMap,displacementMap:!!a.displacementMap,roughnessMap:!!a.roughnessMap,metalnessMap:!!a.metalnessMap,specularMap:!!a.specularMap,specularIntensityMap:!!a.specularIntensityMap,specularTintMap:!!a.specularTintMap,specularTintMapEncoding:m(a.specularTintMap),alphaMap:!!a.alphaMap,gradientMap:!!a.gradientMap,sheen:!!a.sheen,transmission:!!a.transmission,transmissionMap:!!a.transmissionMap,thicknessMap:!!a.thicknessMap,combine:a.combine,vertexTangents:!!a.normalMap&&!!_.geometry&&!!_.geometry.attributes.tangent,vertexColors:a.vertexColors,vertexAlphas:!0===a.vertexColors&&!!_.geometry&&!!_.geometry.attributes.color&&4===_.geometry.attributes.color.itemSize,vertexUvs:!!(a.map||a.bumpMap||a.normalMap||a.specularMap||a.alphaMap||a.emissiveMap||a.roughnessMap||a.metalnessMap||a.clearcoatMap||a.clearcoatRoughnessMap||a.clearcoatNormalMap||a.displacementMap||a.transmissionMap||a.thicknessMap||a.specularIntensityMap||a.specularTintMap),uvsVertexOnly:!(a.map||a.bumpMap||a.normalMap||a.specularMap||a.alphaMap||a.emissiveMap||a.roughnessMap||a.metalnessMap||a.clearcoatNormalMap||a.transmission||a.transmissionMap||a.thicknessMap||a.specularIntensityMap||a.specularTintMap||!a.displacementMap),fog:!!b,useFog:a.fog,fogExp2:b&&b.isFogExp2,flatShading:!!a.flatShading,sizeAttenuation:a.sizeAttenuation,logarithmicDepthBuffer:u,skinning:!0===_.isSkinnedMesh&&A>0,maxBones:A,useVertexTexture:c,morphTargets:!!_.geometry&&!!_.geometry.morphAttributes.position,morphNormals:!!_.geometry&&!!_.geometry.morphAttributes.normal,numDirLights:s.directional.length,numPointLights:s.point.length,numSpotLights:s.spot.length,numRectAreaLights:s.rectArea.length,numHemiLights:s.hemi.length,numDirLightShadows:s.directionalShadowMap.length,numPointLightShadows:s.pointShadowMap.length,numSpotLightShadows:s.spotShadowMap.length,numClippingPlanes:o.numPlanes,numClipIntersection:o.numIntersection,dithering:a.dithering,shadowMapEnabled:e.shadowMap.enabled&&v.length>0,shadowMapType:e.shadowMap.type,toneMapping:a.toneMapped?e.toneMapping:0,physicallyCorrectLights:e.physicallyCorrectLights,premultipliedAlpha:a.premultipliedAlpha,alphaTest:a.alphaTest,doubleSided:2===a.side,flipSided:1===a.side,depthPacking:void 0!==a.depthPacking&&a.depthPacking,index0AttributeName:a.index0AttributeName,extensionDerivatives:a.extensions&&a.extensions.derivatives,extensionFragDepth:a.extensions&&a.extensions.fragDepth,extensionDrawBuffers:a.extensions&&a.extensions.drawBuffers,extensionShaderTextureLOD:a.extensions&&a.extensions.shaderTextureLOD,rendererExtensionFragDepth:l||r.has("EXT_frag_depth"),rendererExtensionDrawBuffers:l||r.has("WEBGL_draw_buffers"),rendererExtensionShaderTextureLod:l||r.has("EXT_shader_texture_lod"),customProgramCacheKey:a.customProgramCacheKey()}},getProgramCacheKey:function(t){var n=[];if(t.shaderID?n.push(t.shaderID):(n.push(t.fragmentShader),n.push(t.vertexShader)),void 0!==t.defines)for(var r in t.defines)n.push(r),n.push(t.defines[r]);if(!1===t.isRawShaderMaterial){for(var i=0;i<v.length;i++)n.push(t[v[i]]);n.push(e.outputEncoding),n.push(e.gammaFactor)}return n.push(t.customProgramCacheKey),n.join()},getUniforms:function(e){var t,n=p[e.type];if(n){var r=Cr[n];t=ur.clone(r.uniforms)}else t=e.uniforms;return t},acquireProgram:function(t,n){for(var r,i=0,o=s.length;i<o;i++){var l=s[i];if(l.cacheKey===n){++(r=l).usedTimes;break}}return void 0===r&&(r=new za(e,n,t,a),s.push(r)),r},releaseProgram:function(e){if(0==--e.usedTimes){var t=s.indexOf(e);s[t]=s[s.length-1],s.pop(),e.destroy()}},programs:s}}function Ga(){var e=new WeakMap;return{get:function(t){var n=e.get(t);return void 0===n&&(n={},e.set(t,n)),n},remove:function(t){e.delete(t)},update:function(t,n,r){e.get(t)[n]=r},dispose:function(){e=new WeakMap}}}function Va(e,t){return e.groupOrder!==t.groupOrder?e.groupOrder-t.groupOrder:e.renderOrder!==t.renderOrder?e.renderOrder-t.renderOrder:e.program!==t.program?e.program.id-t.program.id:e.material.id!==t.material.id?e.material.id-t.material.id:e.z!==t.z?e.z-t.z:e.id-t.id}function Wa(e,t){return e.groupOrder!==t.groupOrder?e.groupOrder-t.groupOrder:e.renderOrder!==t.renderOrder?e.renderOrder-t.renderOrder:e.z!==t.z?t.z-e.z:e.id-t.id}function ja(e){var t=[],n=0,r=[],i=[],a=[],o={id:-1};function s(r,i,a,s,l,u){var c=t[n],h=e.get(a);return void 0===c?(c={id:r.id,object:r,geometry:i,material:a,program:h.program||o,groupOrder:s,renderOrder:r.renderOrder,z:l,group:u},t[n]=c):(c.id=r.id,c.object=r,c.geometry=i,c.material=a,c.program=h.program||o,c.groupOrder=s,c.renderOrder=r.renderOrder,c.z=l,c.group=u),n++,c}return{opaque:r,transmissive:i,transparent:a,init:function(){n=0,r.length=0,i.length=0,a.length=0},push:function(e,t,n,o,l,u){var c=s(e,t,n,o,l,u);n.transmission>0?i.push(c):!0===n.transparent?a.push(c):r.push(c)},unshift:function(e,t,n,o,l,u){var c=s(e,t,n,o,l,u);n.transmission>0?i.unshift(c):!0===n.transparent?a.unshift(c):r.unshift(c)},finish:function(){for(var e=n,r=t.length;e<r;e++){var i=t[e];if(null===i.id)break;i.id=null,i.object=null,i.geometry=null,i.material=null,i.program=null,i.group=null}},sort:function(e,t){r.length>1&&r.sort(e||Va),i.length>1&&i.sort(t||Wa),a.length>1&&a.sort(t||Wa)}}}function qa(e){var t=new WeakMap;return{get:function(n,r){var i;return!1===t.has(n)?(i=new ja(e),t.set(n,[i])):r>=t.get(n).length?(i=new ja(e),t.get(n).push(i)):i=t.get(n)[r],i},dispose:function(){t=new WeakMap}}}function Xa(){var e={};return{get:function(t){if(void 0!==e[t.id])return e[t.id];var n;switch(t.type){case"DirectionalLight":n={direction:new qe,color:new vn};break;case"SpotLight":n={position:new qe,direction:new qe,color:new vn,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":n={position:new qe,color:new vn,distance:0,decay:0};break;case"HemisphereLight":n={direction:new qe,skyColor:new vn,groundColor:new vn};break;case"RectAreaLight":n={color:new vn,position:new qe,halfWidth:new qe,halfHeight:new qe}}return e[t.id]=n,n}}}var Ya=0;function Ka(e,t){return(t.castShadow?1:0)-(e.castShadow?1:0)}function Za(e,t){for(var n,r=new Xa,i=(n={},{get:function(e){if(void 0!==n[e.id])return n[e.id];var t;switch(e.type){case"DirectionalLight":case"SpotLight":t={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Ie};break;case"PointLight":t={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Ie,shadowCameraNear:1,shadowCameraFar:1e3}}return n[e.id]=t,t}}),a={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotShadow:[],spotShadowMap:[],spotShadowMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[]},o=0;o<9;o++)a.probe.push(new qe);var s=new qe,l=new Tt,u=new Tt;return{setup:function(n){for(var o=0,s=0,l=0,u=0;u<9;u++)a.probe[u].set(0,0,0);var c=0,h=0,d=0,f=0,p=0,v=0,m=0,g=0;n.sort(Ka);for(var _=0,y=n.length;_<y;_++){var x=n[_],b=x.color,w=x.intensity,T=x.distance,M=x.shadow&&x.shadow.map?x.shadow.map.texture:null;if(x.isAmbientLight)o+=b.r*w,s+=b.g*w,l+=b.b*w;else if(x.isLightProbe)for(var S=0;S<9;S++)a.probe[S].addScaledVector(x.sh.coefficients[S],w);else if(x.isDirectionalLight){var E=r.get(x);if(E.color.copy(x.color).multiplyScalar(x.intensity),x.castShadow){var A=x.shadow,L=i.get(x);L.shadowBias=A.bias,L.shadowNormalBias=A.normalBias,L.shadowRadius=A.radius,L.shadowMapSize=A.mapSize,a.directionalShadow[c]=L,a.directionalShadowMap[c]=M,a.directionalShadowMatrix[c]=x.shadow.matrix,v++}a.directional[c]=E,c++}else if(x.isSpotLight){var C=r.get(x);if(C.position.setFromMatrixPosition(x.matrixWorld),C.color.copy(b).multiplyScalar(w),C.distance=T,C.coneCos=Math.cos(x.angle),C.penumbraCos=Math.cos(x.angle*(1-x.penumbra)),C.decay=x.decay,x.castShadow){var R=x.shadow,k=i.get(x);k.shadowBias=R.bias,k.shadowNormalBias=R.normalBias,k.shadowRadius=R.radius,k.shadowMapSize=R.mapSize,a.spotShadow[d]=k,a.spotShadowMap[d]=M,a.spotShadowMatrix[d]=x.shadow.matrix,g++}a.spot[d]=C,d++}else if(x.isRectAreaLight){var P=r.get(x);P.color.copy(b).multiplyScalar(w),P.halfWidth.set(.5*x.width,0,0),P.halfHeight.set(0,.5*x.height,0),a.rectArea[f]=P,f++}else if(x.isPointLight){var D=r.get(x);if(D.color.copy(x.color).multiplyScalar(x.intensity),D.distance=x.distance,D.decay=x.decay,x.castShadow){var I=x.shadow,O=i.get(x);O.shadowBias=I.bias,O.shadowNormalBias=I.normalBias,O.shadowRadius=I.radius,O.shadowMapSize=I.mapSize,O.shadowCameraNear=I.camera.near,O.shadowCameraFar=I.camera.far,a.pointShadow[h]=O,a.pointShadowMap[h]=M,a.pointShadowMatrix[h]=x.shadow.matrix,m++}a.point[h]=D,h++}else if(x.isHemisphereLight){var F=r.get(x);F.skyColor.copy(x.color).multiplyScalar(w),F.groundColor.copy(x.groundColor).multiplyScalar(w),a.hemi[p]=F,p++}}f>0&&(t.isWebGL2||!0===e.has("OES_texture_float_linear")?(a.rectAreaLTC1=Lr.LTC_FLOAT_1,a.rectAreaLTC2=Lr.LTC_FLOAT_2):!0===e.has("OES_texture_half_float_linear")?(a.rectAreaLTC1=Lr.LTC_HALF_1,a.rectAreaLTC2=Lr.LTC_HALF_2):console.error("THREE.WebGLRenderer: Unable to use RectAreaLight. Missing WebGL extensions.")),a.ambient[0]=o,a.ambient[1]=s,a.ambient[2]=l;var N=a.hash;N.directionalLength===c&&N.pointLength===h&&N.spotLength===d&&N.rectAreaLength===f&&N.hemiLength===p&&N.numDirectionalShadows===v&&N.numPointShadows===m&&N.numSpotShadows===g||(a.directional.length=c,a.spot.length=d,a.rectArea.length=f,a.point.length=h,a.hemi.length=p,a.directionalShadow.length=v,a.directionalShadowMap.length=v,a.pointShadow.length=m,a.pointShadowMap.length=m,a.spotShadow.length=g,a.spotShadowMap.length=g,a.directionalShadowMatrix.length=v,a.pointShadowMatrix.length=m,a.spotShadowMatrix.length=g,N.directionalLength=c,N.pointLength=h,N.spotLength=d,N.rectAreaLength=f,N.hemiLength=p,N.numDirectionalShadows=v,N.numPointShadows=m,N.numSpotShadows=g,a.version=Ya++)},setupView:function(e,t){for(var n=0,r=0,i=0,o=0,c=0,h=t.matrixWorldInverse,d=0,f=e.length;d<f;d++){var p=e[d];if(p.isDirectionalLight){var v=a.directional[n];v.direction.setFromMatrixPosition(p.matrixWorld),s.setFromMatrixPosition(p.target.matrixWorld),v.direction.sub(s),v.direction.transformDirection(h),n++}else if(p.isSpotLight){var m=a.spot[i];m.position.setFromMatrixPosition(p.matrixWorld),m.position.applyMatrix4(h),m.direction.setFromMatrixPosition(p.matrixWorld),s.setFromMatrixPosition(p.target.matrixWorld),m.direction.sub(s),m.direction.transformDirection(h),i++}else if(p.isRectAreaLight){var g=a.rectArea[o];g.position.setFromMatrixPosition(p.matrixWorld),g.position.applyMatrix4(h),u.identity(),l.copy(p.matrixWorld),l.premultiply(h),u.extractRotation(l),g.halfWidth.set(.5*p.width,0,0),g.halfHeight.set(0,.5*p.height,0),g.halfWidth.applyMatrix4(u),g.halfHeight.applyMatrix4(u),o++}else if(p.isPointLight){var _=a.point[r];_.position.setFromMatrixPosition(p.matrixWorld),_.position.applyMatrix4(h),r++}else if(p.isHemisphereLight){var y=a.hemi[c];y.direction.setFromMatrixPosition(p.matrixWorld),y.direction.transformDirection(h),y.direction.normalize(),c++}}},state:a}}function Ja(e,t){var n=new Za(e,t),r=[],i=[];return{init:function(){r.length=0,i.length=0},state:{lightsArray:r,shadowsArray:i,lights:n},setupLights:function(){n.setup(r)},setupLightsView:function(e){n.setupView(r,e)},pushLight:function(e){r.push(e)},pushShadow:function(e){i.push(e)}}}function Qa(e,t){var n=new WeakMap;return{get:function(r){var i,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return!1===n.has(r)?(i=new Ja(e,t),n.set(r,[i])):a>=n.get(r).length?(i=new Ja(e,t),n.get(r).push(i)):i=n.get(r)[a],i},dispose:function(){n=new WeakMap}}}var $a=function(e){(0,d.default)(n,e);var t=b(n);function n(e){var r;return(0,v.default)(this,n),(r=t.call(this)).type="MeshDepthMaterial",r.depthPacking=3200,r.map=null,r.alphaMap=null,r.displacementMap=null,r.displacementScale=1,r.displacementBias=0,r.wireframe=!1,r.wireframeLinewidth=1,r.fog=!1,r.setValues(e),r}return(0,m.default)(n,[{key:"copy",value:function(e){return(0,u.default)((0,p.default)(n.prototype),"copy",this).call(this,e),this.depthPacking=e.depthPacking,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this}}]),n}(ln);$a.prototype.isMeshDepthMaterial=!0;var eo=function(e){(0,d.default)(n,e);var t=b(n);function n(e){var r;return(0,v.default)(this,n),(r=t.call(this)).type="MeshDistanceMaterial",r.referencePosition=new qe,r.nearDistance=1,r.farDistance=1e3,r.map=null,r.alphaMap=null,r.displacementMap=null,r.displacementScale=1,r.displacementBias=0,r.fog=!1,r.setValues(e),r}return(0,m.default)(n,[{key:"copy",value:function(e){return(0,u.default)((0,p.default)(n.prototype),"copy",this).call(this,e),this.referencePosition.copy(e.referencePosition),this.nearDistance=e.nearDistance,this.farDistance=e.farDistance,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this}}]),n}(ln);function to(e,t,n){var r=new Tr,i=new Ie,a=new Ie,o=new He,s=new $a({depthPacking:3201}),l=new eo,u={},c=n.maxTextureSize,h={0:1,1:0,2:2},d=new cr({defines:{SAMPLE_RATE:2/8,HALF_SAMPLE_RATE:1/8},uniforms:{shadow_pass:{value:null},resolution:{value:new Ie},radius:{value:4}},vertexShader:"void main() {\n\tgl_Position = vec4( position, 1.0 );\n}",fragmentShader:"uniform sampler2D shadow_pass;\nuniform vec2 resolution;\nuniform float radius;\n#include <packing>\nvoid main() {\n\tfloat mean = 0.0;\n\tfloat squared_mean = 0.0;\n\tfloat depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy ) / resolution ) );\n\tfor ( float i = -1.0; i < 1.0 ; i += SAMPLE_RATE) {\n\t\t#ifdef HORIZONTAL_PASS\n\t\t\tvec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( i, 0.0 ) * radius ) / resolution ) );\n\t\t\tmean += distribution.x;\n\t\t\tsquared_mean += distribution.y * distribution.y + distribution.x * distribution.x;\n\t\t#else\n\t\t\tfloat depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, i ) * radius ) / resolution ) );\n\t\t\tmean += depth;\n\t\t\tsquared_mean += depth * depth;\n\t\t#endif\n\t}\n\tmean = mean * HALF_SAMPLE_RATE;\n\tsquared_mean = squared_mean * HALF_SAMPLE_RATE;\n\tfloat std_dev = sqrt( squared_mean - mean * mean );\n\tgl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );\n}"}),f=d.clone();f.defines.HORIZONTAL_PASS=1;var p=new zn;p.setAttribute("position",new yn(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));var v=new ir(p,d),m=this;function g(n,r){var i=t.update(v);d.uniforms.shadow_pass.value=n.map.texture,d.uniforms.resolution.value=n.mapSize,d.uniforms.radius.value=n.radius,e.setRenderTarget(n.mapPass),e.clear(),e.renderBufferDirect(r,null,i,d,v,null),f.uniforms.shadow_pass.value=n.mapPass.texture,f.uniforms.resolution.value=n.mapSize,f.uniforms.radius.value=n.radius,e.setRenderTarget(n.map),e.clear(),e.renderBufferDirect(r,null,i,f,v,null)}function _(t,n,r,i,a,o,c){var d=null,f=!0===i.isPointLight?t.customDistanceMaterial:t.customDepthMaterial;if(d=void 0!==f?f:!0===i.isPointLight?l:s,e.localClippingEnabled&&!0===r.clipShadows&&0!==r.clippingPlanes.length){var p=d.uuid,v=r.uuid,m=u[p];void 0===m&&(m={},u[p]=m);var g=m[v];void 0===g&&(g=d.clone(),m[v]=g),d=g}return d.visible=r.visible,d.wireframe=r.wireframe,d.side=3===c?null!==r.shadowSide?r.shadowSide:r.side:null!==r.shadowSide?r.shadowSide:h[r.side],d.clipShadows=r.clipShadows,d.clippingPlanes=r.clippingPlanes,d.clipIntersection=r.clipIntersection,d.wireframeLinewidth=r.wireframeLinewidth,d.linewidth=r.linewidth,!0===i.isPointLight&&!0===d.isMeshDistanceMaterial&&(d.referencePosition.setFromMatrixPosition(i.matrixWorld),d.nearDistance=a,d.farDistance=o),d}function y(n,i,a,o,s){if(!1!==n.visible){if(n.layers.test(i.layers)&&(n.isMesh||n.isLine||n.isPoints)&&(n.castShadow||n.receiveShadow&&3===s)&&(!n.frustumCulled||r.intersectsObject(n))){n.modelViewMatrix.multiplyMatrices(a.matrixWorldInverse,n.matrixWorld);var l=t.update(n),u=n.material;if(Array.isArray(u))for(var c=l.groups,h=0,d=c.length;h<d;h++){var f=c[h],p=u[f.materialIndex];if(p&&p.visible){var v=_(n,0,p,o,a.near,a.far,s);e.renderBufferDirect(a,null,l,v,n,f)}}else if(u.visible){var m=_(n,0,u,o,a.near,a.far,s);e.renderBufferDirect(a,null,l,m,n,null)}}for(var g=n.children,x=0,b=g.length;x<b;x++)y(g[x],i,a,o,s)}}this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=1,this.render=function(t,n,s){if(!1!==m.enabled&&(!1!==m.autoUpdate||!1!==m.needsUpdate)&&0!==t.length){var l=e.getRenderTarget(),u=e.getActiveCubeFace(),h=e.getActiveMipmapLevel(),d=e.state;d.setBlending(0),d.buffers.color.setClear(1,1,1,1),d.buffers.depth.setTest(!0),d.setScissorTest(!1);for(var f=0,p=t.length;f<p;f++){var v=t[f],_=v.shadow;if(void 0!==_){if(!1!==_.autoUpdate||!1!==_.needsUpdate){i.copy(_.mapSize);var x=_.getFrameExtents();if(i.multiply(x),a.copy(_.mapSize),(i.x>c||i.y>c)&&(i.x>c&&(a.x=Math.floor(c/x.x),i.x=a.x*x.x,_.mapSize.x=a.x),i.y>c&&(a.y=Math.floor(c/x.y),i.y=a.y*x.y,_.mapSize.y=a.y)),null===_.map&&!_.isPointLightShadow&&3===this.type){var b={minFilter:k,magFilter:k,format:H};_.map=new Ge(i.x,i.y,b),_.map.texture.name=v.name+".shadowMap",_.mapPass=new Ge(i.x,i.y,b),_.camera.updateProjectionMatrix()}if(null===_.map){var w={minFilter:L,magFilter:L,format:H};_.map=new Ge(i.x,i.y,w),_.map.texture.name=v.name+".shadowMap",_.camera.updateProjectionMatrix()}e.setRenderTarget(_.map),e.clear();for(var T=_.getViewportCount(),M=0;M<T;M++){var S=_.getViewport(M);o.set(a.x*S.x,a.y*S.y,a.x*S.z,a.y*S.w),d.viewport(o),_.updateMatrices(v,M),r=_.getFrustum(),y(n,s,_.camera,v,this.type)}_.isPointLightShadow||3!==this.type||g(_,s),_.needsUpdate=!1}}else console.warn("THREE.WebGLShadowMap:",v,"has no shadow.")}m.needsUpdate=!1,e.setRenderTarget(l,u,h)}}}function no(e,t,n){var i,a,o=n.isWebGL2,s=new function(){var t=!1,n=new He,r=null,i=new He(0,0,0,0);return{setMask:function(n){r===n||t||(e.colorMask(n,n,n,n),r=n)},setLocked:function(e){t=e},setClear:function(t,r,a,o,s){!0===s&&(t*=o,r*=o,a*=o),n.set(t,r,a,o),!1===i.equals(n)&&(e.clearColor(t,r,a,o),i.copy(n))},reset:function(){t=!1,r=null,i.set(-1,0,0,0)}}},l=new function(){var t=!1,n=null,r=null,i=null;return{setTest:function(t){t?H(e.DEPTH_TEST):G(e.DEPTH_TEST)},setMask:function(r){n===r||t||(e.depthMask(r),n=r)},setFunc:function(t){if(r!==t){if(t)switch(t){case 0:e.depthFunc(e.NEVER);break;case 1:e.depthFunc(e.ALWAYS);break;case 2:e.depthFunc(e.LESS);break;case 3:default:e.depthFunc(e.LEQUAL);break;case 4:e.depthFunc(e.EQUAL);break;case 5:e.depthFunc(e.GEQUAL);break;case 6:e.depthFunc(e.GREATER);break;case 7:e.depthFunc(e.NOTEQUAL)}else e.depthFunc(e.LEQUAL);r=t}},setLocked:function(e){t=e},setClear:function(t){i!==t&&(e.clearDepth(t),i=t)},reset:function(){t=!1,n=null,r=null,i=null}}},u=new function(){var t=!1,n=null,r=null,i=null,a=null,o=null,s=null,l=null,u=null;return{setTest:function(n){t||(n?H(e.STENCIL_TEST):G(e.STENCIL_TEST))},setMask:function(r){n===r||t||(e.stencilMask(r),n=r)},setFunc:function(t,n,o){r===t&&i===n&&a===o||(e.stencilFunc(t,n,o),r=t,i=n,a=o)},setOp:function(t,n,r){o===t&&s===n&&l===r||(e.stencilOp(t,n,r),o=t,s=n,l=r)},setLocked:function(e){t=e},setClear:function(t){u!==t&&(e.clearStencil(t),u=t)},reset:function(){t=!1,n=null,r=null,i=null,a=null,o=null,s=null,l=null,u=null}}},h={},d=null,f={},p=null,v=!1,m=null,g=null,_=null,y=null,x=null,b=null,w=null,T=!1,M=null,S=null,E=null,A=null,L=null,C=e.getParameter(e.MAX_COMBINED_TEXTURE_IMAGE_UNITS),R=!1,k=0,P=e.getParameter(e.VERSION);-1!==P.indexOf("WebGL")?(k=parseFloat(/^WebGL (\d)/.exec(P)[1]),R=k>=1):-1!==P.indexOf("OpenGL ES")&&(k=parseFloat(/^OpenGL ES (\d)/.exec(P)[1]),R=k>=2);var D=null,I={},O=e.getParameter(e.SCISSOR_BOX),F=e.getParameter(e.VIEWPORT),N=(new He).fromArray(O),U=(new He).fromArray(F);function B(t,n,r){var i=new Uint8Array(4),a=e.createTexture();e.bindTexture(t,a),e.texParameteri(t,e.TEXTURE_MIN_FILTER,e.NEAREST),e.texParameteri(t,e.TEXTURE_MAG_FILTER,e.NEAREST);for(var o=0;o<r;o++)e.texImage2D(n+o,0,e.RGBA,1,1,0,e.RGBA,e.UNSIGNED_BYTE,i);return a}var z={};function H(t){!0!==h[t]&&(e.enable(t),h[t]=!0)}function G(t){!1!==h[t]&&(e.disable(t),h[t]=!1)}z[e.TEXTURE_2D]=B(e.TEXTURE_2D,e.TEXTURE_2D,1),z[e.TEXTURE_CUBE_MAP]=B(e.TEXTURE_CUBE_MAP,e.TEXTURE_CUBE_MAP_POSITIVE_X,6),s.setClear(0,0,0,1),l.setClear(1),u.setClear(0),H(e.DEPTH_TEST),l.setFunc(3),X(!1),Y(1),H(e.CULL_FACE),q(0);var V=(i={},(0,c.default)(i,r,e.FUNC_ADD),(0,c.default)(i,101,e.FUNC_SUBTRACT),(0,c.default)(i,102,e.FUNC_REVERSE_SUBTRACT),i);if(o)V[103]=e.MIN,V[104]=e.MAX;else{var W=t.get("EXT_blend_minmax");null!==W&&(V[103]=W.MIN_EXT,V[104]=W.MAX_EXT)}var j=(a={},(0,c.default)(a,200,e.ZERO),(0,c.default)(a,201,e.ONE),(0,c.default)(a,202,e.SRC_COLOR),(0,c.default)(a,204,e.SRC_ALPHA),(0,c.default)(a,210,e.SRC_ALPHA_SATURATE),(0,c.default)(a,208,e.DST_COLOR),(0,c.default)(a,206,e.DST_ALPHA),(0,c.default)(a,203,e.ONE_MINUS_SRC_COLOR),(0,c.default)(a,205,e.ONE_MINUS_SRC_ALPHA),(0,c.default)(a,209,e.ONE_MINUS_DST_COLOR),(0,c.default)(a,207,e.ONE_MINUS_DST_ALPHA),a);function q(t,n,i,a,o,s,l,u){if(0!==t){if(!1===v&&(H(e.BLEND),v=!0),5===t)o=o||n,s=s||i,l=l||a,n===g&&o===x||(e.blendEquationSeparate(V[n],V[o]),g=n,x=o),i===_&&a===y&&s===b&&l===w||(e.blendFuncSeparate(j[i],j[a],j[s],j[l]),_=i,y=a,b=s,w=l),m=t,T=null;else if(t!==m||u!==T){if(g===r&&x===r||(e.blendEquation(e.FUNC_ADD),g=r,x=r),u)switch(t){case 1:e.blendFuncSeparate(e.ONE,e.ONE_MINUS_SRC_ALPHA,e.ONE,e.ONE_MINUS_SRC_ALPHA);break;case 2:e.blendFunc(e.ONE,e.ONE);break;case 3:e.blendFuncSeparate(e.ZERO,e.ZERO,e.ONE_MINUS_SRC_COLOR,e.ONE_MINUS_SRC_ALPHA);break;case 4:e.blendFuncSeparate(e.ZERO,e.SRC_COLOR,e.ZERO,e.SRC_ALPHA);break;default:console.error("THREE.WebGLState: Invalid blending: ",t)}else switch(t){case 1:e.blendFuncSeparate(e.SRC_ALPHA,e.ONE_MINUS_SRC_ALPHA,e.ONE,e.ONE_MINUS_SRC_ALPHA);break;case 2:e.blendFunc(e.SRC_ALPHA,e.ONE);break;case 3:e.blendFunc(e.ZERO,e.ONE_MINUS_SRC_COLOR);break;case 4:e.blendFunc(e.ZERO,e.SRC_COLOR);break;default:console.error("THREE.WebGLState: Invalid blending: ",t)}_=null,y=null,b=null,w=null,m=t,T=u}}else!0===v&&(G(e.BLEND),v=!1)}function X(t){M!==t&&(t?e.frontFace(e.CW):e.frontFace(e.CCW),M=t)}function Y(t){0!==t?(H(e.CULL_FACE),t!==S&&(1===t?e.cullFace(e.BACK):2===t?e.cullFace(e.FRONT):e.cullFace(e.FRONT_AND_BACK))):G(e.CULL_FACE),S=t}function K(t,n,r){t?(H(e.POLYGON_OFFSET_FILL),A===n&&L===r||(e.polygonOffset(n,r),A=n,L=r)):G(e.POLYGON_OFFSET_FILL)}function Z(t){void 0===t&&(t=e.TEXTURE0+C-1),D!==t&&(e.activeTexture(t),D=t)}return{buffers:{color:s,depth:l,stencil:u},enable:H,disable:G,bindFramebuffer:function(t,n){return null===n&&null!==d&&(n=d),f[t]!==n&&(e.bindFramebuffer(t,n),f[t]=n,o&&(t===e.DRAW_FRAMEBUFFER&&(f[e.FRAMEBUFFER]=n),t===e.FRAMEBUFFER&&(f[e.DRAW_FRAMEBUFFER]=n)),!0)},bindXRFramebuffer:function(t){t!==d&&(e.bindFramebuffer(e.FRAMEBUFFER,t),d=t)},useProgram:function(t){return p!==t&&(e.useProgram(t),p=t,!0)},setBlending:q,setMaterial:function(t,n){2===t.side?G(e.CULL_FACE):H(e.CULL_FACE);var r=1===t.side;n&&(r=!r),X(r),1===t.blending&&!1===t.transparent?q(0):q(t.blending,t.blendEquation,t.blendSrc,t.blendDst,t.blendEquationAlpha,t.blendSrcAlpha,t.blendDstAlpha,t.premultipliedAlpha),l.setFunc(t.depthFunc),l.setTest(t.depthTest),l.setMask(t.depthWrite),s.setMask(t.colorWrite);var i=t.stencilWrite;u.setTest(i),i&&(u.setMask(t.stencilWriteMask),u.setFunc(t.stencilFunc,t.stencilRef,t.stencilFuncMask),u.setOp(t.stencilFail,t.stencilZFail,t.stencilZPass)),K(t.polygonOffset,t.polygonOffsetFactor,t.polygonOffsetUnits),!0===t.alphaToCoverage?H(e.SAMPLE_ALPHA_TO_COVERAGE):G(e.SAMPLE_ALPHA_TO_COVERAGE)},setFlipSided:X,setCullFace:Y,setLineWidth:function(t){t!==E&&(R&&e.lineWidth(t),E=t)},setPolygonOffset:K,setScissorTest:function(t){t?H(e.SCISSOR_TEST):G(e.SCISSOR_TEST)},activeTexture:Z,bindTexture:function(t,n){null===D&&Z();var r=I[D];void 0===r&&(r={type:void 0,texture:void 0},I[D]=r),r.type===t&&r.texture===n||(e.bindTexture(t,n||z[t]),r.type=t,r.texture=n)},unbindTexture:function(){var t=I[D];void 0!==t&&void 0!==t.type&&(e.bindTexture(t.type,null),t.type=void 0,t.texture=void 0)},compressedTexImage2D:function(){try{e.compressedTexImage2D.apply(e,arguments)}catch(e){console.error("THREE.WebGLState:",e)}},texImage2D:function(){try{e.texImage2D.apply(e,arguments)}catch(e){console.error("THREE.WebGLState:",e)}},texImage3D:function(){try{e.texImage3D.apply(e,arguments)}catch(e){console.error("THREE.WebGLState:",e)}},scissor:function(t){!1===N.equals(t)&&(e.scissor(t.x,t.y,t.z,t.w),N.copy(t))},viewport:function(t){!1===U.equals(t)&&(e.viewport(t.x,t.y,t.z,t.w),U.copy(t))},reset:function(){e.disable(e.BLEND),e.disable(e.CULL_FACE),e.disable(e.DEPTH_TEST),e.disable(e.POLYGON_OFFSET_FILL),e.disable(e.SCISSOR_TEST),e.disable(e.STENCIL_TEST),e.disable(e.SAMPLE_ALPHA_TO_COVERAGE),e.blendEquation(e.FUNC_ADD),e.blendFunc(e.ONE,e.ZERO),e.blendFuncSeparate(e.ONE,e.ZERO,e.ONE,e.ZERO),e.colorMask(!0,!0,!0,!0),e.clearColor(0,0,0,0),e.depthMask(!0),e.depthFunc(e.LESS),e.clearDepth(1),e.stencilMask(4294967295),e.stencilFunc(e.ALWAYS,0,4294967295),e.stencilOp(e.KEEP,e.KEEP,e.KEEP),e.clearStencil(0),e.cullFace(e.BACK),e.frontFace(e.CCW),e.polygonOffset(0,0),e.activeTexture(e.TEXTURE0),e.bindFramebuffer(e.FRAMEBUFFER,null),!0===o&&(e.bindFramebuffer(e.DRAW_FRAMEBUFFER,null),e.bindFramebuffer(e.READ_FRAMEBUFFER,null)),e.useProgram(null),e.lineWidth(1),e.scissor(0,0,e.canvas.width,e.canvas.height),e.viewport(0,0,e.canvas.width,e.canvas.height),h={},D=null,I={},d=null,f={},p=null,v=!1,m=null,g=null,_=null,y=null,x=null,b=null,w=null,T=!1,M=null,S=null,E=null,A=null,L=null,N.set(0,0,e.canvas.width,e.canvas.height),U.set(0,0,e.canvas.width,e.canvas.height),s.reset(),l.reset(),u.reset()}}}function ro(e,t,n,r,i,a,o){var s,l,u,h=i.isWebGL2,d=i.maxTextures,f=i.maxCubemapSize,p=i.maxTextureSize,v=i.maxSamples,m=new WeakMap,g=!1;try{g="undefined"!=typeof OffscreenCanvas&&null!==new OffscreenCanvas(1,1).getContext("2d")}catch(e){}function _(e,t){return g?new OffscreenCanvas(e,t):document.createElementNS("http://www.w3.org/1999/xhtml","canvas")}function y(e,t,n,r){var i=1;if((e.width>r||e.height>r)&&(i=r/Math.max(e.width,e.height)),i<1||!0===t){if("undefined"!=typeof HTMLImageElement&&e instanceof HTMLImageElement||"undefined"!=typeof HTMLCanvasElement&&e instanceof HTMLCanvasElement||"undefined"!=typeof ImageBitmap&&e instanceof ImageBitmap){var a=t?Pe:Math.floor,o=a(i*e.width),s=a(i*e.height);void 0===u&&(u=_(o,s));var l=n?_(o,s):u;return l.width=o,l.height=s,l.getContext("2d").drawImage(e,0,0,o,s),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+e.width+"x"+e.height+") to ("+o+"x"+s+")."),l}return"data"in e&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+e.width+"x"+e.height+")."),e}return e}function x(e){return Re(e.width)&&Re(e.height)}function b(e,t){return e.generateMipmaps&&t&&e.minFilter!==L&&e.minFilter!==k}function w(t,n,i,a){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1;e.generateMipmap(t);var s=r.get(n);s.__maxMipLevel=Math.log2(Math.max(i,a,o))}function T(n,r,i){if(!1===h)return r;if(null!==n){if(void 0!==e[n])return e[n];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+n+"'")}var a=r;return r===e.RED&&(i===e.FLOAT&&(a=e.R32F),i===e.HALF_FLOAT&&(a=e.R16F),i===e.UNSIGNED_BYTE&&(a=e.R8)),r===e.RGB&&(i===e.FLOAT&&(a=e.RGB32F),i===e.HALF_FLOAT&&(a=e.RGB16F),i===e.UNSIGNED_BYTE&&(a=e.RGB8)),r===e.RGBA&&(i===e.FLOAT&&(a=e.RGBA32F),i===e.HALF_FLOAT&&(a=e.RGBA16F),i===e.UNSIGNED_BYTE&&(a=e.RGBA8)),a!==e.R16F&&a!==e.R32F&&a!==e.RGBA16F&&a!==e.RGBA32F||t.get("EXT_color_buffer_float"),a}function M(t){return t===L||t===C||t===R?e.NEAREST:e.LINEAR}function I(t){var n=t.target;n.removeEventListener("dispose",I),function(t){var n=r.get(t);void 0!==n.__webglInit&&(e.deleteTexture(n.__webglTexture),r.remove(t))}(n),n.isVideoTexture&&m.delete(n),o.memory.textures--}function W(t){var n=t.target;n.removeEventListener("dispose",W),function(t){var n=t.texture,i=r.get(t),a=r.get(n);if(t){if(void 0!==a.__webglTexture&&(e.deleteTexture(a.__webglTexture),o.memory.textures--),t.depthTexture&&t.depthTexture.dispose(),t.isWebGLCubeRenderTarget)for(var s=0;s<6;s++)e.deleteFramebuffer(i.__webglFramebuffer[s]),i.__webglDepthbuffer&&e.deleteRenderbuffer(i.__webglDepthbuffer[s]);else e.deleteFramebuffer(i.__webglFramebuffer),i.__webglDepthbuffer&&e.deleteRenderbuffer(i.__webglDepthbuffer),i.__webglMultisampledFramebuffer&&e.deleteFramebuffer(i.__webglMultisampledFramebuffer),i.__webglColorRenderbuffer&&e.deleteRenderbuffer(i.__webglColorRenderbuffer),i.__webglDepthRenderbuffer&&e.deleteRenderbuffer(i.__webglDepthRenderbuffer);if(t.isWebGLMultipleRenderTargets)for(var l=0,u=n.length;l<u;l++){var c=r.get(n[l]);c.__webglTexture&&(e.deleteTexture(c.__webglTexture),o.memory.textures--),r.remove(n[l])}r.remove(n),r.remove(t)}}(n)}var j=0;function q(t,i){var a=r.get(t);if(t.isVideoTexture&&function(e){var t=o.render.frame;m.get(e)!==t&&(m.set(e,t),e.update())}(t),t.version>0&&a.__version!==t.version){var s=t.image;if(void 0===s)console.warn("THREE.WebGLRenderer: Texture marked for update but image is undefined");else{if(!1!==s.complete)return void Q(a,t,i);console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete")}}n.activeTexture(e.TEXTURE0+i),n.bindTexture(e.TEXTURE_2D,a.__webglTexture)}function X(t,i){var o=r.get(t);t.version>0&&o.__version!==t.version?function(t,r,i){if(6===r.image.length){J(t,r),n.activeTexture(e.TEXTURE0+i),n.bindTexture(e.TEXTURE_CUBE_MAP,t.__webglTexture),e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,r.flipY),e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,r.premultiplyAlpha),e.pixelStorei(e.UNPACK_ALIGNMENT,r.unpackAlignment),e.pixelStorei(e.UNPACK_COLORSPACE_CONVERSION_WEBGL,e.NONE);for(var o=r&&(r.isCompressedTexture||r.image[0].isCompressedTexture),s=r.image[0]&&r.image[0].isDataTexture,l=[],u=0;u<6;u++)l[u]=o||s?s?r.image[u].image:r.image[u]:y(r.image[u],!1,!0,f);var c,d=l[0],p=x(d)||h,v=a.convert(r.format),m=a.convert(r.type),g=T(r.internalFormat,v,m);if(Z(e.TEXTURE_CUBE_MAP,r,p),o){for(var _=0;_<6;_++){c=l[_].mipmaps;for(var M=0;M<c.length;M++){var S=c[M];r.format!==H&&r.format!==z?null!==v?n.compressedTexImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+_,M,g,S.width,S.height,0,S.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):n.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+_,M,g,S.width,S.height,0,v,m,S.data)}}t.__maxMipLevel=c.length-1}else{c=r.mipmaps;for(var E=0;E<6;E++)if(s){n.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+E,0,g,l[E].width,l[E].height,0,v,m,l[E].data);for(var A=0;A<c.length;A++){var L=c[A].image[E].image;n.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+E,A+1,g,L.width,L.height,0,v,m,L.data)}}else{n.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+E,0,g,v,m,l[E]);for(var C=0;C<c.length;C++){var R=c[C];n.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+E,C+1,g,v,m,R.image[E])}}t.__maxMipLevel=c.length}b(r,p)&&w(e.TEXTURE_CUBE_MAP,r,d.width,d.height),t.__version=r.version,r.onUpdate&&r.onUpdate(r)}}(o,t,i):(n.activeTexture(e.TEXTURE0+i),n.bindTexture(e.TEXTURE_CUBE_MAP,o.__webglTexture))}var Y=(s={},(0,c.default)(s,S,e.REPEAT),(0,c.default)(s,E,e.CLAMP_TO_EDGE),(0,c.default)(s,A,e.MIRRORED_REPEAT),s),K=(l={},(0,c.default)(l,L,e.NEAREST),(0,c.default)(l,C,e.NEAREST_MIPMAP_NEAREST),(0,c.default)(l,R,e.NEAREST_MIPMAP_LINEAR),(0,c.default)(l,k,e.LINEAR),(0,c.default)(l,P,e.LINEAR_MIPMAP_NEAREST),(0,c.default)(l,D,e.LINEAR_MIPMAP_LINEAR),l);function Z(n,a,o){if(o?(e.texParameteri(n,e.TEXTURE_WRAP_S,Y[a.wrapS]),e.texParameteri(n,e.TEXTURE_WRAP_T,Y[a.wrapT]),n!==e.TEXTURE_3D&&n!==e.TEXTURE_2D_ARRAY||e.texParameteri(n,e.TEXTURE_WRAP_R,Y[a.wrapR]),e.texParameteri(n,e.TEXTURE_MAG_FILTER,K[a.magFilter]),e.texParameteri(n,e.TEXTURE_MIN_FILTER,K[a.minFilter])):(e.texParameteri(n,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(n,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),n!==e.TEXTURE_3D&&n!==e.TEXTURE_2D_ARRAY||e.texParameteri(n,e.TEXTURE_WRAP_R,e.CLAMP_TO_EDGE),a.wrapS===E&&a.wrapT===E||console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),e.texParameteri(n,e.TEXTURE_MAG_FILTER,M(a.magFilter)),e.texParameteri(n,e.TEXTURE_MIN_FILTER,M(a.minFilter)),a.minFilter!==L&&a.minFilter!==k&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.")),!0===t.has("EXT_texture_filter_anisotropic")){var s=t.get("EXT_texture_filter_anisotropic");if(a.type===N&&!1===t.has("OES_texture_float_linear"))return;if(!1===h&&a.type===U&&!1===t.has("OES_texture_half_float_linear"))return;(a.anisotropy>1||r.get(a).__currentAnisotropy)&&(e.texParameterf(n,s.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(a.anisotropy,i.getMaxAnisotropy())),r.get(a).__currentAnisotropy=a.anisotropy)}}function J(t,n){void 0===t.__webglInit&&(t.__webglInit=!0,n.addEventListener("dispose",I),t.__webglTexture=e.createTexture(),o.memory.textures++)}function Q(t,r,i){var o=e.TEXTURE_2D;r.isDataTexture2DArray&&(o=e.TEXTURE_2D_ARRAY),r.isDataTexture3D&&(o=e.TEXTURE_3D),J(t,r),n.activeTexture(e.TEXTURE0+i),n.bindTexture(o,t.__webglTexture),e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,r.flipY),e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,r.premultiplyAlpha),e.pixelStorei(e.UNPACK_ALIGNMENT,r.unpackAlignment),e.pixelStorei(e.UNPACK_COLORSPACE_CONVERSION_WEBGL,e.NONE);var s,l=function(e){return!h&&(e.wrapS!==E||e.wrapT!==E||e.minFilter!==L&&e.minFilter!==k)}(r)&&!1===x(r.image),u=y(r.image,l,!1,p),c=x(u)||h,d=a.convert(r.format),f=a.convert(r.type),v=T(r.internalFormat,d,f);Z(o,r,c);var m=r.mipmaps;if(r.isDepthTexture)v=e.DEPTH_COMPONENT,h?v=r.type===N?e.DEPTH_COMPONENT32F:r.type===F?e.DEPTH_COMPONENT24:r.type===B?e.DEPTH24_STENCIL8:e.DEPTH_COMPONENT16:r.type===N&&console.error("WebGLRenderer: Floating point depth texture requires WebGL2."),r.format===G&&v===e.DEPTH_COMPONENT&&r.type!==O&&r.type!==F&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),r.type=O,f=a.convert(r.type)),r.format===V&&v===e.DEPTH_COMPONENT&&(v=e.DEPTH_STENCIL,r.type!==B&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),r.type=B,f=a.convert(r.type))),n.texImage2D(e.TEXTURE_2D,0,v,u.width,u.height,0,d,f,null);else if(r.isDataTexture)if(m.length>0&&c){for(var g=0,_=m.length;g<_;g++)s=m[g],n.texImage2D(e.TEXTURE_2D,g,v,s.width,s.height,0,d,f,s.data);r.generateMipmaps=!1,t.__maxMipLevel=m.length-1}else n.texImage2D(e.TEXTURE_2D,0,v,u.width,u.height,0,d,f,u.data),t.__maxMipLevel=0;else if(r.isCompressedTexture){for(var M=0,S=m.length;M<S;M++)s=m[M],r.format!==H&&r.format!==z?null!==d?n.compressedTexImage2D(e.TEXTURE_2D,M,v,s.width,s.height,0,s.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):n.texImage2D(e.TEXTURE_2D,M,v,s.width,s.height,0,d,f,s.data);t.__maxMipLevel=m.length-1}else if(r.isDataTexture2DArray)n.texImage3D(e.TEXTURE_2D_ARRAY,0,v,u.width,u.height,u.depth,0,d,f,u.data),t.__maxMipLevel=0;else if(r.isDataTexture3D)n.texImage3D(e.TEXTURE_3D,0,v,u.width,u.height,u.depth,0,d,f,u.data),t.__maxMipLevel=0;else if(m.length>0&&c){for(var A=0,C=m.length;A<C;A++)s=m[A],n.texImage2D(e.TEXTURE_2D,A,v,d,f,s);r.generateMipmaps=!1,t.__maxMipLevel=m.length-1}else n.texImage2D(e.TEXTURE_2D,0,v,d,f,u),t.__maxMipLevel=0;b(r,c)&&w(o,r,u.width,u.height),t.__version=r.version,r.onUpdate&&r.onUpdate(r)}function $(t,i,o,s,l){var u=a.convert(o.format),c=a.convert(o.type),h=T(o.internalFormat,u,c);l===e.TEXTURE_3D||l===e.TEXTURE_2D_ARRAY?n.texImage3D(l,0,h,i.width,i.height,i.depth,0,u,c,null):n.texImage2D(l,0,h,i.width,i.height,0,u,c,null),n.bindFramebuffer(e.FRAMEBUFFER,t),e.framebufferTexture2D(e.FRAMEBUFFER,s,l,r.get(o).__webglTexture,0),n.bindFramebuffer(e.FRAMEBUFFER,null)}function ee(t,n,r){if(e.bindRenderbuffer(e.RENDERBUFFER,t),n.depthBuffer&&!n.stencilBuffer){var i=e.DEPTH_COMPONENT16;if(r){var o=n.depthTexture;o&&o.isDepthTexture&&(o.type===N?i=e.DEPTH_COMPONENT32F:o.type===F&&(i=e.DEPTH_COMPONENT24));var s=ne(n);e.renderbufferStorageMultisample(e.RENDERBUFFER,s,i,n.width,n.height)}else e.renderbufferStorage(e.RENDERBUFFER,i,n.width,n.height);e.framebufferRenderbuffer(e.FRAMEBUFFER,e.DEPTH_ATTACHMENT,e.RENDERBUFFER,t)}else if(n.depthBuffer&&n.stencilBuffer){if(r){var l=ne(n);e.renderbufferStorageMultisample(e.RENDERBUFFER,l,e.DEPTH24_STENCIL8,n.width,n.height)}else e.renderbufferStorage(e.RENDERBUFFER,e.DEPTH_STENCIL,n.width,n.height);e.framebufferRenderbuffer(e.FRAMEBUFFER,e.DEPTH_STENCIL_ATTACHMENT,e.RENDERBUFFER,t)}else{var u=!0===n.isWebGLMultipleRenderTargets?n.texture[0]:n.texture,c=a.convert(u.format),h=a.convert(u.type),d=T(u.internalFormat,c,h);if(r){var f=ne(n);e.renderbufferStorageMultisample(e.RENDERBUFFER,f,d,n.width,n.height)}else e.renderbufferStorage(e.RENDERBUFFER,d,n.width,n.height)}e.bindRenderbuffer(e.RENDERBUFFER,null)}function te(t){var i=r.get(t),a=!0===t.isWebGLCubeRenderTarget;if(t.depthTexture){if(a)throw new Error("target.depthTexture not supported in Cube render targets");!function(t,i){if(i&&i.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(n.bindFramebuffer(e.FRAMEBUFFER,t),!i.depthTexture||!i.depthTexture.isDepthTexture)throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");r.get(i.depthTexture).__webglTexture&&i.depthTexture.image.width===i.width&&i.depthTexture.image.height===i.height||(i.depthTexture.image.width=i.width,i.depthTexture.image.height=i.height,i.depthTexture.needsUpdate=!0),q(i.depthTexture,0);var a=r.get(i.depthTexture).__webglTexture;if(i.depthTexture.format===G)e.framebufferTexture2D(e.FRAMEBUFFER,e.DEPTH_ATTACHMENT,e.TEXTURE_2D,a,0);else{if(i.depthTexture.format!==V)throw new Error("Unknown depthTexture format");e.framebufferTexture2D(e.FRAMEBUFFER,e.DEPTH_STENCIL_ATTACHMENT,e.TEXTURE_2D,a,0)}}(i.__webglFramebuffer,t)}else if(a){i.__webglDepthbuffer=[];for(var o=0;o<6;o++)n.bindFramebuffer(e.FRAMEBUFFER,i.__webglFramebuffer[o]),i.__webglDepthbuffer[o]=e.createRenderbuffer(),ee(i.__webglDepthbuffer[o],t,!1)}else n.bindFramebuffer(e.FRAMEBUFFER,i.__webglFramebuffer),i.__webglDepthbuffer=e.createRenderbuffer(),ee(i.__webglDepthbuffer,t,!1);n.bindFramebuffer(e.FRAMEBUFFER,null)}function ne(e){return h&&e.isWebGLMultisampleRenderTarget?Math.min(v,e.samples):0}var re=!1,ie=!1;this.allocateTextureUnit=function(){var e=j;return e>=d&&console.warn("THREE.WebGLTextures: Trying to use "+e+" texture units while this GPU supports only "+d),j+=1,e},this.resetTextureUnits=function(){j=0},this.setTexture2D=q,this.setTexture2DArray=function(t,i){var a=r.get(t);t.version>0&&a.__version!==t.version?Q(a,t,i):(n.activeTexture(e.TEXTURE0+i),n.bindTexture(e.TEXTURE_2D_ARRAY,a.__webglTexture))},this.setTexture3D=function(t,i){var a=r.get(t);t.version>0&&a.__version!==t.version?Q(a,t,i):(n.activeTexture(e.TEXTURE0+i),n.bindTexture(e.TEXTURE_3D,a.__webglTexture))},this.setTextureCube=X,this.setupRenderTarget=function(t){var s=t.texture,l=r.get(t),u=r.get(s);t.addEventListener("dispose",W),!0!==t.isWebGLMultipleRenderTargets&&(u.__webglTexture=e.createTexture(),u.__version=s.version,o.memory.textures++);var c=!0===t.isWebGLCubeRenderTarget,d=!0===t.isWebGLMultipleRenderTargets,f=!0===t.isWebGLMultisampleRenderTarget,p=s.isDataTexture3D||s.isDataTexture2DArray,v=x(t)||h;if(!h||s.format!==z||s.type!==N&&s.type!==U||(s.format=H,console.warn("THREE.WebGLRenderer: Rendering to textures with RGB format is not supported. Using RGBA format instead.")),c){l.__webglFramebuffer=[];for(var m=0;m<6;m++)l.__webglFramebuffer[m]=e.createFramebuffer()}else if(l.__webglFramebuffer=e.createFramebuffer(),d)if(i.drawBuffers)for(var g=t.texture,_=0,y=g.length;_<y;_++){var M=r.get(g[_]);void 0===M.__webglTexture&&(M.__webglTexture=e.createTexture(),o.memory.textures++)}else console.warn("THREE.WebGLRenderer: WebGLMultipleRenderTargets can only be used with WebGL2 or WEBGL_draw_buffers extension.");else if(f)if(h){l.__webglMultisampledFramebuffer=e.createFramebuffer(),l.__webglColorRenderbuffer=e.createRenderbuffer(),e.bindRenderbuffer(e.RENDERBUFFER,l.__webglColorRenderbuffer);var S=a.convert(s.format),E=a.convert(s.type),A=T(s.internalFormat,S,E),L=ne(t);e.renderbufferStorageMultisample(e.RENDERBUFFER,L,A,t.width,t.height),n.bindFramebuffer(e.FRAMEBUFFER,l.__webglMultisampledFramebuffer),e.framebufferRenderbuffer(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.RENDERBUFFER,l.__webglColorRenderbuffer),e.bindRenderbuffer(e.RENDERBUFFER,null),t.depthBuffer&&(l.__webglDepthRenderbuffer=e.createRenderbuffer(),ee(l.__webglDepthRenderbuffer,t,!0)),n.bindFramebuffer(e.FRAMEBUFFER,null)}else console.warn("THREE.WebGLRenderer: WebGLMultisampleRenderTarget can only be used with WebGL2.");if(c){n.bindTexture(e.TEXTURE_CUBE_MAP,u.__webglTexture),Z(e.TEXTURE_CUBE_MAP,s,v);for(var C=0;C<6;C++)$(l.__webglFramebuffer[C],t,s,e.COLOR_ATTACHMENT0,e.TEXTURE_CUBE_MAP_POSITIVE_X+C);b(s,v)&&w(e.TEXTURE_CUBE_MAP,s,t.width,t.height),n.bindTexture(e.TEXTURE_CUBE_MAP,null)}else if(d){for(var R=t.texture,k=0,P=R.length;k<P;k++){var D=R[k],I=r.get(D);n.bindTexture(e.TEXTURE_2D,I.__webglTexture),Z(e.TEXTURE_2D,D,v),$(l.__webglFramebuffer,t,D,e.COLOR_ATTACHMENT0+k,e.TEXTURE_2D),b(D,v)&&w(e.TEXTURE_2D,D,t.width,t.height)}n.bindTexture(e.TEXTURE_2D,null)}else{var O=e.TEXTURE_2D;p&&(h?O=s.isDataTexture3D?e.TEXTURE_3D:e.TEXTURE_2D_ARRAY:console.warn("THREE.DataTexture3D and THREE.DataTexture2DArray only supported with WebGL2.")),n.bindTexture(O,u.__webglTexture),Z(O,s,v),$(l.__webglFramebuffer,t,s,e.COLOR_ATTACHMENT0,O),b(s,v)&&w(O,s,t.width,t.height,t.depth),n.bindTexture(O,null)}t.depthBuffer&&te(t)},this.updateRenderTargetMipmap=function(t){for(var i=x(t)||h,a=!0===t.isWebGLMultipleRenderTargets?t.texture:[t.texture],o=0,s=a.length;o<s;o++){var l=a[o];if(b(l,i)){var u=t.isWebGLCubeRenderTarget?e.TEXTURE_CUBE_MAP:e.TEXTURE_2D,c=r.get(l).__webglTexture;n.bindTexture(u,c),w(u,l,t.width,t.height),n.bindTexture(u,null)}}},this.updateMultisampleRenderTarget=function(t){if(t.isWebGLMultisampleRenderTarget)if(h){var i=t.width,a=t.height,o=e.COLOR_BUFFER_BIT;t.depthBuffer&&(o|=e.DEPTH_BUFFER_BIT),t.stencilBuffer&&(o|=e.STENCIL_BUFFER_BIT);var s=r.get(t);n.bindFramebuffer(e.READ_FRAMEBUFFER,s.__webglMultisampledFramebuffer),n.bindFramebuffer(e.DRAW_FRAMEBUFFER,s.__webglFramebuffer),e.blitFramebuffer(0,0,i,a,0,0,i,a,o,e.NEAREST),n.bindFramebuffer(e.READ_FRAMEBUFFER,null),n.bindFramebuffer(e.DRAW_FRAMEBUFFER,s.__webglMultisampledFramebuffer)}else console.warn("THREE.WebGLRenderer: WebGLMultisampleRenderTarget can only be used with WebGL2.")},this.safeSetTexture2D=function(e,t){e&&e.isWebGLRenderTarget&&(!1===re&&(console.warn("THREE.WebGLTextures.safeSetTexture2D: don't use render targets as textures. Use their .texture property instead."),re=!0),e=e.texture),q(e,t)},this.safeSetTextureCube=function(e,t){e&&e.isWebGLCubeRenderTarget&&(!1===ie&&(console.warn("THREE.WebGLTextures.safeSetTextureCube: don't use cube render targets as textures. Use their .texture property instead."),ie=!0),e=e.texture),X(e,t)}}function io(e,t,n){var r=n.isWebGL2;return{convert:function(n){var i;if(n===I)return e.UNSIGNED_BYTE;if(1017===n)return e.UNSIGNED_SHORT_4_4_4_4;if(1018===n)return e.UNSIGNED_SHORT_5_5_5_1;if(1019===n)return e.UNSIGNED_SHORT_5_6_5;if(1010===n)return e.BYTE;if(1011===n)return e.SHORT;if(n===O)return e.UNSIGNED_SHORT;if(1013===n)return e.INT;if(n===F)return e.UNSIGNED_INT;if(n===N)return e.FLOAT;if(n===U)return r?e.HALF_FLOAT:null!==(i=t.get("OES_texture_half_float"))?i.HALF_FLOAT_OES:null;if(1021===n)return e.ALPHA;if(n===z)return e.RGB;if(n===H)return e.RGBA;if(1024===n)return e.LUMINANCE;if(1025===n)return e.LUMINANCE_ALPHA;if(n===G)return e.DEPTH_COMPONENT;if(n===V)return e.DEPTH_STENCIL;if(1028===n)return e.RED;if(1029===n)return e.RED_INTEGER;if(1030===n)return e.RG;if(1031===n)return e.RG_INTEGER;if(1032===n)return e.RGB_INTEGER;if(1033===n)return e.RGBA_INTEGER;if(n===W||n===j||n===q||n===X){if(null===(i=t.get("WEBGL_compressed_texture_s3tc")))return null;if(n===W)return i.COMPRESSED_RGB_S3TC_DXT1_EXT;if(n===j)return i.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(n===q)return i.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(n===X)return i.COMPRESSED_RGBA_S3TC_DXT5_EXT}if(n===Y||n===K||n===Z||n===J){if(null===(i=t.get("WEBGL_compressed_texture_pvrtc")))return null;if(n===Y)return i.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(n===K)return i.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(n===Z)return i.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(n===J)return i.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(36196===n)return null!==(i=t.get("WEBGL_compressed_texture_etc1"))?i.COMPRESSED_RGB_ETC1_WEBGL:null;if((n===Q||n===$)&&null!==(i=t.get("WEBGL_compressed_texture_etc"))){if(n===Q)return i.COMPRESSED_RGB8_ETC2;if(n===$)return i.COMPRESSED_RGBA8_ETC2_EAC}return 37808===n||37809===n||37810===n||37811===n||37812===n||37813===n||37814===n||37815===n||37816===n||37817===n||37818===n||37819===n||37820===n||37821===n||37840===n||37841===n||37842===n||37843===n||37844===n||37845===n||37846===n||37847===n||37848===n||37849===n||37850===n||37851===n||37852===n||37853===n?null!==(i=t.get("WEBGL_compressed_texture_astc"))?n:null:36492===n?null!==(i=t.get("EXT_texture_compression_bptc"))?n:null:n===B?r?e.UNSIGNED_INT_24_8:null!==(i=t.get("WEBGL_depth_texture"))?i.UNSIGNED_INT_24_8_WEBGL:null:void 0}}}eo.prototype.isMeshDistanceMaterial=!0;var ao=function(e){(0,d.default)(n,e);var t=b(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return(0,v.default)(this,n),(e=t.call(this)).cameras=r,e}return(0,m.default)(n)}(dr);ao.prototype.isArrayCamera=!0;var oo=function(e){(0,d.default)(n,e);var t=b(n);function n(){var e;return(0,v.default)(this,n),(e=t.call(this)).type="Group",e}return(0,m.default)(n)}(Yt);oo.prototype.isGroup=!0;var so={type:"move"},lo=function(){function e(){(0,v.default)(this,e),this._targetRay=null,this._grip=null,this._hand=null}return(0,m.default)(e,[{key:"getHandSpace",value:function(){return null===this._hand&&(this._hand=new oo,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}},{key:"getTargetRaySpace",value:function(){return null===this._targetRay&&(this._targetRay=new oo,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new qe,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new qe),this._targetRay}},{key:"getGripSpace",value:function(){return null===this._grip&&(this._grip=new oo,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new qe,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new qe),this._grip}},{key:"dispatchEvent",value:function(e){return null!==this._targetRay&&this._targetRay.dispatchEvent(e),null!==this._grip&&this._grip.dispatchEvent(e),null!==this._hand&&this._hand.dispatchEvent(e),this}},{key:"disconnect",value:function(e){return this.dispatchEvent({type:"disconnected",data:e}),null!==this._targetRay&&(this._targetRay.visible=!1),null!==this._grip&&(this._grip.visible=!1),null!==this._hand&&(this._hand.visible=!1),this}},{key:"update",value:function(e,t,n){var r=null,i=null,a=null,o=this._targetRay,s=this._grip,l=this._hand;if(e&&"visible-blurred"!==t.session.visibilityState)if(null!==o&&null!==(r=t.getPose(e.targetRaySpace,n))&&(o.matrix.fromArray(r.transform.matrix),o.matrix.decompose(o.position,o.rotation,o.scale),r.linearVelocity?(o.hasLinearVelocity=!0,o.linearVelocity.copy(r.linearVelocity)):o.hasLinearVelocity=!1,r.angularVelocity?(o.hasAngularVelocity=!0,o.angularVelocity.copy(r.angularVelocity)):o.hasAngularVelocity=!1,this.dispatchEvent(so)),l&&e.hand){a=!0;var u,c=_(e.hand.values());try{for(c.s();!(u=c.n()).done;){var h=u.value,d=t.getJointPose(h,n);if(void 0===l.joints[h.jointName]){var f=new oo;f.matrixAutoUpdate=!1,f.visible=!1,l.joints[h.jointName]=f,l.add(f)}var p=l.joints[h.jointName];null!==d&&(p.matrix.fromArray(d.transform.matrix),p.matrix.decompose(p.position,p.rotation,p.scale),p.jointRadius=d.radius),p.visible=null!==d}}catch(e){c.e(e)}finally{c.f()}var v=l.joints["index-finger-tip"],m=l.joints["thumb-tip"],g=v.position.distanceTo(m.position);l.inputState.pinching&&g>.025?(l.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})):!l.inputState.pinching&&g<=.015&&(l.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this}))}else null!==s&&e.gripSpace&&null!==(i=t.getPose(e.gripSpace,n))&&(s.matrix.fromArray(i.transform.matrix),s.matrix.decompose(s.position,s.rotation,s.scale),i.linearVelocity?(s.hasLinearVelocity=!0,s.linearVelocity.copy(i.linearVelocity)):s.hasLinearVelocity=!1,i.angularVelocity?(s.hasAngularVelocity=!0,s.angularVelocity.copy(i.angularVelocity)):s.hasAngularVelocity=!1);return null!==o&&(o.visible=null!==r),null!==s&&(s.visible=null!==i),null!==l&&(l.visible=null!==a),this}}]),e}(),uo=function(e){(0,d.default)(n,e);var t=b(n);function n(e,r){var i;(0,v.default)(this,n),i=t.call(this);var a=(0,h.default)(i),l=e.state,u=null,c=1,d=null,f="local-floor",p=null,m=null,g=null,_=null,y=null,x=[],b=new Map,w=new dr;w.layers.enable(1),w.viewport=new He;var T=new dr;T.layers.enable(2),T.viewport=new He;var M=[w,T],S=new ao;S.layers.enable(1),S.layers.enable(2);var E=null,A=null;function L(e){var t=b.get(e.inputSource);t&&t.dispatchEvent({type:e.type,data:e.inputSource})}function C(){b.forEach((function(e,t){e.disconnect(t)})),b.clear(),E=null,A=null,l.bindXRFramebuffer(null),e.setRenderTarget(e.getRenderTarget()),O.stop(),a.isPresenting=!1,a.dispatchEvent({type:"sessionend"})}function R(e){for(var t=u.inputSources,n=0;n<x.length;n++)b.set(t[n],x[n]);for(var r=0;r<e.removed.length;r++){var i=e.removed[r],a=b.get(i);a&&(a.dispatchEvent({type:"disconnected",data:i}),b.delete(i))}for(var o=0;o<e.added.length;o++){var s=e.added[o],l=b.get(s);l&&l.dispatchEvent({type:"connected",data:s})}}i.cameraAutoUpdate=!0,i.enabled=!1,i.isPresenting=!1,i.getController=function(e){var t=x[e];return void 0===t&&(t=new lo,x[e]=t),t.getTargetRaySpace()},i.getControllerGrip=function(e){var t=x[e];return void 0===t&&(t=new lo,x[e]=t),t.getGripSpace()},i.getHand=function(e){var t=x[e];return void 0===t&&(t=new lo,x[e]=t),t.getHandSpace()},i.setFramebufferScaleFactor=function(e){c=e,!0===a.isPresenting&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},i.setReferenceSpaceType=function(e){f=e,!0===a.isPresenting&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},i.getReferenceSpace=function(){return d},i.getSession=function(){return u},i.setSession=function(){var e=(0,s.default)(o.default.mark((function e(t){var n,i,s,l,h;return o.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null===(u=t)){e.next=22;break}if(u.addEventListener("select",L),u.addEventListener("selectstart",L),u.addEventListener("selectend",L),u.addEventListener("squeeze",L),u.addEventListener("squeezestart",L),u.addEventListener("squeezeend",L),u.addEventListener("end",C),u.addEventListener("inputsourceschange",R),!0===(n=r.getContextAttributes()).xrCompatible){e.next=14;break}return e.next=14,r.makeXRCompatible();case 14:return void 0===u.renderState.layers?(i={antialias:n.antialias,alpha:n.alpha,depth:n.depth,stencil:n.stencil,framebufferScaleFactor:c},y=new XRWebGLLayer(u,r,i),u.updateRenderState({baseLayer:y})):(s=0,n.antialias?(l={antialias:!0,alpha:n.alpha,depth:n.depth,stencil:n.stencil,framebufferScaleFactor:c},y=new XRWebGLLayer(u,r,l),u.updateRenderState({layers:[y]})):(n.depth&&(s=n.stencil?r.DEPTH_STENCIL:r.DEPTH_COMPONENT),h={colorFormat:n.alpha?r.RGBA:r.RGB,depthFormat:s,scaleFactor:c},m=new XRWebGLBinding(u,r),_=m.createProjectionLayer(h),g=r.createFramebuffer(),u.updateRenderState({layers:[_]}))),e.next=17,u.requestReferenceSpace(f);case 17:d=e.sent,O.setContext(u),O.start(),a.isPresenting=!0,a.dispatchEvent({type:"sessionstart"});case 22:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();var k=new qe,P=new qe;function D(e,t){null===t?e.matrixWorld.copy(e.matrix):e.matrixWorld.multiplyMatrices(t.matrixWorld,e.matrix),e.matrixWorldInverse.copy(e.matrixWorld).invert()}i.updateCamera=function(e){if(null!==u){S.near=T.near=w.near=e.near,S.far=T.far=w.far=e.far,E===S.near&&A===S.far||(u.updateRenderState({depthNear:S.near,depthFar:S.far}),E=S.near,A=S.far);var t=e.parent,n=S.cameras;D(S,t);for(var r=0;r<n.length;r++)D(n[r],t);S.matrixWorld.decompose(S.position,S.quaternion,S.scale),e.position.copy(S.position),e.quaternion.copy(S.quaternion),e.scale.copy(S.scale),e.matrix.copy(S.matrix),e.matrixWorld.copy(S.matrixWorld);for(var i=e.children,a=0,o=i.length;a<o;a++)i[a].updateMatrixWorld(!0);2===n.length?function(e,t,n){k.setFromMatrixPosition(t.matrixWorld),P.setFromMatrixPosition(n.matrixWorld);var r=k.distanceTo(P),i=t.projectionMatrix.elements,a=n.projectionMatrix.elements,o=i[14]/(i[10]-1),s=i[14]/(i[10]+1),l=(i[9]+1)/i[5],u=(i[9]-1)/i[5],c=(i[8]-1)/i[0],h=(a[8]+1)/a[0],d=o*c,f=o*h,p=r/(-c+h),v=p*-c;t.matrixWorld.decompose(e.position,e.quaternion,e.scale),e.translateX(v),e.translateZ(p),e.matrixWorld.compose(e.position,e.quaternion,e.scale),e.matrixWorldInverse.copy(e.matrixWorld).invert();var m=o+p,g=s+p,_=d-v,y=f+(r-v),x=l*s/g*m,b=u*s/g*m;e.projectionMatrix.makePerspective(_,y,x,b,m,g)}(S,w,T):S.projectionMatrix.copy(w.projectionMatrix)}},i.getCamera=function(){return S},i.getFoveation=function(){return null!==_?_.fixedFoveation:null!==y?y.fixedFoveation:void 0},i.setFoveation=function(e){null!==_&&(_.fixedFoveation=e),null!==y&&void 0!==y.fixedFoveation&&(y.fixedFoveation=e)};var I=null,O=new Mr;return O.setAnimationLoop((function(e,t){if(null!==(p=t.getViewerPose(d))){var n=p.views;null!==y&&l.bindXRFramebuffer(y.framebuffer);var i=!1;n.length!==S.cameras.length&&(S.cameras.length=0,i=!0);for(var a=0;a<n.length;a++){var o=n[a],s=null;if(null!==y)s=y.getViewport(o);else{var c=m.getViewSubImage(_,o);l.bindXRFramebuffer(g),void 0!==c.depthStencilTexture&&r.framebufferTexture2D(r.FRAMEBUFFER,r.DEPTH_ATTACHMENT,r.TEXTURE_2D,c.depthStencilTexture,0),r.framebufferTexture2D(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0,r.TEXTURE_2D,c.colorTexture,0),s=c.viewport}var h=M[a];h.matrix.fromArray(o.transform.matrix),h.projectionMatrix.fromArray(o.projectionMatrix),h.viewport.set(s.x,s.y,s.width,s.height),0===a&&S.matrix.copy(h.matrix),!0===i&&S.cameras.push(h)}}for(var f=u.inputSources,v=0;v<x.length;v++){var b=x[v],w=f[v];b.update(w,t,d)}I&&I(e,t)})),i.setAnimationLoop=function(e){I=e},i.dispose=function(){},i}return(0,m.default)(n)}(xe);function co(e){function t(t,n){t.opacity.value=n.opacity,n.color&&t.diffuse.value.copy(n.color),n.emissive&&t.emissive.value.copy(n.emissive).multiplyScalar(n.emissiveIntensity),n.map&&(t.map.value=n.map),n.alphaMap&&(t.alphaMap.value=n.alphaMap),n.specularMap&&(t.specularMap.value=n.specularMap);var r,i,a=e.get(n).envMap;if(a){t.envMap.value=a,t.flipEnvMap.value=a.isCubeTexture&&!1===a.isRenderTargetTexture?-1:1,t.reflectivity.value=n.reflectivity,t.refractionRatio.value=n.refractionRatio;var o=e.get(a).__maxMipLevel;void 0!==o&&(t.maxMipLevel.value=o)}n.lightMap&&(t.lightMap.value=n.lightMap,t.lightMapIntensity.value=n.lightMapIntensity),n.aoMap&&(t.aoMap.value=n.aoMap,t.aoMapIntensity.value=n.aoMapIntensity),n.map?r=n.map:n.specularMap?r=n.specularMap:n.displacementMap?r=n.displacementMap:n.normalMap?r=n.normalMap:n.bumpMap?r=n.bumpMap:n.roughnessMap?r=n.roughnessMap:n.metalnessMap?r=n.metalnessMap:n.alphaMap?r=n.alphaMap:n.emissiveMap?r=n.emissiveMap:n.clearcoatMap?r=n.clearcoatMap:n.clearcoatNormalMap?r=n.clearcoatNormalMap:n.clearcoatRoughnessMap?r=n.clearcoatRoughnessMap:n.specularIntensityMap?r=n.specularIntensityMap:n.specularTintMap&&(r=n.specularTintMap),void 0!==r&&(r.isWebGLRenderTarget&&(r=r.texture),!0===r.matrixAutoUpdate&&r.updateMatrix(),t.uvTransform.value.copy(r.matrix)),n.aoMap?i=n.aoMap:n.lightMap&&(i=n.lightMap),void 0!==i&&(i.isWebGLRenderTarget&&(i=i.texture),!0===i.matrixAutoUpdate&&i.updateMatrix(),t.uv2Transform.value.copy(i.matrix))}function n(t,n){t.roughness.value=n.roughness,t.metalness.value=n.metalness,n.roughnessMap&&(t.roughnessMap.value=n.roughnessMap),n.metalnessMap&&(t.metalnessMap.value=n.metalnessMap),n.emissiveMap&&(t.emissiveMap.value=n.emissiveMap),n.bumpMap&&(t.bumpMap.value=n.bumpMap,t.bumpScale.value=n.bumpScale,1===n.side&&(t.bumpScale.value*=-1)),n.normalMap&&(t.normalMap.value=n.normalMap,t.normalScale.value.copy(n.normalScale),1===n.side&&t.normalScale.value.negate()),n.displacementMap&&(t.displacementMap.value=n.displacementMap,t.displacementScale.value=n.displacementScale,t.displacementBias.value=n.displacementBias),e.get(n).envMap&&(t.envMapIntensity.value=n.envMapIntensity)}return{refreshFogUniforms:function(e,t){e.fogColor.value.copy(t.color),t.isFog?(e.fogNear.value=t.near,e.fogFar.value=t.far):t.isFogExp2&&(e.fogDensity.value=t.density)},refreshMaterialUniforms:function(e,r,i,a,o){r.isMeshBasicMaterial?t(e,r):r.isMeshLambertMaterial?(t(e,r),function(e,t){t.emissiveMap&&(e.emissiveMap.value=t.emissiveMap)}(e,r)):r.isMeshToonMaterial?(t(e,r),function(e,t){t.gradientMap&&(e.gradientMap.value=t.gradientMap),t.emissiveMap&&(e.emissiveMap.value=t.emissiveMap),t.bumpMap&&(e.bumpMap.value=t.bumpMap,e.bumpScale.value=t.bumpScale,1===t.side&&(e.bumpScale.value*=-1)),t.normalMap&&(e.normalMap.value=t.normalMap,e.normalScale.value.copy(t.normalScale),1===t.side&&e.normalScale.value.negate()),t.displacementMap&&(e.displacementMap.value=t.displacementMap,e.displacementScale.value=t.displacementScale,e.displacementBias.value=t.displacementBias)}(e,r)):r.isMeshPhongMaterial?(t(e,r),function(e,t){e.specular.value.copy(t.specular),e.shininess.value=Math.max(t.shininess,1e-4),t.emissiveMap&&(e.emissiveMap.value=t.emissiveMap),t.bumpMap&&(e.bumpMap.value=t.bumpMap,e.bumpScale.value=t.bumpScale,1===t.side&&(e.bumpScale.value*=-1)),t.normalMap&&(e.normalMap.value=t.normalMap,e.normalScale.value.copy(t.normalScale),1===t.side&&e.normalScale.value.negate()),t.displacementMap&&(e.displacementMap.value=t.displacementMap,e.displacementScale.value=t.displacementScale,e.displacementBias.value=t.displacementBias)}(e,r)):r.isMeshStandardMaterial?(t(e,r),r.isMeshPhysicalMaterial?function(e,t,r){n(e,t),e.reflectivity.value=t.reflectivity,e.clearcoat.value=t.clearcoat,e.clearcoatRoughness.value=t.clearcoatRoughness,t.sheen&&e.sheen.value.copy(t.sheen),t.clearcoatMap&&(e.clearcoatMap.value=t.clearcoatMap),t.clearcoatRoughnessMap&&(e.clearcoatRoughnessMap.value=t.clearcoatRoughnessMap),t.clearcoatNormalMap&&(e.clearcoatNormalScale.value.copy(t.clearcoatNormalScale),e.clearcoatNormalMap.value=t.clearcoatNormalMap,1===t.side&&e.clearcoatNormalScale.value.negate()),e.transmission.value=t.transmission,t.transmissionMap&&(e.transmissionMap.value=t.transmissionMap),t.transmission>0&&(e.transmissionSamplerMap.value=r.texture,e.transmissionSamplerSize.value.set(r.width,r.height)),e.thickness.value=t.thickness,t.thicknessMap&&(e.thicknessMap.value=t.thicknessMap),e.attenuationDistance.value=t.attenuationDistance,e.attenuationTint.value.copy(t.attenuationTint),e.specularIntensity.value=t.specularIntensity,e.specularTint.value.copy(t.specularTint),t.specularIntensityMap&&(e.specularIntensityMap.value=t.specularIntensityMap),t.specularTintMap&&(e.specularTintMap.value=t.specularTintMap)}(e,r,o):n(e,r)):r.isMeshMatcapMaterial?(t(e,r),function(e,t){t.matcap&&(e.matcap.value=t.matcap),t.bumpMap&&(e.bumpMap.value=t.bumpMap,e.bumpScale.value=t.bumpScale,1===t.side&&(e.bumpScale.value*=-1)),t.normalMap&&(e.normalMap.value=t.normalMap,e.normalScale.value.copy(t.normalScale),1===t.side&&e.normalScale.value.negate()),t.displacementMap&&(e.displacementMap.value=t.displacementMap,e.displacementScale.value=t.displacementScale,e.displacementBias.value=t.displacementBias)}(e,r)):r.isMeshDepthMaterial?(t(e,r),function(e,t){t.displacementMap&&(e.displacementMap.value=t.displacementMap,e.displacementScale.value=t.displacementScale,e.displacementBias.value=t.displacementBias)}(e,r)):r.isMeshDistanceMaterial?(t(e,r),function(e,t){t.displacementMap&&(e.displacementMap.value=t.displacementMap,e.displacementScale.value=t.displacementScale,e.displacementBias.value=t.displacementBias),e.referencePosition.value.copy(t.referencePosition),e.nearDistance.value=t.nearDistance,e.farDistance.value=t.farDistance}(e,r)):r.isMeshNormalMaterial?(t(e,r),function(e,t){t.bumpMap&&(e.bumpMap.value=t.bumpMap,e.bumpScale.value=t.bumpScale,1===t.side&&(e.bumpScale.value*=-1)),t.normalMap&&(e.normalMap.value=t.normalMap,e.normalScale.value.copy(t.normalScale),1===t.side&&e.normalScale.value.negate()),t.displacementMap&&(e.displacementMap.value=t.displacementMap,e.displacementScale.value=t.displacementScale,e.displacementBias.value=t.displacementBias)}(e,r)):r.isLineBasicMaterial?(function(e,t){e.diffuse.value.copy(t.color),e.opacity.value=t.opacity}(e,r),r.isLineDashedMaterial&&function(e,t){e.dashSize.value=t.dashSize,e.totalSize.value=t.dashSize+t.gapSize,e.scale.value=t.scale}(e,r)):r.isPointsMaterial?function(e,t,n,r){var i;e.diffuse.value.copy(t.color),e.opacity.value=t.opacity,e.size.value=t.size*n,e.scale.value=.5*r,t.map&&(e.map.value=t.map),t.alphaMap&&(e.alphaMap.value=t.alphaMap),t.map?i=t.map:t.alphaMap&&(i=t.alphaMap),void 0!==i&&(!0===i.matrixAutoUpdate&&i.updateMatrix(),e.uvTransform.value.copy(i.matrix))}(e,r,i,a):r.isSpriteMaterial?function(e,t){var n;e.diffuse.value.copy(t.color),e.opacity.value=t.opacity,e.rotation.value=t.rotation,t.map&&(e.map.value=t.map),t.alphaMap&&(e.alphaMap.value=t.alphaMap),t.map?n=t.map:t.alphaMap&&(n=t.alphaMap),void 0!==n&&(!0===n.matrixAutoUpdate&&n.updateMatrix(),e.uvTransform.value.copy(n.matrix))}(e,r):r.isShadowMaterial?(e.color.value.copy(r.color),e.opacity.value=r.opacity):r.isShaderMaterial&&(r.uniformsNeedUpdate=!1)}}}function ho(){var e=document.createElementNS("http://www.w3.org/1999/xhtml","canvas");return e.style.display="block",e}function fo(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=void 0!==e.canvas?e.canvas:ho(),n=void 0!==e.context?e.context:null,r=void 0!==e.alpha&&e.alpha,i=void 0===e.depth||e.depth,a=void 0===e.stencil||e.stencil,o=void 0!==e.antialias&&e.antialias,s=void 0===e.premultipliedAlpha||e.premultipliedAlpha,l=void 0!==e.preserveDrawingBuffer&&e.preserveDrawingBuffer,u=void 0!==e.powerPreference?e.powerPreference:"default",c=void 0!==e.failIfMajorPerformanceCaveat&&e.failIfMajorPerformanceCaveat,h=null,d=null,f=[],p=[];this.domElement=t,this.debug={checkShaderErrors:!0},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.gammaFactor=2,this.outputEncoding=ue,this.physicallyCorrectLights=!1,this.toneMapping=0,this.toneMappingExposure=1;var v=this,m=!1,g=0,_=0,y=null,x=-1,b=null,w=new He,T=new He,M=null,S=t.width,A=t.height,C=1,R=null,k=null,P=new He(0,0,S,A),O=new He(0,0,S,A),F=!1,B=[],z=new Tr,G=!1,V=!1,W=null,j=new Tt,q=new qe,X={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};function Y(){return null===y?C:1}var K,Z,J,Q,$,ee,te,ne,re,ie,ae,oe,se,le,ce,he,de,fe,pe,ve,me,ge,_e,ye=n;function xe(e,n){for(var r=0;r<e.length;r++){var i=e[r],a=t.getContext(i,n);if(null!==a)return a}return null}try{var be={alpha:r,depth:i,stencil:a,antialias:o,premultipliedAlpha:s,preserveDrawingBuffer:l,powerPreference:u,failIfMajorPerformanceCaveat:c};if(t.addEventListener("webglcontextlost",Se,!1),t.addEventListener("webglcontextrestored",Ee,!1),null===ye){var we=["webgl2","webgl","experimental-webgl"];if(!0===v.isWebGL1Renderer&&we.shift(),null===(ye=xe(we,be)))throw xe(we)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}void 0===ye.getShaderPrecisionFormat&&(ye.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(e){throw console.error("THREE.WebGLRenderer: "+e.message),e}function Te(){K=new ci(ye),Z=new Dr(ye,K,e),K.init(Z),ge=new io(ye,K,Z),J=new no(ye,K,Z),B[0]=ye.BACK,Q=new fi(ye),$=new Ga,ee=new ro(ye,K,J,$,Z,ge,Q),te=new Or(v),ne=new ui(v),re=new Sr(ye,Z),_e=new kr(ye,K,re,Z),ie=new hi(ye,re,Q,_e),ae=new gi(ye,ie,re,Q),pe=new mi(ye),he=new Ir($),oe=new Ha(v,te,ne,K,Z,_e,he),se=new co($),le=new qa($),ce=new Qa(K,Z),fe=new Rr(v,te,J,ae,s),de=new to(v,ae,Z),ve=new Pr(ye,K,Q,Z),me=new di(ye,K,Q,Z),Q.programs=oe.programs,v.capabilities=Z,v.extensions=K,v.properties=$,v.renderLists=le,v.shadowMap=de,v.state=J,v.info=Q}Te();var Me=new uo(v,ye);function Se(e){e.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),m=!0}function Ee(){console.log("THREE.WebGLRenderer: Context Restored."),m=!1;var e=Q.autoReset,t=de.enabled,n=de.autoUpdate,r=de.needsUpdate,i=de.type;Te(),Q.autoReset=e,de.enabled=t,de.autoUpdate=n,de.needsUpdate=r,de.type=i}function Ae(e){var t=e.target;t.removeEventListener("dispose",Ae),Le(t)}function Le(e){Ce(e),$.remove(e)}function Ce(e){var t=$.get(e).programs;void 0!==t&&t.forEach((function(e){oe.releaseProgram(e)}))}function Re(e,t){e.render((function(e){v.renderBufferImmediate(e,t)}))}this.xr=Me,this.getContext=function(){return ye},this.getContextAttributes=function(){return ye.getContextAttributes()},this.forceContextLoss=function(){var e=K.get("WEBGL_lose_context");e&&e.loseContext()},this.forceContextRestore=function(){var e=K.get("WEBGL_lose_context");e&&e.restoreContext()},this.getPixelRatio=function(){return C},this.setPixelRatio=function(e){void 0!==e&&(C=e,this.setSize(S,A,!1))},this.getSize=function(e){return e.set(S,A)},this.setSize=function(e,n,r){Me.isPresenting?console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting."):(S=e,A=n,t.width=Math.floor(e*C),t.height=Math.floor(n*C),!1!==r&&(t.style.width=e+"px",t.style.height=n+"px"),this.setViewport(0,0,e,n))},this.getDrawingBufferSize=function(e){return e.set(S*C,A*C).floor()},this.setDrawingBufferSize=function(e,n,r){S=e,A=n,C=r,t.width=Math.floor(e*r),t.height=Math.floor(n*r),this.setViewport(0,0,e,n)},this.getCurrentViewport=function(e){return e.copy(w)},this.getViewport=function(e){return e.copy(P)},this.setViewport=function(e,t,n,r){e.isVector4?P.set(e.x,e.y,e.z,e.w):P.set(e,t,n,r),J.viewport(w.copy(P).multiplyScalar(C).floor())},this.getScissor=function(e){return e.copy(O)},this.setScissor=function(e,t,n,r){e.isVector4?O.set(e.x,e.y,e.z,e.w):O.set(e,t,n,r),J.scissor(T.copy(O).multiplyScalar(C).floor())},this.getScissorTest=function(){return F},this.setScissorTest=function(e){J.setScissorTest(F=e)},this.setOpaqueSort=function(e){R=e},this.setTransparentSort=function(e){k=e},this.getClearColor=function(e){return e.copy(fe.getClearColor())},this.setClearColor=function(){fe.setClearColor.apply(fe,arguments)},this.getClearAlpha=function(){return fe.getClearAlpha()},this.setClearAlpha=function(){fe.setClearAlpha.apply(fe,arguments)},this.clear=function(e,t,n){var r=0;(void 0===e||e)&&(r|=ye.COLOR_BUFFER_BIT),(void 0===t||t)&&(r|=ye.DEPTH_BUFFER_BIT),(void 0===n||n)&&(r|=ye.STENCIL_BUFFER_BIT),ye.clear(r)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){t.removeEventListener("webglcontextlost",Se,!1),t.removeEventListener("webglcontextrestored",Ee,!1),le.dispose(),ce.dispose(),$.dispose(),te.dispose(),ne.dispose(),ae.dispose(),_e.dispose(),Me.dispose(),Me.removeEventListener("sessionstart",De),Me.removeEventListener("sessionend",Ie),W&&(W.dispose(),W=null),Oe.stop()},this.renderBufferImmediate=function(e,t){_e.initAttributes();var n=$.get(e);e.hasPositions&&!n.position&&(n.position=ye.createBuffer()),e.hasNormals&&!n.normal&&(n.normal=ye.createBuffer()),e.hasUvs&&!n.uv&&(n.uv=ye.createBuffer()),e.hasColors&&!n.color&&(n.color=ye.createBuffer());var r=t.getAttributes();e.hasPositions&&(ye.bindBuffer(ye.ARRAY_BUFFER,n.position),ye.bufferData(ye.ARRAY_BUFFER,e.positionArray,ye.DYNAMIC_DRAW),_e.enableAttribute(r.position),ye.vertexAttribPointer(r.position,3,ye.FLOAT,!1,0,0)),e.hasNormals&&(ye.bindBuffer(ye.ARRAY_BUFFER,n.normal),ye.bufferData(ye.ARRAY_BUFFER,e.normalArray,ye.DYNAMIC_DRAW),_e.enableAttribute(r.normal),ye.vertexAttribPointer(r.normal,3,ye.FLOAT,!1,0,0)),e.hasUvs&&(ye.bindBuffer(ye.ARRAY_BUFFER,n.uv),ye.bufferData(ye.ARRAY_BUFFER,e.uvArray,ye.DYNAMIC_DRAW),_e.enableAttribute(r.uv),ye.vertexAttribPointer(r.uv,2,ye.FLOAT,!1,0,0)),e.hasColors&&(ye.bindBuffer(ye.ARRAY_BUFFER,n.color),ye.bufferData(ye.ARRAY_BUFFER,e.colorArray,ye.DYNAMIC_DRAW),_e.enableAttribute(r.color),ye.vertexAttribPointer(r.color,3,ye.FLOAT,!1,0,0)),_e.disableUnusedAttributes(),ye.drawArrays(ye.TRIANGLES,0,e.count),e.count=0},this.renderBufferDirect=function(e,t,n,r,i,a){null===t&&(t=X);var o=i.isMesh&&i.matrixWorld.determinant()<0,s=je(e,t,r,i);J.setMaterial(r,o);var l=n.index,u=n.attributes.position;if(null===l){if(void 0===u||0===u.count)return}else if(0===l.count)return;var c,h=1;!0===r.wireframe&&(l=ie.getWireframeAttribute(n),h=2),void 0===n.morphAttributes.position&&void 0===n.morphAttributes.normal||pe.update(i,n,r,s),_e.setup(i,r,s,n,l);var d=ve;null!==l&&(c=re.get(l),(d=me).setIndex(c));var f=null!==l?l.count:u.count,p=n.drawRange.start*h,v=n.drawRange.count*h,m=null!==a?a.start*h:0,g=null!==a?a.count*h:1/0,_=Math.max(p,m),y=Math.min(f,p+v,m+g)-1,x=Math.max(0,y-_+1);if(0!==x){if(i.isMesh)!0===r.wireframe?(J.setLineWidth(r.wireframeLinewidth*Y()),d.setMode(ye.LINES)):d.setMode(ye.TRIANGLES);else if(i.isLine){var b=r.linewidth;void 0===b&&(b=1),J.setLineWidth(b*Y()),i.isLineSegments?d.setMode(ye.LINES):i.isLineLoop?d.setMode(ye.LINE_LOOP):d.setMode(ye.LINE_STRIP)}else i.isPoints?d.setMode(ye.POINTS):i.isSprite&&d.setMode(ye.TRIANGLES);if(i.isInstancedMesh)d.renderInstances(_,x,i.count);else if(n.isInstancedBufferGeometry){var w=Math.min(n.instanceCount,n._maxInstanceCount);d.renderInstances(_,x,w)}else d.render(_,x)}},this.compile=function(e,t){(d=ce.get(e)).init(),p.push(d),e.traverseVisible((function(e){e.isLight&&e.layers.test(t.layers)&&(d.pushLight(e),e.castShadow&&d.pushShadow(e))})),d.setupLights(),e.traverse((function(t){var n=t.material;if(n)if(Array.isArray(n))for(var r=0;r<n.length;r++)ze(n[r],e,t);else ze(n,e,t)})),p.pop(),d=null};var ke=null;function Pe(e){ke&&ke(e)}function De(){Oe.stop()}function Ie(){Oe.start()}var Oe=new Mr;function Fe(e,t,n,r){if(!1!==e.visible){if(e.layers.test(t.layers))if(e.isGroup)n=e.renderOrder;else if(e.isLOD)!0===e.autoUpdate&&e.update(t);else if(e.isLight)d.pushLight(e),e.castShadow&&d.pushShadow(e);else if(e.isSprite){if(!e.frustumCulled||z.intersectsSprite(e)){r&&q.setFromMatrixPosition(e.matrixWorld).applyMatrix4(j);var i=ae.update(e),a=e.material;a.visible&&h.push(e,i,a,n,q.z,null)}}else if(e.isImmediateRenderObject)r&&q.setFromMatrixPosition(e.matrixWorld).applyMatrix4(j),h.push(e,null,e.material,n,q.z,null);else if((e.isMesh||e.isLine||e.isPoints)&&(e.isSkinnedMesh&&e.skeleton.frame!==Q.render.frame&&(e.skeleton.update(),e.skeleton.frame=Q.render.frame),!e.frustumCulled||z.intersectsObject(e))){r&&q.setFromMatrixPosition(e.matrixWorld).applyMatrix4(j);var o=ae.update(e),s=e.material;if(Array.isArray(s))for(var l=o.groups,u=0,c=l.length;u<c;u++){var f=l[u],p=s[f.materialIndex];p&&p.visible&&h.push(e,o,p,n,q.z,f)}else s.visible&&h.push(e,o,s,n,q.z,null)}for(var v=e.children,m=0,g=v.length;m<g;m++)Fe(v[m],t,n,r)}}function Ne(e,t,n,r){if(null===W){var i=!0===o&&!0===Z.isWebGL2;W=new(i?We:Ge)(1024,1024,{generateMipmaps:!0,type:null!==ge.convert(U)?U:I,minFilter:D,magFilter:L,wrapS:E,wrapT:E})}var a=v.getRenderTarget();v.setRenderTarget(W),v.clear();var s=v.toneMapping;v.toneMapping=0,Ue(e,n,r),v.toneMapping=s,ee.updateMultisampleRenderTarget(W),ee.updateRenderTargetMipmap(W),v.setRenderTarget(a),Ue(t,n,r)}function Ue(e,t,n){var r=!0===t.isScene?t.overrideMaterial:null;if(n.isArrayCamera)for(var i=n.cameras,a=0,o=i.length;a<o;a++){var s=i[a];J.viewport(w.copy(s.viewport)),d.setupLightsView(s);for(var l=0,u=e.length;l<u;l++){var c=e[l],h=c.object,f=c.geometry,p=null===r?c.material:r,v=c.group;h.layers.test(s.layers)&&Be(h,t,s,f,p,v)}}else for(var m=0,g=e.length;m<g;m++){var _=e[m];Be(_.object,t,n,_.geometry,null===r?_.material:r,_.group)}}function Be(e,t,n,r,i,a){if(e.onBeforeRender(v,t,n,r,i,a),e.modelViewMatrix.multiplyMatrices(n.matrixWorldInverse,e.matrixWorld),e.normalMatrix.getNormalMatrix(e.modelViewMatrix),e.isImmediateRenderObject){var o=je(n,t,i,e);J.setMaterial(i),_e.reset(),Re(e,o)}else!0===i.transparent&&2===i.side?(i.side=1,i.needsUpdate=!0,v.renderBufferDirect(n,t,r,i,e,a),i.side=0,i.needsUpdate=!0,v.renderBufferDirect(n,t,r,i,e,a),i.side=2):v.renderBufferDirect(n,t,r,i,e,a);e.onAfterRender(v,t,n,r,i,a)}function ze(e,t,n){!0!==t.isScene&&(t=X);var r=$.get(e),i=d.state.lights,a=d.state.shadowsArray,o=i.state.version,s=oe.getParameters(e,i.state,a,t,n),l=oe.getProgramCacheKey(s),u=r.programs;r.environment=e.isMeshStandardMaterial?t.environment:null,r.fog=t.fog,r.envMap=(e.isMeshStandardMaterial?ne:te).get(e.envMap||r.environment),void 0===u&&(e.addEventListener("dispose",Ae),u=new Map,r.programs=u);var c=u.get(l);if(void 0!==c){if(r.currentProgram===c&&r.lightsStateVersion===o)return Ve(e,s),c}else s.uniforms=oe.getUniforms(e),e.onBuild(s,v),e.onBeforeCompile(s,v),c=oe.acquireProgram(s,l),u.set(l,c),r.uniforms=s.uniforms;var h=r.uniforms;(e.isShaderMaterial||e.isRawShaderMaterial)&&!0!==e.clipping||(h.clippingPlanes=he.uniform),Ve(e,s),r.needsLights=Ye(e),r.lightsStateVersion=o,r.needsLights&&(h.ambientLightColor.value=i.state.ambient,h.lightProbe.value=i.state.probe,h.directionalLights.value=i.state.directional,h.directionalLightShadows.value=i.state.directionalShadow,h.spotLights.value=i.state.spot,h.spotLightShadows.value=i.state.spotShadow,h.rectAreaLights.value=i.state.rectArea,h.ltc_1.value=i.state.rectAreaLTC1,h.ltc_2.value=i.state.rectAreaLTC2,h.pointLights.value=i.state.point,h.pointLightShadows.value=i.state.pointShadow,h.hemisphereLights.value=i.state.hemi,h.directionalShadowMap.value=i.state.directionalShadowMap,h.directionalShadowMatrix.value=i.state.directionalShadowMatrix,h.spotShadowMap.value=i.state.spotShadowMap,h.spotShadowMatrix.value=i.state.spotShadowMatrix,h.pointShadowMap.value=i.state.pointShadowMap,h.pointShadowMatrix.value=i.state.pointShadowMatrix);var f=c.getUniforms(),p=ba.seqWithValue(f.seq,h);return r.currentProgram=c,r.uniformsList=p,c}function Ve(e,t){var n=$.get(e);n.outputEncoding=t.outputEncoding,n.instancing=t.instancing,n.skinning=t.skinning,n.morphTargets=t.morphTargets,n.morphNormals=t.morphNormals,n.numClippingPlanes=t.numClippingPlanes,n.numIntersection=t.numClipIntersection,n.vertexAlphas=t.vertexAlphas,n.vertexTangents=t.vertexTangents}function je(e,t,n,r){!0!==t.isScene&&(t=X),ee.resetTextureUnits();var i=t.fog,a=n.isMeshStandardMaterial?t.environment:null,o=null===y?v.outputEncoding:y.texture.encoding,s=(n.isMeshStandardMaterial?ne:te).get(n.envMap||a),l=!0===n.vertexColors&&!!r.geometry&&!!r.geometry.attributes.color&&4===r.geometry.attributes.color.itemSize,u=!!r.geometry&&!!r.geometry.attributes.tangent,c=!!r.geometry&&!!r.geometry.morphAttributes.position,h=!!r.geometry&&!!r.geometry.morphAttributes.normal,f=$.get(n),p=d.state.lights;if(!0===G&&(!0===V||e!==b)){var m=e===b&&n.id===x;he.setState(n,e,m)}var g=!1;n.version===f.__version?f.needsLights&&f.lightsStateVersion!==p.state.version||f.outputEncoding!==o||r.isInstancedMesh&&!1===f.instancing?g=!0:r.isInstancedMesh||!0!==f.instancing?r.isSkinnedMesh&&!1===f.skinning?g=!0:r.isSkinnedMesh||!0!==f.skinning?f.envMap!==s||n.fog&&f.fog!==i?g=!0:void 0===f.numClippingPlanes||f.numClippingPlanes===he.numPlanes&&f.numIntersection===he.numIntersection?(f.vertexAlphas!==l||f.vertexTangents!==u||f.morphTargets!==c||f.morphNormals!==h)&&(g=!0):g=!0:g=!0:g=!0:(g=!0,f.__version=n.version);var _=f.currentProgram;!0===g&&(_=ze(n,t,r));var w=!1,T=!1,M=!1,S=_.getUniforms(),E=f.uniforms;if(J.useProgram(_.program)&&(w=!0,T=!0,M=!0),n.id!==x&&(x=n.id,T=!0),w||b!==e){if(S.setValue(ye,"projectionMatrix",e.projectionMatrix),Z.logarithmicDepthBuffer&&S.setValue(ye,"logDepthBufFC",2/(Math.log(e.far+1)/Math.LN2)),b!==e&&(b=e,T=!0,M=!0),n.isShaderMaterial||n.isMeshPhongMaterial||n.isMeshToonMaterial||n.isMeshStandardMaterial||n.envMap){var L=S.map.cameraPosition;void 0!==L&&L.setValue(ye,q.setFromMatrixPosition(e.matrixWorld))}(n.isMeshPhongMaterial||n.isMeshToonMaterial||n.isMeshLambertMaterial||n.isMeshBasicMaterial||n.isMeshStandardMaterial||n.isShaderMaterial)&&S.setValue(ye,"isOrthographic",!0===e.isOrthographicCamera),(n.isMeshPhongMaterial||n.isMeshToonMaterial||n.isMeshLambertMaterial||n.isMeshBasicMaterial||n.isMeshStandardMaterial||n.isShaderMaterial||n.isShadowMaterial||r.isSkinnedMesh)&&S.setValue(ye,"viewMatrix",e.matrixWorldInverse)}if(r.isSkinnedMesh){S.setOptional(ye,r,"bindMatrix"),S.setOptional(ye,r,"bindMatrixInverse");var R=r.skeleton;R&&(Z.floatVertexTextures?(null===R.boneTexture&&R.computeBoneTexture(),S.setValue(ye,"boneTexture",R.boneTexture,ee),S.setValue(ye,"boneTextureSize",R.boneTextureSize)):S.setOptional(ye,R,"boneMatrices"))}return(T||f.receiveShadow!==r.receiveShadow)&&(f.receiveShadow=r.receiveShadow,S.setValue(ye,"receiveShadow",r.receiveShadow)),T&&(S.setValue(ye,"toneMappingExposure",v.toneMappingExposure),f.needsLights&&Xe(E,M),i&&n.fog&&se.refreshFogUniforms(E,i),se.refreshMaterialUniforms(E,n,C,A,W),ba.upload(ye,f.uniformsList,E,ee)),n.isShaderMaterial&&!0===n.uniformsNeedUpdate&&(ba.upload(ye,f.uniformsList,E,ee),n.uniformsNeedUpdate=!1),n.isSpriteMaterial&&S.setValue(ye,"center",r.center),S.setValue(ye,"modelViewMatrix",r.modelViewMatrix),S.setValue(ye,"normalMatrix",r.normalMatrix),S.setValue(ye,"modelMatrix",r.matrixWorld),_}function Xe(e,t){e.ambientLightColor.needsUpdate=t,e.lightProbe.needsUpdate=t,e.directionalLights.needsUpdate=t,e.directionalLightShadows.needsUpdate=t,e.pointLights.needsUpdate=t,e.pointLightShadows.needsUpdate=t,e.spotLights.needsUpdate=t,e.spotLightShadows.needsUpdate=t,e.rectAreaLights.needsUpdate=t,e.hemisphereLights.needsUpdate=t}function Ye(e){return e.isMeshLambertMaterial||e.isMeshToonMaterial||e.isMeshPhongMaterial||e.isMeshStandardMaterial||e.isShadowMaterial||e.isShaderMaterial&&!0===e.lights}Oe.setAnimationLoop(Pe),"undefined"!=typeof window&&Oe.setContext(window),this.setAnimationLoop=function(e){ke=e,Me.setAnimationLoop(e),null===e?Oe.stop():Oe.start()},Me.addEventListener("sessionstart",De),Me.addEventListener("sessionend",Ie),this.render=function(e,t){if(void 0===t||!0===t.isCamera){if(!0!==m){!0===e.autoUpdate&&e.updateMatrixWorld(),null===t.parent&&t.updateMatrixWorld(),!0===Me.enabled&&!0===Me.isPresenting&&(!0===Me.cameraAutoUpdate&&Me.updateCamera(t),t=Me.getCamera()),!0===e.isScene&&e.onBeforeRender(v,e,t,y),(d=ce.get(e,p.length)).init(),p.push(d),j.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),z.setFromProjectionMatrix(j),V=this.localClippingEnabled,G=he.init(this.clippingPlanes,V,t),(h=le.get(e,f.length)).init(),f.push(h),Fe(e,t,0,v.sortObjects),h.finish(),!0===v.sortObjects&&h.sort(R,k),!0===G&&he.beginShadows();var n=d.state.shadowsArray;de.render(n,e,t),d.setupLights(),d.setupLightsView(t),!0===G&&he.endShadows(),!0===this.info.autoReset&&this.info.reset(),fe.render(h,e);var r=h.opaque,i=h.transmissive,a=h.transparent;r.length>0&&Ue(r,e,t),i.length>0&&Ne(r,i,e,t),a.length>0&&Ue(a,e,t),null!==y&&(ee.updateMultisampleRenderTarget(y),ee.updateRenderTargetMipmap(y)),!0===e.isScene&&e.onAfterRender(v,e,t),J.buffers.depth.setTest(!0),J.buffers.depth.setMask(!0),J.buffers.color.setMask(!0),J.setPolygonOffset(!1),_e.resetDefaultState(),x=-1,b=null,p.pop(),d=p.length>0?p[p.length-1]:null,f.pop(),h=f.length>0?f[f.length-1]:null}}else console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.")},this.getActiveCubeFace=function(){return g},this.getActiveMipmapLevel=function(){return _},this.getRenderTarget=function(){return y},this.setRenderTarget=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;y=e,g=t,_=n,e&&void 0===$.get(e).__webglFramebuffer&&ee.setupRenderTarget(e);var r=null,i=!1,a=!1;if(e){var o=e.texture;(o.isDataTexture3D||o.isDataTexture2DArray)&&(a=!0);var s=$.get(e).__webglFramebuffer;e.isWebGLCubeRenderTarget?(r=s[t],i=!0):r=e.isWebGLMultisampleRenderTarget?$.get(e).__webglMultisampledFramebuffer:s,w.copy(e.viewport),T.copy(e.scissor),M=e.scissorTest}else w.copy(P).multiplyScalar(C).floor(),T.copy(O).multiplyScalar(C).floor(),M=F;var l=J.bindFramebuffer(ye.FRAMEBUFFER,r);if(l&&Z.drawBuffers){var u=!1;if(e)if(e.isWebGLMultipleRenderTargets){var c=e.texture;if(B.length!==c.length||B[0]!==ye.COLOR_ATTACHMENT0){for(var h=0,d=c.length;h<d;h++)B[h]=ye.COLOR_ATTACHMENT0+h;B.length=c.length,u=!0}}else 1===B.length&&B[0]===ye.COLOR_ATTACHMENT0||(B[0]=ye.COLOR_ATTACHMENT0,B.length=1,u=!0);else 1===B.length&&B[0]===ye.BACK||(B[0]=ye.BACK,B.length=1,u=!0);u&&(Z.isWebGL2?ye.drawBuffers(B):K.get("WEBGL_draw_buffers").drawBuffersWEBGL(B))}if(J.viewport(w),J.scissor(T),J.setScissorTest(M),i){var f=$.get(e.texture);ye.framebufferTexture2D(ye.FRAMEBUFFER,ye.COLOR_ATTACHMENT0,ye.TEXTURE_CUBE_MAP_POSITIVE_X+t,f.__webglTexture,n)}else if(a){var p=$.get(e.texture),v=t||0;ye.framebufferTextureLayer(ye.FRAMEBUFFER,ye.COLOR_ATTACHMENT0,p.__webglTexture,n||0,v)}},this.readRenderTargetPixels=function(e,t,n,r,i,a,o){if(e&&e.isWebGLRenderTarget){var s=$.get(e).__webglFramebuffer;if(e.isWebGLCubeRenderTarget&&void 0!==o&&(s=s[o]),s){J.bindFramebuffer(ye.FRAMEBUFFER,s);try{var l=e.texture,u=l.format,c=l.type;if(u!==H&&ge.convert(u)!==ye.getParameter(ye.IMPLEMENTATION_COLOR_READ_FORMAT))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");var h=c===U&&(K.has("EXT_color_buffer_half_float")||Z.isWebGL2&&K.has("EXT_color_buffer_float"));if(!(c===I||ge.convert(c)===ye.getParameter(ye.IMPLEMENTATION_COLOR_READ_TYPE)||c===N&&(Z.isWebGL2||K.has("OES_texture_float")||K.has("WEBGL_color_buffer_float"))||h))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");ye.checkFramebufferStatus(ye.FRAMEBUFFER)===ye.FRAMEBUFFER_COMPLETE?t>=0&&t<=e.width-r&&n>=0&&n<=e.height-i&&ye.readPixels(t,n,r,i,ge.convert(u),ge.convert(c),a):console.error("THREE.WebGLRenderer.readRenderTargetPixels: readPixels from renderTarget failed. Framebuffer not complete.")}finally{var d=null!==y?$.get(y).__webglFramebuffer:null;J.bindFramebuffer(ye.FRAMEBUFFER,d)}}}else console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.")},this.copyFramebufferToTexture=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=Math.pow(2,-n),i=Math.floor(t.image.width*r),a=Math.floor(t.image.height*r),o=ge.convert(t.format);Z.isWebGL2&&(o===ye.RGB&&(o=ye.RGB8),o===ye.RGBA&&(o=ye.RGBA8)),ee.setTexture2D(t,0),ye.copyTexImage2D(ye.TEXTURE_2D,n,o,e.x,e.y,i,a,0),J.unbindTexture()},this.copyTextureToTexture=function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,i=t.image.width,a=t.image.height,o=ge.convert(n.format),s=ge.convert(n.type);ee.setTexture2D(n,0),ye.pixelStorei(ye.UNPACK_FLIP_Y_WEBGL,n.flipY),ye.pixelStorei(ye.UNPACK_PREMULTIPLY_ALPHA_WEBGL,n.premultiplyAlpha),ye.pixelStorei(ye.UNPACK_ALIGNMENT,n.unpackAlignment),t.isDataTexture?ye.texSubImage2D(ye.TEXTURE_2D,r,e.x,e.y,i,a,o,s,t.image.data):t.isCompressedTexture?ye.compressedTexSubImage2D(ye.TEXTURE_2D,r,e.x,e.y,t.mipmaps[0].width,t.mipmaps[0].height,o,t.mipmaps[0].data):ye.texSubImage2D(ye.TEXTURE_2D,r,e.x,e.y,o,s,t.image),0===r&&n.generateMipmaps&&ye.generateMipmap(ye.TEXTURE_2D),J.unbindTexture()},this.copyTextureToTexture3D=function(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;if(v.isWebGL1Renderer)console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: can only be used with WebGL2.");else{var a,o=e.max.x-e.min.x+1,s=e.max.y-e.min.y+1,l=e.max.z-e.min.z+1,u=ge.convert(r.format),c=ge.convert(r.type);if(r.isDataTexture3D)ee.setTexture3D(r,0),a=ye.TEXTURE_3D;else{if(!r.isDataTexture2DArray)return void console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: only supports THREE.DataTexture3D and THREE.DataTexture2DArray.");ee.setTexture2DArray(r,0),a=ye.TEXTURE_2D_ARRAY}ye.pixelStorei(ye.UNPACK_FLIP_Y_WEBGL,r.flipY),ye.pixelStorei(ye.UNPACK_PREMULTIPLY_ALPHA_WEBGL,r.premultiplyAlpha),ye.pixelStorei(ye.UNPACK_ALIGNMENT,r.unpackAlignment);var h=ye.getParameter(ye.UNPACK_ROW_LENGTH),d=ye.getParameter(ye.UNPACK_IMAGE_HEIGHT),f=ye.getParameter(ye.UNPACK_SKIP_PIXELS),p=ye.getParameter(ye.UNPACK_SKIP_ROWS),m=ye.getParameter(ye.UNPACK_SKIP_IMAGES),g=n.isCompressedTexture?n.mipmaps[0]:n.image;ye.pixelStorei(ye.UNPACK_ROW_LENGTH,g.width),ye.pixelStorei(ye.UNPACK_IMAGE_HEIGHT,g.height),ye.pixelStorei(ye.UNPACK_SKIP_PIXELS,e.min.x),ye.pixelStorei(ye.UNPACK_SKIP_ROWS,e.min.y),ye.pixelStorei(ye.UNPACK_SKIP_IMAGES,e.min.z),n.isDataTexture||n.isDataTexture3D?ye.texSubImage3D(a,i,t.x,t.y,t.z,o,s,l,u,c,g.data):n.isCompressedTexture?(console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: untested support for compressed srcTexture."),ye.compressedTexSubImage3D(a,i,t.x,t.y,t.z,o,s,l,u,g.data)):ye.texSubImage3D(a,i,t.x,t.y,t.z,o,s,l,u,c,g),ye.pixelStorei(ye.UNPACK_ROW_LENGTH,h),ye.pixelStorei(ye.UNPACK_IMAGE_HEIGHT,d),ye.pixelStorei(ye.UNPACK_SKIP_PIXELS,f),ye.pixelStorei(ye.UNPACK_SKIP_ROWS,p),ye.pixelStorei(ye.UNPACK_SKIP_IMAGES,m),0===i&&r.generateMipmaps&&ye.generateMipmap(a),J.unbindTexture()}},this.initTexture=function(e){ee.setTexture2D(e,0),J.unbindTexture()},this.resetState=function(){g=0,_=0,y=null,J.reset(),_e.reset()},"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}var po=function(e){(0,d.default)(n,e);var t=b(n);function n(){return(0,v.default)(this,n),t.apply(this,arguments)}return(0,m.default)(n)}(fo);po.prototype.isWebGL1Renderer=!0;var vo=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:25e-5;(0,v.default)(this,e),this.name="",this.color=new vn(t),this.density=n}return(0,m.default)(e,[{key:"clone",value:function(){return new e(this.color,this.density)}},{key:"toJSON",value:function(){return{type:"FogExp2",color:this.color.getHex(),density:this.density}}}]),e}();vo.prototype.isFogExp2=!0;var mo=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e3;(0,v.default)(this,e),this.name="",this.color=new vn(t),this.near=n,this.far=r}return(0,m.default)(e,[{key:"clone",value:function(){return new e(this.color,this.near,this.far)}},{key:"toJSON",value:function(){return{type:"Fog",color:this.color.getHex(),near:this.near,far:this.far}}}]),e}();mo.prototype.isFog=!0;var go=function(e){(0,d.default)(n,e);var t=b(n);function n(){var e;return(0,v.default)(this,n),(e=t.call(this)).type="Scene",e.background=null,e.environment=null,e.fog=null,e.overrideMaterial=null,e.autoUpdate=!0,"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:(0,h.default)(e)})),e}return(0,m.default)(n,[{key:"copy",value:function(e,t){return(0,u.default)((0,p.default)(n.prototype),"copy",this).call(this,e,t),null!==e.background&&(this.background=e.background.clone()),null!==e.environment&&(this.environment=e.environment.clone()),null!==e.fog&&(this.fog=e.fog.clone()),null!==e.overrideMaterial&&(this.overrideMaterial=e.overrideMaterial.clone()),this.autoUpdate=e.autoUpdate,this.matrixAutoUpdate=e.matrixAutoUpdate,this}},{key:"toJSON",value:function(e){var t=(0,u.default)((0,p.default)(n.prototype),"toJSON",this).call(this,e);return null!==this.fog&&(t.object.fog=this.fog.toJSON()),t}}]),n}(Yt);go.prototype.isScene=!0;var _o=function(){function e(t,n){(0,v.default)(this,e),this.array=t,this.stride=n,this.count=void 0!==t?t.length/n:0,this.usage=ge,this.updateRange={offset:0,count:-1},this.version=0,this.uuid=Ee()}return(0,m.default)(e,[{key:"onUploadCallback",value:function(){}},{key:"needsUpdate",set:function(e){!0===e&&this.version++}},{key:"setUsage",value:function(e){return this.usage=e,this}},{key:"copy",value:function(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.usage=e.usage,this}},{key:"copyAt",value:function(e,t,n){e*=this.stride,n*=t.stride;for(var r=0,i=this.stride;r<i;r++)this.array[e+r]=t.array[n+r];return this}},{key:"set",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.array.set(e,t),this}},{key:"clone",value:function(e){void 0===e.arrayBuffers&&(e.arrayBuffers={}),void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=Ee()),void 0===e.arrayBuffers[this.array.buffer._uuid]&&(e.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);var t=new this.array.constructor(e.arrayBuffers[this.array.buffer._uuid]),n=new this.constructor(t,this.stride);return n.setUsage(this.usage),n}},{key:"onUpload",value:function(e){return this.onUploadCallback=e,this}},{key:"toJSON",value:function(e){return void 0===e.arrayBuffers&&(e.arrayBuffers={}),void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=Ee()),void 0===e.arrayBuffers[this.array.buffer._uuid]&&(e.arrayBuffers[this.array.buffer._uuid]=Array.prototype.slice.call(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}}]),e}();_o.prototype.isInterleavedBuffer=!0;var yo=new qe,xo=function(){function e(t,n,r){var i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];(0,v.default)(this,e),this.name="",this.data=t,this.itemSize=n,this.offset=r,this.normalized=!0===i}return(0,m.default)(e,[{key:"count",get:function(){return this.data.count}},{key:"array",get:function(){return this.data.array}},{key:"needsUpdate",set:function(e){this.data.needsUpdate=e}},{key:"applyMatrix4",value:function(e){for(var t=0,n=this.data.count;t<n;t++)yo.x=this.getX(t),yo.y=this.getY(t),yo.z=this.getZ(t),yo.applyMatrix4(e),this.setXYZ(t,yo.x,yo.y,yo.z);return this}},{key:"applyNormalMatrix",value:function(e){for(var t=0,n=this.count;t<n;t++)yo.x=this.getX(t),yo.y=this.getY(t),yo.z=this.getZ(t),yo.applyNormalMatrix(e),this.setXYZ(t,yo.x,yo.y,yo.z);return this}},{key:"transformDirection",value:function(e){for(var t=0,n=this.count;t<n;t++)yo.x=this.getX(t),yo.y=this.getY(t),yo.z=this.getZ(t),yo.transformDirection(e),this.setXYZ(t,yo.x,yo.y,yo.z);return this}},{key:"setX",value:function(e,t){return this.data.array[e*this.data.stride+this.offset]=t,this}},{key:"setY",value:function(e,t){return this.data.array[e*this.data.stride+this.offset+1]=t,this}},{key:"setZ",value:function(e,t){return this.data.array[e*this.data.stride+this.offset+2]=t,this}},{key:"setW",value:function(e,t){return this.data.array[e*this.data.stride+this.offset+3]=t,this}},{key:"getX",value:function(e){return this.data.array[e*this.data.stride+this.offset]}},{key:"getY",value:function(e){return this.data.array[e*this.data.stride+this.offset+1]}},{key:"getZ",value:function(e){return this.data.array[e*this.data.stride+this.offset+2]}},{key:"getW",value:function(e){return this.data.array[e*this.data.stride+this.offset+3]}},{key:"setXY",value:function(e,t,n){return e=e*this.data.stride+this.offset,this.data.array[e+0]=t,this.data.array[e+1]=n,this}},{key:"setXYZ",value:function(e,t,n,r){return e=e*this.data.stride+this.offset,this.data.array[e+0]=t,this.data.array[e+1]=n,this.data.array[e+2]=r,this}},{key:"setXYZW",value:function(e,t,n,r,i){return e=e*this.data.stride+this.offset,this.data.array[e+0]=t,this.data.array[e+1]=n,this.data.array[e+2]=r,this.data.array[e+3]=i,this}},{key:"clone",value:function(t){if(void 0===t){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interlaved buffer attribute will deinterleave buffer data.");for(var n=[],r=0;r<this.count;r++)for(var i=r*this.data.stride+this.offset,a=0;a<this.itemSize;a++)n.push(this.data.array[i+a]);return new yn(new this.array.constructor(n),this.itemSize,this.normalized)}return void 0===t.interleavedBuffers&&(t.interleavedBuffers={}),void 0===t.interleavedBuffers[this.data.uuid]&&(t.interleavedBuffers[this.data.uuid]=this.data.clone(t)),new e(t.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}},{key:"toJSON",value:function(e){if(void 0===e){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interlaved buffer attribute will deinterleave buffer data.");for(var t=[],n=0;n<this.count;n++)for(var r=n*this.data.stride+this.offset,i=0;i<this.itemSize;i++)t.push(this.data.array[r+i]);return{itemSize:this.itemSize,type:this.array.constructor.name,array:t,normalized:this.normalized}}return void 0===e.interleavedBuffers&&(e.interleavedBuffers={}),void 0===e.interleavedBuffers[this.data.uuid]&&(e.interleavedBuffers[this.data.uuid]=this.data.toJSON(e)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}}]),e}();xo.prototype.isInterleavedBufferAttribute=!0;var bo,wo=function(e){(0,d.default)(n,e);var t=b(n);function n(e){var r;return(0,v.default)(this,n),(r=t.call(this)).type="SpriteMaterial",r.color=new vn(16777215),r.map=null,r.alphaMap=null,r.rotation=0,r.sizeAttenuation=!0,r.transparent=!0,r.setValues(e),r}return(0,m.default)(n,[{key:"copy",value:function(e){return(0,u.default)((0,p.default)(n.prototype),"copy",this).call(this,e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.rotation=e.rotation,this.sizeAttenuation=e.sizeAttenuation,this}}]),n}(ln);wo.prototype.isSpriteMaterial=!0;var To=new qe,Mo=new qe,So=new qe,Eo=new Ie,Ao=new Ie,Lo=new Tt,Co=new qe,Ro=new qe,ko=new qe,Po=new Ie,Do=new Ie,Io=new Ie,Oo=function(e){(0,d.default)(n,e);var t=b(n);function n(e){var r;if((0,v.default)(this,n),(r=t.call(this)).type="Sprite",void 0===bo){bo=new zn;var i=new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),a=new _o(i,5);bo.setIndex([0,1,2,0,2,3]),bo.setAttribute("position",new xo(a,3,0,!1)),bo.setAttribute("uv",new xo(a,2,3,!1))}return r.geometry=bo,r.material=void 0!==e?e:new wo,r.center=new Ie(.5,.5),r}return(0,m.default)(n,[{key:"raycast",value:function(e,t){null===e.camera&&console.error('THREE.Sprite: "Raycaster.camera" needs to be set in order to raycast against sprites.'),Mo.setFromMatrixScale(this.matrixWorld),Lo.copy(e.camera.matrixWorld),this.modelViewMatrix.multiplyMatrices(e.camera.matrixWorldInverse,this.matrixWorld),So.setFromMatrixPosition(this.modelViewMatrix),e.camera.isPerspectiveCamera&&!1===this.material.sizeAttenuation&&Mo.multiplyScalar(-So.z);var n,r,i=this.material.rotation;0!==i&&(r=Math.cos(i),n=Math.sin(i));var a=this.center;Fo(Co.set(-.5,-.5,0),So,a,Mo,n,r),Fo(Ro.set(.5,-.5,0),So,a,Mo,n,r),Fo(ko.set(.5,.5,0),So,a,Mo,n,r),Po.set(0,0),Do.set(1,0),Io.set(1,1);var o=e.ray.intersectTriangle(Co,Ro,ko,!1,To);if(null!==o||(Fo(Ro.set(-.5,.5,0),So,a,Mo,n,r),Do.set(0,1),null!==(o=e.ray.intersectTriangle(Co,ko,Ro,!1,To)))){var s=e.ray.origin.distanceTo(To);s<e.near||s>e.far||t.push({distance:s,point:To.clone(),uv:on.getUV(To,Co,Ro,ko,Po,Do,Io,new Ie),face:null,object:this})}}},{key:"copy",value:function(e){return(0,u.default)((0,p.default)(n.prototype),"copy",this).call(this,e),void 0!==e.center&&this.center.copy(e.center),this.material=e.material,this}}]),n}(Yt);function Fo(e,t,n,r,i,a){Eo.subVectors(e,n).addScalar(.5).multiply(r),void 0!==i?(Ao.x=a*Eo.x-i*Eo.y,Ao.y=i*Eo.x+a*Eo.y):Ao.copy(Eo),e.copy(t),e.x+=Ao.x,e.y+=Ao.y,e.applyMatrix4(Lo)}Oo.prototype.isSprite=!0;var No=new qe,Uo=new qe,Bo=function(e){(0,d.default)(n,e);var t=b(n);function n(){var e;return(0,v.default)(this,n),(e=t.call(this))._currentLevel=0,e.type="LOD",Object.defineProperties((0,h.default)(e),{levels:{enumerable:!0,value:[]},isLOD:{value:!0}}),e.autoUpdate=!0,e}return(0,m.default)(n,[{key:"copy",value:function(e){(0,u.default)((0,p.default)(n.prototype),"copy",this).call(this,e,!1);for(var t=e.levels,r=0,i=t.length;r<i;r++){var a=t[r];this.addLevel(a.object.clone(),a.distance)}return this.autoUpdate=e.autoUpdate,this}},{key:"addLevel",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;t=Math.abs(t);var n,r=this.levels;for(n=0;n<r.length&&!(t<r[n].distance);n++);return r.splice(n,0,{distance:t,object:e}),this.add(e),this}},{key:"getCurrentLevel",value:function(){return this._currentLevel}},{key:"getObjectForDistance",value:function(e){var t=this.levels;if(t.length>0){var n,r;for(n=1,r=t.length;n<r&&!(e<t[n].distance);n++);return t[n-1].object}return null}},{key:"raycast",value:function(e,t){if(this.levels.length>0){No.setFromMatrixPosition(this.matrixWorld);var n=e.ray.origin.distanceTo(No);this.getObjectForDistance(n).raycast(e,t)}}},{key:"update",value:function(e){var t=this.levels;if(t.length>1){No.setFromMatrixPosition(e.matrixWorld),Uo.setFromMatrixPosition(this.matrixWorld);var n,r,i=No.distanceTo(Uo)/e.zoom;for(t[0].object.visible=!0,n=1,r=t.length;n<r&&i>=t[n].distance;n++)t[n-1].object.visible=!1,t[n].object.visible=!0;for(this._currentLevel=n-1;n<r;n++)t[n].object.visible=!1}}},{key:"toJSON",value:function(e){var t=(0,u.default)((0,p.default)(n.prototype),"toJSON",this).call(this,e);!1===this.autoUpdate&&(t.object.autoUpdate=!1),t.object.levels=[];for(var r=this.levels,i=0,a=r.length;i<a;i++){var o=r[i];t.object.levels.push({object:o.object.uuid,distance:o.distance})}return t}}]),n}(Yt),zo=new qe,Ho=new He,Go=new He,Vo=new qe,Wo=new Tt,jo=function(e){(0,d.default)(n,e);var t=b(n);function n(e,r){var i;return(0,v.default)(this,n),(i=t.call(this,e,r)).type="SkinnedMesh",i.bindMode="attached",i.bindMatrix=new Tt,i.bindMatrixInverse=new Tt,i}return(0,m.default)(n,[{key:"copy",value:function(e){return(0,u.default)((0,p.default)(n.prototype),"copy",this).call(this,e),this.bindMode=e.bindMode,this.bindMatrix.copy(e.bindMatrix),this.bindMatrixInverse.copy(e.bindMatrixInverse),this.skeleton=e.skeleton,this}},{key:"bind",value:function(e,t){this.skeleton=e,void 0===t&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),t=this.matrixWorld),this.bindMatrix.copy(t),this.bindMatrixInverse.copy(t).invert()}},{key:"pose",value:function(){this.skeleton.pose()}},{key:"normalizeSkinWeights",value:function(){for(var e=new He,t=this.geometry.attributes.skinWeight,n=0,r=t.count;n<r;n++){e.x=t.getX(n),e.y=t.getY(n),e.z=t.getZ(n),e.w=t.getW(n);var i=1/e.manhattanLength();i!==1/0?e.multiplyScalar(i):e.set(1,0,0,0),t.setXYZW(n,e.x,e.y,e.z,e.w)}}},{key:"updateMatrixWorld",value:function(e){(0,u.default)((0,p.default)(n.prototype),"updateMatrixWorld",this).call(this,e),"attached"===this.bindMode?this.bindMatrixInverse.copy(this.matrixWorld).invert():"detached"===this.bindMode?this.bindMatrixInverse.copy(this.bindMatrix).invert():console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)}},{key:"boneTransform",value:function(e,t){var n=this.skeleton,r=this.geometry;Ho.fromBufferAttribute(r.attributes.skinIndex,e),Go.fromBufferAttribute(r.attributes.skinWeight,e),zo.fromBufferAttribute(r.attributes.position,e).applyMatrix4(this.bindMatrix),t.set(0,0,0);for(var i=0;i<4;i++){var a=Go.getComponent(i);if(0!==a){var o=Ho.getComponent(i);Wo.multiplyMatrices(n.bones[o].matrixWorld,n.boneInverses[o]),t.addScaledVector(Vo.copy(zo).applyMatrix4(Wo),a)}}return t.applyMatrix4(this.bindMatrixInverse)}}]),n}(ir);jo.prototype.isSkinnedMesh=!0;var qo=function(e){(0,d.default)(n,e);var t=b(n);function n(){var e;return(0,v.default)(this,n),(e=t.call(this)).type="Bone",e}return(0,m.default)(n)}(Yt);qo.prototype.isBone=!0;var Xo=function(e){(0,d.default)(n,e);var t=b(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,o=arguments.length>3?arguments[3]:void 0,s=arguments.length>4?arguments[4]:void 0,l=arguments.length>5?arguments[5]:void 0,u=arguments.length>6?arguments[6]:void 0,c=arguments.length>7?arguments[7]:void 0,h=arguments.length>8&&void 0!==arguments[8]?arguments[8]:L,d=arguments.length>9&&void 0!==arguments[9]?arguments[9]:L,f=arguments.length>10?arguments[10]:void 0,p=arguments.length>11?arguments[11]:void 0;return(0,v.default)(this,n),(e=t.call(this,null,l,u,c,h,d,o,s,f,p)).image={data:r,width:i,height:a},e.magFilter=h,e.minFilter=d,e.generateMipmaps=!1,e.flipY=!1,e.unpackAlignment=1,e.needsUpdate=!0,e}return(0,m.default)(n)}(Be);Xo.prototype.isDataTexture=!0;var Yo=new Tt,Ko=new Tt,Zo=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];(0,v.default)(this,e),this.uuid=Ee(),this.bones=t.slice(0),this.boneInverses=n,this.boneMatrices=null,this.boneTexture=null,this.boneTextureSize=0,this.frame=-1,this.init()}return(0,m.default)(e,[{key:"init",value:function(){var e=this.bones,t=this.boneInverses;if(this.boneMatrices=new Float32Array(16*e.length),0===t.length)this.calculateInverses();else if(e.length!==t.length){console.warn("THREE.Skeleton: Number of inverse bone matrices does not match amount of bones."),this.boneInverses=[];for(var n=0,r=this.bones.length;n<r;n++)this.boneInverses.push(new Tt)}}},{key:"calculateInverses",value:function(){this.boneInverses.length=0;for(var e=0,t=this.bones.length;e<t;e++){var n=new Tt;this.bones[e]&&n.copy(this.bones[e].matrixWorld).invert(),this.boneInverses.push(n)}}},{key:"pose",value:function(){for(var e=0,t=this.bones.length;e<t;e++){var n=this.bones[e];n&&n.matrixWorld.copy(this.boneInverses[e]).invert()}for(var r=0,i=this.bones.length;r<i;r++){var a=this.bones[r];a&&(a.parent&&a.parent.isBone?(a.matrix.copy(a.parent.matrixWorld).invert(),a.matrix.multiply(a.matrixWorld)):a.matrix.copy(a.matrixWorld),a.matrix.decompose(a.position,a.quaternion,a.scale))}}},{key:"update",value:function(){for(var e=this.bones,t=this.boneInverses,n=this.boneMatrices,r=this.boneTexture,i=0,a=e.length;i<a;i++){var o=e[i]?e[i].matrixWorld:Ko;Yo.multiplyMatrices(o,t[i]),Yo.toArray(n,16*i)}null!==r&&(r.needsUpdate=!0)}},{key:"clone",value:function(){return new e(this.bones,this.boneInverses)}},{key:"computeBoneTexture",value:function(){var e=Math.sqrt(4*this.bones.length);e=ke(e),e=Math.max(e,4);var t=new Float32Array(e*e*4);t.set(this.boneMatrices);var n=new Xo(t,e,e,H,N);return this.boneMatrices=t,this.boneTexture=n,this.boneTextureSize=e,this}},{key:"getBoneByName",value:function(e){for(var t=0,n=this.bones.length;t<n;t++){var r=this.bones[t];if(r.name===e)return r}}},{key:"dispose",value:function(){null!==this.boneTexture&&(this.boneTexture.dispose(),this.boneTexture=null)}},{key:"fromJSON",value:function(e,t){this.uuid=e.uuid;for(var n=0,r=e.bones.length;n<r;n++){var i=e.bones[n],a=t[i];void 0===a&&(console.warn("THREE.Skeleton: No bone found with UUID:",i),a=new qo),this.bones.push(a),this.boneInverses.push((new Tt).fromArray(e.boneInverses[n]))}return this.init(),this}},{key:"toJSON",value:function(){var e={metadata:{version:4.5,type:"Skeleton",generator:"Skeleton.toJSON"},bones:[],boneInverses:[]};e.uuid=this.uuid;for(var t=this.bones,n=this.boneInverses,r=0,i=t.length;r<i;r++){var a=t[r];e.bones.push(a.uuid);var o=n[r];e.boneInverses.push(o.toArray())}return e}}]),e}(),Jo=new Tt,Qo=new Tt,$o=[],es=new ir,ts=function(e){(0,d.default)(n,e);var t=b(n);function n(e,r,i){var a;return(0,v.default)(this,n),(a=t.call(this,e,r)).instanceMatrix=new yn(new Float32Array(16*i),16),a.instanceColor=null,a.count=i,a.frustumCulled=!1,a}return(0,m.default)(n,[{key:"copy",value:function(e){return(0,u.default)((0,p.default)(n.prototype),"copy",this).call(this,e),this.instanceMatrix.copy(e.instanceMatrix),null!==e.instanceColor&&(this.instanceColor=e.instanceColor.clone()),this.count=e.count,this}},{key:"getColorAt",value:function(e,t){t.fromArray(this.instanceColor.array,3*e)}},{key:"getMatrixAt",value:function(e,t){t.fromArray(this.instanceMatrix.array,16*e)}},{key:"raycast",value:function(e,t){var n=this.matrixWorld,r=this.count;if(es.geometry=this.geometry,es.material=this.material,void 0!==es.material)for(var i=0;i<r;i++){this.getMatrixAt(i,Jo),Qo.multiplyMatrices(n,Jo),es.matrixWorld=Qo,es.raycast(e,$o);for(var a=0,o=$o.length;a<o;a++){var s=$o[a];s.instanceId=i,s.object=this,t.push(s)}$o.length=0}}},{key:"setColorAt",value:function(e,t){null===this.instanceColor&&(this.instanceColor=new yn(new Float32Array(3*this.instanceMatrix.count),3)),t.toArray(this.instanceColor.array,3*e)}},{key:"setMatrixAt",value:function(e,t){t.toArray(this.instanceMatrix.array,16*e)}},{key:"updateMorphTargets",value:function(){}},{key:"dispose",value:function(){this.dispatchEvent({type:"dispose"})}}]),n}(ir);ts.prototype.isInstancedMesh=!0;var ns=function(e){(0,d.default)(n,e);var t=b(n);function n(e){var r;return(0,v.default)(this,n),(r=t.call(this)).type="LineBasicMaterial",r.color=new vn(16777215),r.linewidth=1,r.linecap="round",r.linejoin="round",r.setValues(e),r}return(0,m.default)(n,[{key:"copy",value:function(e){return(0,u.default)((0,p.default)(n.prototype),"copy",this).call(this,e),this.color.copy(e.color),this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this}}]),n}(ln);ns.prototype.isLineBasicMaterial=!0;var rs=new qe,is=new qe,as=new Tt,os=new wt,ss=new pt,ls=function(e){(0,d.default)(n,e);var t=b(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new zn,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new ns;return(0,v.default)(this,n),(e=t.call(this)).type="Line",e.geometry=r,e.material=i,e.updateMorphTargets(),e}return(0,m.default)(n,[{key:"copy",value:function(e){return(0,u.default)((0,p.default)(n.prototype),"copy",this).call(this,e),this.material=e.material,this.geometry=e.geometry,this}},{key:"computeLineDistances",value:function(){var e=this.geometry;if(e.isBufferGeometry)if(null===e.index){for(var t=e.attributes.position,n=[0],r=1,i=t.count;r<i;r++)rs.fromBufferAttribute(t,r-1),is.fromBufferAttribute(t,r),n[r]=n[r-1],n[r]+=rs.distanceTo(is);e.setAttribute("lineDistance",new Ln(n,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else e.isGeometry&&console.error("THREE.Line.computeLineDistances() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.");return this}},{key:"raycast",value:function(e,t){var n=this.geometry,r=this.matrixWorld,i=e.params.Line.threshold,a=n.drawRange;if(null===n.boundingSphere&&n.computeBoundingSphere(),ss.copy(n.boundingSphere),ss.applyMatrix4(r),ss.radius+=i,!1!==e.ray.intersectsSphere(ss)){as.copy(r).invert(),os.copy(e.ray).applyMatrix4(as);var o=i/((this.scale.x+this.scale.y+this.scale.z)/3),s=o*o,l=new qe,u=new qe,c=new qe,h=new qe,d=this.isLineSegments?2:1;if(n.isBufferGeometry){var f=n.index,p=n.attributes.position;if(null!==f)for(var v=Math.max(0,a.start),m=Math.min(f.count,a.start+a.count)-1;v<m;v+=d){var g=f.getX(v),_=f.getX(v+1);if(l.fromBufferAttribute(p,g),u.fromBufferAttribute(p,_),!(os.distanceSqToSegment(l,u,h,c)>s)){h.applyMatrix4(this.matrixWorld);var y=e.ray.origin.distanceTo(h);y<e.near||y>e.far||t.push({distance:y,point:c.clone().applyMatrix4(this.matrixWorld),index:v,face:null,faceIndex:null,object:this})}}else for(var x=Math.max(0,a.start),b=Math.min(p.count,a.start+a.count)-1;x<b;x+=d)if(l.fromBufferAttribute(p,x),u.fromBufferAttribute(p,x+1),!(os.distanceSqToSegment(l,u,h,c)>s)){h.applyMatrix4(this.matrixWorld);var w=e.ray.origin.distanceTo(h);w<e.near||w>e.far||t.push({distance:w,point:c.clone().applyMatrix4(this.matrixWorld),index:x,face:null,faceIndex:null,object:this})}}else n.isGeometry&&console.error("THREE.Line.raycast() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}}},{key:"updateMorphTargets",value:function(){var e=this.geometry;if(e.isBufferGeometry){var t=e.morphAttributes,n=Object.keys(t);if(n.length>0){var r=t[n[0]];if(void 0!==r){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(var i=0,a=r.length;i<a;i++){var o=r[i].name||String(i);this.morphTargetInfluences.push(0),this.morphTargetDictionary[o]=i}}}}else{var s=e.morphTargets;void 0!==s&&s.length>0&&console.error("THREE.Line.updateMorphTargets() does not support THREE.Geometry. Use THREE.BufferGeometry instead.")}}}]),n}(Yt);ls.prototype.isLine=!0;var us=new qe,cs=new qe,hs=function(e){(0,d.default)(n,e);var t=b(n);function n(e,r){var i;return(0,v.default)(this,n),(i=t.call(this,e,r)).type="LineSegments",i}return(0,m.default)(n,[{key:"computeLineDistances",value:function(){var e=this.geometry;if(e.isBufferGeometry)if(null===e.index){for(var t=e.attributes.position,n=[],r=0,i=t.count;r<i;r+=2)us.fromBufferAttribute(t,r),cs.fromBufferAttribute(t,r+1),n[r]=0===r?0:n[r-1],n[r+1]=n[r]+us.distanceTo(cs);e.setAttribute("lineDistance",new Ln(n,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else e.isGeometry&&console.error("THREE.LineSegments.computeLineDistances() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.");return this}}]),n}(ls);hs.prototype.isLineSegments=!0;var ds=function(e){(0,d.default)(n,e);var t=b(n);function n(e,r){var i;return(0,v.default)(this,n),(i=t.call(this,e,r)).type="LineLoop",i}return(0,m.default)(n)}(ls);ds.prototype.isLineLoop=!0;var fs=function(e){(0,d.default)(n,e);var t=b(n);function n(e){var r;return(0,v.default)(this,n),(r=t.call(this)).type="PointsMaterial",r.color=new vn(16777215),r.map=null,r.alphaMap=null,r.size=1,r.sizeAttenuation=!0,r.setValues(e),r}return(0,m.default)(n,[{key:"copy",value:function(e){return(0,u.default)((0,p.default)(n.prototype),"copy",this).call(this,e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.size=e.size,this.sizeAttenuation=e.sizeAttenuation,this}}]),n}(ln);fs.prototype.isPointsMaterial=!0;var ps=new Tt,vs=new wt,ms=new pt,gs=new qe,_s=function(e){(0,d.default)(n,e);var t=b(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new zn,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new fs;return(0,v.default)(this,n),(e=t.call(this)).type="Points",e.geometry=r,e.material=i,e.updateMorphTargets(),e}return(0,m.default)(n,[{key:"copy",value:function(e){return(0,u.default)((0,p.default)(n.prototype),"copy",this).call(this,e),this.material=e.material,this.geometry=e.geometry,this}},{key:"raycast",value:function(e,t){var n=this.geometry,r=this.matrixWorld,i=e.params.Points.threshold,a=n.drawRange;if(null===n.boundingSphere&&n.computeBoundingSphere(),ms.copy(n.boundingSphere),ms.applyMatrix4(r),ms.radius+=i,!1!==e.ray.intersectsSphere(ms)){ps.copy(r).invert(),vs.copy(e.ray).applyMatrix4(ps);var o=i/((this.scale.x+this.scale.y+this.scale.z)/3),s=o*o;if(n.isBufferGeometry){var l=n.index,u=n.attributes.position;if(null!==l)for(var c=Math.max(0,a.start),h=Math.min(l.count,a.start+a.count);c<h;c++){var d=l.getX(c);gs.fromBufferAttribute(u,d),ys(gs,d,s,r,e,t,this)}else for(var f=Math.max(0,a.start),p=Math.min(u.count,a.start+a.count);f<p;f++)gs.fromBufferAttribute(u,f),ys(gs,f,s,r,e,t,this)}else console.error("THREE.Points.raycast() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}}},{key:"updateMorphTargets",value:function(){var e=this.geometry;if(e.isBufferGeometry){var t=e.morphAttributes,n=Object.keys(t);if(n.length>0){var r=t[n[0]];if(void 0!==r){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(var i=0,a=r.length;i<a;i++){var o=r[i].name||String(i);this.morphTargetInfluences.push(0),this.morphTargetDictionary[o]=i}}}}else{var s=e.morphTargets;void 0!==s&&s.length>0&&console.error("THREE.Points.updateMorphTargets() does not support THREE.Geometry. Use THREE.BufferGeometry instead.")}}}]),n}(Yt);function ys(e,t,n,r,i,a,o){var s=vs.distanceSqToPoint(e);if(s<n){var l=new qe;vs.closestPointToPoint(e,l),l.applyMatrix4(r);var u=i.ray.origin.distanceTo(l);if(u<i.near||u>i.far)return;a.push({distance:u,distanceToRay:Math.sqrt(s),point:l,index:t,face:null,object:o})}}_s.prototype.isPoints=!0;var xs=function(e){(0,d.default)(n,e);var t=b(n);function n(e,r,i,a,o,s,l,u,c){var d;(0,v.default)(this,n),(d=t.call(this,e,r,i,a,o,s,l,u,c)).format=void 0!==l?l:z,d.minFilter=void 0!==s?s:k,d.magFilter=void 0!==o?o:k,d.generateMipmaps=!1;var f=(0,h.default)(d);return"requestVideoFrameCallback"in e&&e.requestVideoFrameCallback((function t(){f.needsUpdate=!0,e.requestVideoFrameCallback(t)})),d}return(0,m.default)(n,[{key:"clone",value:function(){return new this.constructor(this.image).copy(this)}},{key:"update",value:function(){var e=this.image;!1=="requestVideoFrameCallback"in e&&e.readyState>=e.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}}]),n}(Be);xs.prototype.isVideoTexture=!0;var bs=function(e){(0,d.default)(n,e);var t=b(n);function n(e,r,i,a,o,s,l,u,c,h,d,f){var p;return(0,v.default)(this,n),(p=t.call(this,null,s,l,u,c,h,a,o,d,f)).image={width:r,height:i},p.mipmaps=e,p.flipY=!1,p.generateMipmaps=!1,p}return(0,m.default)(n)}(Be);bs.prototype.isCompressedTexture=!0;var ws=function(e){(0,d.default)(n,e);var t=b(n);function n(e,r,i,a,o,s,l,u,c){var h;return(0,v.default)(this,n),(h=t.call(this,e,r,i,a,o,s,l,u,c)).needsUpdate=!0,h}return(0,m.default)(n)}(Be);ws.prototype.isCanvasTexture=!0;var Ts=function(e){(0,d.default)(n,e);var t=b(n);function n(e,r,i,a,o,s,l,u,c,h){var d;if((0,v.default)(this,n),(h=void 0!==h?h:G)!==G&&h!==V)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");return void 0===i&&h===G&&(i=O),void 0===i&&h===V&&(i=B),(d=t.call(this,null,a,o,s,l,u,h,i,c)).image={width:e,height:r},d.magFilter=void 0!==l?l:L,d.minFilter=void 0!==u?u:L,d.flipY=!1,d.generateMipmaps=!1,d}return(0,m.default)(n)}(Be);Ts.prototype.isDepthTexture=!0;var Ms=function(e){(0,d.default)(n,e);var t=b(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:8,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2*Math.PI;(0,v.default)(this,n),(e=t.call(this)).type="CircleGeometry",e.parameters={radius:r,segments:i,thetaStart:a,thetaLength:o},i=Math.max(3,i);var s=[],l=[],u=[],c=[],h=new qe,d=new Ie;l.push(0,0,0),u.push(0,0,1),c.push(.5,.5);for(var f=0,p=3;f<=i;f++,p+=3){var m=a+f/i*o;h.x=r*Math.cos(m),h.y=r*Math.sin(m),l.push(h.x,h.y,h.z),u.push(0,0,1),d.x=(l[p]/r+1)/2,d.y=(l[p+1]/r+1)/2,c.push(d.x,d.y)}for(var g=1;g<=i;g++)s.push(g,g+1,0);return e.setIndex(s),e.setAttribute("position",new Ln(l,3)),e.setAttribute("normal",new Ln(u,3)),e.setAttribute("uv",new Ln(c,2)),e}return(0,m.default)(n,null,[{key:"fromJSON",value:function(e){return new n(e.radius,e.segments,e.thetaStart,e.thetaLength)}}]),n}(zn),Ss=function(e){(0,d.default)(n,e);var t=b(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:8,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1,l=arguments.length>5&&void 0!==arguments[5]&&arguments[5],u=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0,c=arguments.length>7&&void 0!==arguments[7]?arguments[7]:2*Math.PI;(0,v.default)(this,n),(e=t.call(this)).type="CylinderGeometry",e.parameters={radiusTop:r,radiusBottom:i,height:a,radialSegments:o,heightSegments:s,openEnded:l,thetaStart:u,thetaLength:c};var d=(0,h.default)(e);o=Math.floor(o),s=Math.floor(s);var f=[],p=[],m=[],g=[],_=0,y=[],x=a/2,b=0;function w(){for(var e=new qe,t=new qe,n=0,l=(i-r)/a,h=0;h<=s;h++){for(var v=[],w=h/s,T=w*(i-r)+r,M=0;M<=o;M++){var S=M/o,E=S*c+u,A=Math.sin(E),L=Math.cos(E);t.x=T*A,t.y=-w*a+x,t.z=T*L,p.push(t.x,t.y,t.z),e.set(A,l,L).normalize(),m.push(e.x,e.y,e.z),g.push(S,1-w),v.push(_++)}y.push(v)}for(var C=0;C<o;C++)for(var R=0;R<s;R++){var k=y[R][C],P=y[R+1][C],D=y[R+1][C+1],I=y[R][C+1];f.push(k,P,I),f.push(P,D,I),n+=6}d.addGroup(b,n,0),b+=n}function T(e){for(var t=_,n=new Ie,a=new qe,s=0,l=!0===e?r:i,h=!0===e?1:-1,v=1;v<=o;v++)p.push(0,x*h,0),m.push(0,h,0),g.push(.5,.5),_++;for(var y=_,w=0;w<=o;w++){var T=w/o*c+u,M=Math.cos(T),S=Math.sin(T);a.x=l*S,a.y=x*h,a.z=l*M,p.push(a.x,a.y,a.z),m.push(0,h,0),n.x=.5*M+.5,n.y=.5*S*h+.5,g.push(n.x,n.y),_++}for(var E=0;E<o;E++){var A=t+E,L=y+E;!0===e?f.push(L,L+1,A):f.push(L+1,L,A),s+=3}d.addGroup(b,s,!0===e?1:2),b+=s}return w(),!1===l&&(r>0&&T(!0),i>0&&T(!1)),e.setIndex(f),e.setAttribute("position",new Ln(p,3)),e.setAttribute("normal",new Ln(m,3)),e.setAttribute("uv",new Ln(g,2)),e}return(0,m.default)(n,null,[{key:"fromJSON",value:function(e){return new n(e.radiusTop,e.radiusBottom,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}]),n}(zn),Es=function(e){(0,d.default)(n,e);var t=b(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:8,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,s=arguments.length>4&&void 0!==arguments[4]&&arguments[4],l=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,u=arguments.length>6&&void 0!==arguments[6]?arguments[6]:2*Math.PI;return(0,v.default)(this,n),(e=t.call(this,0,r,i,a,o,s,l,u)).type="ConeGeometry",e.parameters={radius:r,height:i,radialSegments:a,heightSegments:o,openEnded:s,thetaStart:l,thetaLength:u},e}return(0,m.default)(n,null,[{key:"fromJSON",value:function(e){return new n(e.radius,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}]),n}(Ss),As=function(e){(0,d.default)(n,e);var t=b(n);function n(e,r){var i,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;(0,v.default)(this,n),(i=t.call(this)).type="PolyhedronGeometry",i.parameters={vertices:e,indices:r,radius:a,detail:o};var s=[],l=[];function u(e){for(var t=new qe,n=new qe,i=new qe,a=0;a<r.length;a+=3)m(r[a+0],t),m(r[a+1],n),m(r[a+2],i),c(t,n,i,e)}function c(e,t,n,r){for(var i=r+1,a=[],o=0;o<=i;o++){a[o]=[];for(var s=e.clone().lerp(n,o/i),l=t.clone().lerp(n,o/i),u=i-o,c=0;c<=u;c++)a[o][c]=0===c&&o===i?s:s.clone().lerp(l,c/u)}for(var h=0;h<i;h++)for(var d=0;d<2*(i-h)-1;d++){var f=Math.floor(d/2);d%2==0?(p(a[h][f+1]),p(a[h+1][f]),p(a[h][f])):(p(a[h][f+1]),p(a[h+1][f+1]),p(a[h+1][f]))}}function h(e){for(var t=new qe,n=0;n<s.length;n+=3)t.x=s[n+0],t.y=s[n+1],t.z=s[n+2],t.normalize().multiplyScalar(e),s[n+0]=t.x,s[n+1]=t.y,s[n+2]=t.z}function d(){for(var e=new qe,t=0;t<s.length;t+=3){e.x=s[t+0],e.y=s[t+1],e.z=s[t+2];var n=y(e)/2/Math.PI+.5,r=x(e)/Math.PI+.5;l.push(n,1-r)}g(),f()}function f(){for(var e=0;e<l.length;e+=6){var t=l[e+0],n=l[e+2],r=l[e+4],i=Math.max(t,n,r),a=Math.min(t,n,r);i>.9&&a<.1&&(t<.2&&(l[e+0]+=1),n<.2&&(l[e+2]+=1),r<.2&&(l[e+4]+=1))}}function p(e){s.push(e.x,e.y,e.z)}function m(t,n){var r=3*t;n.x=e[r+0],n.y=e[r+1],n.z=e[r+2]}function g(){for(var e=new qe,t=new qe,n=new qe,r=new qe,i=new Ie,a=new Ie,o=new Ie,u=0,c=0;u<s.length;u+=9,c+=6){e.set(s[u+0],s[u+1],s[u+2]),t.set(s[u+3],s[u+4],s[u+5]),n.set(s[u+6],s[u+7],s[u+8]),i.set(l[c+0],l[c+1]),a.set(l[c+2],l[c+3]),o.set(l[c+4],l[c+5]),r.copy(e).add(t).add(n).divideScalar(3);var h=y(r);_(i,c+0,e,h),_(a,c+2,t,h),_(o,c+4,n,h)}}function _(e,t,n,r){r<0&&1===e.x&&(l[t]=e.x-1),0===n.x&&0===n.z&&(l[t]=r/2/Math.PI+.5)}function y(e){return Math.atan2(e.z,-e.x)}function x(e){return Math.atan2(-e.y,Math.sqrt(e.x*e.x+e.z*e.z))}return u(o),h(a),d(),i.setAttribute("position",new Ln(s,3)),i.setAttribute("normal",new Ln(s.slice(),3)),i.setAttribute("uv",new Ln(l,2)),0===o?i.computeVertexNormals():i.normalizeNormals(),i}return(0,m.default)(n,null,[{key:"fromJSON",value:function(e){return new n(e.vertices,e.indices,e.radius,e.details)}}]),n}(zn),Ls=function(e){(0,d.default)(n,e);var t=b(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;(0,v.default)(this,n);var a=(1+Math.sqrt(5))/2,o=1/a,s=[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-o,-a,0,-o,a,0,o,-a,0,o,a,-o,-a,0,-o,a,0,o,-a,0,o,a,0,-a,0,-o,a,0,-o,-a,0,o,a,0,o],l=[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9];return(e=t.call(this,s,l,r,i)).type="DodecahedronGeometry",e.parameters={radius:r,detail:i},e}return(0,m.default)(n,null,[{key:"fromJSON",value:function(e){return new n(e.radius,e.detail)}}]),n}(As),Cs=new qe,Rs=new qe,ks=new qe,Ps=new on,Ds=function(e){(0,d.default)(n,e);var t=b(n);function n(e,r){var i;if((0,v.default)(this,n),(i=t.call(this)).type="EdgesGeometry",i.parameters={thresholdAngle:r},r=void 0!==r?r:1,!0===e.isGeometry)return console.error("THREE.EdgesGeometry no longer supports THREE.Geometry. Use THREE.BufferGeometry instead."),(0,f.default)(i);for(var a=Math.cos(Me*r),o=e.getIndex(),s=e.getAttribute("position"),l=o?o.count:s.count,u=[0,0,0],c=["a","b","c"],h=new Array(3),d={},p=[],m=0;m<l;m+=3){o?(u[0]=o.getX(m),u[1]=o.getX(m+1),u[2]=o.getX(m+2)):(u[0]=m,u[1]=m+1,u[2]=m+2);var g=Ps.a,_=Ps.b,y=Ps.c;if(g.fromBufferAttribute(s,u[0]),_.fromBufferAttribute(s,u[1]),y.fromBufferAttribute(s,u[2]),Ps.getNormal(ks),h[0]="".concat(g.x,",").concat(g.y,",").concat(g.z),h[1]="".concat(_.x,",").concat(_.y,",").concat(_.z),h[2]="".concat(y.x,",").concat(y.y,",").concat(y.z),h[0]!==h[1]&&h[1]!==h[2]&&h[2]!==h[0])for(var x=0;x<3;x++){var b=(x+1)%3,w=h[x],T=h[b],M=Ps[c[x]],S=Ps[c[b]],E="".concat(w,"_").concat(T),A="".concat(T,"_").concat(w);A in d&&d[A]?(ks.dot(d[A].normal)<=a&&(p.push(M.x,M.y,M.z),p.push(S.x,S.y,S.z)),d[A]=null):E in d||(d[E]={index0:u[x],index1:u[b],normal:ks.clone()})}}for(var L in d)if(d[L]){var C=d[L],R=C.index0,k=C.index1;Cs.fromBufferAttribute(s,R),Rs.fromBufferAttribute(s,k),p.push(Cs.x,Cs.y,Cs.z),p.push(Rs.x,Rs.y,Rs.z)}return i.setAttribute("position",new Ln(p,3)),i}return(0,m.default)(n)}(zn),Is=function(){function e(){(0,v.default)(this,e),this.type="Curve",this.arcLengthDivisions=200}return(0,m.default)(e,[{key:"getPoint",value:function(){return console.warn("THREE.Curve: .getPoint() not implemented."),null}},{key:"getPointAt",value:function(e,t){var n=this.getUtoTmapping(e);return this.getPoint(n,t)}},{key:"getPoints",value:function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:5,t=[],n=0;n<=e;n++)t.push(this.getPoint(n/e));return t}},{key:"getSpacedPoints",value:function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:5,t=[],n=0;n<=e;n++)t.push(this.getPointAt(n/e));return t}},{key:"getLength",value:function(){var e=this.getLengths();return e[e.length-1]}},{key:"getLengths",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.arcLengthDivisions;if(this.cacheArcLengths&&this.cacheArcLengths.length===e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;var t,n=[],r=this.getPoint(0),i=0;n.push(0);for(var a=1;a<=e;a++)i+=(t=this.getPoint(a/e)).distanceTo(r),n.push(i),r=t;return this.cacheArcLengths=n,n}},{key:"updateArcLengths",value:function(){this.needsUpdate=!0,this.getLengths()}},{key:"getUtoTmapping",value:function(e,t){var n,r=this.getLengths(),i=0,a=r.length;n=t||e*r[a-1];for(var o,s=0,l=a-1;s<=l;)if((o=r[i=Math.floor(s+(l-s)/2)]-n)<0)s=i+1;else{if(!(o>0)){l=i;break}l=i-1}if(r[i=l]===n)return i/(a-1);var u=r[i];return(i+(n-u)/(r[i+1]-u))/(a-1)}},{key:"getTangent",value:function(e,t){var n=1e-4,r=e-n,i=e+n;r<0&&(r=0),i>1&&(i=1);var a=this.getPoint(r),o=this.getPoint(i),s=t||(a.isVector2?new Ie:new qe);return s.copy(o).sub(a).normalize(),s}},{key:"getTangentAt",value:function(e,t){var n=this.getUtoTmapping(e);return this.getTangent(n,t)}},{key:"computeFrenetFrames",value:function(e,t){for(var n=new qe,r=[],i=[],a=[],o=new qe,s=new Tt,l=0;l<=e;l++){var u=l/e;r[l]=this.getTangentAt(u,new qe),r[l].normalize()}i[0]=new qe,a[0]=new qe;var c=Number.MAX_VALUE,h=Math.abs(r[0].x),d=Math.abs(r[0].y),f=Math.abs(r[0].z);h<=c&&(c=h,n.set(1,0,0)),d<=c&&(c=d,n.set(0,1,0)),f<=c&&n.set(0,0,1),o.crossVectors(r[0],n).normalize(),i[0].crossVectors(r[0],o),a[0].crossVectors(r[0],i[0]);for(var p=1;p<=e;p++){if(i[p]=i[p-1].clone(),a[p]=a[p-1].clone(),o.crossVectors(r[p-1],r[p]),o.length()>Number.EPSILON){o.normalize();var v=Math.acos(Ae(r[p-1].dot(r[p]),-1,1));i[p].applyMatrix4(s.makeRotationAxis(o,v))}a[p].crossVectors(r[p],i[p])}if(!0===t){var m=Math.acos(Ae(i[0].dot(i[e]),-1,1));m/=e,r[0].dot(o.crossVectors(i[0],i[e]))>0&&(m=-m);for(var g=1;g<=e;g++)i[g].applyMatrix4(s.makeRotationAxis(r[g],m*g)),a[g].crossVectors(r[g],i[g])}return{tangents:r,normals:i,binormals:a}}},{key:"clone",value:function(){return(new this.constructor).copy(this)}},{key:"copy",value:function(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}},{key:"toJSON",value:function(){var e={metadata:{version:4.5,type:"Curve",generator:"Curve.toJSON"}};return e.arcLengthDivisions=this.arcLengthDivisions,e.type=this.type,e}},{key:"fromJSON",value:function(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}}]),e}(),Os=function(e){(0,d.default)(n,e);var t=b(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,l=arguments.length>5&&void 0!==arguments[5]?arguments[5]:2*Math.PI,u=arguments.length>6&&void 0!==arguments[6]&&arguments[6],c=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0;return(0,v.default)(this,n),(e=t.call(this)).type="EllipseCurve",e.aX=r,e.aY=i,e.xRadius=a,e.yRadius=o,e.aStartAngle=s,e.aEndAngle=l,e.aClockwise=u,e.aRotation=c,e}return(0,m.default)(n,[{key:"getPoint",value:function(e,t){for(var n=t||new Ie,r=2*Math.PI,i=this.aEndAngle-this.aStartAngle,a=Math.abs(i)<Number.EPSILON;i<0;)i+=r;for(;i>r;)i-=r;i<Number.EPSILON&&(i=a?0:r),!0!==this.aClockwise||a||(i===r?i=-r:i-=r);var o=this.aStartAngle+e*i,s=this.aX+this.xRadius*Math.cos(o),l=this.aY+this.yRadius*Math.sin(o);if(0!==this.aRotation){var u=Math.cos(this.aRotation),c=Math.sin(this.aRotation),h=s-this.aX,d=l-this.aY;s=h*u-d*c+this.aX,l=h*c+d*u+this.aY}return n.set(s,l)}},{key:"copy",value:function(e){return(0,u.default)((0,p.default)(n.prototype),"copy",this).call(this,e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}},{key:"toJSON",value:function(){var e=(0,u.default)((0,p.default)(n.prototype),"toJSON",this).call(this);return e.aX=this.aX,e.aY=this.aY,e.xRadius=this.xRadius,e.yRadius=this.yRadius,e.aStartAngle=this.aStartAngle,e.aEndAngle=this.aEndAngle,e.aClockwise=this.aClockwise,e.aRotation=this.aRotation,e}},{key:"fromJSON",value:function(e){return(0,u.default)((0,p.default)(n.prototype),"fromJSON",this).call(this,e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}}]),n}(Is);Os.prototype.isEllipseCurve=!0;var Fs=function(e){(0,d.default)(n,e);var t=b(n);function n(e,r,i,a,o,s){var l;return(0,v.default)(this,n),(l=t.call(this,e,r,i,i,a,o,s)).type="ArcCurve",l}return(0,m.default)(n)}(Os);function Ns(){var e=0,t=0,n=0,r=0;function i(i,a,o,s){e=i,t=o,n=-3*i+3*a-2*o-s,r=2*i-2*a+o+s}return{initCatmullRom:function(e,t,n,r,a){i(t,n,a*(n-e),a*(r-t))},initNonuniformCatmullRom:function(e,t,n,r,a,o,s){var l=(t-e)/a-(n-e)/(a+o)+(n-t)/o,u=(n-t)/o-(r-t)/(o+s)+(r-n)/s;i(t,n,l*=o,u*=o)},calc:function(i){var a=i*i;return e+t*i+n*a+r*(a*i)}}}Fs.prototype.isArcCurve=!0;var Us=new qe,Bs=new Ns,zs=new Ns,Hs=new Ns,Gs=function(e){(0,d.default)(n,e);var t=b(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],i=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"centripetal",o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5;return(0,v.default)(this,n),(e=t.call(this)).type="CatmullRomCurve3",e.points=r,e.closed=i,e.curveType=a,e.tension=o,e}return(0,m.default)(n,[{key:"getPoint",value:function(e){var t,n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new qe,i=r,a=this.points,o=a.length,s=(o-(this.closed?0:1))*e,l=Math.floor(s),u=s-l;this.closed?l+=l>0?0:(Math.floor(Math.abs(l)/o)+1)*o:0===u&&l===o-1&&(l=o-2,u=1),this.closed||l>0?t=a[(l-1)%o]:(Us.subVectors(a[0],a[1]).add(a[0]),t=Us);var c=a[l%o],h=a[(l+1)%o];if(this.closed||l+2<o?n=a[(l+2)%o]:(Us.subVectors(a[o-1],a[o-2]).add(a[o-1]),n=Us),"centripetal"===this.curveType||"chordal"===this.curveType){var d="chordal"===this.curveType?.5:.25,f=Math.pow(t.distanceToSquared(c),d),p=Math.pow(c.distanceToSquared(h),d),v=Math.pow(h.distanceToSquared(n),d);p<1e-4&&(p=1),f<1e-4&&(f=p),v<1e-4&&(v=p),Bs.initNonuniformCatmullRom(t.x,c.x,h.x,n.x,f,p,v),zs.initNonuniformCatmullRom(t.y,c.y,h.y,n.y,f,p,v),Hs.initNonuniformCatmullRom(t.z,c.z,h.z,n.z,f,p,v)}else"catmullrom"===this.curveType&&(Bs.initCatmullRom(t.x,c.x,h.x,n.x,this.tension),zs.initCatmullRom(t.y,c.y,h.y,n.y,this.tension),Hs.initCatmullRom(t.z,c.z,h.z,n.z,this.tension));return i.set(Bs.calc(u),zs.calc(u),Hs.calc(u)),i}},{key:"copy",value:function(e){(0,u.default)((0,p.default)(n.prototype),"copy",this).call(this,e),this.points=[];for(var t=0,r=e.points.length;t<r;t++){var i=e.points[t];this.points.push(i.clone())}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}},{key:"toJSON",value:function(){var e=(0,u.default)((0,p.default)(n.prototype),"toJSON",this).call(this);e.points=[];for(var t=0,r=this.points.length;t<r;t++){var i=this.points[t];e.points.push(i.toArray())}return e.closed=this.closed,e.curveType=this.curveType,e.tension=this.tension,e}},{key:"fromJSON",value:function(e){(0,u.default)((0,p.default)(n.prototype),"fromJSON",this).call(this,e),this.points=[];for(var t=0,r=e.points.length;t<r;t++){var i=e.points[t];this.points.push((new qe).fromArray(i))}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}}]),n}(Is);function Vs(e,t,n,r,i){var a=.5*(r-t),o=.5*(i-n),s=e*e;return(2*n-2*r+a+o)*(e*s)+(-3*n+3*r-2*a-o)*s+a*e+n}function Ws(e,t,n,r){return function(e,t){var n=1-e;return n*n*t}(e,t)+function(e,t){return 2*(1-e)*e*t}(e,n)+function(e,t){return e*e*t}(e,r)}function js(e,t,n,r,i){return function(e,t){var n=1-e;return n*n*n*t}(e,t)+function(e,t){var n=1-e;return 3*n*n*e*t}(e,n)+function(e,t){return 3*(1-e)*e*e*t}(e,r)+function(e,t){return e*e*e*t}(e,i)}Gs.prototype.isCatmullRomCurve3=!0;var qs=function(e){(0,d.default)(n,e);var t=b(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Ie,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Ie,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new Ie,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:new Ie;return(0,v.default)(this,n),(e=t.call(this)).type="CubicBezierCurve",e.v0=r,e.v1=i,e.v2=a,e.v3=o,e}return(0,m.default)(n,[{key:"getPoint",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Ie,n=t,r=this.v0,i=this.v1,a=this.v2,o=this.v3;return n.set(js(e,r.x,i.x,a.x,o.x),js(e,r.y,i.y,a.y,o.y)),n}},{key:"copy",value:function(e){return(0,u.default)((0,p.default)(n.prototype),"copy",this).call(this,e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}},{key:"toJSON",value:function(){var e=(0,u.default)((0,p.default)(n.prototype),"toJSON",this).call(this);return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}},{key:"fromJSON",value:function(e){return(0,u.default)((0,p.default)(n.prototype),"fromJSON",this).call(this,e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}]),n}(Is);qs.prototype.isCubicBezierCurve=!0;var Xs=function(e){(0,d.default)(n,e);var t=b(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new qe,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new qe,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new qe,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:new qe;return(0,v.default)(this,n),(e=t.call(this)).type="CubicBezierCurve3",e.v0=r,e.v1=i,e.v2=a,e.v3=o,e}return(0,m.default)(n,[{key:"getPoint",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new qe,n=t,r=this.v0,i=this.v1,a=this.v2,o=this.v3;return n.set(js(e,r.x,i.x,a.x,o.x),js(e,r.y,i.y,a.y,o.y),js(e,r.z,i.z,a.z,o.z)),n}},{key:"copy",value:function(e){return(0,u.default)((0,p.default)(n.prototype),"copy",this).call(this,e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}},{key:"toJSON",value:function(){var e=(0,u.default)((0,p.default)(n.prototype),"toJSON",this).call(this);return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}},{key:"fromJSON",value:function(e){return(0,u.default)((0,p.default)(n.prototype),"fromJSON",this).call(this,e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}]),n}(Is);Xs.prototype.isCubicBezierCurve3=!0;var Ys=function(e){(0,d.default)(n,e);var t=b(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Ie,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Ie;return(0,v.default)(this,n),(e=t.call(this)).type="LineCurve",e.v1=r,e.v2=i,e}return(0,m.default)(n,[{key:"getPoint",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Ie,n=t;return 1===e?n.copy(this.v2):(n.copy(this.v2).sub(this.v1),n.multiplyScalar(e).add(this.v1)),n}},{key:"getPointAt",value:function(e,t){return this.getPoint(e,t)}},{key:"getTangent",value:function(e,t){var n=t||new Ie;return n.copy(this.v2).sub(this.v1).normalize(),n}},{key:"copy",value:function(e){return(0,u.default)((0,p.default)(n.prototype),"copy",this).call(this,e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}},{key:"toJSON",value:function(){var e=(0,u.default)((0,p.default)(n.prototype),"toJSON",this).call(this);return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}},{key:"fromJSON",value:function(e){return(0,u.default)((0,p.default)(n.prototype),"fromJSON",this).call(this,e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}]),n}(Is);Ys.prototype.isLineCurve=!0;var Ks=function(e){(0,d.default)(n,e);var t=b(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new qe,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new qe;return(0,v.default)(this,n),(e=t.call(this)).type="LineCurve3",e.isLineCurve3=!0,e.v1=r,e.v2=i,e}return(0,m.default)(n,[{key:"getPoint",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new qe,n=t;return 1===e?n.copy(this.v2):(n.copy(this.v2).sub(this.v1),n.multiplyScalar(e).add(this.v1)),n}},{key:"getPointAt",value:function(e,t){return this.getPoint(e,t)}},{key:"copy",value:function(e){return(0,u.default)((0,p.default)(n.prototype),"copy",this).call(this,e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}},{key:"toJSON",value:function(){var e=(0,u.default)((0,p.default)(n.prototype),"toJSON",this).call(this);return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}},{key:"fromJSON",value:function(e){return(0,u.default)((0,p.default)(n.prototype),"fromJSON",this).call(this,e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}]),n}(Is),Zs=function(e){(0,d.default)(n,e);var t=b(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Ie,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Ie,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new Ie;return(0,v.default)(this,n),(e=t.call(this)).type="QuadraticBezierCurve",e.v0=r,e.v1=i,e.v2=a,e}return(0,m.default)(n,[{key:"getPoint",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Ie,n=t,r=this.v0,i=this.v1,a=this.v2;return n.set(Ws(e,r.x,i.x,a.x),Ws(e,r.y,i.y,a.y)),n}},{key:"copy",value:function(e){return(0,u.default)((0,p.default)(n.prototype),"copy",this).call(this,e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}},{key:"toJSON",value:function(){var e=(0,u.default)((0,p.default)(n.prototype),"toJSON",this).call(this);return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}},{key:"fromJSON",value:function(e){return(0,u.default)((0,p.default)(n.prototype),"fromJSON",this).call(this,e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}]),n}(Is);Zs.prototype.isQuadraticBezierCurve=!0;var Js=function(e){(0,d.default)(n,e);var t=b(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new qe,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new qe,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new qe;return(0,v.default)(this,n),(e=t.call(this)).type="QuadraticBezierCurve3",e.v0=r,e.v1=i,e.v2=a,e}return(0,m.default)(n,[{key:"getPoint",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new qe,n=t,r=this.v0,i=this.v1,a=this.v2;return n.set(Ws(e,r.x,i.x,a.x),Ws(e,r.y,i.y,a.y),Ws(e,r.z,i.z,a.z)),n}},{key:"copy",value:function(e){return(0,u.default)((0,p.default)(n.prototype),"copy",this).call(this,e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}},{key:"toJSON",value:function(){var e=(0,u.default)((0,p.default)(n.prototype),"toJSON",this).call(this);return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}},{key:"fromJSON",value:function(e){return(0,u.default)((0,p.default)(n.prototype),"fromJSON",this).call(this,e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}]),n}(Is);Js.prototype.isQuadraticBezierCurve3=!0;var Qs=function(e){(0,d.default)(n,e);var t=b(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return(0,v.default)(this,n),(e=t.call(this)).type="SplineCurve",e.points=r,e}return(0,m.default)(n,[{key:"getPoint",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Ie,n=t,r=this.points,i=(r.length-1)*e,a=Math.floor(i),o=i-a,s=r[0===a?a:a-1],l=r[a],u=r[a>r.length-2?r.length-1:a+1],c=r[a>r.length-3?r.length-1:a+2];return n.set(Vs(o,s.x,l.x,u.x,c.x),Vs(o,s.y,l.y,u.y,c.y)),n}},{key:"copy",value:function(e){(0,u.default)((0,p.default)(n.prototype),"copy",this).call(this,e),this.points=[];for(var t=0,r=e.points.length;t<r;t++){var i=e.points[t];this.points.push(i.clone())}return this}},{key:"toJSON",value:function(){var e=(0,u.default)((0,p.default)(n.prototype),"toJSON",this).call(this);e.points=[];for(var t=0,r=this.points.length;t<r;t++){var i=this.points[t];e.points.push(i.toArray())}return e}},{key:"fromJSON",value:function(e){(0,u.default)((0,p.default)(n.prototype),"fromJSON",this).call(this,e),this.points=[];for(var t=0,r=e.points.length;t<r;t++){var i=e.points[t];this.points.push((new Ie).fromArray(i))}return this}}]),n}(Is);Qs.prototype.isSplineCurve=!0;var $s=Object.freeze({__proto__:null,ArcCurve:Fs,CatmullRomCurve3:Gs,CubicBezierCurve:qs,CubicBezierCurve3:Xs,EllipseCurve:Os,LineCurve:Ys,LineCurve3:Ks,QuadraticBezierCurve:Zs,QuadraticBezierCurve3:Js,SplineCurve:Qs}),el=function(e,t){var n,r,i,a,o,s,l,u=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2,c=t&&t.length,h=c?t[0]*u:e.length,d=tl(e,0,h,u,!0),f=[];if(!d||d.next===d.prev)return f;if(c&&(d=ll(e,t,d,u)),e.length>80*u){n=i=e[0],r=a=e[1];for(var p=u;p<h;p+=u)(o=e[p])<n&&(n=o),(s=e[p+1])<r&&(r=s),o>i&&(i=o),s>a&&(a=s);l=0!==(l=Math.max(i-n,a-r))?1/l:0}return rl(d,f,u,n,r,l),f};function tl(e,t,n,r,i){var a,o;if(i===function(e,t,n,r){for(var i=0,a=t,o=n-r;a<n;a+=r)i+=(e[o]-e[a])*(e[a+1]+e[o+1]),o=a;return i}(e,t,n,r)>0)for(a=t;a<n;a+=r)o=Tl(a,e[a],e[a+1],o);else for(a=n-r;a>=t;a-=r)o=Tl(a,e[a],e[a+1],o);return o&&gl(o,o.next)&&(Ml(o),o=o.next),o}function nl(e,t){if(!e)return e;t||(t=e);var n,r=e;do{if(n=!1,r.steiner||!gl(r,r.next)&&0!==ml(r.prev,r,r.next))r=r.next;else{if(Ml(r),(r=t=r.prev)===r.next)break;n=!0}}while(n||r!==t);return t}function rl(e,t,n,r,i,a,o){if(e){!o&&a&&function(e,t,n,r){var i=e;do{null===i.z&&(i.z=dl(i.x,i.y,t,n,r)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next}while(i!==e);i.prevZ.nextZ=null,i.prevZ=null,function(e){var t,n,r,i,a,o,s,l,u=1;do{for(n=e,e=null,a=null,o=0;n;){for(o++,r=n,s=0,t=0;t<u&&(s++,r=r.nextZ);t++);for(l=u;s>0||l>0&&r;)0!==s&&(0===l||!r||n.z<=r.z)?(i=n,n=n.nextZ,s--):(i=r,r=r.nextZ,l--),a?a.nextZ=i:e=i,i.prevZ=a,a=i;n=r}a.nextZ=null,u*=2}while(o>1)}(i)}(e,r,i,a);for(var s,l,u=e;e.prev!==e.next;)if(s=e.prev,l=e.next,a?al(e,r,i,a):il(e))t.push(s.i/n),t.push(e.i/n),t.push(l.i/n),Ml(e),e=l.next,u=l.next;else if((e=l)===u){o?1===o?rl(e=ol(nl(e),t,n),t,n,r,i,a,2):2===o&&sl(e,t,n,r,i,a):rl(nl(e),t,n,r,i,a,1);break}}}function il(e){var t=e.prev,n=e,r=e.next;if(ml(t,n,r)>=0)return!1;for(var i=e.next.next;i!==e.prev;){if(pl(t.x,t.y,n.x,n.y,r.x,r.y,i.x,i.y)&&ml(i.prev,i,i.next)>=0)return!1;i=i.next}return!0}function al(e,t,n,r){var i=e.prev,a=e,o=e.next;if(ml(i,a,o)>=0)return!1;for(var s=i.x<a.x?i.x<o.x?i.x:o.x:a.x<o.x?a.x:o.x,l=i.y<a.y?i.y<o.y?i.y:o.y:a.y<o.y?a.y:o.y,u=i.x>a.x?i.x>o.x?i.x:o.x:a.x>o.x?a.x:o.x,c=i.y>a.y?i.y>o.y?i.y:o.y:a.y>o.y?a.y:o.y,h=dl(s,l,t,n,r),d=dl(u,c,t,n,r),f=e.prevZ,p=e.nextZ;f&&f.z>=h&&p&&p.z<=d;){if(f!==e.prev&&f!==e.next&&pl(i.x,i.y,a.x,a.y,o.x,o.y,f.x,f.y)&&ml(f.prev,f,f.next)>=0)return!1;if(f=f.prevZ,p!==e.prev&&p!==e.next&&pl(i.x,i.y,a.x,a.y,o.x,o.y,p.x,p.y)&&ml(p.prev,p,p.next)>=0)return!1;p=p.nextZ}for(;f&&f.z>=h;){if(f!==e.prev&&f!==e.next&&pl(i.x,i.y,a.x,a.y,o.x,o.y,f.x,f.y)&&ml(f.prev,f,f.next)>=0)return!1;f=f.prevZ}for(;p&&p.z<=d;){if(p!==e.prev&&p!==e.next&&pl(i.x,i.y,a.x,a.y,o.x,o.y,p.x,p.y)&&ml(p.prev,p,p.next)>=0)return!1;p=p.nextZ}return!0}function ol(e,t,n){var r=e;do{var i=r.prev,a=r.next.next;!gl(i,a)&&_l(i,r,r.next,a)&&bl(i,a)&&bl(a,i)&&(t.push(i.i/n),t.push(r.i/n),t.push(a.i/n),Ml(r),Ml(r.next),r=e=a),r=r.next}while(r!==e);return nl(r)}function sl(e,t,n,r,i,a){var o=e;do{for(var s=o.next.next;s!==o.prev;){if(o.i!==s.i&&vl(o,s)){var l=wl(o,s);return o=nl(o,o.next),l=nl(l,l.next),rl(o,t,n,r,i,a),void rl(l,t,n,r,i,a)}s=s.next}o=o.next}while(o!==e)}function ll(e,t,n,r){var i,a,o,s=[];for(i=0,a=t.length;i<a;i++)(o=tl(e,t[i]*r,i<a-1?t[i+1]*r:e.length,r,!1))===o.next&&(o.steiner=!0),s.push(fl(o));for(s.sort(ul),i=0;i<s.length;i++)cl(s[i],n),n=nl(n,n.next);return n}function ul(e,t){return e.x-t.x}function cl(e,t){if(t=function(e,t){var n,r=t,i=e.x,a=e.y,o=-1/0;do{if(a<=r.y&&a>=r.next.y&&r.next.y!==r.y){var s=r.x+(a-r.y)*(r.next.x-r.x)/(r.next.y-r.y);if(s<=i&&s>o){if(o=s,s===i){if(a===r.y)return r;if(a===r.next.y)return r.next}n=r.x<r.next.x?r:r.next}}r=r.next}while(r!==t);if(!n)return null;if(i===o)return n;var l,u=n,c=n.x,h=n.y,d=1/0;r=n;do{i>=r.x&&r.x>=c&&i!==r.x&&pl(a<h?i:o,a,c,h,a<h?o:i,a,r.x,r.y)&&(l=Math.abs(a-r.y)/(i-r.x),bl(r,e)&&(l<d||l===d&&(r.x>n.x||r.x===n.x&&hl(n,r)))&&(n=r,d=l)),r=r.next}while(r!==u);return n}(e,t),t){var n=wl(t,e);nl(t,t.next),nl(n,n.next)}}function hl(e,t){return ml(e.prev,e,t.prev)<0&&ml(t.next,e,e.next)<0}function dl(e,t,n,r,i){return(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-n)*i)|e<<8))|e<<4))|e<<2))|e<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-r)*i)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function fl(e){var t=e,n=e;do{(t.x<n.x||t.x===n.x&&t.y<n.y)&&(n=t),t=t.next}while(t!==e);return n}function pl(e,t,n,r,i,a,o,s){return(i-o)*(t-s)-(e-o)*(a-s)>=0&&(e-o)*(r-s)-(n-o)*(t-s)>=0&&(n-o)*(a-s)-(i-o)*(r-s)>=0}function vl(e,t){return e.next.i!==t.i&&e.prev.i!==t.i&&!function(e,t){var n=e;do{if(n.i!==e.i&&n.next.i!==e.i&&n.i!==t.i&&n.next.i!==t.i&&_l(n,n.next,e,t))return!0;n=n.next}while(n!==e);return!1}(e,t)&&(bl(e,t)&&bl(t,e)&&function(e,t){var n=e,r=!1,i=(e.x+t.x)/2,a=(e.y+t.y)/2;do{n.y>a!=n.next.y>a&&n.next.y!==n.y&&i<(n.next.x-n.x)*(a-n.y)/(n.next.y-n.y)+n.x&&(r=!r),n=n.next}while(n!==e);return r}(e,t)&&(ml(e.prev,e,t.prev)||ml(e,t.prev,t))||gl(e,t)&&ml(e.prev,e,e.next)>0&&ml(t.prev,t,t.next)>0)}function ml(e,t,n){return(t.y-e.y)*(n.x-t.x)-(t.x-e.x)*(n.y-t.y)}function gl(e,t){return e.x===t.x&&e.y===t.y}function _l(e,t,n,r){var i=xl(ml(e,t,n)),a=xl(ml(e,t,r)),o=xl(ml(n,r,e)),s=xl(ml(n,r,t));return i!==a&&o!==s||!(0!==i||!yl(e,n,t))||!(0!==a||!yl(e,r,t))||!(0!==o||!yl(n,e,r))||!(0!==s||!yl(n,t,r))}function yl(e,t,n){return t.x<=Math.max(e.x,n.x)&&t.x>=Math.min(e.x,n.x)&&t.y<=Math.max(e.y,n.y)&&t.y>=Math.min(e.y,n.y)}function xl(e){return e>0?1:e<0?-1:0}function bl(e,t){return ml(e.prev,e,e.next)<0?ml(e,t,e.next)>=0&&ml(e,e.prev,t)>=0:ml(e,t,e.prev)<0||ml(e,e.next,t)<0}function wl(e,t){var n=new Sl(e.i,e.x,e.y),r=new Sl(t.i,t.x,t.y),i=e.next,a=t.prev;return e.next=t,t.prev=e,n.next=i,i.prev=n,r.next=n,n.prev=r,a.next=r,r.prev=a,r}function Tl(e,t,n,r){var i=new Sl(e,t,n);return r?(i.next=r.next,i.prev=r,r.next.prev=i,r.next=i):(i.prev=i,i.next=i),i}function Ml(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function Sl(e,t,n){this.i=e,this.x=t,this.y=n,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}var El=function(){function e(){(0,v.default)(this,e)}return(0,m.default)(e,null,[{key:"area",value:function(e){for(var t=e.length,n=0,r=t-1,i=0;i<t;r=i++)n+=e[r].x*e[i].y-e[i].x*e[r].y;return.5*n}},{key:"isClockWise",value:function(t){return e.area(t)<0}},{key:"triangulateShape",value:function(e,t){var n=[],r=[],i=[];Al(e),Ll(n,e);var a=e.length;t.forEach(Al);for(var o=0;o<t.length;o++)r.push(a),a+=t[o].length,Ll(n,t[o]);for(var s=el(n,r),l=0;l<s.length;l+=3)i.push(s.slice(l,l+3));return i}}]),e}();function Al(e){var t=e.length;t>2&&e[t-1].equals(e[0])&&e.pop()}function Ll(e,t){for(var n=0;n<t.length;n++)e.push(t[n].x),e.push(t[n].y)}var Cl=function(e){(0,d.default)(n,e);var t=b(n);function n(e,r){var i;(0,v.default)(this,n),(i=t.call(this)).type="ExtrudeGeometry",i.parameters={shapes:e,options:r},e=Array.isArray(e)?e:[e];for(var a=(0,h.default)(i),o=[],s=[],l=0,u=e.length;l<u;l++)c(e[l]);function c(e){var t=[],n=void 0!==r.curveSegments?r.curveSegments:12,i=void 0!==r.steps?r.steps:1,l=void 0!==r.depth?r.depth:100,u=void 0===r.bevelEnabled||r.bevelEnabled,c=void 0!==r.bevelThickness?r.bevelThickness:6,h=void 0!==r.bevelSize?r.bevelSize:c-2,d=void 0!==r.bevelOffset?r.bevelOffset:0,f=void 0!==r.bevelSegments?r.bevelSegments:3,p=r.extrudePath,v=void 0!==r.UVGenerator?r.UVGenerator:Rl;void 0!==r.amount&&(console.warn("THREE.ExtrudeBufferGeometry: amount has been renamed to depth."),l=r.amount);var m,g,_,y,x,b=!1;p&&(m=p.getSpacedPoints(i),b=!0,u=!1,g=p.computeFrenetFrames(i,!1),_=new qe,y=new qe,x=new qe),u||(f=0,c=0,h=0,d=0);var w=e.extractPoints(n),T=w.shape,M=w.holes;if(!El.isClockWise(T)){T=T.reverse();for(var S=0,E=M.length;S<E;S++){var A=M[S];El.isClockWise(A)&&(M[S]=A.reverse())}}for(var L=El.triangulateShape(T,M),C=T,R=0,k=M.length;R<k;R++){var P=M[R];T=T.concat(P)}function D(e,t,n){return t||console.error("THREE.ExtrudeGeometry: vec does not exist"),t.clone().multiplyScalar(n).add(e)}var I=T.length,O=L.length;function F(e,t,n){var r,i,a,o=e.x-t.x,s=e.y-t.y,l=n.x-e.x,u=n.y-e.y,c=o*o+s*s,h=o*u-s*l;if(Math.abs(h)>Number.EPSILON){var d=Math.sqrt(c),f=Math.sqrt(l*l+u*u),p=t.x-s/d,v=t.y+o/d,m=((n.x-u/f-p)*u-(n.y+l/f-v)*l)/(o*u-s*l),g=(r=p+o*m-e.x)*r+(i=v+s*m-e.y)*i;if(g<=2)return new Ie(r,i);a=Math.sqrt(g/2)}else{var _=!1;o>Number.EPSILON?l>Number.EPSILON&&(_=!0):o<-Number.EPSILON?l<-Number.EPSILON&&(_=!0):Math.sign(s)===Math.sign(u)&&(_=!0),_?(r=-s,i=o,a=Math.sqrt(c)):(r=o,i=s,a=Math.sqrt(c/2))}return new Ie(r/a,i/a)}for(var N=[],U=0,B=C.length,z=B-1,H=U+1;U<B;U++,z++,H++)z===B&&(z=0),H===B&&(H=0),N[U]=F(C[U],C[z],C[H]);for(var G,V=[],W=N.concat(),j=0,q=M.length;j<q;j++){var X=M[j];G=[];for(var Y=0,K=X.length,Z=K-1,J=Y+1;Y<K;Y++,Z++,J++)Z===K&&(Z=0),J===K&&(J=0),G[Y]=F(X[Y],X[Z],X[J]);V.push(G),W=W.concat(G)}for(var Q=0;Q<f;Q++){for(var $=Q/f,ee=c*Math.cos($*Math.PI/2),te=h*Math.sin($*Math.PI/2)+d,ne=0,re=C.length;ne<re;ne++){var ie=D(C[ne],N[ne],te);ke(ie.x,ie.y,-ee)}for(var ae=0,oe=M.length;ae<oe;ae++){var se=M[ae];G=V[ae];for(var le=0,ue=se.length;le<ue;le++){var ce=D(se[le],G[le],te);ke(ce.x,ce.y,-ee)}}}for(var he=h+d,de=0;de<I;de++){var fe=u?D(T[de],W[de],he):T[de];b?(y.copy(g.normals[0]).multiplyScalar(fe.x),_.copy(g.binormals[0]).multiplyScalar(fe.y),x.copy(m[0]).add(y).add(_),ke(x.x,x.y,x.z)):ke(fe.x,fe.y,0)}for(var pe=1;pe<=i;pe++)for(var ve=0;ve<I;ve++){var me=u?D(T[ve],W[ve],he):T[ve];b?(y.copy(g.normals[pe]).multiplyScalar(me.x),_.copy(g.binormals[pe]).multiplyScalar(me.y),x.copy(m[pe]).add(y).add(_),ke(x.x,x.y,x.z)):ke(me.x,me.y,l/i*pe)}for(var ge=f-1;ge>=0;ge--){for(var _e=ge/f,ye=c*Math.cos(_e*Math.PI/2),xe=h*Math.sin(_e*Math.PI/2)+d,be=0,we=C.length;be<we;be++){var Te=D(C[be],N[be],xe);ke(Te.x,Te.y,l+ye)}for(var Me=0,Se=M.length;Me<Se;Me++){var Ee=M[Me];G=V[Me];for(var Ae=0,Le=Ee.length;Ae<Le;Ae++){var Ce=D(Ee[Ae],G[Ae],xe);b?ke(Ce.x,Ce.y+m[i-1].y,m[i-1].x+ye):ke(Ce.x,Ce.y,l+ye)}}}function Re(e,t){for(var n=e.length;--n>=0;){var r=n,a=n-1;a<0&&(a=e.length-1);for(var o=0,s=i+2*f;o<s;o++){var l=I*o,u=I*(o+1);De(t+r+l,t+a+l,t+a+u,t+r+u)}}}function ke(e,n,r){t.push(e),t.push(n),t.push(r)}function Pe(e,t,n){Oe(e),Oe(t),Oe(n);var r=o.length/3,i=v.generateTopUV(a,o,r-3,r-2,r-1);Fe(i[0]),Fe(i[1]),Fe(i[2])}function De(e,t,n,r){Oe(e),Oe(t),Oe(r),Oe(t),Oe(n),Oe(r);var i=o.length/3,s=v.generateSideWallUV(a,o,i-6,i-3,i-2,i-1);Fe(s[0]),Fe(s[1]),Fe(s[3]),Fe(s[1]),Fe(s[2]),Fe(s[3])}function Oe(e){o.push(t[3*e+0]),o.push(t[3*e+1]),o.push(t[3*e+2])}function Fe(e){s.push(e.x),s.push(e.y)}!function(){var e=o.length/3;if(u){for(var t=0,n=I*t,r=0;r<O;r++){var s=L[r];Pe(s[2]+n,s[1]+n,s[0]+n)}n=I*(t=i+2*f);for(var l=0;l<O;l++){var c=L[l];Pe(c[0]+n,c[1]+n,c[2]+n)}}else{for(var h=0;h<O;h++){var d=L[h];Pe(d[2],d[1],d[0])}for(var p=0;p<O;p++){var v=L[p];Pe(v[0]+I*i,v[1]+I*i,v[2]+I*i)}}a.addGroup(e,o.length/3-e,0)}(),function(){var e=o.length/3,t=0;Re(C,t),t+=C.length;for(var n=0,r=M.length;n<r;n++){var i=M[n];Re(i,t),t+=i.length}a.addGroup(e,o.length/3-e,1)}()}return i.setAttribute("position",new Ln(o,3)),i.setAttribute("uv",new Ln(s,2)),i.computeVertexNormals(),i}return(0,m.default)(n,[{key:"toJSON",value:function(){var e=(0,u.default)((0,p.default)(n.prototype),"toJSON",this).call(this);return function(e,t,n){if(n.shapes=[],Array.isArray(e))for(var r=0,i=e.length;r<i;r++){var a=e[r];n.shapes.push(a.uuid)}else n.shapes.push(e.uuid);return void 0!==t.extrudePath&&(n.options.extrudePath=t.extrudePath.toJSON()),n}(this.parameters.shapes,this.parameters.options,e)}}],[{key:"fromJSON",value:function(e,t){for(var r=[],i=0,a=e.shapes.length;i<a;i++){var o=t[e.shapes[i]];r.push(o)}var s=e.options.extrudePath;return void 0!==s&&(e.options.extrudePath=(new $s[s.type]).fromJSON(s)),new n(r,e.options)}}]),n}(zn),Rl={generateTopUV:function(e,t,n,r,i){var a=t[3*n],o=t[3*n+1],s=t[3*r],l=t[3*r+1],u=t[3*i],c=t[3*i+1];return[new Ie(a,o),new Ie(s,l),new Ie(u,c)]},generateSideWallUV:function(e,t,n,r,i,a){var o=t[3*n],s=t[3*n+1],l=t[3*n+2],u=t[3*r],c=t[3*r+1],h=t[3*r+2],d=t[3*i],f=t[3*i+1],p=t[3*i+2],v=t[3*a],m=t[3*a+1],g=t[3*a+2];return Math.abs(s-c)<Math.abs(o-u)?[new Ie(o,1-l),new Ie(u,1-h),new Ie(d,1-p),new Ie(v,1-g)]:[new Ie(s,1-l),new Ie(c,1-h),new Ie(f,1-p),new Ie(m,1-g)]}},kl=function(e){(0,d.default)(n,e);var t=b(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;(0,v.default)(this,n);var a=(1+Math.sqrt(5))/2,o=[-1,a,0,1,a,0,-1,-a,0,1,-a,0,0,-1,a,0,1,a,0,-1,-a,0,1,-a,a,0,-1,a,0,1,-a,0,-1,-a,0,1],s=[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1];return(e=t.call(this,o,s,r,i)).type="IcosahedronGeometry",e.parameters={radius:r,detail:i},e}return(0,m.default)(n,null,[{key:"fromJSON",value:function(e){return new n(e.radius,e.detail)}}]),n}(As),Pl=function(e){(0,d.default)(n,e);var t=b(n);function n(e){var r,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:12,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2*Math.PI;(0,v.default)(this,n),(r=t.call(this)).type="LatheGeometry",r.parameters={points:e,segments:i,phiStart:a,phiLength:o},i=Math.floor(i),o=Ae(o,0,2*Math.PI);for(var s=[],l=[],u=[],c=1/i,h=new qe,d=new Ie,f=0;f<=i;f++)for(var p=a+f*c*o,m=Math.sin(p),g=Math.cos(p),_=0;_<=e.length-1;_++)h.x=e[_].x*m,h.y=e[_].y,h.z=e[_].x*g,l.push(h.x,h.y,h.z),d.x=f/i,d.y=_/(e.length-1),u.push(d.x,d.y);for(var y=0;y<i;y++)for(var x=0;x<e.length-1;x++){var b=x+y*e.length,w=b,T=b+e.length,M=b+e.length+1,S=b+1;s.push(w,T,S),s.push(T,M,S)}if(r.setIndex(s),r.setAttribute("position",new Ln(l,3)),r.setAttribute("uv",new Ln(u,2)),r.computeVertexNormals(),o===2*Math.PI)for(var E=r.attributes.normal.array,A=new qe,L=new qe,C=new qe,R=i*e.length*3,k=0,P=0;k<e.length;k++,P+=3)A.x=E[P+0],A.y=E[P+1],A.z=E[P+2],L.x=E[R+P+0],L.y=E[R+P+1],L.z=E[R+P+2],C.addVectors(A,L).normalize(),E[P+0]=E[R+P+0]=C.x,E[P+1]=E[R+P+1]=C.y,E[P+2]=E[R+P+2]=C.z;return r}return(0,m.default)(n,null,[{key:"fromJSON",value:function(e){return new n(e.points,e.segments,e.phiStart,e.phiLength)}}]),n}(zn),Dl=function(e){(0,d.default)(n,e);var t=b(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;(0,v.default)(this,n);var a=[1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],o=[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2];return(e=t.call(this,a,o,r,i)).type="OctahedronGeometry",e.parameters={radius:r,detail:i},e}return(0,m.default)(n,null,[{key:"fromJSON",value:function(e){return new n(e.radius,e.detail)}}]),n}(As),Il=function(e){(0,d.default)(n,e);var t=b(n);function n(e,r,i){var a;(0,v.default)(this,n),(a=t.call(this)).type="ParametricGeometry",a.parameters={func:e,slices:r,stacks:i};var o=[],s=[],l=[],u=[],c=1e-5,h=new qe,d=new qe,f=new qe,p=new qe,m=new qe;e.length<3&&console.error("THREE.ParametricGeometry: Function must now modify a Vector3 as third parameter.");for(var g=r+1,_=0;_<=i;_++)for(var y=_/i,x=0;x<=r;x++){var b=x/r;e(b,y,d),s.push(d.x,d.y,d.z),b-c>=0?(e(b-c,y,f),p.subVectors(d,f)):(e(b+c,y,f),p.subVectors(f,d)),y-c>=0?(e(b,y-c,f),m.subVectors(d,f)):(e(b,y+c,f),m.subVectors(f,d)),h.crossVectors(p,m).normalize(),l.push(h.x,h.y,h.z),u.push(b,y)}for(var w=0;w<i;w++)for(var T=0;T<r;T++){var M=w*g+T,S=w*g+T+1,E=(w+1)*g+T+1,A=(w+1)*g+T;o.push(M,S,A),o.push(S,E,A)}return a.setIndex(o),a.setAttribute("position",new Ln(s,3)),a.setAttribute("normal",new Ln(l,3)),a.setAttribute("uv",new Ln(u,2)),a}return(0,m.default)(n)}(zn),Ol=function(e){(0,d.default)(n,e);var t=b(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:.5,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:8,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,l=arguments.length>5&&void 0!==arguments[5]?arguments[5]:2*Math.PI;(0,v.default)(this,n),(e=t.call(this)).type="RingGeometry",e.parameters={innerRadius:r,outerRadius:i,thetaSegments:a,phiSegments:o,thetaStart:s,thetaLength:l},a=Math.max(3,a);for(var u=[],c=[],h=[],d=[],f=r,p=(i-r)/(o=Math.max(1,o)),m=new qe,g=new Ie,_=0;_<=o;_++){for(var y=0;y<=a;y++){var x=s+y/a*l;m.x=f*Math.cos(x),m.y=f*Math.sin(x),c.push(m.x,m.y,m.z),h.push(0,0,1),g.x=(m.x/i+1)/2,g.y=(m.y/i+1)/2,d.push(g.x,g.y)}f+=p}for(var b=0;b<o;b++)for(var w=b*(a+1),T=0;T<a;T++){var M=T+w,S=M,E=M+a+1,A=M+a+2,L=M+1;u.push(S,E,L),u.push(E,A,L)}return e.setIndex(u),e.setAttribute("position",new Ln(c,3)),e.setAttribute("normal",new Ln(h,3)),e.setAttribute("uv",new Ln(d,2)),e}return(0,m.default)(n,null,[{key:"fromJSON",value:function(e){return new n(e.innerRadius,e.outerRadius,e.thetaSegments,e.phiSegments,e.thetaStart,e.thetaLength)}}]),n}(zn),Fl=function(e){(0,d.default)(n,e);var t=b(n);function n(e){var r,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:12;(0,v.default)(this,n),(r=t.call(this)).type="ShapeGeometry",r.parameters={shapes:e,curveSegments:i};var a=[],o=[],s=[],l=[],u=0,c=0;if(!1===Array.isArray(e))d(e);else for(var h=0;h<e.length;h++)d(e[h]),r.addGroup(u,c,h),u+=c,c=0;function d(e){var t=o.length/3,n=e.extractPoints(i),r=n.shape,u=n.holes;!1===El.isClockWise(r)&&(r=r.reverse());for(var h=0,d=u.length;h<d;h++){var f=u[h];!0===El.isClockWise(f)&&(u[h]=f.reverse())}for(var p=El.triangulateShape(r,u),v=0,m=u.length;v<m;v++){var g=u[v];r=r.concat(g)}for(var _=0,y=r.length;_<y;_++){var x=r[_];o.push(x.x,x.y,0),s.push(0,0,1),l.push(x.x,x.y)}for(var b=0,w=p.length;b<w;b++){var T=p[b],M=T[0]+t,S=T[1]+t,E=T[2]+t;a.push(M,S,E),c+=3}}return r.setIndex(a),r.setAttribute("position",new Ln(o,3)),r.setAttribute("normal",new Ln(s,3)),r.setAttribute("uv",new Ln(l,2)),r}return(0,m.default)(n,[{key:"toJSON",value:function(){var e=(0,u.default)((0,p.default)(n.prototype),"toJSON",this).call(this);return function(e,t){if(t.shapes=[],Array.isArray(e))for(var n=0,r=e.length;n<r;n++){var i=e[n];t.shapes.push(i.uuid)}else t.shapes.push(e.uuid);return t}(this.parameters.shapes,e)}}],[{key:"fromJSON",value:function(e,t){for(var r=[],i=0,a=e.shapes.length;i<a;i++){var o=t[e.shapes[i]];r.push(o)}return new n(r,e.curveSegments)}}]),n}(zn),Nl=function(e){(0,d.default)(n,e);var t=b(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:32,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:16,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:2*Math.PI,l=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,u=arguments.length>6&&void 0!==arguments[6]?arguments[6]:Math.PI;(0,v.default)(this,n),(e=t.call(this)).type="SphereGeometry",e.parameters={radius:r,widthSegments:i,heightSegments:a,phiStart:o,phiLength:s,thetaStart:l,thetaLength:u},i=Math.max(3,Math.floor(i)),a=Math.max(2,Math.floor(a));for(var c=Math.min(l+u,Math.PI),h=0,d=[],f=new qe,p=new qe,m=[],g=[],_=[],y=[],x=0;x<=a;x++){var b=[],w=x/a,T=0;0==x&&0==l?T=.5/i:x==a&&c==Math.PI&&(T=-.5/i);for(var M=0;M<=i;M++){var S=M/i;f.x=-r*Math.cos(o+S*s)*Math.sin(l+w*u),f.y=r*Math.cos(l+w*u),f.z=r*Math.sin(o+S*s)*Math.sin(l+w*u),g.push(f.x,f.y,f.z),p.copy(f).normalize(),_.push(p.x,p.y,p.z),y.push(S+T,1-w),b.push(h++)}d.push(b)}for(var E=0;E<a;E++)for(var A=0;A<i;A++){var L=d[E][A+1],C=d[E][A],R=d[E+1][A],k=d[E+1][A+1];(0!==E||l>0)&&m.push(L,C,k),(E!==a-1||c<Math.PI)&&m.push(C,R,k)}return e.setIndex(m),e.setAttribute("position",new Ln(g,3)),e.setAttribute("normal",new Ln(_,3)),e.setAttribute("uv",new Ln(y,2)),e}return(0,m.default)(n,null,[{key:"fromJSON",value:function(e){return new n(e.radius,e.widthSegments,e.heightSegments,e.phiStart,e.phiLength,e.thetaStart,e.thetaLength)}}]),n}(zn),Ul=function(e){(0,d.default)(n,e);var t=b(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;(0,v.default)(this,n);var a=[1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],o=[2,1,0,0,3,2,1,3,0,2,3,1];return(e=t.call(this,a,o,r,i)).type="TetrahedronGeometry",e.parameters={radius:r,detail:i},e}return(0,m.default)(n,null,[{key:"fromJSON",value:function(e){return new n(e.radius,e.detail)}}]),n}(As),Bl=function(e){(0,d.default)(n,e);var t=b(n);function n(e){var r,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};(0,v.default)(this,n);var a=i.font;if(!a||!a.isFont)return console.error("THREE.TextGeometry: font parameter is not an instance of THREE.Font."),(0,f.default)(r,new zn);var o=a.generateShapes(e,i.size);return i.depth=void 0!==i.height?i.height:50,void 0===i.bevelThickness&&(i.bevelThickness=10),void 0===i.bevelSize&&(i.bevelSize=8),void 0===i.bevelEnabled&&(i.bevelEnabled=!1),(r=t.call(this,o,i)).type="TextGeometry",r}return(0,m.default)(n)}(Cl),zl=function(e){(0,d.default)(n,e);var t=b(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.4,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:8,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:6,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:2*Math.PI;(0,v.default)(this,n),(e=t.call(this)).type="TorusGeometry",e.parameters={radius:r,tube:i,radialSegments:a,tubularSegments:o,arc:s},a=Math.floor(a),o=Math.floor(o);for(var l=[],u=[],c=[],h=[],d=new qe,f=new qe,p=new qe,m=0;m<=a;m++)for(var g=0;g<=o;g++){var _=g/o*s,y=m/a*Math.PI*2;f.x=(r+i*Math.cos(y))*Math.cos(_),f.y=(r+i*Math.cos(y))*Math.sin(_),f.z=i*Math.sin(y),u.push(f.x,f.y,f.z),d.x=r*Math.cos(_),d.y=r*Math.sin(_),p.subVectors(f,d).normalize(),c.push(p.x,p.y,p.z),h.push(g/o),h.push(m/a)}for(var x=1;x<=a;x++)for(var b=1;b<=o;b++){var w=(o+1)*x+b-1,T=(o+1)*(x-1)+b-1,M=(o+1)*(x-1)+b,S=(o+1)*x+b;l.push(w,T,S),l.push(T,M,S)}return e.setIndex(l),e.setAttribute("position",new Ln(u,3)),e.setAttribute("normal",new Ln(c,3)),e.setAttribute("uv",new Ln(h,2)),e}return(0,m.default)(n,null,[{key:"fromJSON",value:function(e){return new n(e.radius,e.tube,e.radialSegments,e.tubularSegments,e.arc)}}]),n}(zn),Hl=function(e){(0,d.default)(n,e);var t=b(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.4,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:64,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:8,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:2,l=arguments.length>5&&void 0!==arguments[5]?arguments[5]:3;(0,v.default)(this,n),(e=t.call(this)).type="TorusKnotGeometry",e.parameters={radius:r,tube:i,tubularSegments:a,radialSegments:o,p:s,q:l},a=Math.floor(a),o=Math.floor(o);for(var u=[],c=[],h=[],d=[],f=new qe,p=new qe,m=new qe,g=new qe,_=new qe,y=new qe,x=new qe,b=0;b<=a;++b){var w=b/a*s*Math.PI*2;D(w,s,l,r,m),D(w+.01,s,l,r,g),y.subVectors(g,m),x.addVectors(g,m),_.crossVectors(y,x),x.crossVectors(_,y),_.normalize(),x.normalize();for(var T=0;T<=o;++T){var M=T/o*Math.PI*2,S=-i*Math.cos(M),E=i*Math.sin(M);f.x=m.x+(S*x.x+E*_.x),f.y=m.y+(S*x.y+E*_.y),f.z=m.z+(S*x.z+E*_.z),c.push(f.x,f.y,f.z),p.subVectors(f,m).normalize(),h.push(p.x,p.y,p.z),d.push(b/a),d.push(T/o)}}for(var A=1;A<=a;A++)for(var L=1;L<=o;L++){var C=(o+1)*(A-1)+(L-1),R=(o+1)*A+(L-1),k=(o+1)*A+L,P=(o+1)*(A-1)+L;u.push(C,R,P),u.push(R,k,P)}function D(e,t,n,r,i){var a=Math.cos(e),o=Math.sin(e),s=n/t*e,l=Math.cos(s);i.x=r*(2+l)*.5*a,i.y=r*(2+l)*o*.5,i.z=r*Math.sin(s)*.5}return e.setIndex(u),e.setAttribute("position",new Ln(c,3)),e.setAttribute("normal",new Ln(h,3)),e.setAttribute("uv",new Ln(d,2)),e}return(0,m.default)(n,null,[{key:"fromJSON",value:function(e){return new n(e.radius,e.tube,e.tubularSegments,e.radialSegments,e.p,e.q)}}]),n}(zn),Gl=function(e){(0,d.default)(n,e);var t=b(n);function n(e){var r,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:64,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:8,s=arguments.length>4&&void 0!==arguments[4]&&arguments[4];(0,v.default)(this,n),(r=t.call(this)).type="TubeGeometry",r.parameters={path:e,tubularSegments:i,radius:a,radialSegments:o,closed:s};var l=e.computeFrenetFrames(i,s);r.tangents=l.tangents,r.normals=l.normals,r.binormals=l.binormals;var u=new qe,c=new qe,h=new Ie,d=new qe,f=[],p=[],m=[],g=[];function _(){for(var e=0;e<i;e++)y(e);y(!1===s?i:0),b(),x()}function y(t){d=e.getPointAt(t/i,d);for(var n=l.normals[t],r=l.binormals[t],s=0;s<=o;s++){var h=s/o*Math.PI*2,v=Math.sin(h),m=-Math.cos(h);c.x=m*n.x+v*r.x,c.y=m*n.y+v*r.y,c.z=m*n.z+v*r.z,c.normalize(),p.push(c.x,c.y,c.z),u.x=d.x+a*c.x,u.y=d.y+a*c.y,u.z=d.z+a*c.z,f.push(u.x,u.y,u.z)}}function x(){for(var e=1;e<=i;e++)for(var t=1;t<=o;t++){var n=(o+1)*(e-1)+(t-1),r=(o+1)*e+(t-1),a=(o+1)*e+t,s=(o+1)*(e-1)+t;g.push(n,r,s),g.push(r,a,s)}}function b(){for(var e=0;e<=i;e++)for(var t=0;t<=o;t++)h.x=e/i,h.y=t/o,m.push(h.x,h.y)}return _(),r.setIndex(g),r.setAttribute("position",new Ln(f,3)),r.setAttribute("normal",new Ln(p,3)),r.setAttribute("uv",new Ln(m,2)),r}return(0,m.default)(n,[{key:"toJSON",value:function(){var e=(0,u.default)((0,p.default)(n.prototype),"toJSON",this).call(this);return e.path=this.parameters.path.toJSON(),e}}],[{key:"fromJSON",value:function(e){return new n((new $s[e.path.type]).fromJSON(e.path),e.tubularSegments,e.radius,e.radialSegments,e.closed)}}]),n}(zn),Vl=function(e){(0,d.default)(n,e);var t=b(n);function n(e){var r;if((0,v.default)(this,n),(r=t.call(this)).type="WireframeGeometry",!0===e.isGeometry)return console.error("THREE.WireframeGeometry no longer supports THREE.Geometry. Use THREE.BufferGeometry instead."),(0,f.default)(r);var i=[],a=new Set,o=new qe,s=new qe;if(null!==e.index){var l=e.attributes.position,u=e.index,c=e.groups;0===c.length&&(c=[{start:0,count:u.count,materialIndex:0}]);for(var h=0,d=c.length;h<d;++h)for(var p=c[h],m=p.start,g=m,_=m+p.count;g<_;g+=3)for(var y=0;y<3;y++){var x=u.getX(g+y),b=u.getX(g+(y+1)%3);o.fromBufferAttribute(l,x),s.fromBufferAttribute(l,b),!0===Wl(o,s,a)&&(i.push(o.x,o.y,o.z),i.push(s.x,s.y,s.z))}}else for(var w=e.attributes.position,T=0,M=w.count/3;T<M;T++)for(var S=0;S<3;S++){var E=3*T+S,A=3*T+(S+1)%3;o.fromBufferAttribute(w,E),s.fromBufferAttribute(w,A),!0===Wl(o,s,a)&&(i.push(o.x,o.y,o.z),i.push(s.x,s.y,s.z))}return r.setAttribute("position",new Ln(i,3)),r}return(0,m.default)(n)}(zn);function Wl(e,t,n){var r="".concat(e.x,",").concat(e.y,",").concat(e.z,"-").concat(t.x,",").concat(t.y,",").concat(t.z),i="".concat(t.x,",").concat(t.y,",").concat(t.z,"-").concat(e.x,",").concat(e.y,",").concat(e.z);return!0!==n.has(r)&&!0!==n.has(i)&&(n.add(r,i),!0)}var jl=Object.freeze({__proto__:null,BoxGeometry:or,BoxBufferGeometry:or,CircleGeometry:Ms,CircleBufferGeometry:Ms,ConeGeometry:Es,ConeBufferGeometry:Es,CylinderGeometry:Ss,CylinderBufferGeometry:Ss,DodecahedronGeometry:Ls,DodecahedronBufferGeometry:Ls,EdgesGeometry:Ds,ExtrudeGeometry:Cl,ExtrudeBufferGeometry:Cl,IcosahedronGeometry:kl,IcosahedronBufferGeometry:kl,LatheGeometry:Pl,LatheBufferGeometry:Pl,OctahedronGeometry:Dl,OctahedronBufferGeometry:Dl,ParametricGeometry:Il,ParametricBufferGeometry:Il,PlaneGeometry:Er,PlaneBufferGeometry:Er,PolyhedronGeometry:As,PolyhedronBufferGeometry:As,RingGeometry:Ol,RingBufferGeometry:Ol,ShapeGeometry:Fl,ShapeBufferGeometry:Fl,SphereGeometry:Nl,SphereBufferGeometry:Nl,TetrahedronGeometry:Ul,TetrahedronBufferGeometry:Ul,TextGeometry:Bl,TextBufferGeometry:Bl,TorusGeometry:zl,TorusBufferGeometry:zl,TorusKnotGeometry:Hl,TorusKnotBufferGeometry:Hl,TubeGeometry:Gl,TubeBufferGeometry:Gl,WireframeGeometry:Vl}),ql=function(e){(0,d.default)(n,e);var t=b(n);function n(e){var r;return(0,v.default)(this,n),(r=t.call(this)).type="ShadowMaterial",r.color=new vn(0),r.transparent=!0,r.setValues(e),r}return(0,m.default)(n,[{key:"copy",value:function(e){return(0,u.default)((0,p.default)(n.prototype),"copy",this).call(this,e),this.color.copy(e.color),this}}]),n}(ln);ql.prototype.isShadowMaterial=!0;var Xl=function(e){(0,d.default)(n,e);var t=b(n);function n(e){var r;return(0,v.default)(this,n),(r=t.call(this)).defines={STANDARD:""},r.type="MeshStandardMaterial",r.color=new vn(16777215),r.roughness=1,r.metalness=0,r.map=null,r.lightMap=null,r.lightMapIntensity=1,r.aoMap=null,r.aoMapIntensity=1,r.emissive=new vn(0),r.emissiveIntensity=1,r.emissiveMap=null,r.bumpMap=null,r.bumpScale=1,r.normalMap=null,r.normalMapType=0,r.normalScale=new Ie(1,1),r.displacementMap=null,r.displacementScale=1,r.displacementBias=0,r.roughnessMap=null,r.metalnessMap=null,r.alphaMap=null,r.envMap=null,r.envMapIntensity=1,r.refractionRatio=.98,r.wireframe=!1,r.wireframeLinewidth=1,r.wireframeLinecap="round",r.wireframeLinejoin="round",r.flatShading=!1,r.setValues(e),r}return(0,m.default)(n,[{key:"copy",value:function(e){return(0,u.default)((0,p.default)(n.prototype),"copy",this).call(this,e),this.defines={STANDARD:""},this.color.copy(e.color),this.roughness=e.roughness,this.metalness=e.metalness,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.roughnessMap=e.roughnessMap,this.metalnessMap=e.metalnessMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapIntensity=e.envMapIntensity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this}}]),n}(ln);Xl.prototype.isMeshStandardMaterial=!0;var Yl=function(e){(0,d.default)(n,e);var t=b(n);function n(e){var r;return(0,v.default)(this,n),(r=t.call(this)).defines={STANDARD:"",PHYSICAL:""},r.type="MeshPhysicalMaterial",r.clearcoat=0,r.clearcoatMap=null,r.clearcoatRoughness=0,r.clearcoatRoughnessMap=null,r.clearcoatNormalScale=new Ie(1,1),r.clearcoatNormalMap=null,r.reflectivity=.5,Object.defineProperty((0,h.default)(r),"ior",{get:function(){return(1+.4*this.reflectivity)/(1-.4*this.reflectivity)},set:function(e){this.reflectivity=Ae(2.5*(e-1)/(e+1),0,1)}}),r.sheen=null,r.transmission=0,r.transmissionMap=null,r.thickness=.01,r.thicknessMap=null,r.attenuationDistance=0,r.attenuationTint=new vn(1,1,1),r.specularIntensity=1,r.specularIntensityMap=null,r.specularTint=new vn(1,1,1),r.specularTintMap=null,r.setValues(e),r}return(0,m.default)(n,[{key:"copy",value:function(e){return(0,u.default)((0,p.default)(n.prototype),"copy",this).call(this,e),this.defines={STANDARD:"",PHYSICAL:""},this.clearcoat=e.clearcoat,this.clearcoatMap=e.clearcoatMap,this.clearcoatRoughness=e.clearcoatRoughness,this.clearcoatRoughnessMap=e.clearcoatRoughnessMap,this.clearcoatNormalMap=e.clearcoatNormalMap,this.clearcoatNormalScale.copy(e.clearcoatNormalScale),this.reflectivity=e.reflectivity,e.sheen?this.sheen=(this.sheen||new vn).copy(e.sheen):this.sheen=null,this.transmission=e.transmission,this.transmissionMap=e.transmissionMap,this.thickness=e.thickness,this.thicknessMap=e.thicknessMap,this.attenuationDistance=e.attenuationDistance,this.attenuationTint.copy(e.attenuationTint),this.specularIntensity=e.specularIntensity,this.specularIntensityMap=e.specularIntensityMap,this.specularTint.copy(e.specularTint),this.specularTintMap=e.specularTintMap,this}}]),n}(Xl);Yl.prototype.isMeshPhysicalMaterial=!0;var Kl=function(e){(0,d.default)(n,e);var t=b(n);function n(e){var r;return(0,v.default)(this,n),(r=t.call(this)).type="MeshPhongMaterial",r.color=new vn(16777215),r.specular=new vn(1118481),r.shininess=30,r.map=null,r.lightMap=null,r.lightMapIntensity=1,r.aoMap=null,r.aoMapIntensity=1,r.emissive=new vn(0),r.emissiveIntensity=1,r.emissiveMap=null,r.bumpMap=null,r.bumpScale=1,r.normalMap=null,r.normalMapType=0,r.normalScale=new Ie(1,1),r.displacementMap=null,r.displacementScale=1,r.displacementBias=0,r.specularMap=null,r.alphaMap=null,r.envMap=null,r.combine=0,r.reflectivity=1,r.refractionRatio=.98,r.wireframe=!1,r.wireframeLinewidth=1,r.wireframeLinecap="round",r.wireframeLinejoin="round",r.flatShading=!1,r.setValues(e),r}return(0,m.default)(n,[{key:"copy",value:function(e){return(0,u.default)((0,p.default)(n.prototype),"copy",this).call(this,e),this.color.copy(e.color),this.specular.copy(e.specular),this.shininess=e.shininess,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this}}]),n}(ln);Kl.prototype.isMeshPhongMaterial=!0;var Zl=function(e){(0,d.default)(n,e);var t=b(n);function n(e){var r;return(0,v.default)(this,n),(r=t.call(this)).defines={TOON:""},r.type="MeshToonMaterial",r.color=new vn(16777215),r.map=null,r.gradientMap=null,r.lightMap=null,r.lightMapIntensity=1,r.aoMap=null,r.aoMapIntensity=1,r.emissive=new vn(0),r.emissiveIntensity=1,r.emissiveMap=null,r.bumpMap=null,r.bumpScale=1,r.normalMap=null,r.normalMapType=0,r.normalScale=new Ie(1,1),r.displacementMap=null,r.displacementScale=1,r.displacementBias=0,r.alphaMap=null,r.wireframe=!1,r.wireframeLinewidth=1,r.wireframeLinecap="round",r.wireframeLinejoin="round",r.setValues(e),r}return(0,m.default)(n,[{key:"copy",value:function(e){return(0,u.default)((0,p.default)(n.prototype),"copy",this).call(this,e),this.color.copy(e.color),this.map=e.map,this.gradientMap=e.gradientMap,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this}}]),n}(ln);Zl.prototype.isMeshToonMaterial=!0;var Jl=function(e){(0,d.default)(n,e);var t=b(n);function n(e){var r;return(0,v.default)(this,n),(r=t.call(this)).type="MeshNormalMaterial",r.bumpMap=null,r.bumpScale=1,r.normalMap=null,r.normalMapType=0,r.normalScale=new Ie(1,1),r.displacementMap=null,r.displacementScale=1,r.displacementBias=0,r.wireframe=!1,r.wireframeLinewidth=1,r.fog=!1,r.flatShading=!1,r.setValues(e),r}return(0,m.default)(n,[{key:"copy",value:function(e){return(0,u.default)((0,p.default)(n.prototype),"copy",this).call(this,e),this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.flatShading=e.flatShading,this}}]),n}(ln);Jl.prototype.isMeshNormalMaterial=!0;var Ql=function(e){(0,d.default)(n,e);var t=b(n);function n(e){var r;return(0,v.default)(this,n),(r=t.call(this)).type="MeshLambertMaterial",r.color=new vn(16777215),r.map=null,r.lightMap=null,r.lightMapIntensity=1,r.aoMap=null,r.aoMapIntensity=1,r.emissive=new vn(0),r.emissiveIntensity=1,r.emissiveMap=null,r.specularMap=null,r.alphaMap=null,r.envMap=null,r.combine=0,r.reflectivity=1,r.refractionRatio=.98,r.wireframe=!1,r.wireframeLinewidth=1,r.wireframeLinecap="round",r.wireframeLinejoin="round",r.setValues(e),r}return(0,m.default)(n,[{key:"copy",value:function(e){return(0,u.default)((0,p.default)(n.prototype),"copy",this).call(this,e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this}}]),n}(ln);Ql.prototype.isMeshLambertMaterial=!0;var $l=function(e){(0,d.default)(n,e);var t=b(n);function n(e){var r;return(0,v.default)(this,n),(r=t.call(this)).defines={MATCAP:""},r.type="MeshMatcapMaterial",r.color=new vn(16777215),r.matcap=null,r.map=null,r.bumpMap=null,r.bumpScale=1,r.normalMap=null,r.normalMapType=0,r.normalScale=new Ie(1,1),r.displacementMap=null,r.displacementScale=1,r.displacementBias=0,r.alphaMap=null,r.flatShading=!1,r.setValues(e),r}return(0,m.default)(n,[{key:"copy",value:function(e){return(0,u.default)((0,p.default)(n.prototype),"copy",this).call(this,e),this.defines={MATCAP:""},this.color.copy(e.color),this.matcap=e.matcap,this.map=e.map,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.flatShading=e.flatShading,this}}]),n}(ln);$l.prototype.isMeshMatcapMaterial=!0;var eu=function(e){(0,d.default)(n,e);var t=b(n);function n(e){var r;return(0,v.default)(this,n),(r=t.call(this)).type="LineDashedMaterial",r.scale=1,r.dashSize=3,r.gapSize=1,r.setValues(e),r}return(0,m.default)(n,[{key:"copy",value:function(e){return(0,u.default)((0,p.default)(n.prototype),"copy",this).call(this,e),this.scale=e.scale,this.dashSize=e.dashSize,this.gapSize=e.gapSize,this}}]),n}(ns);eu.prototype.isLineDashedMaterial=!0;var tu=Object.freeze({__proto__:null,ShadowMaterial:ql,SpriteMaterial:wo,RawShaderMaterial:Nr,ShaderMaterial:cr,PointsMaterial:fs,MeshPhysicalMaterial:Yl,MeshStandardMaterial:Xl,MeshPhongMaterial:Kl,MeshToonMaterial:Zl,MeshNormalMaterial:Jl,MeshLambertMaterial:Ql,MeshDepthMaterial:$a,MeshDistanceMaterial:eo,MeshBasicMaterial:mn,MeshMatcapMaterial:$l,LineDashedMaterial:eu,LineBasicMaterial:ns,Material:ln}),nu={arraySlice:function(e,t,n){return nu.isTypedArray(e)?new e.constructor(e.subarray(t,void 0!==n?n:e.length)):e.slice(t,n)},convertArray:function(e,t,n){return!e||!n&&e.constructor===t?e:"number"==typeof t.BYTES_PER_ELEMENT?new t(e):Array.prototype.slice.call(e)},isTypedArray:function(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)},getKeyframeOrder:function(e){for(var t=e.length,n=new Array(t),r=0;r!==t;++r)n[r]=r;return n.sort((function(t,n){return e[t]-e[n]})),n},sortedArray:function(e,t,n){for(var r=e.length,i=new e.constructor(r),a=0,o=0;o!==r;++a)for(var s=n[a]*t,l=0;l!==t;++l)i[o++]=e[s+l];return i},flattenJSON:function(e,t,n,r){for(var i=1,a=e[0];void 0!==a&&void 0===a[r];)a=e[i++];if(void 0!==a){var o=a[r];if(void 0!==o)if(Array.isArray(o))do{void 0!==(o=a[r])&&(t.push(a.time),n.push.apply(n,o)),a=e[i++]}while(void 0!==a);else if(void 0!==o.toArray)do{void 0!==(o=a[r])&&(t.push(a.time),o.toArray(n,n.length)),a=e[i++]}while(void 0!==a);else do{void 0!==(o=a[r])&&(t.push(a.time),n.push(o)),a=e[i++]}while(void 0!==a)}},subclip:function(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:30,a=e.clone();a.name=t;for(var o=[],s=0;s<a.tracks.length;++s){for(var l=a.tracks[s],u=l.getValueSize(),c=[],h=[],d=0;d<l.times.length;++d){var f=l.times[d]*i;if(!(f<n||f>=r)){c.push(l.times[d]);for(var p=0;p<u;++p)h.push(l.values[d*u+p])}}0!==c.length&&(l.times=nu.convertArray(c,l.times.constructor),l.values=nu.convertArray(h,l.values.constructor),o.push(l))}a.tracks=o;for(var v=1/0,m=0;m<a.tracks.length;++m)v>a.tracks[m].times[0]&&(v=a.tracks[m].times[0]);for(var g=0;g<a.tracks.length;++g)a.tracks[g].shift(-1*v);return a.resetDuration(),a},makeClipAdditive:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:30;r<=0&&(r=30);for(var i=n.tracks.length,a=t/r,o=function(t){var r=n.tracks[t],i=r.ValueTypeName;if("bool"===i||"string"===i)return"continue";var o=e.tracks.find((function(e){return e.name===r.name&&e.ValueTypeName===i}));if(void 0===o)return"continue";var s=0,l=r.getValueSize();r.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(s=l/3);var u=0,c=o.getValueSize();o.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(u=c/3);var h=r.times.length-1,d=void 0;if(a<=r.times[0]){var f=s,p=l-s;d=nu.arraySlice(r.values,f,p)}else if(a>=r.times[h]){var v=h*l+s,m=v+l-s;d=nu.arraySlice(r.values,v,m)}else{var g=r.createInterpolant(),_=s,y=l-s;g.evaluate(a),d=nu.arraySlice(g.resultBuffer,_,y)}"quaternion"===i&&(new je).fromArray(d).normalize().conjugate().toArray(d);for(var x=o.times.length,b=0;b<x;++b){var w=b*c+u;if("quaternion"===i)je.multiplyQuaternionsFlat(o.values,w,d,0,o.values,w);else for(var T=c-2*u,M=0;M<T;++M)o.values[w+M]-=d[M]}},s=0;s<i;++s)o(s);return e.blendMode=le,e}},ru=function(){function e(t,n,r,i){(0,v.default)(this,e),this.parameterPositions=t,this._cachedIndex=0,this.resultBuffer=void 0!==i?i:new n.constructor(r),this.sampleValues=n,this.valueSize=r,this.settings=null,this.DefaultSettings_={}}return(0,m.default)(e,[{key:"evaluate",value:function(e){var t=this.parameterPositions,n=this._cachedIndex,r=t[n],i=t[n-1];e:{t:{var a;n:{r:if(!(e<r)){for(var o=n+2;;){if(void 0===r){if(e<i)break r;return n=t.length,this._cachedIndex=n,this.afterEnd_(n-1,e,i)}if(n===o)break;if(i=r,e<(r=t[++n]))break t}a=t.length;break n}if(e>=i)break e;var s=t[1];e<s&&(n=2,i=s);for(var l=n-2;;){if(void 0===i)return this._cachedIndex=0,this.beforeStart_(0,e,r);if(n===l)break;if(r=i,e>=(i=t[--n-1]))break t}a=n,n=0}for(;n<a;){var u=n+a>>>1;e<t[u]?a=u:n=u+1}if(r=t[n],void 0===(i=t[n-1]))return this._cachedIndex=0,this.beforeStart_(0,e,r);if(void 0===r)return n=t.length,this._cachedIndex=n,this.afterEnd_(n-1,i,e)}this._cachedIndex=n,this.intervalChanged_(n,i,r)}return this.interpolate_(n,i,e,r)}},{key:"getSettings_",value:function(){return this.settings||this.DefaultSettings_}},{key:"copySampleValue_",value:function(e){for(var t=this.resultBuffer,n=this.sampleValues,r=this.valueSize,i=e*r,a=0;a!==r;++a)t[a]=n[i+a];return t}},{key:"interpolate_",value:function(){throw new Error("call to abstract method")}},{key:"intervalChanged_",value:function(){}}]),e}();ru.prototype.beforeStart_=ru.prototype.copySampleValue_,ru.prototype.afterEnd_=ru.prototype.copySampleValue_;var iu=function(e){(0,d.default)(n,e);var t=b(n);function n(e,r,i,a){var o;return(0,v.default)(this,n),(o=t.call(this,e,r,i,a))._weightPrev=-0,o._offsetPrev=-0,o._weightNext=-0,o._offsetNext=-0,o.DefaultSettings_={endingStart:ie,endingEnd:ie},o}return(0,m.default)(n,[{key:"intervalChanged_",value:function(e,t,n){var r=this.parameterPositions,i=e-2,a=e+1,o=r[i],s=r[a];if(void 0===o)switch(this.getSettings_().endingStart){case ae:i=e,o=2*t-n;break;case oe:o=t+r[i=r.length-2]-r[i+1];break;default:i=e,o=n}if(void 0===s)switch(this.getSettings_().endingEnd){case ae:a=e,s=2*n-t;break;case oe:a=1,s=n+r[1]-r[0];break;default:a=e-1,s=t}var l=.5*(n-t),u=this.valueSize;this._weightPrev=l/(t-o),this._weightNext=l/(s-n),this._offsetPrev=i*u,this._offsetNext=a*u}},{key:"interpolate_",value:function(e,t,n,r){for(var i=this.resultBuffer,a=this.sampleValues,o=this.valueSize,s=e*o,l=s-o,u=this._offsetPrev,c=this._offsetNext,h=this._weightPrev,d=this._weightNext,f=(n-t)/(r-t),p=f*f,v=p*f,m=-h*v+2*h*p-h*f,g=(1+h)*v+(-1.5-2*h)*p+(-.5+h)*f+1,_=(-1-d)*v+(1.5+d)*p+.5*f,y=d*v-d*p,x=0;x!==o;++x)i[x]=m*a[u+x]+g*a[l+x]+_*a[s+x]+y*a[c+x];return i}}]),n}(ru),au=function(e){(0,d.default)(n,e);var t=b(n);function n(e,r,i,a){return(0,v.default)(this,n),t.call(this,e,r,i,a)}return(0,m.default)(n,[{key:"interpolate_",value:function(e,t,n,r){for(var i=this.resultBuffer,a=this.sampleValues,o=this.valueSize,s=e*o,l=s-o,u=(n-t)/(r-t),c=1-u,h=0;h!==o;++h)i[h]=a[l+h]*c+a[s+h]*u;return i}}]),n}(ru),ou=function(e){(0,d.default)(n,e);var t=b(n);function n(e,r,i,a){return(0,v.default)(this,n),t.call(this,e,r,i,a)}return(0,m.default)(n,[{key:"interpolate_",value:function(e){return this.copySampleValue_(e-1)}}]),n}(ru),su=function(){function e(t,n,r,i){if((0,v.default)(this,e),void 0===t)throw new Error("THREE.KeyframeTrack: track name is undefined");if(void 0===n||0===n.length)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+t);this.name=t,this.times=nu.convertArray(n,this.TimeBufferType),this.values=nu.convertArray(r,this.ValueBufferType),this.setInterpolation(i||this.DefaultInterpolation)}return(0,m.default)(e,[{key:"InterpolantFactoryMethodDiscrete",value:function(e){return new ou(this.times,this.values,this.getValueSize(),e)}},{key:"InterpolantFactoryMethodLinear",value:function(e){return new au(this.times,this.values,this.getValueSize(),e)}},{key:"InterpolantFactoryMethodSmooth",value:function(e){return new iu(this.times,this.values,this.getValueSize(),e)}},{key:"setInterpolation",value:function(e){var t;switch(e){case te:t=this.InterpolantFactoryMethodDiscrete;break;case ne:t=this.InterpolantFactoryMethodLinear;break;case re:t=this.InterpolantFactoryMethodSmooth}if(void 0===t){var n="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(void 0===this.createInterpolant){if(e===this.DefaultInterpolation)throw new Error(n);this.setInterpolation(this.DefaultInterpolation)}return console.warn("THREE.KeyframeTrack:",n),this}return this.createInterpolant=t,this}},{key:"getInterpolation",value:function(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return te;case this.InterpolantFactoryMethodLinear:return ne;case this.InterpolantFactoryMethodSmooth:return re}}},{key:"getValueSize",value:function(){return this.values.length/this.times.length}},{key:"shift",value:function(e){if(0!==e)for(var t=this.times,n=0,r=t.length;n!==r;++n)t[n]+=e;return this}},{key:"scale",value:function(e){if(1!==e)for(var t=this.times,n=0,r=t.length;n!==r;++n)t[n]*=e;return this}},{key:"trim",value:function(e,t){for(var n=this.times,r=n.length,i=0,a=r-1;i!==r&&n[i]<e;)++i;for(;-1!==a&&n[a]>t;)--a;if(++a,0!==i||a!==r){i>=a&&(i=(a=Math.max(a,1))-1);var o=this.getValueSize();this.times=nu.arraySlice(n,i,a),this.values=nu.arraySlice(this.values,i*o,a*o)}return this}},{key:"validate",value:function(){var e=!0,t=this.getValueSize();t-Math.floor(t)!=0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),e=!1);var n=this.times,r=this.values,i=n.length;0===i&&(console.error("THREE.KeyframeTrack: Track is empty.",this),e=!1);for(var a=null,o=0;o!==i;o++){var s=n[o];if("number"==typeof s&&isNaN(s)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,o,s),e=!1;break}if(null!==a&&a>s){console.error("THREE.KeyframeTrack: Out of order keys.",this,o,s,a),e=!1;break}a=s}if(void 0!==r&&nu.isTypedArray(r))for(var l=0,u=r.length;l!==u;++l){var c=r[l];if(isNaN(c)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,l,c),e=!1;break}}return e}},{key:"optimize",value:function(){for(var e=nu.arraySlice(this.times),t=nu.arraySlice(this.values),n=this.getValueSize(),r=this.getInterpolation()===re,i=e.length-1,a=1,o=1;o<i;++o){var s=!1,l=e[o];if(l!==e[o+1]&&(1!==o||l!==e[0]))if(r)s=!0;else for(var u=o*n,c=u-n,h=u+n,d=0;d!==n;++d){var f=t[u+d];if(f!==t[c+d]||f!==t[h+d]){s=!0;break}}if(s){if(o!==a){e[a]=e[o];for(var p=o*n,v=a*n,m=0;m!==n;++m)t[v+m]=t[p+m]}++a}}if(i>0){e[a]=e[i];for(var g=i*n,_=a*n,y=0;y!==n;++y)t[_+y]=t[g+y];++a}return a!==e.length?(this.times=nu.arraySlice(e,0,a),this.values=nu.arraySlice(t,0,a*n)):(this.times=e,this.values=t),this}},{key:"clone",value:function(){var e=nu.arraySlice(this.times,0),t=nu.arraySlice(this.values,0),n=new(0,this.constructor)(this.name,e,t);return n.createInterpolant=this.createInterpolant,n}}],[{key:"toJSON",value:function(e){var t,n=e.constructor;if(n.toJSON!==this.toJSON)t=n.toJSON(e);else{t={name:e.name,times:nu.convertArray(e.times,Array),values:nu.convertArray(e.values,Array)};var r=e.getInterpolation();r!==e.DefaultInterpolation&&(t.interpolation=r)}return t.type=e.ValueTypeName,t}}]),e}();su.prototype.TimeBufferType=Float32Array,su.prototype.ValueBufferType=Float32Array,su.prototype.DefaultInterpolation=ne;var lu=function(e){(0,d.default)(n,e);var t=b(n);function n(){return(0,v.default)(this,n),t.apply(this,arguments)}return(0,m.default)(n)}(su);lu.prototype.ValueTypeName="bool",lu.prototype.ValueBufferType=Array,lu.prototype.DefaultInterpolation=te,lu.prototype.InterpolantFactoryMethodLinear=void 0,lu.prototype.InterpolantFactoryMethodSmooth=void 0;var uu=function(e){(0,d.default)(n,e);var t=b(n);function n(){return(0,v.default)(this,n),t.apply(this,arguments)}return(0,m.default)(n)}(su);uu.prototype.ValueTypeName="color";var cu=function(e){(0,d.default)(n,e);var t=b(n);function n(){return(0,v.default)(this,n),t.apply(this,arguments)}return(0,m.default)(n)}(su);cu.prototype.ValueTypeName="number";var hu=function(e){(0,d.default)(n,e);var t=b(n);function n(e,r,i,a){return(0,v.default)(this,n),t.call(this,e,r,i,a)}return(0,m.default)(n,[{key:"interpolate_",value:function(e,t,n,r){for(var i=this.resultBuffer,a=this.sampleValues,o=this.valueSize,s=(n-t)/(r-t),l=e*o,u=l+o;l!==u;l+=4)je.slerpFlat(i,0,a,l-o,a,l,s);return i}}]),n}(ru),du=function(e){(0,d.default)(n,e);var t=b(n);function n(){return(0,v.default)(this,n),t.apply(this,arguments)}return(0,m.default)(n,[{key:"InterpolantFactoryMethodLinear",value:function(e){return new hu(this.times,this.values,this.getValueSize(),e)}}]),n}(su);du.prototype.ValueTypeName="quaternion",du.prototype.DefaultInterpolation=ne,du.prototype.InterpolantFactoryMethodSmooth=void 0;var fu=function(e){(0,d.default)(n,e);var t=b(n);function n(){return(0,v.default)(this,n),t.apply(this,arguments)}return(0,m.default)(n)}(su);fu.prototype.ValueTypeName="string",fu.prototype.ValueBufferType=Array,fu.prototype.DefaultInterpolation=te,fu.prototype.InterpolantFactoryMethodLinear=void 0,fu.prototype.InterpolantFactoryMethodSmooth=void 0;var pu=function(e){(0,d.default)(n,e);var t=b(n);function n(){return(0,v.default)(this,n),t.apply(this,arguments)}return(0,m.default)(n)}(su);pu.prototype.ValueTypeName="vector";var vu=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,r=arguments.length>2?arguments[2]:void 0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:se;(0,v.default)(this,e),this.name=t,this.tracks=r,this.duration=n,this.blendMode=i,this.uuid=Ee(),this.duration<0&&this.resetDuration()}return(0,m.default)(e,[{key:"resetDuration",value:function(){for(var e=0,t=0,n=this.tracks.length;t!==n;++t){var r=this.tracks[t];e=Math.max(e,r.times[r.times.length-1])}return this.duration=e,this}},{key:"trim",value:function(){for(var e=0;e<this.tracks.length;e++)this.tracks[e].trim(0,this.duration);return this}},{key:"validate",value:function(){for(var e=!0,t=0;t<this.tracks.length;t++)e=e&&this.tracks[t].validate();return e}},{key:"optimize",value:function(){for(var e=0;e<this.tracks.length;e++)this.tracks[e].optimize();return this}},{key:"clone",value:function(){for(var e=[],t=0;t<this.tracks.length;t++)e.push(this.tracks[t].clone());return new this.constructor(this.name,this.duration,e,this.blendMode)}},{key:"toJSON",value:function(){return this.constructor.toJSON(this)}}],[{key:"parse",value:function(e){for(var t=[],n=e.tracks,r=1/(e.fps||1),i=0,a=n.length;i!==a;++i)t.push(mu(n[i]).scale(r));var o=new this(e.name,e.duration,t,e.blendMode);return o.uuid=e.uuid,o}},{key:"toJSON",value:function(e){for(var t=[],n=e.tracks,r={name:e.name,duration:e.duration,tracks:t,uuid:e.uuid,blendMode:e.blendMode},i=0,a=n.length;i!==a;++i)t.push(su.toJSON(n[i]));return r}},{key:"CreateFromMorphTargetSequence",value:function(e,t,n,r){for(var i=t.length,a=[],o=0;o<i;o++){var s=[],l=[];s.push((o+i-1)%i,o,(o+1)%i),l.push(0,1,0);var u=nu.getKeyframeOrder(s);s=nu.sortedArray(s,1,u),l=nu.sortedArray(l,1,u),r||0!==s[0]||(s.push(i),l.push(l[0])),a.push(new cu(".morphTargetInfluences["+t[o].name+"]",s,l).scale(1/n))}return new this(e,-1,a)}},{key:"findByName",value:function(e,t){var n=e;if(!Array.isArray(e)){var r=e;n=r.geometry&&r.geometry.animations||r.animations}for(var i=0;i<n.length;i++)if(n[i].name===t)return n[i];return null}},{key:"CreateClipsFromMorphTargetSequences",value:function(e,t,n){for(var r={},i=/^([\w-]*?)([\d]+)$/,a=0,o=e.length;a<o;a++){var s=e[a],l=s.name.match(i);if(l&&l.length>1){var u=l[1],c=r[u];c||(r[u]=c=[]),c.push(s)}}var h=[];for(var d in r)h.push(this.CreateFromMorphTargetSequence(d,r[d],t,n));return h}},{key:"parseAnimation",value:function(e,t){if(!e)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;for(var n=function(e,t,n,r,i){if(0!==n.length){var a=[],o=[];nu.flattenJSON(n,a,o,r),0!==a.length&&i.push(new e(t,a,o))}},r=[],i=e.name||"default",a=e.fps||30,o=e.blendMode,s=e.length||-1,l=e.hierarchy||[],u=0;u<l.length;u++){var c=l[u].keys;if(c&&0!==c.length)if(c[0].morphTargets){var h={},d=void 0;for(d=0;d<c.length;d++)if(c[d].morphTargets)for(var f=0;f<c[d].morphTargets.length;f++)h[c[d].morphTargets[f]]=-1;for(var p in h){for(var v=[],m=[],g=0;g!==c[d].morphTargets.length;++g){var _=c[d];v.push(_.time),m.push(_.morphTarget===p?1:0)}r.push(new cu(".morphTargetInfluence["+p+"]",v,m))}s=h.length*(a||1)}else{var y=".bones["+t[u].name+"]";n(pu,y+".position",c,"pos",r),n(du,y+".quaternion",c,"rot",r),n(pu,y+".scale",c,"scl",r)}}return 0===r.length?null:new this(i,s,r,o)}}]),e}();function mu(e){if(void 0===e.type)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");var t=function(e){switch(e.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return cu;case"vector":case"vector2":case"vector3":case"vector4":return pu;case"color":return uu;case"quaternion":return du;case"bool":case"boolean":return lu;case"string":return fu}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+e)}(e.type);if(void 0===e.times){var n=[],r=[];nu.flattenJSON(e.keys,n,r,"value"),e.times=n,e.values=r}return void 0!==t.parse?t.parse(e):new t(e.name,e.times,e.values,e.interpolation)}var gu={enabled:!1,files:{},add:function(e,t){!1!==this.enabled&&(this.files[e]=t)},get:function(e){if(!1!==this.enabled)return this.files[e]},remove:function(e){delete this.files[e]},clear:function(){this.files={}}},_u=(0,m.default)((function e(t,n,r){(0,v.default)(this,e);var i=this,a=!1,o=0,s=0,l=void 0,u=[];this.onStart=void 0,this.onLoad=t,this.onProgress=n,this.onError=r,this.itemStart=function(e){s++,!1===a&&void 0!==i.onStart&&i.onStart(e,o,s),a=!0},this.itemEnd=function(e){o++,void 0!==i.onProgress&&i.onProgress(e,o,s),o===s&&(a=!1,void 0!==i.onLoad&&i.onLoad())},this.itemError=function(e){void 0!==i.onError&&i.onError(e)},this.resolveURL=function(e){return l?l(e):e},this.setURLModifier=function(e){return l=e,this},this.addHandler=function(e,t){return u.push(e,t),this},this.removeHandler=function(e){var t=u.indexOf(e);return-1!==t&&u.splice(t,2),this},this.getHandler=function(e){for(var t=0,n=u.length;t<n;t+=2){var r=u[t],i=u[t+1];if(r.global&&(r.lastIndex=0),r.test(e))return i}return null}})),yu=new _u,xu=function(){function e(t){(0,v.default)(this,e),this.manager=void 0!==t?t:yu,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}return(0,m.default)(e,[{key:"load",value:function(){}},{key:"loadAsync",value:function(e,t){var n=this;return new Promise((function(r,i){n.load(e,r,t,i)}))}},{key:"parse",value:function(){}},{key:"setCrossOrigin",value:function(e){return this.crossOrigin=e,this}},{key:"setWithCredentials",value:function(e){return this.withCredentials=e,this}},{key:"setPath",value:function(e){return this.path=e,this}},{key:"setResourcePath",value:function(e){return this.resourcePath=e,this}},{key:"setRequestHeader",value:function(e){return this.requestHeader=e,this}}]),e}(),bu={},wu=function(e){(0,d.default)(n,e);var t=b(n);function n(e){return(0,v.default)(this,n),t.call(this,e)}return(0,m.default)(n,[{key:"load",value:function(e,t,n,r){void 0===e&&(e=""),void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);var i=this,a=gu.get(e);if(void 0!==a)return i.manager.itemStart(e),setTimeout((function(){t&&t(a),i.manager.itemEnd(e)}),0),a;if(void 0===bu[e]){var o,s=e.match(/^data:(.*?)(;base64)?,(.*)$/);if(s){var l=s[1],u=!!s[2],c=s[3];c=decodeURIComponent(c),u&&(c=atob(c));try{var h,d=(this.responseType||"").toLowerCase();switch(d){case"arraybuffer":case"blob":for(var f=new Uint8Array(c.length),p=0;p<c.length;p++)f[p]=c.charCodeAt(p);h="blob"===d?new Blob([f.buffer],{type:l}):f.buffer;break;case"document":var v=new DOMParser;h=v.parseFromString(c,l);break;case"json":h=JSON.parse(c);break;default:h=c}setTimeout((function(){t&&t(h),i.manager.itemEnd(e)}),0)}catch(t){setTimeout((function(){r&&r(t),i.manager.itemError(e),i.manager.itemEnd(e)}),0)}}else{for(var m in bu[e]=[],bu[e].push({onLoad:t,onProgress:n,onError:r}),(o=new XMLHttpRequest).open("GET",e,!0),o.addEventListener("load",(function(t){var n=this.response,r=bu[e];if(delete bu[e],200===this.status||0===this.status){0===this.status&&console.warn("THREE.FileLoader: HTTP Status 0 received."),gu.add(e,n);for(var a=0,o=r.length;a<o;a++){var s=r[a];s.onLoad&&s.onLoad(n)}i.manager.itemEnd(e)}else{for(var l=0,u=r.length;l<u;l++){var c=r[l];c.onError&&c.onError(t)}i.manager.itemError(e),i.manager.itemEnd(e)}}),!1),o.addEventListener("progress",(function(t){for(var n=bu[e],r=0,i=n.length;r<i;r++){var a=n[r];a.onProgress&&a.onProgress(t)}}),!1),o.addEventListener("error",(function(t){var n=bu[e];delete bu[e];for(var r=0,a=n.length;r<a;r++){var o=n[r];o.onError&&o.onError(t)}i.manager.itemError(e),i.manager.itemEnd(e)}),!1),o.addEventListener("abort",(function(t){var n=bu[e];delete bu[e];for(var r=0,a=n.length;r<a;r++){var o=n[r];o.onError&&o.onError(t)}i.manager.itemError(e),i.manager.itemEnd(e)}),!1),void 0!==this.responseType&&(o.responseType=this.responseType),void 0!==this.withCredentials&&(o.withCredentials=this.withCredentials),o.overrideMimeType&&o.overrideMimeType(void 0!==this.mimeType?this.mimeType:"text/plain"),this.requestHeader)o.setRequestHeader(m,this.requestHeader[m]);o.send(null)}return i.manager.itemStart(e),o}bu[e].push({onLoad:t,onProgress:n,onError:r})}},{key:"setResponseType",value:function(e){return this.responseType=e,this}},{key:"setMimeType",value:function(e){return this.mimeType=e,this}}]),n}(xu),Tu=function(e){(0,d.default)(n,e);var t=b(n);function n(e){return(0,v.default)(this,n),t.call(this,e)}return(0,m.default)(n,[{key:"load",value:function(e,t,n,r){var i=this,a=new wu(this.manager);a.setPath(this.path),a.setRequestHeader(this.requestHeader),a.setWithCredentials(this.withCredentials),a.load(e,(function(n){try{t(i.parse(JSON.parse(n)))}catch(t){r?r(t):console.error(t),i.manager.itemError(e)}}),n,r)}},{key:"parse",value:function(e){for(var t=[],n=0;n<e.length;n++){var r=vu.parse(e[n]);t.push(r)}return t}}]),n}(xu),Mu=function(e){(0,d.default)(n,e);var t=b(n);function n(e){return(0,v.default)(this,n),t.call(this,e)}return(0,m.default)(n,[{key:"load",value:function(e,t,n,r){var i=this,a=[],o=new bs,s=new wu(this.manager);s.setPath(this.path),s.setResponseType("arraybuffer"),s.setRequestHeader(this.requestHeader),s.setWithCredentials(i.withCredentials);var l=0;function u(u){s.load(e[u],(function(e){var n=i.parse(e,!0);a[u]={width:n.width,height:n.height,format:n.format,mipmaps:n.mipmaps},6===(l+=1)&&(1===n.mipmapCount&&(o.minFilter=k),o.image=a,o.format=n.format,o.needsUpdate=!0,t&&t(o))}),n,r)}if(Array.isArray(e))for(var c=0,h=e.length;c<h;++c)u(c);else s.load(e,(function(e){var n=i.parse(e,!0);if(n.isCubemap){for(var r=n.mipmaps.length/n.mipmapCount,s=0;s<r;s++){a[s]={mipmaps:[]};for(var l=0;l<n.mipmapCount;l++)a[s].mipmaps.push(n.mipmaps[s*n.mipmapCount+l]),a[s].format=n.format,a[s].width=n.width,a[s].height=n.height}o.image=a}else o.image.width=n.width,o.image.height=n.height,o.mipmaps=n.mipmaps;1===n.mipmapCount&&(o.minFilter=k),o.format=n.format,o.needsUpdate=!0,t&&t(o)}),n,r);return o}}]),n}(xu),Su=function(e){(0,d.default)(n,e);var t=b(n);function n(e){return(0,v.default)(this,n),t.call(this,e)}return(0,m.default)(n,[{key:"load",value:function(e,t,n,r){void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);var i=this,a=gu.get(e);if(void 0!==a)return i.manager.itemStart(e),setTimeout((function(){t&&t(a),i.manager.itemEnd(e)}),0),a;var o=document.createElementNS("http://www.w3.org/1999/xhtml","img");function s(){o.removeEventListener("load",s,!1),o.removeEventListener("error",l,!1),gu.add(e,this),t&&t(this),i.manager.itemEnd(e)}function l(t){o.removeEventListener("load",s,!1),o.removeEventListener("error",l,!1),r&&r(t),i.manager.itemError(e),i.manager.itemEnd(e)}return o.addEventListener("load",s,!1),o.addEventListener("error",l,!1),"data:"!==e.substr(0,5)&&void 0!==this.crossOrigin&&(o.crossOrigin=this.crossOrigin),i.manager.itemStart(e),o.src=e,o}}]),n}(xu),Eu=function(e){(0,d.default)(n,e);var t=b(n);function n(e){return(0,v.default)(this,n),t.call(this,e)}return(0,m.default)(n,[{key:"load",value:function(e,t,n,r){var i=new vr,a=new Su(this.manager);a.setCrossOrigin(this.crossOrigin),a.setPath(this.path);var o=0;function s(n){a.load(e[n],(function(e){i.images[n]=e,6==++o&&(i.needsUpdate=!0,t&&t(i))}),void 0,r)}for(var l=0;l<e.length;++l)s(l);return i}}]),n}(xu),Au=function(e){(0,d.default)(n,e);var t=b(n);function n(e){return(0,v.default)(this,n),t.call(this,e)}return(0,m.default)(n,[{key:"load",value:function(e,t,n,r){var i=this,a=new Xo,o=new wu(this.manager);return o.setResponseType("arraybuffer"),o.setRequestHeader(this.requestHeader),o.setPath(this.path),o.setWithCredentials(i.withCredentials),o.load(e,(function(e){var n=i.parse(e);n&&(void 0!==n.image?a.image=n.image:void 0!==n.data&&(a.image.width=n.width,a.image.height=n.height,a.image.data=n.data),a.wrapS=void 0!==n.wrapS?n.wrapS:E,a.wrapT=void 0!==n.wrapT?n.wrapT:E,a.magFilter=void 0!==n.magFilter?n.magFilter:k,a.minFilter=void 0!==n.minFilter?n.minFilter:k,a.anisotropy=void 0!==n.anisotropy?n.anisotropy:1,void 0!==n.encoding&&(a.encoding=n.encoding),void 0!==n.flipY&&(a.flipY=n.flipY),void 0!==n.format&&(a.format=n.format),void 0!==n.type&&(a.type=n.type),void 0!==n.mipmaps&&(a.mipmaps=n.mipmaps,a.minFilter=D),1===n.mipmapCount&&(a.minFilter=k),void 0!==n.generateMipmaps&&(a.generateMipmaps=n.generateMipmaps),a.needsUpdate=!0,t&&t(a,n))}),n,r),a}}]),n}(xu),Lu=function(e){(0,d.default)(n,e);var t=b(n);function n(e){return(0,v.default)(this,n),t.call(this,e)}return(0,m.default)(n,[{key:"load",value:function(e,t,n,r){var i=new Be,a=new Su(this.manager);return a.setCrossOrigin(this.crossOrigin),a.setPath(this.path),a.load(e,(function(n){i.image=n;var r=e.search(/\.jpe?g($|\?)/i)>0||0===e.search(/^data\:image\/jpeg/);i.format=r?z:H,i.needsUpdate=!0,void 0!==t&&t(i)}),n,r),i}}]),n}(xu),Cu=function(e){(0,d.default)(n,e);var t=b(n);function n(){var e;return(0,v.default)(this,n),(e=t.call(this)).type="CurvePath",e.curves=[],e.autoClose=!1,e}return(0,m.default)(n,[{key:"add",value:function(e){this.curves.push(e)}},{key:"closePath",value:function(){var e=this.curves[0].getPoint(0),t=this.curves[this.curves.length-1].getPoint(1);e.equals(t)||this.curves.push(new Ys(t,e))}},{key:"getPoint",value:function(e){for(var t=e*this.getLength(),n=this.getCurveLengths(),r=0;r<n.length;){if(n[r]>=t){var i=n[r]-t,a=this.curves[r],o=a.getLength(),s=0===o?0:1-i/o;return a.getPointAt(s)}r++}return null}},{key:"getLength",value:function(){var e=this.getCurveLengths();return e[e.length-1]}},{key:"updateArcLengths",value:function(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()}},{key:"getCurveLengths",value:function(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;for(var e=[],t=0,n=0,r=this.curves.length;n<r;n++)t+=this.curves[n].getLength(),e.push(t);return this.cacheLengths=e,e}},{key:"getSpacedPoints",value:function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:40,t=[],n=0;n<=e;n++)t.push(this.getPoint(n/e));return this.autoClose&&t.push(t[0]),t}},{key:"getPoints",value:function(){for(var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:12,n=[],r=0,i=this.curves;r<i.length;r++)for(var a=i[r],o=a&&a.isEllipseCurve?2*t:a&&(a.isLineCurve||a.isLineCurve3)?1:a&&a.isSplineCurve?t*a.points.length:t,s=a.getPoints(o),l=0;l<s.length;l++){var u=s[l];e&&e.equals(u)||(n.push(u),e=u)}return this.autoClose&&n.length>1&&!n[n.length-1].equals(n[0])&&n.push(n[0]),n}},{key:"copy",value:function(e){(0,u.default)((0,p.default)(n.prototype),"copy",this).call(this,e),this.curves=[];for(var t=0,r=e.curves.length;t<r;t++){var i=e.curves[t];this.curves.push(i.clone())}return this.autoClose=e.autoClose,this}},{key:"toJSON",value:function(){var e=(0,u.default)((0,p.default)(n.prototype),"toJSON",this).call(this);e.autoClose=this.autoClose,e.curves=[];for(var t=0,r=this.curves.length;t<r;t++){var i=this.curves[t];e.curves.push(i.toJSON())}return e}},{key:"fromJSON",value:function(e){(0,u.default)((0,p.default)(n.prototype),"fromJSON",this).call(this,e),this.autoClose=e.autoClose,this.curves=[];for(var t=0,r=e.curves.length;t<r;t++){var i=e.curves[t];this.curves.push((new $s[i.type]).fromJSON(i))}return this}}]),n}(Is),Ru=function(e){(0,d.default)(n,e);var t=b(n);function n(e){var r;return(0,v.default)(this,n),(r=t.call(this)).type="Path",r.currentPoint=new Ie,e&&r.setFromPoints(e),r}return(0,m.default)(n,[{key:"setFromPoints",value:function(e){this.moveTo(e[0].x,e[0].y);for(var t=1,n=e.length;t<n;t++)this.lineTo(e[t].x,e[t].y);return this}},{key:"moveTo",value:function(e,t){return this.currentPoint.set(e,t),this}},{key:"lineTo",value:function(e,t){var n=new Ys(this.currentPoint.clone(),new Ie(e,t));return this.curves.push(n),this.currentPoint.set(e,t),this}},{key:"quadraticCurveTo",value:function(e,t,n,r){var i=new Zs(this.currentPoint.clone(),new Ie(e,t),new Ie(n,r));return this.curves.push(i),this.currentPoint.set(n,r),this}},{key:"bezierCurveTo",value:function(e,t,n,r,i,a){var o=new qs(this.currentPoint.clone(),new Ie(e,t),new Ie(n,r),new Ie(i,a));return this.curves.push(o),this.currentPoint.set(i,a),this}},{key:"splineThru",value:function(e){var t=[this.currentPoint.clone()].concat(e),n=new Qs(t);return this.curves.push(n),this.currentPoint.copy(e[e.length-1]),this}},{key:"arc",value:function(e,t,n,r,i,a){var o=this.currentPoint.x,s=this.currentPoint.y;return this.absarc(e+o,t+s,n,r,i,a),this}},{key:"absarc",value:function(e,t,n,r,i,a){return this.absellipse(e,t,n,n,r,i,a),this}},{key:"ellipse",value:function(e,t,n,r,i,a,o,s){var l=this.currentPoint.x,u=this.currentPoint.y;return this.absellipse(e+l,t+u,n,r,i,a,o,s),this}},{key:"absellipse",value:function(e,t,n,r,i,a,o,s){var l=new Os(e,t,n,r,i,a,o,s);if(this.curves.length>0){var u=l.getPoint(0);u.equals(this.currentPoint)||this.lineTo(u.x,u.y)}this.curves.push(l);var c=l.getPoint(1);return this.currentPoint.copy(c),this}},{key:"copy",value:function(e){return(0,u.default)((0,p.default)(n.prototype),"copy",this).call(this,e),this.currentPoint.copy(e.currentPoint),this}},{key:"toJSON",value:function(){var e=(0,u.default)((0,p.default)(n.prototype),"toJSON",this).call(this);return e.currentPoint=this.currentPoint.toArray(),e}},{key:"fromJSON",value:function(e){return(0,u.default)((0,p.default)(n.prototype),"fromJSON",this).call(this,e),this.currentPoint.fromArray(e.currentPoint),this}}]),n}(Cu),ku=function(e){(0,d.default)(n,e);var t=b(n);function n(e){var r;return(0,v.default)(this,n),(r=t.call(this,e)).uuid=Ee(),r.type="Shape",r.holes=[],r}return(0,m.default)(n,[{key:"getPointsHoles",value:function(e){for(var t=[],n=0,r=this.holes.length;n<r;n++)t[n]=this.holes[n].getPoints(e);return t}},{key:"extractPoints",value:function(e){return{shape:this.getPoints(e),holes:this.getPointsHoles(e)}}},{key:"copy",value:function(e){(0,u.default)((0,p.default)(n.prototype),"copy",this).call(this,e),this.holes=[];for(var t=0,r=e.holes.length;t<r;t++){var i=e.holes[t];this.holes.push(i.clone())}return this}},{key:"toJSON",value:function(){var e=(0,u.default)((0,p.default)(n.prototype),"toJSON",this).call(this);e.uuid=this.uuid,e.holes=[];for(var t=0,r=this.holes.length;t<r;t++){var i=this.holes[t];e.holes.push(i.toJSON())}return e}},{key:"fromJSON",value:function(e){(0,u.default)((0,p.default)(n.prototype),"fromJSON",this).call(this,e),this.uuid=e.uuid,this.holes=[];for(var t=0,r=e.holes.length;t<r;t++){var i=e.holes[t];this.holes.push((new Ru).fromJSON(i))}return this}}]),n}(Ru),Pu=function(e){(0,d.default)(n,e);var t=b(n);function n(e){var r,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return(0,v.default)(this,n),(r=t.call(this)).type="Light",r.color=new vn(e),r.intensity=i,r}return(0,m.default)(n,[{key:"dispose",value:function(){}},{key:"copy",value:function(e){return(0,u.default)((0,p.default)(n.prototype),"copy",this).call(this,e),this.color.copy(e.color),this.intensity=e.intensity,this}},{key:"toJSON",value:function(e){var t=(0,u.default)((0,p.default)(n.prototype),"toJSON",this).call(this,e);return t.object.color=this.color.getHex(),t.object.intensity=this.intensity,void 0!==this.groundColor&&(t.object.groundColor=this.groundColor.getHex()),void 0!==this.distance&&(t.object.distance=this.distance),void 0!==this.angle&&(t.object.angle=this.angle),void 0!==this.decay&&(t.object.decay=this.decay),void 0!==this.penumbra&&(t.object.penumbra=this.penumbra),void 0!==this.shadow&&(t.object.shadow=this.shadow.toJSON()),t}}]),n}(Yt);Pu.prototype.isLight=!0;var Du=function(e){(0,d.default)(n,e);var t=b(n);function n(e,r,i){var a;return(0,v.default)(this,n),(a=t.call(this,e,i)).type="HemisphereLight",a.position.copy(Yt.DefaultUp),a.updateMatrix(),a.groundColor=new vn(r),a}return(0,m.default)(n,[{key:"copy",value:function(e){return Pu.prototype.copy.call(this,e),this.groundColor.copy(e.groundColor),this}}]),n}(Pu);Du.prototype.isHemisphereLight=!0;var Iu=new Tt,Ou=new qe,Fu=new qe,Nu=function(){function e(t){(0,v.default)(this,e),this.camera=t,this.bias=0,this.normalBias=0,this.radius=1,this.mapSize=new Ie(512,512),this.map=null,this.mapPass=null,this.matrix=new Tt,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new Tr,this._frameExtents=new Ie(1,1),this._viewportCount=1,this._viewports=[new He(0,0,1,1)]}return(0,m.default)(e,[{key:"getViewportCount",value:function(){return this._viewportCount}},{key:"getFrustum",value:function(){return this._frustum}},{key:"updateMatrices",value:function(e){var t=this.camera,n=this.matrix;Ou.setFromMatrixPosition(e.matrixWorld),t.position.copy(Ou),Fu.setFromMatrixPosition(e.target.matrixWorld),t.lookAt(Fu),t.updateMatrixWorld(),Iu.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),this._frustum.setFromProjectionMatrix(Iu),n.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),n.multiply(t.projectionMatrix),n.multiply(t.matrixWorldInverse)}},{key:"getViewport",value:function(e){return this._viewports[e]}},{key:"getFrameExtents",value:function(){return this._frameExtents}},{key:"dispose",value:function(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}},{key:"copy",value:function(e){return this.camera=e.camera.clone(),this.bias=e.bias,this.radius=e.radius,this.mapSize.copy(e.mapSize),this}},{key:"clone",value:function(){return(new this.constructor).copy(this)}},{key:"toJSON",value:function(){var e={};return 0!==this.bias&&(e.bias=this.bias),0!==this.normalBias&&(e.normalBias=this.normalBias),1!==this.radius&&(e.radius=this.radius),512===this.mapSize.x&&512===this.mapSize.y||(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}}]),e}(),Uu=function(e){(0,d.default)(n,e);var t=b(n);function n(){var e;return(0,v.default)(this,n),(e=t.call(this,new dr(50,1,.5,500))).focus=1,e}return(0,m.default)(n,[{key:"updateMatrices",value:function(e){var t=this.camera,r=2*Se*e.angle*this.focus,i=this.mapSize.width/this.mapSize.height,a=e.distance||t.far;r===t.fov&&i===t.aspect&&a===t.far||(t.fov=r,t.aspect=i,t.far=a,t.updateProjectionMatrix()),(0,u.default)((0,p.default)(n.prototype),"updateMatrices",this).call(this,e)}},{key:"copy",value:function(e){return(0,u.default)((0,p.default)(n.prototype),"copy",this).call(this,e),this.focus=e.focus,this}}]),n}(Nu);Uu.prototype.isSpotLightShadow=!0;var Bu=function(e){(0,d.default)(n,e);var t=b(n);function n(e,r){var i,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Math.PI/3,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,l=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1;return(0,v.default)(this,n),(i=t.call(this,e,r)).type="SpotLight",i.position.copy(Yt.DefaultUp),i.updateMatrix(),i.target=new Yt,i.distance=a,i.angle=o,i.penumbra=s,i.decay=l,i.shadow=new Uu,i}return(0,m.default)(n,[{key:"power",get:function(){return this.intensity*Math.PI},set:function(e){this.intensity=e/Math.PI}},{key:"dispose",value:function(){this.shadow.dispose()}},{key:"copy",value:function(e){return(0,u.default)((0,p.default)(n.prototype),"copy",this).call(this,e),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}]),n}(Pu);Bu.prototype.isSpotLight=!0;var zu=new Tt,Hu=new qe,Gu=new qe,Vu=function(e){(0,d.default)(n,e);var t=b(n);function n(){var e;return(0,v.default)(this,n),(e=t.call(this,new dr(90,1,.5,500)))._frameExtents=new Ie(4,2),e._viewportCount=6,e._viewports=[new He(2,1,1,1),new He(0,1,1,1),new He(3,1,1,1),new He(1,1,1,1),new He(3,0,1,1),new He(1,0,1,1)],e._cubeDirections=[new qe(1,0,0),new qe(-1,0,0),new qe(0,0,1),new qe(0,0,-1),new qe(0,1,0),new qe(0,-1,0)],e._cubeUps=[new qe(0,1,0),new qe(0,1,0),new qe(0,1,0),new qe(0,1,0),new qe(0,0,1),new qe(0,0,-1)],e}return(0,m.default)(n,[{key:"updateMatrices",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=this.camera,r=this.matrix,i=e.distance||n.far;i!==n.far&&(n.far=i,n.updateProjectionMatrix()),Hu.setFromMatrixPosition(e.matrixWorld),n.position.copy(Hu),Gu.copy(n.position),Gu.add(this._cubeDirections[t]),n.up.copy(this._cubeUps[t]),n.lookAt(Gu),n.updateMatrixWorld(),r.makeTranslation(-Hu.x,-Hu.y,-Hu.z),zu.multiplyMatrices(n.projectionMatrix,n.matrixWorldInverse),this._frustum.setFromProjectionMatrix(zu)}}]),n}(Nu);Vu.prototype.isPointLightShadow=!0;var Wu=function(e){(0,d.default)(n,e);var t=b(n);function n(e,r){var i,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;return(0,v.default)(this,n),(i=t.call(this,e,r)).type="PointLight",i.distance=a,i.decay=o,i.shadow=new Vu,i}return(0,m.default)(n,[{key:"power",get:function(){return 4*this.intensity*Math.PI},set:function(e){this.intensity=e/(4*Math.PI)}},{key:"dispose",value:function(){this.shadow.dispose()}},{key:"copy",value:function(e){return(0,u.default)((0,p.default)(n.prototype),"copy",this).call(this,e),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}}]),n}(Pu);Wu.prototype.isPointLight=!0;var ju=function(e){(0,d.default)(n,e);var t=b(n);function n(){return(0,v.default)(this,n),t.call(this,new Fr(-5,5,5,-5,.5,500))}return(0,m.default)(n)}(Nu);ju.prototype.isDirectionalLightShadow=!0;var qu=function(e){(0,d.default)(n,e);var t=b(n);function n(e,r){var i;return(0,v.default)(this,n),(i=t.call(this,e,r)).type="DirectionalLight",i.position.copy(Yt.DefaultUp),i.updateMatrix(),i.target=new Yt,i.shadow=new ju,i}return(0,m.default)(n,[{key:"dispose",value:function(){this.shadow.dispose()}},{key:"copy",value:function(e){return(0,u.default)((0,p.default)(n.prototype),"copy",this).call(this,e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}]),n}(Pu);qu.prototype.isDirectionalLight=!0;var Xu=function(e){(0,d.default)(n,e);var t=b(n);function n(e,r){var i;return(0,v.default)(this,n),(i=t.call(this,e,r)).type="AmbientLight",i}return(0,m.default)(n)}(Pu);Xu.prototype.isAmbientLight=!0;var Yu=function(e){(0,d.default)(n,e);var t=b(n);function n(e,r){var i,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:10,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:10;return(0,v.default)(this,n),(i=t.call(this,e,r)).type="RectAreaLight",i.width=a,i.height=o,i}return(0,m.default)(n,[{key:"copy",value:function(e){return(0,u.default)((0,p.default)(n.prototype),"copy",this).call(this,e),this.width=e.width,this.height=e.height,this}},{key:"toJSON",value:function(e){var t=(0,u.default)((0,p.default)(n.prototype),"toJSON",this).call(this,e);return t.object.width=this.width,t.object.height=this.height,t}}]),n}(Pu);Yu.prototype.isRectAreaLight=!0;var Ku=function(){function e(){(0,v.default)(this,e),this.coefficients=[];for(var t=0;t<9;t++)this.coefficients.push(new qe)}return(0,m.default)(e,[{key:"set",value:function(e){for(var t=0;t<9;t++)this.coefficients[t].copy(e[t]);return this}},{key:"zero",value:function(){for(var e=0;e<9;e++)this.coefficients[e].set(0,0,0);return this}},{key:"getAt",value:function(e,t){var n=e.x,r=e.y,i=e.z,a=this.coefficients;return t.copy(a[0]).multiplyScalar(.282095),t.addScaledVector(a[1],.488603*r),t.addScaledVector(a[2],.488603*i),t.addScaledVector(a[3],.488603*n),t.addScaledVector(a[4],n*r*1.092548),t.addScaledVector(a[5],r*i*1.092548),t.addScaledVector(a[6],.315392*(3*i*i-1)),t.addScaledVector(a[7],n*i*1.092548),t.addScaledVector(a[8],.546274*(n*n-r*r)),t}},{key:"getIrradianceAt",value:function(e,t){var n=e.x,r=e.y,i=e.z,a=this.coefficients;return t.copy(a[0]).multiplyScalar(.886227),t.addScaledVector(a[1],1.023328*r),t.addScaledVector(a[2],1.023328*i),t.addScaledVector(a[3],1.023328*n),t.addScaledVector(a[4],.858086*n*r),t.addScaledVector(a[5],.858086*r*i),t.addScaledVector(a[6],.743125*i*i-.247708),t.addScaledVector(a[7],.858086*n*i),t.addScaledVector(a[8],.429043*(n*n-r*r)),t}},{key:"add",value:function(e){for(var t=0;t<9;t++)this.coefficients[t].add(e.coefficients[t]);return this}},{key:"addScaledSH",value:function(e,t){for(var n=0;n<9;n++)this.coefficients[n].addScaledVector(e.coefficients[n],t);return this}},{key:"scale",value:function(e){for(var t=0;t<9;t++)this.coefficients[t].multiplyScalar(e);return this}},{key:"lerp",value:function(e,t){for(var n=0;n<9;n++)this.coefficients[n].lerp(e.coefficients[n],t);return this}},{key:"equals",value:function(e){for(var t=0;t<9;t++)if(!this.coefficients[t].equals(e.coefficients[t]))return!1;return!0}},{key:"copy",value:function(e){return this.set(e.coefficients)}},{key:"clone",value:function(){return(new this.constructor).copy(this)}},{key:"fromArray",value:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=this.coefficients,r=0;r<9;r++)n[r].fromArray(e,t+3*r);return this}},{key:"toArray",value:function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=this.coefficients,r=0;r<9;r++)n[r].toArray(e,t+3*r);return e}}],[{key:"getBasisAt",value:function(e,t){var n=e.x,r=e.y,i=e.z;t[0]=.282095,t[1]=.488603*r,t[2]=.488603*i,t[3]=.488603*n,t[4]=1.092548*n*r,t[5]=1.092548*r*i,t[6]=.315392*(3*i*i-1),t[7]=1.092548*n*i,t[8]=.546274*(n*n-r*r)}}]),e}();Ku.prototype.isSphericalHarmonics3=!0;var Zu=function(e){(0,d.default)(n,e);var t=b(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Ku,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return(0,v.default)(this,n),(e=t.call(this,void 0,i)).sh=r,e}return(0,m.default)(n,[{key:"copy",value:function(e){return(0,u.default)((0,p.default)(n.prototype),"copy",this).call(this,e),this.sh.copy(e.sh),this}},{key:"fromJSON",value:function(e){return this.intensity=e.intensity,this.sh.fromArray(e.sh),this}},{key:"toJSON",value:function(e){var t=(0,u.default)((0,p.default)(n.prototype),"toJSON",this).call(this,e);return t.object.sh=this.sh.toArray(),t}}]),n}(Pu);Zu.prototype.isLightProbe=!0;var Ju=function(e){(0,d.default)(n,e);var t=b(n);function n(e){var r;return(0,v.default)(this,n),(r=t.call(this,e)).textures={},r}return(0,m.default)(n,[{key:"load",value:function(e,t,n,r){var i=this,a=new wu(i.manager);a.setPath(i.path),a.setRequestHeader(i.requestHeader),a.setWithCredentials(i.withCredentials),a.load(e,(function(n){try{t(i.parse(JSON.parse(n)))}catch(t){r?r(t):console.error(t),i.manager.itemError(e)}}),n,r)}},{key:"parse",value:function(e){var t=this.textures;function n(e){return void 0===t[e]&&console.warn("THREE.MaterialLoader: Undefined texture",e),t[e]}var r=new tu[e.type];if(void 0!==e.uuid&&(r.uuid=e.uuid),void 0!==e.name&&(r.name=e.name),void 0!==e.color&&void 0!==r.color&&r.color.setHex(e.color),void 0!==e.roughness&&(r.roughness=e.roughness),void 0!==e.metalness&&(r.metalness=e.metalness),void 0!==e.sheen&&(r.sheen=(new vn).setHex(e.sheen)),void 0!==e.emissive&&void 0!==r.emissive&&r.emissive.setHex(e.emissive),void 0!==e.specular&&void 0!==r.specular&&r.specular.setHex(e.specular),void 0!==e.specularIntensity&&(r.specularIntensity=e.specularIntensity),void 0!==e.specularTint&&void 0!==r.specularTint&&r.specularTint.setHex(e.specularTint),void 0!==e.shininess&&(r.shininess=e.shininess),void 0!==e.clearcoat&&(r.clearcoat=e.clearcoat),void 0!==e.clearcoatRoughness&&(r.clearcoatRoughness=e.clearcoatRoughness),void 0!==e.transmission&&(r.transmission=e.transmission),void 0!==e.thickness&&(r.thickness=e.thickness),void 0!==e.attenuationDistance&&(r.attenuationDistance=e.attenuationDistance),void 0!==e.attenuationTint&&void 0!==r.attenuationTint&&r.attenuationTint.setHex(e.attenuationTint),void 0!==e.fog&&(r.fog=e.fog),void 0!==e.flatShading&&(r.flatShading=e.flatShading),void 0!==e.blending&&(r.blending=e.blending),void 0!==e.combine&&(r.combine=e.combine),void 0!==e.side&&(r.side=e.side),void 0!==e.shadowSide&&(r.shadowSide=e.shadowSide),void 0!==e.opacity&&(r.opacity=e.opacity),void 0!==e.transparent&&(r.transparent=e.transparent),void 0!==e.alphaTest&&(r.alphaTest=e.alphaTest),void 0!==e.depthTest&&(r.depthTest=e.depthTest),void 0!==e.depthWrite&&(r.depthWrite=e.depthWrite),void 0!==e.colorWrite&&(r.colorWrite=e.colorWrite),void 0!==e.stencilWrite&&(r.stencilWrite=e.stencilWrite),void 0!==e.stencilWriteMask&&(r.stencilWriteMask=e.stencilWriteMask),void 0!==e.stencilFunc&&(r.stencilFunc=e.stencilFunc),void 0!==e.stencilRef&&(r.stencilRef=e.stencilRef),void 0!==e.stencilFuncMask&&(r.stencilFuncMask=e.stencilFuncMask),void 0!==e.stencilFail&&(r.stencilFail=e.stencilFail),void 0!==e.stencilZFail&&(r.stencilZFail=e.stencilZFail),void 0!==e.stencilZPass&&(r.stencilZPass=e.stencilZPass),void 0!==e.wireframe&&(r.wireframe=e.wireframe),void 0!==e.wireframeLinewidth&&(r.wireframeLinewidth=e.wireframeLinewidth),void 0!==e.wireframeLinecap&&(r.wireframeLinecap=e.wireframeLinecap),void 0!==e.wireframeLinejoin&&(r.wireframeLinejoin=e.wireframeLinejoin),void 0!==e.rotation&&(r.rotation=e.rotation),1!==e.linewidth&&(r.linewidth=e.linewidth),void 0!==e.dashSize&&(r.dashSize=e.dashSize),void 0!==e.gapSize&&(r.gapSize=e.gapSize),void 0!==e.scale&&(r.scale=e.scale),void 0!==e.polygonOffset&&(r.polygonOffset=e.polygonOffset),void 0!==e.polygonOffsetFactor&&(r.polygonOffsetFactor=e.polygonOffsetFactor),void 0!==e.polygonOffsetUnits&&(r.polygonOffsetUnits=e.polygonOffsetUnits),void 0!==e.dithering&&(r.dithering=e.dithering),void 0!==e.alphaToCoverage&&(r.alphaToCoverage=e.alphaToCoverage),void 0!==e.premultipliedAlpha&&(r.premultipliedAlpha=e.premultipliedAlpha),void 0!==e.visible&&(r.visible=e.visible),void 0!==e.toneMapped&&(r.toneMapped=e.toneMapped),void 0!==e.userData&&(r.userData=e.userData),void 0!==e.vertexColors&&("number"==typeof e.vertexColors?r.vertexColors=e.vertexColors>0:r.vertexColors=e.vertexColors),void 0!==e.uniforms)for(var i in e.uniforms){var a=e.uniforms[i];switch(r.uniforms[i]={},a.type){case"t":r.uniforms[i].value=n(a.value);break;case"c":r.uniforms[i].value=(new vn).setHex(a.value);break;case"v2":r.uniforms[i].value=(new Ie).fromArray(a.value);break;case"v3":r.uniforms[i].value=(new qe).fromArray(a.value);break;case"v4":r.uniforms[i].value=(new He).fromArray(a.value);break;case"m3":r.uniforms[i].value=(new Fe).fromArray(a.value);break;case"m4":r.uniforms[i].value=(new Tt).fromArray(a.value);break;default:r.uniforms[i].value=a.value}}if(void 0!==e.defines&&(r.defines=e.defines),void 0!==e.vertexShader&&(r.vertexShader=e.vertexShader),void 0!==e.fragmentShader&&(r.fragmentShader=e.fragmentShader),void 0!==e.extensions)for(var o in e.extensions)r.extensions[o]=e.extensions[o];if(void 0!==e.shading&&(r.flatShading=1===e.shading),void 0!==e.size&&(r.size=e.size),void 0!==e.sizeAttenuation&&(r.sizeAttenuation=e.sizeAttenuation),void 0!==e.map&&(r.map=n(e.map)),void 0!==e.matcap&&(r.matcap=n(e.matcap)),void 0!==e.alphaMap&&(r.alphaMap=n(e.alphaMap)),void 0!==e.bumpMap&&(r.bumpMap=n(e.bumpMap)),void 0!==e.bumpScale&&(r.bumpScale=e.bumpScale),void 0!==e.normalMap&&(r.normalMap=n(e.normalMap)),void 0!==e.normalMapType&&(r.normalMapType=e.normalMapType),void 0!==e.normalScale){var s=e.normalScale;!1===Array.isArray(s)&&(s=[s,s]),r.normalScale=(new Ie).fromArray(s)}return void 0!==e.displacementMap&&(r.displacementMap=n(e.displacementMap)),void 0!==e.displacementScale&&(r.displacementScale=e.displacementScale),void 0!==e.displacementBias&&(r.displacementBias=e.displacementBias),void 0!==e.roughnessMap&&(r.roughnessMap=n(e.roughnessMap)),void 0!==e.metalnessMap&&(r.metalnessMap=n(e.metalnessMap)),void 0!==e.emissiveMap&&(r.emissiveMap=n(e.emissiveMap)),void 0!==e.emissiveIntensity&&(r.emissiveIntensity=e.emissiveIntensity),void 0!==e.specularMap&&(r.specularMap=n(e.specularMap)),void 0!==e.specularIntensityMap&&(r.specularIntensityMap=n(e.specularIntensityMap)),void 0!==e.specularTintMap&&(r.specularTintMap=n(e.specularTintMap)),void 0!==e.envMap&&(r.envMap=n(e.envMap)),void 0!==e.envMapIntensity&&(r.envMapIntensity=e.envMapIntensity),void 0!==e.reflectivity&&(r.reflectivity=e.reflectivity),void 0!==e.refractionRatio&&(r.refractionRatio=e.refractionRatio),void 0!==e.lightMap&&(r.lightMap=n(e.lightMap)),void 0!==e.lightMapIntensity&&(r.lightMapIntensity=e.lightMapIntensity),void 0!==e.aoMap&&(r.aoMap=n(e.aoMap)),void 0!==e.aoMapIntensity&&(r.aoMapIntensity=e.aoMapIntensity),void 0!==e.gradientMap&&(r.gradientMap=n(e.gradientMap)),void 0!==e.clearcoatMap&&(r.clearcoatMap=n(e.clearcoatMap)),void 0!==e.clearcoatRoughnessMap&&(r.clearcoatRoughnessMap=n(e.clearcoatRoughnessMap)),void 0!==e.clearcoatNormalMap&&(r.clearcoatNormalMap=n(e.clearcoatNormalMap)),void 0!==e.clearcoatNormalScale&&(r.clearcoatNormalScale=(new Ie).fromArray(e.clearcoatNormalScale)),void 0!==e.transmissionMap&&(r.transmissionMap=n(e.transmissionMap)),void 0!==e.thicknessMap&&(r.thicknessMap=n(e.thicknessMap)),r}},{key:"setTextures",value:function(e){return this.textures=e,this}}]),n}(xu),Qu=function(){function e(){(0,v.default)(this,e)}return(0,m.default)(e,null,[{key:"decodeText",value:function(e){if("undefined"!=typeof TextDecoder)return(new TextDecoder).decode(e);for(var t="",n=0,r=e.length;n<r;n++)t+=String.fromCharCode(e[n]);try{return decodeURIComponent(escape(t))}catch(e){return t}}},{key:"extractUrlBase",value:function(e){var t=e.lastIndexOf("/");return-1===t?"./":e.substr(0,t+1)}}]),e}(),$u=function(e){(0,d.default)(n,e);var t=b(n);function n(){var e;return(0,v.default)(this,n),(e=t.call(this)).type="InstancedBufferGeometry",e.instanceCount=1/0,e}return(0,m.default)(n,[{key:"copy",value:function(e){return(0,u.default)((0,p.default)(n.prototype),"copy",this).call(this,e),this.instanceCount=e.instanceCount,this}},{key:"clone",value:function(){return(new this.constructor).copy(this)}},{key:"toJSON",value:function(){var e=(0,u.default)((0,p.default)(n.prototype),"toJSON",this).call(this,this);return e.instanceCount=this.instanceCount,e.isInstancedBufferGeometry=!0,e}}]),n}(zn);$u.prototype.isInstancedBufferGeometry=!0;var ec=function(e){(0,d.default)(n,e);var t=b(n);function n(e,r,i){var a,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;return(0,v.default)(this,n),"number"==typeof i&&(o=i,i=!1,console.error("THREE.InstancedBufferAttribute: The constructor now expects normalized as the third argument.")),(a=t.call(this,e,r,i)).meshPerAttribute=o,a}return(0,m.default)(n,[{key:"copy",value:function(e){return(0,u.default)((0,p.default)(n.prototype),"copy",this).call(this,e),this.meshPerAttribute=e.meshPerAttribute,this}},{key:"toJSON",value:function(){var e=(0,u.default)((0,p.default)(n.prototype),"toJSON",this).call(this);return e.meshPerAttribute=this.meshPerAttribute,e.isInstancedBufferAttribute=!0,e}}]),n}(yn);ec.prototype.isInstancedBufferAttribute=!0;var tc=function(e){(0,d.default)(n,e);var t=b(n);function n(e){return(0,v.default)(this,n),t.call(this,e)}return(0,m.default)(n,[{key:"load",value:function(e,t,n,r){var i=this,a=new wu(i.manager);a.setPath(i.path),a.setRequestHeader(i.requestHeader),a.setWithCredentials(i.withCredentials),a.load(e,(function(n){try{t(i.parse(JSON.parse(n)))}catch(t){r?r(t):console.error(t),i.manager.itemError(e)}}),n,r)}},{key:"parse",value:function(e){var t={},n={};function r(e,r){if(void 0!==t[r])return t[r];var i=e.interleavedBuffers[r],a=function(e,t){if(void 0!==n[t])return n[t];var r=e.arrayBuffers[t],i=new Uint32Array(r).buffer;return n[t]=i,i}(e,i.buffer),o=Pn(i.type,a),s=new _o(o,i.stride);return s.uuid=i.uuid,t[r]=s,s}var i=e.isInstancedBufferGeometry?new $u:new zn,a=e.data.index;if(void 0!==a){var o=Pn(a.type,a.array);i.setIndex(new yn(o,1))}var s=e.data.attributes;for(var l in s){var u=s[l],c=void 0;if(u.isInterleavedBufferAttribute){var h=r(e.data,u.data);c=new xo(h,u.itemSize,u.offset,u.normalized)}else{var d=Pn(u.type,u.array);c=new(u.isInstancedBufferAttribute?ec:yn)(d,u.itemSize,u.normalized)}void 0!==u.name&&(c.name=u.name),void 0!==u.usage&&c.setUsage(u.usage),void 0!==u.updateRange&&(c.updateRange.offset=u.updateRange.offset,c.updateRange.count=u.updateRange.count),i.setAttribute(l,c)}var f=e.data.morphAttributes;if(f)for(var p in f){for(var v=f[p],m=[],g=0,_=v.length;g<_;g++){var y=v[g],x=void 0;if(y.isInterleavedBufferAttribute){var b=r(e.data,y.data);x=new xo(b,y.itemSize,y.offset,y.normalized)}else{var w=Pn(y.type,y.array);x=new yn(w,y.itemSize,y.normalized)}void 0!==y.name&&(x.name=y.name),m.push(x)}i.morphAttributes[p]=m}e.data.morphTargetsRelative&&(i.morphTargetsRelative=!0);var T=e.data.groups||e.data.drawcalls||e.data.offsets;if(void 0!==T)for(var M=0,S=T.length;M!==S;++M){var E=T[M];i.addGroup(E.start,E.count,E.materialIndex)}var A=e.data.boundingSphere;if(void 0!==A){var L=new qe;void 0!==A.center&&L.fromArray(A.center),i.boundingSphere=new pt(L,A.radius)}return e.name&&(i.name=e.name),e.userData&&(i.userData=e.userData),i}}]),n}(xu),nc=function(e){(0,d.default)(a,e);var t,n,r,i=b(a);function a(e){return(0,v.default)(this,a),i.call(this,e)}return(0,m.default)(a,[{key:"load",value:function(e,t,n,r){var i=this,a=""===this.path?Qu.extractUrlBase(e):this.path;this.resourcePath=this.resourcePath||a;var o=new wu(this.manager);o.setPath(this.path),o.setRequestHeader(this.requestHeader),o.setWithCredentials(this.withCredentials),o.load(e,(function(n){var a=null;try{a=JSON.parse(n)}catch(t){return void 0!==r&&r(t),void console.error("THREE:ObjectLoader: Can't parse "+e+".",t.message)}var o=a.metadata;void 0!==o&&void 0!==o.type&&"geometry"!==o.type.toLowerCase()?i.parse(a,t):console.error("THREE.ObjectLoader: Can't load "+e)}),n,r)}},{key:"loadAsync",value:(r=(0,s.default)(o.default.mark((function e(t,n){var r,i,a,s,l,u;return o.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=this,i=""===this.path?Qu.extractUrlBase(t):this.path,this.resourcePath=this.resourcePath||i,(a=new wu(this.manager)).setPath(this.path),a.setRequestHeader(this.requestHeader),a.setWithCredentials(this.withCredentials),e.next=9,a.loadAsync(t,n);case 9:if(s=e.sent,l=JSON.parse(s),void 0!==(u=l.metadata)&&void 0!==u.type&&"geometry"!==u.type.toLowerCase()){e.next=14;break}throw new Error("THREE.ObjectLoader: Can't load "+t);case 14:return e.next=16,r.parseAsync(l);case 16:return e.abrupt("return",e.sent);case 17:case"end":return e.stop()}}),e,this)}))),function(e,t){return r.apply(this,arguments)})},{key:"parse",value:function(e,t){var n=this.parseAnimations(e.animations),r=this.parseShapes(e.shapes),i=this.parseGeometries(e.geometries,r),a=this.parseImages(e.images,(function(){void 0!==t&&t(l)})),o=this.parseTextures(e.textures,a),s=this.parseMaterials(e.materials,o),l=this.parseObject(e.object,i,s,o,n),u=this.parseSkeletons(e.skeletons,l);if(this.bindSkeletons(l,u),void 0!==t){var c=!1;for(var h in a)if(a[h]instanceof HTMLImageElement){c=!0;break}!1===c&&t(l)}return l}},{key:"parseAsync",value:(n=(0,s.default)(o.default.mark((function e(t){var n,r,i,a,s,l,u,c;return o.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.parseAnimations(t.animations),r=this.parseShapes(t.shapes),i=this.parseGeometries(t.geometries,r),e.next=5,this.parseImagesAsync(t.images);case 5:return a=e.sent,s=this.parseTextures(t.textures,a),l=this.parseMaterials(t.materials,s),u=this.parseObject(t.object,i,l,s,n),c=this.parseSkeletons(t.skeletons,u),this.bindSkeletons(u,c),e.abrupt("return",u);case 12:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"parseShapes",value:function(e){var t={};if(void 0!==e)for(var n=0,r=e.length;n<r;n++){var i=(new ku).fromJSON(e[n]);t[i.uuid]=i}return t}},{key:"parseSkeletons",value:function(e,t){var n={},r={};if(t.traverse((function(e){e.isBone&&(r[e.uuid]=e)})),void 0!==e)for(var i=0,a=e.length;i<a;i++){var o=(new Zo).fromJSON(e[i],r);n[o.uuid]=o}return n}},{key:"parseGeometries",value:function(e,t){var n={};if(void 0!==e)for(var r=new tc,i=0,a=e.length;i<a;i++){var o=void 0,s=e[i];switch(s.type){case"BufferGeometry":case"InstancedBufferGeometry":o=r.parse(s);break;case"Geometry":console.error("THREE.ObjectLoader: The legacy Geometry type is no longer supported.");break;default:s.type in jl?o=jl[s.type].fromJSON(s,t):console.warn('THREE.ObjectLoader: Unsupported geometry type "'.concat(s.type,'"'))}o.uuid=s.uuid,void 0!==s.name&&(o.name=s.name),!0===o.isBufferGeometry&&void 0!==s.userData&&(o.userData=s.userData),n[s.uuid]=o}return n}},{key:"parseMaterials",value:function(e,t){var n={},r={};if(void 0!==e){var i=new Ju;i.setTextures(t);for(var a=0,o=e.length;a<o;a++){var s=e[a];if("MultiMaterial"===s.type){for(var l=[],u=0;u<s.materials.length;u++){var c=s.materials[u];void 0===n[c.uuid]&&(n[c.uuid]=i.parse(c)),l.push(n[c.uuid])}r[s.uuid]=l}else void 0===n[s.uuid]&&(n[s.uuid]=i.parse(s)),r[s.uuid]=n[s.uuid]}}return r}},{key:"parseAnimations",value:function(e){var t={};if(void 0!==e)for(var n=0;n<e.length;n++){var r=e[n],i=vu.parse(r);t[i.uuid]=i}return t}},{key:"parseImages",value:function(e,t){var n,r=this,i={};function a(e){if("string"==typeof e){var t=e;return function(e){return r.manager.itemStart(e),n.load(e,(function(){r.manager.itemEnd(e)}),void 0,(function(){r.manager.itemError(e),r.manager.itemEnd(e)}))}(/^(\/\/)|([a-z]+:(\/\/)?)/i.test(t)?t:r.resourcePath+t)}return e.data?{data:Pn(e.type,e.data),width:e.width,height:e.height}:null}if(void 0!==e&&e.length>0){var o=new _u(t);(n=new Su(o)).setCrossOrigin(this.crossOrigin);for(var s=0,l=e.length;s<l;s++){var u=e[s],c=u.url;if(Array.isArray(c)){i[u.uuid]=[];for(var h=0,d=c.length;h<d;h++){var f=a(c[h]);null!==f&&(f instanceof HTMLImageElement?i[u.uuid].push(f):i[u.uuid].push(new Xo(f.data,f.width,f.height)))}}else{var p=a(u.url);null!==p&&(i[u.uuid]=p)}}}return i}},{key:"parseImagesAsync",value:(t=(0,s.default)(o.default.mark((function e(t){var n,r,i,a,l,u,c,h,d,f,p,v,m,g;return o.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(l=function(){return l=(0,s.default)(o.default.mark((function e(t){var r,a;return o.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("string"!=typeof t){e.next=8;break}return a=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(r=t)?r:n.resourcePath+r,e.next=5,i.loadAsync(a);case 5:return e.abrupt("return",e.sent);case 8:if(!t.data){e.next=12;break}return e.abrupt("return",{data:Pn(t.type,t.data),width:t.width,height:t.height});case 12:return e.abrupt("return",null);case 13:case"end":return e.stop()}}),e)}))),l.apply(this,arguments)},a=function(e){return l.apply(this,arguments)},n=this,r={},!(void 0!==t&&t.length>0)){e.next=32;break}(i=new Su(this.manager)).setCrossOrigin(this.crossOrigin),u=0,c=t.length;case 8:if(!(u<c)){e.next=32;break}if(h=t[u],d=h.url,!Array.isArray(d)){e.next=25;break}r[h.uuid]=[],f=0,p=d.length;case 14:if(!(f<p)){e.next=23;break}return v=d[f],e.next=18,a(v);case 18:null!==(m=e.sent)&&(m instanceof HTMLImageElement?r[h.uuid].push(m):r[h.uuid].push(new Xo(m.data,m.width,m.height)));case 20:f++,e.next=14;break;case 23:e.next=29;break;case 25:return e.next=27,a(h.url);case 27:null!==(g=e.sent)&&(r[h.uuid]=g);case 29:u++,e.next=8;break;case 32:return e.abrupt("return",r);case 33:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})},{key:"parseTextures",value:function(e,t){function n(e,t){return"number"==typeof e?e:(console.warn("THREE.ObjectLoader.parseTexture: Constant should be in numeric form.",e),t[e])}var r={};if(void 0!==e)for(var i=0,a=e.length;i<a;i++){var o=e[i];void 0===o.image&&console.warn('THREE.ObjectLoader: No "image" specified for',o.uuid),void 0===t[o.image]&&console.warn("THREE.ObjectLoader: Undefined image",o.image);var s=void 0,l=t[o.image];Array.isArray(l)?(s=new vr(l),6===l.length&&(s.needsUpdate=!0)):(s=l&&l.data?new Xo(l.data,l.width,l.height):new Be(l),l&&(s.needsUpdate=!0)),s.uuid=o.uuid,void 0!==o.name&&(s.name=o.name),void 0!==o.mapping&&(s.mapping=n(o.mapping,rc)),void 0!==o.offset&&s.offset.fromArray(o.offset),void 0!==o.repeat&&s.repeat.fromArray(o.repeat),void 0!==o.center&&s.center.fromArray(o.center),void 0!==o.rotation&&(s.rotation=o.rotation),void 0!==o.wrap&&(s.wrapS=n(o.wrap[0],ic),s.wrapT=n(o.wrap[1],ic)),void 0!==o.format&&(s.format=o.format),void 0!==o.type&&(s.type=o.type),void 0!==o.encoding&&(s.encoding=o.encoding),void 0!==o.minFilter&&(s.minFilter=n(o.minFilter,ac)),void 0!==o.magFilter&&(s.magFilter=n(o.magFilter,ac)),void 0!==o.anisotropy&&(s.anisotropy=o.anisotropy),void 0!==o.flipY&&(s.flipY=o.flipY),void 0!==o.premultiplyAlpha&&(s.premultiplyAlpha=o.premultiplyAlpha),void 0!==o.unpackAlignment&&(s.unpackAlignment=o.unpackAlignment),r[o.uuid]=s}return r}},{key:"parseObject",value:function(e,t,n,r,i){var a,o,s;function l(e){return void 0===t[e]&&console.warn("THREE.ObjectLoader: Undefined geometry",e),t[e]}function u(e){if(void 0!==e){if(Array.isArray(e)){for(var t=[],r=0,i=e.length;r<i;r++){var a=e[r];void 0===n[a]&&console.warn("THREE.ObjectLoader: Undefined material",a),t.push(n[a])}return t}return void 0===n[e]&&console.warn("THREE.ObjectLoader: Undefined material",e),n[e]}}function c(e){return void 0===r[e]&&console.warn("THREE.ObjectLoader: Undefined texture",e),r[e]}switch(e.type){case"Scene":a=new go,void 0!==e.background&&(Number.isInteger(e.background)?a.background=new vn(e.background):a.background=c(e.background)),void 0!==e.environment&&(a.environment=c(e.environment)),void 0!==e.fog&&("Fog"===e.fog.type?a.fog=new mo(e.fog.color,e.fog.near,e.fog.far):"FogExp2"===e.fog.type&&(a.fog=new vo(e.fog.color,e.fog.density)));break;case"PerspectiveCamera":a=new dr(e.fov,e.aspect,e.near,e.far),void 0!==e.focus&&(a.focus=e.focus),void 0!==e.zoom&&(a.zoom=e.zoom),void 0!==e.filmGauge&&(a.filmGauge=e.filmGauge),void 0!==e.filmOffset&&(a.filmOffset=e.filmOffset),void 0!==e.view&&(a.view=Object.assign({},e.view));break;case"OrthographicCamera":a=new Fr(e.left,e.right,e.top,e.bottom,e.near,e.far),void 0!==e.zoom&&(a.zoom=e.zoom),void 0!==e.view&&(a.view=Object.assign({},e.view));break;case"AmbientLight":a=new Xu(e.color,e.intensity);break;case"DirectionalLight":a=new qu(e.color,e.intensity);break;case"PointLight":a=new Wu(e.color,e.intensity,e.distance,e.decay);break;case"RectAreaLight":a=new Yu(e.color,e.intensity,e.width,e.height);break;case"SpotLight":a=new Bu(e.color,e.intensity,e.distance,e.angle,e.penumbra,e.decay);break;case"HemisphereLight":a=new Du(e.color,e.groundColor,e.intensity);break;case"LightProbe":a=(new Zu).fromJSON(e);break;case"SkinnedMesh":o=l(e.geometry),s=u(e.material),a=new jo(o,s),void 0!==e.bindMode&&(a.bindMode=e.bindMode),void 0!==e.bindMatrix&&a.bindMatrix.fromArray(e.bindMatrix),void 0!==e.skeleton&&(a.skeleton=e.skeleton);break;case"Mesh":o=l(e.geometry),s=u(e.material),a=new ir(o,s);break;case"InstancedMesh":o=l(e.geometry),s=u(e.material);var h=e.count,d=e.instanceMatrix,f=e.instanceColor;(a=new ts(o,s,h)).instanceMatrix=new yn(new Float32Array(d.array),16),void 0!==f&&(a.instanceColor=new yn(new Float32Array(f.array),f.itemSize));break;case"LOD":a=new Bo;break;case"Line":a=new ls(l(e.geometry),u(e.material));break;case"LineLoop":a=new ds(l(e.geometry),u(e.material));break;case"LineSegments":a=new hs(l(e.geometry),u(e.material));break;case"PointCloud":case"Points":a=new _s(l(e.geometry),u(e.material));break;case"Sprite":a=new Oo(u(e.material));break;case"Group":a=new oo;break;case"Bone":a=new qo;break;default:a=new Yt}if(a.uuid=e.uuid,void 0!==e.name&&(a.name=e.name),void 0!==e.matrix?(a.matrix.fromArray(e.matrix),void 0!==e.matrixAutoUpdate&&(a.matrixAutoUpdate=e.matrixAutoUpdate),a.matrixAutoUpdate&&a.matrix.decompose(a.position,a.quaternion,a.scale)):(void 0!==e.position&&a.position.fromArray(e.position),void 0!==e.rotation&&a.rotation.fromArray(e.rotation),void 0!==e.quaternion&&a.quaternion.fromArray(e.quaternion),void 0!==e.scale&&a.scale.fromArray(e.scale)),void 0!==e.castShadow&&(a.castShadow=e.castShadow),void 0!==e.receiveShadow&&(a.receiveShadow=e.receiveShadow),e.shadow&&(void 0!==e.shadow.bias&&(a.shadow.bias=e.shadow.bias),void 0!==e.shadow.normalBias&&(a.shadow.normalBias=e.shadow.normalBias),void 0!==e.shadow.radius&&(a.shadow.radius=e.shadow.radius),void 0!==e.shadow.mapSize&&a.shadow.mapSize.fromArray(e.shadow.mapSize),void 0!==e.shadow.camera&&(a.shadow.camera=this.parseObject(e.shadow.camera))),void 0!==e.visible&&(a.visible=e.visible),void 0!==e.frustumCulled&&(a.frustumCulled=e.frustumCulled),void 0!==e.renderOrder&&(a.renderOrder=e.renderOrder),void 0!==e.userData&&(a.userData=e.userData),void 0!==e.layers&&(a.layers.mask=e.layers),void 0!==e.children)for(var p=e.children,v=0;v<p.length;v++)a.add(this.parseObject(p[v],t,n,r,i));if(void 0!==e.animations)for(var m=e.animations,g=0;g<m.length;g++){var _=m[g];a.animations.push(i[_])}if("LOD"===e.type){void 0!==e.autoUpdate&&(a.autoUpdate=e.autoUpdate);for(var y=e.levels,x=0;x<y.length;x++){var b=y[x],w=a.getObjectByProperty("uuid",b.object);void 0!==w&&a.addLevel(w,b.distance)}}return a}},{key:"bindSkeletons",value:function(e,t){0!==Object.keys(t).length&&e.traverse((function(e){if(!0===e.isSkinnedMesh&&void 0!==e.skeleton){var n=t[e.skeleton];void 0===n?console.warn("THREE.ObjectLoader: No skeleton found with UUID:",e.skeleton):e.bind(n,e.bindMatrix)}}))}},{key:"setTexturePath",value:function(e){return console.warn("THREE.ObjectLoader: .setTexturePath() has been renamed to .setResourcePath()."),this.setResourcePath(e)}}]),a}(xu),rc={UVMapping:i,CubeReflectionMapping:a,CubeRefractionMapping:g,EquirectangularReflectionMapping:y,EquirectangularRefractionMapping:w,CubeUVReflectionMapping:T,CubeUVRefractionMapping:M},ic={RepeatWrapping:S,ClampToEdgeWrapping:E,MirroredRepeatWrapping:A},ac={NearestFilter:L,NearestMipmapNearestFilter:C,NearestMipmapLinearFilter:R,LinearFilter:k,LinearMipmapNearestFilter:P,LinearMipmapLinearFilter:D},oc=function(e){(0,d.default)(n,e);var t=b(n);function n(e){var r;return(0,v.default)(this,n),r=t.call(this,e),"undefined"==typeof createImageBitmap&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),"undefined"==typeof fetch&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),r.options={premultiplyAlpha:"none"},r}return(0,m.default)(n,[{key:"setOptions",value:function(e){return this.options=e,this}},{key:"load",value:function(e,t,n,r){void 0===e&&(e=""),void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);var i=this,a=gu.get(e);if(void 0!==a)return i.manager.itemStart(e),setTimeout((function(){t&&t(a),i.manager.itemEnd(e)}),0),a;var o={};o.credentials="anonymous"===this.crossOrigin?"same-origin":"include",o.headers=this.requestHeader,fetch(e,o).then((function(e){return e.blob()})).then((function(e){return createImageBitmap(e,Object.assign(i.options,{colorSpaceConversion:"none"}))})).then((function(n){gu.add(e,n),t&&t(n),i.manager.itemEnd(e)})).catch((function(t){r&&r(t),i.manager.itemError(e),i.manager.itemEnd(e)})),i.manager.itemStart(e)}}]),n}(xu);oc.prototype.isImageBitmapLoader=!0;var sc=function(){function e(){(0,v.default)(this,e),this.type="ShapePath",this.color=new vn,this.subPaths=[],this.currentPath=null}return(0,m.default)(e,[{key:"moveTo",value:function(e,t){return this.currentPath=new Ru,this.subPaths.push(this.currentPath),this.currentPath.moveTo(e,t),this}},{key:"lineTo",value:function(e,t){return this.currentPath.lineTo(e,t),this}},{key:"quadraticCurveTo",value:function(e,t,n,r){return this.currentPath.quadraticCurveTo(e,t,n,r),this}},{key:"bezierCurveTo",value:function(e,t,n,r,i,a){return this.currentPath.bezierCurveTo(e,t,n,r,i,a),this}},{key:"splineThru",value:function(e){return this.currentPath.splineThru(e),this}},{key:"toShapes",value:function(e,t){function n(e){for(var t=[],n=0,r=e.length;n<r;n++){var i=e[n],a=new ku;a.curves=i.curves,t.push(a)}return t}function r(e,t){for(var n=t.length,r=!1,i=n-1,a=0;a<n;i=a++){var o=t[i],s=t[a],l=s.x-o.x,u=s.y-o.y;if(Math.abs(u)>Number.EPSILON){if(u<0&&(o=t[a],l=-l,s=t[i],u=-u),e.y<o.y||e.y>s.y)continue;if(e.y===o.y){if(e.x===o.x)return!0}else{var c=u*(e.x-o.x)-l*(e.y-o.y);if(0===c)return!0;if(c<0)continue;r=!r}}else{if(e.y!==o.y)continue;if(s.x<=e.x&&e.x<=o.x||o.x<=e.x&&e.x<=s.x)return!0}}return r}var i,a,o,s=El.isClockWise,l=this.subPaths;if(0===l.length)return[];if(!0===t)return n(l);var u=[];if(1===l.length)return a=l[0],(o=new ku).curves=a.curves,u.push(o),u;var c=!s(l[0].getPoints());c=e?!c:c;var h,d,f=[],p=[],v=[],m=0;p[m]=void 0,v[m]=[];for(var g=0,_=l.length;g<_;g++)i=s(h=(a=l[g]).getPoints()),(i=e?!i:i)?(!c&&p[m]&&m++,p[m]={s:new ku,p:h},p[m].s.curves=a.curves,c&&m++,v[m]=[]):v[m].push({h:a,p:h[0]});if(!p[0])return n(l);if(p.length>1){for(var y=!1,x=[],b=0,w=p.length;b<w;b++)f[b]=[];for(var T=0,M=p.length;T<M;T++)for(var S=v[T],E=0;E<S.length;E++){for(var A=S[E],L=!0,C=0;C<p.length;C++)r(A.p,p[C].p)&&(T!==C&&x.push({froms:T,tos:C,hole:E}),L?(L=!1,f[C].push(A)):y=!0);L&&f[T].push(A)}x.length>0&&(y||(v=f))}for(var R=0,k=p.length;R<k;R++){o=p[R].s,u.push(o);for(var P=0,D=(d=v[R]).length;P<D;P++)o.holes.push(d[P].h)}return u}}]),e}(),lc=function(){function e(t){(0,v.default)(this,e),this.type="Font",this.data=t}return(0,m.default)(e,[{key:"generateShapes",value:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:100,n=[],r=uc(e,t,this.data),i=0,a=r.length;i<a;i++)Array.prototype.push.apply(n,r[i].toShapes());return n}}]),e}();function uc(e,t,n){for(var r=Array.from(e),i=t/n.resolution,a=(n.boundingBox.yMax-n.boundingBox.yMin+n.underlineThickness)*i,o=[],s=0,l=0,u=0;u<r.length;u++){var c=r[u];if("\n"===c)s=0,l-=a;else{var h=cc(c,i,s,l,n);s+=h.offsetX,o.push(h.path)}}return o}function cc(e,t,n,r,i){var a=i.glyphs[e]||i.glyphs["?"];if(a){var o,s,l,u,c,h,d,f,p=new sc;if(a.o)for(var v=a._cachedOutline||(a._cachedOutline=a.o.split(" ")),m=0,g=v.length;m<g;)switch(v[m++]){case"m":o=v[m++]*t+n,s=v[m++]*t+r,p.moveTo(o,s);break;case"l":o=v[m++]*t+n,s=v[m++]*t+r,p.lineTo(o,s);break;case"q":l=v[m++]*t+n,u=v[m++]*t+r,c=v[m++]*t+n,h=v[m++]*t+r,p.quadraticCurveTo(c,h,l,u);break;case"b":l=v[m++]*t+n,u=v[m++]*t+r,c=v[m++]*t+n,h=v[m++]*t+r,d=v[m++]*t+n,f=v[m++]*t+r,p.bezierCurveTo(c,h,d,f,l,u)}return{offsetX:a.ha*t,path:p}}console.error('THREE.Font: character "'+e+'" does not exists in font family '+i.familyName+".")}lc.prototype.isFont=!0;var hc,dc=function(e){(0,d.default)(n,e);var t=b(n);function n(e){return(0,v.default)(this,n),t.call(this,e)}return(0,m.default)(n,[{key:"load",value:function(e,t,n,r){var i=this,a=new wu(this.manager);a.setPath(this.path),a.setRequestHeader(this.requestHeader),a.setWithCredentials(i.withCredentials),a.load(e,(function(e){var n;try{n=JSON.parse(e)}catch(t){console.warn("THREE.FontLoader: typeface.js support is being deprecated. Use typeface.json instead."),n=JSON.parse(e.substring(65,e.length-2))}var r=i.parse(n);t&&t(r)}),n,r)}},{key:"parse",value:function(e){return new lc(e)}}]),n}(xu),fc={getContext:function(){return void 0===hc&&(hc=new(window.AudioContext||window.webkitAudioContext)),hc},setContext:function(e){hc=e}},pc=function(e){(0,d.default)(n,e);var t=b(n);function n(e){return(0,v.default)(this,n),t.call(this,e)}return(0,m.default)(n,[{key:"load",value:function(e,t,n,r){var i=this,a=new wu(this.manager);a.setResponseType("arraybuffer"),a.setPath(this.path),a.setRequestHeader(this.requestHeader),a.setWithCredentials(this.withCredentials),a.load(e,(function(n){try{var a=n.slice(0);fc.getContext().decodeAudioData(a,(function(e){t(e)}))}catch(t){r?r(t):console.error(t),i.manager.itemError(e)}}),n,r)}}]),n}(xu),vc=function(e){(0,d.default)(n,e);var t=b(n);function n(e,r){var i,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;(0,v.default)(this,n),i=t.call(this,void 0,a);var o=(new vn).set(e),s=(new vn).set(r),l=new qe(o.r,o.g,o.b),u=new qe(s.r,s.g,s.b),c=Math.sqrt(Math.PI),h=c*Math.sqrt(.75);return i.sh.coefficients[0].copy(l).add(u).multiplyScalar(c),i.sh.coefficients[1].copy(l).sub(u).multiplyScalar(h),i}return(0,m.default)(n)}(Zu);vc.prototype.isHemisphereLightProbe=!0;var mc=function(e){(0,d.default)(n,e);var t=b(n);function n(e){var r,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;(0,v.default)(this,n),r=t.call(this,void 0,i);var a=(new vn).set(e);return r.sh.coefficients[0].set(a.r,a.g,a.b).multiplyScalar(2*Math.sqrt(Math.PI)),r}return(0,m.default)(n)}(Zu);mc.prototype.isAmbientLightProbe=!0;var gc=new Tt,_c=new Tt,yc=function(){function e(){(0,v.default)(this,e),this.type="StereoCamera",this.aspect=1,this.eyeSep=.064,this.cameraL=new dr,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new dr,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1,this._cache={focus:null,fov:null,aspect:null,near:null,far:null,zoom:null,eyeSep:null}}return(0,m.default)(e,[{key:"update",value:function(e){var t=this._cache;if(t.focus!==e.focus||t.fov!==e.fov||t.aspect!==e.aspect*this.aspect||t.near!==e.near||t.far!==e.far||t.zoom!==e.zoom||t.eyeSep!==this.eyeSep){t.focus=e.focus,t.fov=e.fov,t.aspect=e.aspect*this.aspect,t.near=e.near,t.far=e.far,t.zoom=e.zoom,t.eyeSep=this.eyeSep;var n,r,i=e.projectionMatrix.clone(),a=t.eyeSep/2,o=a*t.near/t.focus,s=t.near*Math.tan(Me*t.fov*.5)/t.zoom;_c.elements[12]=-a,gc.elements[12]=a,n=-s*t.aspect+o,r=s*t.aspect+o,i.elements[0]=2*t.near/(r-n),i.elements[8]=(r+n)/(r-n),this.cameraL.projectionMatrix.copy(i),n=-s*t.aspect-o,r=s*t.aspect-o,i.elements[0]=2*t.near/(r-n),i.elements[8]=(r+n)/(r-n),this.cameraR.projectionMatrix.copy(i)}this.cameraL.matrixWorld.copy(e.matrixWorld).multiply(_c),this.cameraR.matrixWorld.copy(e.matrixWorld).multiply(gc)}}]),e}(),xc=function(){function e(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];(0,v.default)(this,e),this.autoStart=t,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}return(0,m.default)(e,[{key:"start",value:function(){this.startTime=bc(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}},{key:"stop",value:function(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}},{key:"getElapsedTime",value:function(){return this.getDelta(),this.elapsedTime}},{key:"getDelta",value:function(){var e=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){var t=bc();e=(t-this.oldTime)/1e3,this.oldTime=t,this.elapsedTime+=e}return e}}]),e}();function bc(){return("undefined"==typeof performance?Date:performance).now()}var wc=new qe,Tc=new je,Mc=new qe,Sc=new qe,Ec=function(e){(0,d.default)(n,e);var t=b(n);function n(){var e;return(0,v.default)(this,n),(e=t.call(this)).type="AudioListener",e.context=fc.getContext(),e.gain=e.context.createGain(),e.gain.connect(e.context.destination),e.filter=null,e.timeDelta=0,e._clock=new xc,e}return(0,m.default)(n,[{key:"getInput",value:function(){return this.gain}},{key:"removeFilter",value:function(){return null!==this.filter&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null),this}},{key:"getFilter",value:function(){return this.filter}},{key:"setFilter",value:function(e){return null!==this.filter?(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)):this.gain.disconnect(this.context.destination),this.filter=e,this.gain.connect(this.filter),this.filter.connect(this.context.destination),this}},{key:"getMasterVolume",value:function(){return this.gain.gain.value}},{key:"setMasterVolume",value:function(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}},{key:"updateMatrixWorld",value:function(e){(0,u.default)((0,p.default)(n.prototype),"updateMatrixWorld",this).call(this,e);var t=this.context.listener,r=this.up;if(this.timeDelta=this._clock.getDelta(),this.matrixWorld.decompose(wc,Tc,Mc),Sc.set(0,0,-1).applyQuaternion(Tc),t.positionX){var i=this.context.currentTime+this.timeDelta;t.positionX.linearRampToValueAtTime(wc.x,i),t.positionY.linearRampToValueAtTime(wc.y,i),t.positionZ.linearRampToValueAtTime(wc.z,i),t.forwardX.linearRampToValueAtTime(Sc.x,i),t.forwardY.linearRampToValueAtTime(Sc.y,i),t.forwardZ.linearRampToValueAtTime(Sc.z,i),t.upX.linearRampToValueAtTime(r.x,i),t.upY.linearRampToValueAtTime(r.y,i),t.upZ.linearRampToValueAtTime(r.z,i)}else t.setPosition(wc.x,wc.y,wc.z),t.setOrientation(Sc.x,Sc.y,Sc.z,r.x,r.y,r.z)}}]),n}(Yt),Ac=function(e){(0,d.default)(n,e);var t=b(n);function n(e){var r;return(0,v.default)(this,n),(r=t.call(this)).type="Audio",r.listener=e,r.context=e.context,r.gain=r.context.createGain(),r.gain.connect(e.getInput()),r.autoplay=!1,r.buffer=null,r.detune=0,r.loop=!1,r.loopStart=0,r.loopEnd=0,r.offset=0,r.duration=void 0,r.playbackRate=1,r.isPlaying=!1,r.hasPlaybackControl=!0,r.source=null,r.sourceType="empty",r._startedAt=0,r._progress=0,r._connected=!1,r.filters=[],r}return(0,m.default)(n,[{key:"getOutput",value:function(){return this.gain}},{key:"setNodeSource",value:function(e){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=e,this.connect(),this}},{key:"setMediaElementSource",value:function(e){return this.hasPlaybackControl=!1,this.sourceType="mediaNode",this.source=this.context.createMediaElementSource(e),this.connect(),this}},{key:"setMediaStreamSource",value:function(e){return this.hasPlaybackControl=!1,this.sourceType="mediaStreamNode",this.source=this.context.createMediaStreamSource(e),this.connect(),this}},{key:"setBuffer",value:function(e){return this.buffer=e,this.sourceType="buffer",this.autoplay&&this.play(),this}},{key:"play",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;if(!0!==this.isPlaying){if(!1!==this.hasPlaybackControl){this._startedAt=this.context.currentTime+e;var t=this.context.createBufferSource();return t.buffer=this.buffer,t.loop=this.loop,t.loopStart=this.loopStart,t.loopEnd=this.loopEnd,t.onended=this.onEnded.bind(this),t.start(this._startedAt,this._progress+this.offset,this.duration),this.isPlaying=!0,this.source=t,this.setDetune(this.detune),this.setPlaybackRate(this.playbackRate),this.connect()}console.warn("THREE.Audio: this Audio has no playback control.")}else console.warn("THREE.Audio: Audio is already playing.")}},{key:"pause",value:function(){if(!1!==this.hasPlaybackControl)return!0===this.isPlaying&&(this._progress+=Math.max(this.context.currentTime-this._startedAt,0)*this.playbackRate,!0===this.loop&&(this._progress=this._progress%(this.duration||this.buffer.duration)),this.source.stop(),this.source.onended=null,this.isPlaying=!1),this;console.warn("THREE.Audio: this Audio has no playback control.")}},{key:"stop",value:function(){if(!1!==this.hasPlaybackControl)return this._progress=0,this.source.stop(),this.source.onended=null,this.isPlaying=!1,this;console.warn("THREE.Audio: this Audio has no playback control.")}},{key:"connect",value:function(){if(this.filters.length>0){this.source.connect(this.filters[0]);for(var e=1,t=this.filters.length;e<t;e++)this.filters[e-1].connect(this.filters[e]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this._connected=!0,this}},{key:"disconnect",value:function(){if(this.filters.length>0){this.source.disconnect(this.filters[0]);for(var e=1,t=this.filters.length;e<t;e++)this.filters[e-1].disconnect(this.filters[e]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this._connected=!1,this}},{key:"getFilters",value:function(){return this.filters}},{key:"setFilters",value:function(e){return e||(e=[]),!0===this._connected?(this.disconnect(),this.filters=e.slice(),this.connect()):this.filters=e.slice(),this}},{key:"setDetune",value:function(e){if(this.detune=e,void 0!==this.source.detune)return!0===this.isPlaying&&this.source.detune.setTargetAtTime(this.detune,this.context.currentTime,.01),this}},{key:"getDetune",value:function(){return this.detune}},{key:"getFilter",value:function(){return this.getFilters()[0]}},{key:"setFilter",value:function(e){return this.setFilters(e?[e]:[])}},{key:"setPlaybackRate",value:function(e){if(!1!==this.hasPlaybackControl)return this.playbackRate=e,!0===this.isPlaying&&this.source.playbackRate.setTargetAtTime(this.playbackRate,this.context.currentTime,.01),this;console.warn("THREE.Audio: this Audio has no playback control.")}},{key:"getPlaybackRate",value:function(){return this.playbackRate}},{key:"onEnded",value:function(){this.isPlaying=!1}},{key:"getLoop",value:function(){return!1===this.hasPlaybackControl?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.loop}},{key:"setLoop",value:function(e){if(!1!==this.hasPlaybackControl)return this.loop=e,!0===this.isPlaying&&(this.source.loop=this.loop),this;console.warn("THREE.Audio: this Audio has no playback control.")}},{key:"setLoopStart",value:function(e){return this.loopStart=e,this}},{key:"setLoopEnd",value:function(e){return this.loopEnd=e,this}},{key:"getVolume",value:function(){return this.gain.gain.value}},{key:"setVolume",value:function(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}}]),n}(Yt),Lc=new qe,Cc=new je,Rc=new qe,kc=new qe,Pc=function(e){(0,d.default)(n,e);var t=b(n);function n(e){var r;return(0,v.default)(this,n),(r=t.call(this,e)).panner=r.context.createPanner(),r.panner.panningModel="HRTF",r.panner.connect(r.gain),r}return(0,m.default)(n,[{key:"getOutput",value:function(){return this.panner}},{key:"getRefDistance",value:function(){return this.panner.refDistance}},{key:"setRefDistance",value:function(e){return this.panner.refDistance=e,this}},{key:"getRolloffFactor",value:function(){return this.panner.rolloffFactor}},{key:"setRolloffFactor",value:function(e){return this.panner.rolloffFactor=e,this}},{key:"getDistanceModel",value:function(){return this.panner.distanceModel}},{key:"setDistanceModel",value:function(e){return this.panner.distanceModel=e,this}},{key:"getMaxDistance",value:function(){return this.panner.maxDistance}},{key:"setMaxDistance",value:function(e){return this.panner.maxDistance=e,this}},{key:"setDirectionalCone",value:function(e,t,n){return this.panner.coneInnerAngle=e,this.panner.coneOuterAngle=t,this.panner.coneOuterGain=n,this}},{key:"updateMatrixWorld",value:function(e){if((0,u.default)((0,p.default)(n.prototype),"updateMatrixWorld",this).call(this,e),!0!==this.hasPlaybackControl||!1!==this.isPlaying){this.matrixWorld.decompose(Lc,Cc,Rc),kc.set(0,0,1).applyQuaternion(Cc);var t=this.panner;if(t.positionX){var r=this.context.currentTime+this.listener.timeDelta;t.positionX.linearRampToValueAtTime(Lc.x,r),t.positionY.linearRampToValueAtTime(Lc.y,r),t.positionZ.linearRampToValueAtTime(Lc.z,r),t.orientationX.linearRampToValueAtTime(kc.x,r),t.orientationY.linearRampToValueAtTime(kc.y,r),t.orientationZ.linearRampToValueAtTime(kc.z,r)}else t.setPosition(Lc.x,Lc.y,Lc.z),t.setOrientation(kc.x,kc.y,kc.z)}}}]),n}(Ac),Dc=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2048;(0,v.default)(this,e),this.analyser=t.context.createAnalyser(),this.analyser.fftSize=n,this.data=new Uint8Array(this.analyser.frequencyBinCount),t.getOutput().connect(this.analyser)}return(0,m.default)(e,[{key:"getFrequencyData",value:function(){return this.analyser.getByteFrequencyData(this.data),this.data}},{key:"getAverageFrequency",value:function(){for(var e=0,t=this.getFrequencyData(),n=0;n<t.length;n++)e+=t[n];return e/t.length}}]),e}(),Ic=function(){function e(t,n,r){var i,a,o;switch((0,v.default)(this,e),this.binding=t,this.valueSize=r,n){case"quaternion":i=this._slerp,a=this._slerpAdditive,o=this._setAdditiveIdentityQuaternion,this.buffer=new Float64Array(6*r),this._workIndex=5;break;case"string":case"bool":i=this._select,a=this._select,o=this._setAdditiveIdentityOther,this.buffer=new Array(5*r);break;default:i=this._lerp,a=this._lerpAdditive,o=this._setAdditiveIdentityNumeric,this.buffer=new Float64Array(5*r)}this._mixBufferRegion=i,this._mixBufferRegionAdditive=a,this._setIdentity=o,this._origIndex=3,this._addIndex=4,this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,this.useCount=0,this.referenceCount=0}return(0,m.default)(e,[{key:"accumulate",value:function(e,t){var n=this.buffer,r=this.valueSize,i=e*r+r,a=this.cumulativeWeight;if(0===a){for(var o=0;o!==r;++o)n[i+o]=n[o];a=t}else{var s=t/(a+=t);this._mixBufferRegion(n,i,0,s,r)}this.cumulativeWeight=a}},{key:"accumulateAdditive",value:function(e){var t=this.buffer,n=this.valueSize,r=n*this._addIndex;0===this.cumulativeWeightAdditive&&this._setIdentity(),this._mixBufferRegionAdditive(t,r,0,e,n),this.cumulativeWeightAdditive+=e}},{key:"apply",value:function(e){var t=this.valueSize,n=this.buffer,r=e*t+t,i=this.cumulativeWeight,a=this.cumulativeWeightAdditive,o=this.binding;if(this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,i<1){var s=t*this._origIndex;this._mixBufferRegion(n,r,s,1-i,t)}a>0&&this._mixBufferRegionAdditive(n,r,this._addIndex*t,1,t);for(var l=t,u=t+t;l!==u;++l)if(n[l]!==n[l+t]){o.setValue(n,r);break}}},{key:"saveOriginalState",value:function(){var e=this.binding,t=this.buffer,n=this.valueSize,r=n*this._origIndex;e.getValue(t,r);for(var i=n,a=r;i!==a;++i)t[i]=t[r+i%n];this._setIdentity(),this.cumulativeWeight=0,this.cumulativeWeightAdditive=0}},{key:"restoreOriginalState",value:function(){var e=3*this.valueSize;this.binding.setValue(this.buffer,e)}},{key:"_setAdditiveIdentityNumeric",value:function(){for(var e=this._addIndex*this.valueSize,t=e+this.valueSize,n=e;n<t;n++)this.buffer[n]=0}},{key:"_setAdditiveIdentityQuaternion",value:function(){this._setAdditiveIdentityNumeric(),this.buffer[this._addIndex*this.valueSize+3]=1}},{key:"_setAdditiveIdentityOther",value:function(){for(var e=this._origIndex*this.valueSize,t=this._addIndex*this.valueSize,n=0;n<this.valueSize;n++)this.buffer[t+n]=this.buffer[e+n]}},{key:"_select",value:function(e,t,n,r,i){if(r>=.5)for(var a=0;a!==i;++a)e[t+a]=e[n+a]}},{key:"_slerp",value:function(e,t,n,r){je.slerpFlat(e,t,e,t,e,n,r)}},{key:"_slerpAdditive",value:function(e,t,n,r,i){var a=this._workIndex*i;je.multiplyQuaternionsFlat(e,a,e,t,e,n),je.slerpFlat(e,t,e,t,e,a,r)}},{key:"_lerp",value:function(e,t,n,r,i){for(var a=1-r,o=0;o!==i;++o){var s=t+o;e[s]=e[s]*a+e[n+o]*r}}},{key:"_lerpAdditive",value:function(e,t,n,r,i){for(var a=0;a!==i;++a){var o=t+a;e[o]=e[o]+e[n+a]*r}}}]),e}(),Oc="\\[\\]\\.:\\/",Fc=new RegExp("[\\[\\]\\.:\\/]","g"),Nc="[^\\[\\]\\.:\\/]",Uc="[^"+Oc.replace("\\.","")+"]",Bc=/((?:WC+[\/:])*)/.source.replace("WC",Nc),zc=/(WCOD+)?/.source.replace("WCOD",Uc),Hc=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",Nc),Gc=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",Nc),Vc=new RegExp("^"+Bc+zc+Hc+Gc+"$"),Wc=["material","materials","bones"],jc=function(){function e(t,n,r){(0,v.default)(this,e);var i=r||qc.parseTrackName(n);this._targetGroup=t,this._bindings=t.subscribe_(n,i)}return(0,m.default)(e,[{key:"getValue",value:function(e,t){this.bind();var n=this._targetGroup.nCachedObjects_,r=this._bindings[n];void 0!==r&&r.getValue(e,t)}},{key:"setValue",value:function(e,t){for(var n=this._bindings,r=this._targetGroup.nCachedObjects_,i=n.length;r!==i;++r)n[r].setValue(e,t)}},{key:"bind",value:function(){for(var e=this._bindings,t=this._targetGroup.nCachedObjects_,n=e.length;t!==n;++t)e[t].bind()}},{key:"unbind",value:function(){for(var e=this._bindings,t=this._targetGroup.nCachedObjects_,n=e.length;t!==n;++t)e[t].unbind()}}]),e}(),qc=function(){function e(t,n,r){(0,v.default)(this,e),this.path=n,this.parsedPath=r||e.parseTrackName(n),this.node=e.findNode(t,this.parsedPath.nodeName)||t,this.rootNode=t,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}return(0,m.default)(e,[{key:"_getValue_unavailable",value:function(){}},{key:"_setValue_unavailable",value:function(){}},{key:"_getValue_direct",value:function(e,t){e[t]=this.node[this.propertyName]}},{key:"_getValue_array",value:function(e,t){for(var n=this.resolvedProperty,r=0,i=n.length;r!==i;++r)e[t++]=n[r]}},{key:"_getValue_arrayElement",value:function(e,t){e[t]=this.resolvedProperty[this.propertyIndex]}},{key:"_getValue_toArray",value:function(e,t){this.resolvedProperty.toArray(e,t)}},{key:"_setValue_direct",value:function(e,t){this.targetObject[this.propertyName]=e[t]}},{key:"_setValue_direct_setNeedsUpdate",value:function(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.needsUpdate=!0}},{key:"_setValue_direct_setMatrixWorldNeedsUpdate",value:function(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}},{key:"_setValue_array",value:function(e,t){for(var n=this.resolvedProperty,r=0,i=n.length;r!==i;++r)n[r]=e[t++]}},{key:"_setValue_array_setNeedsUpdate",value:function(e,t){for(var n=this.resolvedProperty,r=0,i=n.length;r!==i;++r)n[r]=e[t++];this.targetObject.needsUpdate=!0}},{key:"_setValue_array_setMatrixWorldNeedsUpdate",value:function(e,t){for(var n=this.resolvedProperty,r=0,i=n.length;r!==i;++r)n[r]=e[t++];this.targetObject.matrixWorldNeedsUpdate=!0}},{key:"_setValue_arrayElement",value:function(e,t){this.resolvedProperty[this.propertyIndex]=e[t]}},{key:"_setValue_arrayElement_setNeedsUpdate",value:function(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.needsUpdate=!0}},{key:"_setValue_arrayElement_setMatrixWorldNeedsUpdate",value:function(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}},{key:"_setValue_fromArray",value:function(e,t){this.resolvedProperty.fromArray(e,t)}},{key:"_setValue_fromArray_setNeedsUpdate",value:function(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.needsUpdate=!0}},{key:"_setValue_fromArray_setMatrixWorldNeedsUpdate",value:function(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.matrixWorldNeedsUpdate=!0}},{key:"_getValue_unbound",value:function(e,t){this.bind(),this.getValue(e,t)}},{key:"_setValue_unbound",value:function(e,t){this.bind(),this.setValue(e,t)}},{key:"bind",value:function(){var t=this.node,n=this.parsedPath,r=n.objectName,i=n.propertyName,a=n.propertyIndex;if(t||(t=e.findNode(this.rootNode,n.nodeName)||this.rootNode,this.node=t),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,t){if(r){var o=n.objectIndex;switch(r){case"materials":if(!t.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!t.material.materials)return void console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);t=t.material.materials;break;case"bones":if(!t.skeleton)return void console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);t=t.skeleton.bones;for(var s=0;s<t.length;s++)if(t[s].name===o){o=s;break}break;default:if(void 0===t[r])return void console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);t=t[r]}if(void 0!==o){if(void 0===t[o])return void console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,t);t=t[o]}}var l=t[i];if(void 0!==l){var u=this.Versioning.None;this.targetObject=t,void 0!==t.needsUpdate?u=this.Versioning.NeedsUpdate:void 0!==t.matrixWorldNeedsUpdate&&(u=this.Versioning.MatrixWorldNeedsUpdate);var c=this.BindingType.Direct;if(void 0!==a){if("morphTargetInfluences"===i){if(!t.geometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);if(!t.geometry.isBufferGeometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences on THREE.Geometry. Use THREE.BufferGeometry instead.",this);if(!t.geometry.morphAttributes)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);void 0!==t.morphTargetDictionary[a]&&(a=t.morphTargetDictionary[a])}c=this.BindingType.ArrayElement,this.resolvedProperty=l,this.propertyIndex=a}else void 0!==l.fromArray&&void 0!==l.toArray?(c=this.BindingType.HasFromToArray,this.resolvedProperty=l):Array.isArray(l)?(c=this.BindingType.EntireArray,this.resolvedProperty=l):this.propertyName=i;this.getValue=this.GetterByBindingType[c],this.setValue=this.SetterByBindingTypeAndVersioning[c][u]}else{var h=n.nodeName;console.error("THREE.PropertyBinding: Trying to update property for track: "+h+"."+i+" but it wasn't found.",t)}}else console.error("THREE.PropertyBinding: Trying to update node for track: "+this.path+" but it wasn't found.")}},{key:"unbind",value:function(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}],[{key:"create",value:function(t,n,r){return t&&t.isAnimationObjectGroup?new e.Composite(t,n,r):new e(t,n,r)}},{key:"sanitizeNodeName",value:function(e){return e.replace(/\s/g,"_").replace(Fc,"")}},{key:"parseTrackName",value:function(e){var t=Vc.exec(e);if(!t)throw new Error("PropertyBinding: Cannot parse trackName: "+e);var n={nodeName:t[2],objectName:t[3],objectIndex:t[4],propertyName:t[5],propertyIndex:t[6]},r=n.nodeName&&n.nodeName.lastIndexOf(".");if(void 0!==r&&-1!==r){var i=n.nodeName.substring(r+1);-1!==Wc.indexOf(i)&&(n.nodeName=n.nodeName.substring(0,r),n.objectName=i)}if(null===n.propertyName||0===n.propertyName.length)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+e);return n}},{key:"findNode",value:function(e,t){if(!t||""===t||"."===t||-1===t||t===e.name||t===e.uuid)return e;if(e.skeleton){var n=e.skeleton.getBoneByName(t);if(void 0!==n)return n}if(e.children){var r=function e(n){for(var r=0;r<n.length;r++){var i=n[r];if(i.name===t||i.uuid===t)return i;var a=e(i.children);if(a)return a}return null}(e.children);if(r)return r}return null}}]),e}();qc.Composite=jc,qc.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},qc.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},qc.prototype.GetterByBindingType=[qc.prototype._getValue_direct,qc.prototype._getValue_array,qc.prototype._getValue_arrayElement,qc.prototype._getValue_toArray],qc.prototype.SetterByBindingTypeAndVersioning=[[qc.prototype._setValue_direct,qc.prototype._setValue_direct_setNeedsUpdate,qc.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[qc.prototype._setValue_array,qc.prototype._setValue_array_setNeedsUpdate,qc.prototype._setValue_array_setMatrixWorldNeedsUpdate],[qc.prototype._setValue_arrayElement,qc.prototype._setValue_arrayElement_setNeedsUpdate,qc.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[qc.prototype._setValue_fromArray,qc.prototype._setValue_fromArray_setNeedsUpdate,qc.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];var Xc=function(){function e(){(0,v.default)(this,e),this.uuid=Ee(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;var t={};this._indicesByUUID=t;for(var n=0,r=arguments.length;n!==r;++n)t[arguments[n].uuid]=n;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};var i=this;this.stats={objects:{get total(){return i._objects.length},get inUse(){return this.total-i.nCachedObjects_}},get bindingsPerObject(){return i._bindings.length}}}return(0,m.default)(e,[{key:"add",value:function(){for(var e=this._objects,t=this._indicesByUUID,n=this._paths,r=this._parsedPaths,i=this._bindings,a=i.length,o=void 0,s=e.length,l=this.nCachedObjects_,u=0,c=arguments.length;u!==c;++u){var h=arguments[u],d=h.uuid,f=t[d];if(void 0===f){f=s++,t[d]=f,e.push(h);for(var p=0,v=a;p!==v;++p)i[p].push(new qc(h,n[p],r[p]))}else if(f<l){o=e[f];var m=--l,g=e[m];t[g.uuid]=f,e[f]=g,t[d]=m,e[m]=h;for(var _=0,y=a;_!==y;++_){var x=i[_],b=x[m],w=x[f];x[f]=b,void 0===w&&(w=new qc(h,n[_],r[_])),x[m]=w}}else e[f]!==o&&console.error("THREE.AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.")}this.nCachedObjects_=l}},{key:"remove",value:function(){for(var e=this._objects,t=this._indicesByUUID,n=this._bindings,r=n.length,i=this.nCachedObjects_,a=0,o=arguments.length;a!==o;++a){var s=arguments[a],l=s.uuid,u=t[l];if(void 0!==u&&u>=i){var c=i++,h=e[c];t[h.uuid]=u,e[u]=h,t[l]=c,e[c]=s;for(var d=0,f=r;d!==f;++d){var p=n[d],v=p[c],m=p[u];p[u]=v,p[c]=m}}}this.nCachedObjects_=i}},{key:"uncache",value:function(){for(var e=this._objects,t=this._indicesByUUID,n=this._bindings,r=n.length,i=this.nCachedObjects_,a=e.length,o=0,s=arguments.length;o!==s;++o){var l=arguments[o],u=l.uuid,c=t[u];if(void 0!==c)if(delete t[u],c<i){var h=--i,d=e[h],f=--a,p=e[f];t[d.uuid]=c,e[c]=d,t[p.uuid]=h,e[h]=p,e.pop();for(var v=0,m=r;v!==m;++v){var g=n[v],_=g[h],y=g[f];g[c]=_,g[h]=y,g.pop()}}else{var x=--a,b=e[x];x>0&&(t[b.uuid]=c),e[c]=b,e.pop();for(var w=0,T=r;w!==T;++w){var M=n[w];M[c]=M[x],M.pop()}}}this.nCachedObjects_=i}},{key:"subscribe_",value:function(e,t){var n=this._bindingsIndicesByPath,r=n[e],i=this._bindings;if(void 0!==r)return i[r];var a=this._paths,o=this._parsedPaths,s=this._objects,l=s.length,u=this.nCachedObjects_,c=new Array(l);r=i.length,n[e]=r,a.push(e),o.push(t),i.push(c);for(var h=u,d=s.length;h!==d;++h){var f=s[h];c[h]=new qc(f,e,t)}return c}},{key:"unsubscribe_",value:function(e){var t=this._bindingsIndicesByPath,n=t[e];if(void 0!==n){var r=this._paths,i=this._parsedPaths,a=this._bindings,o=a.length-1,s=a[o];t[e[o]]=n,a[n]=s,a.pop(),i[n]=i[o],i.pop(),r[n]=r[o],r.pop()}}}]),e}();Xc.prototype.isAnimationObjectGroup=!0;var Yc=function(){function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:n.blendMode;(0,v.default)(this,e),this._mixer=t,this._clip=n,this._localRoot=r,this.blendMode=i;for(var a=n.tracks,o=a.length,s=new Array(o),l={endingStart:ie,endingEnd:ie},u=0;u!==o;++u){var c=a[u].createInterpolant(null);s[u]=c,c.settings=l}this._interpolantSettings=l,this._interpolants=s,this._propertyBindings=new Array(o),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=ee,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}return(0,m.default)(e,[{key:"play",value:function(){return this._mixer._activateAction(this),this}},{key:"stop",value:function(){return this._mixer._deactivateAction(this),this.reset()}},{key:"reset",value:function(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()}},{key:"isRunning",value:function(){return this.enabled&&!this.paused&&0!==this.timeScale&&null===this._startTime&&this._mixer._isActiveAction(this)}},{key:"isScheduled",value:function(){return this._mixer._isActiveAction(this)}},{key:"startAt",value:function(e){return this._startTime=e,this}},{key:"setLoop",value:function(e,t){return this.loop=e,this.repetitions=t,this}},{key:"setEffectiveWeight",value:function(e){return this.weight=e,this._effectiveWeight=this.enabled?e:0,this.stopFading()}},{key:"getEffectiveWeight",value:function(){return this._effectiveWeight}},{key:"fadeIn",value:function(e){return this._scheduleFading(e,0,1)}},{key:"fadeOut",value:function(e){return this._scheduleFading(e,1,0)}},{key:"crossFadeFrom",value:function(e,t,n){if(e.fadeOut(t),this.fadeIn(t),n){var r=this._clip.duration,i=e._clip.duration,a=i/r,o=r/i;e.warp(1,a,t),this.warp(o,1,t)}return this}},{key:"crossFadeTo",value:function(e,t,n){return e.crossFadeFrom(this,t,n)}},{key:"stopFading",value:function(){var e=this._weightInterpolant;return null!==e&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}},{key:"setEffectiveTimeScale",value:function(e){return this.timeScale=e,this._effectiveTimeScale=this.paused?0:e,this.stopWarping()}},{key:"getEffectiveTimeScale",value:function(){return this._effectiveTimeScale}},{key:"setDuration",value:function(e){return this.timeScale=this._clip.duration/e,this.stopWarping()}},{key:"syncWith",value:function(e){return this.time=e.time,this.timeScale=e.timeScale,this.stopWarping()}},{key:"halt",value:function(e){return this.warp(this._effectiveTimeScale,0,e)}},{key:"warp",value:function(e,t,n){var r=this._mixer,i=r.time,a=this.timeScale,o=this._timeScaleInterpolant;null===o&&(o=r._lendControlInterpolant(),this._timeScaleInterpolant=o);var s=o.parameterPositions,l=o.sampleValues;return s[0]=i,s[1]=i+n,l[0]=e/a,l[1]=t/a,this}},{key:"stopWarping",value:function(){var e=this._timeScaleInterpolant;return null!==e&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}},{key:"getMixer",value:function(){return this._mixer}},{key:"getClip",value:function(){return this._clip}},{key:"getRoot",value:function(){return this._localRoot||this._mixer._root}},{key:"_update",value:function(e,t,n,r){if(this.enabled){var i=this._startTime;if(null!==i){var a=(e-i)*n;if(a<0||0===n)return;this._startTime=null,t=n*a}t*=this._updateTimeScale(e);var o=this._updateTime(t),s=this._updateWeight(e);if(s>0){var l=this._interpolants,u=this._propertyBindings;if(this.blendMode===le)for(var c=0,h=l.length;c!==h;++c)l[c].evaluate(o),u[c].accumulateAdditive(s);else for(var d=0,f=l.length;d!==f;++d)l[d].evaluate(o),u[d].accumulate(r,s)}}else this._updateWeight(e)}},{key:"_updateWeight",value:function(e){var t=0;if(this.enabled){t=this.weight;var n=this._weightInterpolant;if(null!==n){var r=n.evaluate(e)[0];t*=r,e>n.parameterPositions[1]&&(this.stopFading(),0===r&&(this.enabled=!1))}}return this._effectiveWeight=t,t}},{key:"_updateTimeScale",value:function(e){var t=0;if(!this.paused){t=this.timeScale;var n=this._timeScaleInterpolant;null!==n&&(t*=n.evaluate(e)[0],e>n.parameterPositions[1]&&(this.stopWarping(),0===t?this.paused=!0:this.timeScale=t))}return this._effectiveTimeScale=t,t}},{key:"_updateTime",value:function(e){var t=this._clip.duration,n=this.loop,r=this.time+e,i=this._loopCount,a=2202===n;if(0===e)return-1===i?r:a&&1==(1&i)?t-r:r;if(2200===n){-1===i&&(this._loopCount=0,this._setEndings(!0,!0,!1));e:{if(r>=t)r=t;else{if(!(r<0)){this.time=r;break e}r=0}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=r,this._mixer.dispatchEvent({type:"finished",action:this,direction:e<0?-1:1})}}else{if(-1===i&&(e>=0?(i=0,this._setEndings(!0,0===this.repetitions,a)):this._setEndings(0===this.repetitions,!0,a)),r>=t||r<0){var o=Math.floor(r/t);r-=t*o,i+=Math.abs(o);var s=this.repetitions-i;if(s<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,r=e>0?t:0,this.time=r,this._mixer.dispatchEvent({type:"finished",action:this,direction:e>0?1:-1});else{if(1===s){var l=e<0;this._setEndings(l,!l,a)}else this._setEndings(!1,!1,a);this._loopCount=i,this.time=r,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:o})}}else this.time=r;if(a&&1==(1&i))return t-r}return r}},{key:"_setEndings",value:function(e,t,n){var r=this._interpolantSettings;n?(r.endingStart=ae,r.endingEnd=ae):(r.endingStart=e?this.zeroSlopeAtStart?ae:ie:oe,r.endingEnd=t?this.zeroSlopeAtEnd?ae:ie:oe)}},{key:"_scheduleFading",value:function(e,t,n){var r=this._mixer,i=r.time,a=this._weightInterpolant;null===a&&(a=r._lendControlInterpolant(),this._weightInterpolant=a);var o=a.parameterPositions,s=a.sampleValues;return o[0]=i,s[0]=t,o[1]=i+e,s[1]=n,this}}]),e}(),Kc=function(e){(0,d.default)(n,e);var t=b(n);function n(e){var r;return(0,v.default)(this,n),(r=t.call(this))._root=e,r._initMemoryManager(),r._accuIndex=0,r.time=0,r.timeScale=1,r}return(0,m.default)(n,[{key:"_bindAction",value:function(e,t){var n=e._localRoot||this._root,r=e._clip.tracks,i=r.length,a=e._propertyBindings,o=e._interpolants,s=n.uuid,l=this._bindingsByRootAndName,u=l[s];void 0===u&&(u={},l[s]=u);for(var c=0;c!==i;++c){var h=r[c],d=h.name,f=u[d];if(void 0!==f)a[c]=f;else{if(void 0!==(f=a[c])){null===f._cacheIndex&&(++f.referenceCount,this._addInactiveBinding(f,s,d));continue}var p=t&&t._propertyBindings[c].binding.parsedPath;++(f=new Ic(qc.create(n,d,p),h.ValueTypeName,h.getValueSize())).referenceCount,this._addInactiveBinding(f,s,d),a[c]=f}o[c].resultBuffer=f.buffer}}},{key:"_activateAction",value:function(e){if(!this._isActiveAction(e)){if(null===e._cacheIndex){var t=(e._localRoot||this._root).uuid,n=e._clip.uuid,r=this._actionsByClip[n];this._bindAction(e,r&&r.knownActions[0]),this._addInactiveAction(e,n,t)}for(var i=e._propertyBindings,a=0,o=i.length;a!==o;++a){var s=i[a];0==s.useCount++&&(this._lendBinding(s),s.saveOriginalState())}this._lendAction(e)}}},{key:"_deactivateAction",value:function(e){if(this._isActiveAction(e)){for(var t=e._propertyBindings,n=0,r=t.length;n!==r;++n){var i=t[n];0==--i.useCount&&(i.restoreOriginalState(),this._takeBackBinding(i))}this._takeBackAction(e)}}},{key:"_initMemoryManager",value:function(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;var e=this;this.stats={actions:{get total(){return e._actions.length},get inUse(){return e._nActiveActions}},bindings:{get total(){return e._bindings.length},get inUse(){return e._nActiveBindings}},controlInterpolants:{get total(){return e._controlInterpolants.length},get inUse(){return e._nActiveControlInterpolants}}}}},{key:"_isActiveAction",value:function(e){var t=e._cacheIndex;return null!==t&&t<this._nActiveActions}},{key:"_addInactiveAction",value:function(e,t,n){var r=this._actions,i=this._actionsByClip,a=i[t];if(void 0===a)a={knownActions:[e],actionByRoot:{}},e._byClipCacheIndex=0,i[t]=a;else{var o=a.knownActions;e._byClipCacheIndex=o.length,o.push(e)}e._cacheIndex=r.length,r.push(e),a.actionByRoot[n]=e}},{key:"_removeInactiveAction",value:function(e){var t=this._actions,n=t[t.length-1],r=e._cacheIndex;n._cacheIndex=r,t[r]=n,t.pop(),e._cacheIndex=null;var i=e._clip.uuid,a=this._actionsByClip,o=a[i],s=o.knownActions,l=s[s.length-1],u=e._byClipCacheIndex;l._byClipCacheIndex=u,s[u]=l,s.pop(),e._byClipCacheIndex=null,delete o.actionByRoot[(e._localRoot||this._root).uuid],0===s.length&&delete a[i],this._removeInactiveBindingsForAction(e)}},{key:"_removeInactiveBindingsForAction",value:function(e){for(var t=e._propertyBindings,n=0,r=t.length;n!==r;++n){var i=t[n];0==--i.referenceCount&&this._removeInactiveBinding(i)}}},{key:"_lendAction",value:function(e){var t=this._actions,n=e._cacheIndex,r=this._nActiveActions++,i=t[r];e._cacheIndex=r,t[r]=e,i._cacheIndex=n,t[n]=i}},{key:"_takeBackAction",value:function(e){var t=this._actions,n=e._cacheIndex,r=--this._nActiveActions,i=t[r];e._cacheIndex=r,t[r]=e,i._cacheIndex=n,t[n]=i}},{key:"_addInactiveBinding",value:function(e,t,n){var r=this._bindingsByRootAndName,i=this._bindings,a=r[t];void 0===a&&(a={},r[t]=a),a[n]=e,e._cacheIndex=i.length,i.push(e)}},{key:"_removeInactiveBinding",value:function(e){var t=this._bindings,n=e.binding,r=n.rootNode.uuid,i=n.path,a=this._bindingsByRootAndName,o=a[r],s=t[t.length-1],l=e._cacheIndex;s._cacheIndex=l,t[l]=s,t.pop(),delete o[i],0===Object.keys(o).length&&delete a[r]}},{key:"_lendBinding",value:function(e){var t=this._bindings,n=e._cacheIndex,r=this._nActiveBindings++,i=t[r];e._cacheIndex=r,t[r]=e,i._cacheIndex=n,t[n]=i}},{key:"_takeBackBinding",value:function(e){var t=this._bindings,n=e._cacheIndex,r=--this._nActiveBindings,i=t[r];e._cacheIndex=r,t[r]=e,i._cacheIndex=n,t[n]=i}},{key:"_lendControlInterpolant",value:function(){var e=this._controlInterpolants,t=this._nActiveControlInterpolants++,n=e[t];return void 0===n&&((n=new au(new Float32Array(2),new Float32Array(2),1,this._controlInterpolantsResultBuffer)).__cacheIndex=t,e[t]=n),n}},{key:"_takeBackControlInterpolant",value:function(e){var t=this._controlInterpolants,n=e.__cacheIndex,r=--this._nActiveControlInterpolants,i=t[r];e.__cacheIndex=r,t[r]=e,i.__cacheIndex=n,t[n]=i}},{key:"clipAction",value:function(e,t,n){var r=t||this._root,i=r.uuid,a="string"==typeof e?vu.findByName(r,e):e,o=null!==a?a.uuid:e,s=this._actionsByClip[o],l=null;if(void 0===n&&(n=null!==a?a.blendMode:se),void 0!==s){var u=s.actionByRoot[i];if(void 0!==u&&u.blendMode===n)return u;l=s.knownActions[0],null===a&&(a=l._clip)}if(null===a)return null;var c=new Yc(this,a,t,n);return this._bindAction(c,l),this._addInactiveAction(c,o,i),c}},{key:"existingAction",value:function(e,t){var n=t||this._root,r=n.uuid,i="string"==typeof e?vu.findByName(n,e):e,a=i?i.uuid:e,o=this._actionsByClip[a];return void 0!==o&&o.actionByRoot[r]||null}},{key:"stopAllAction",value:function(){for(var e=this._actions,t=this._nActiveActions-1;t>=0;--t)e[t].stop();return this}},{key:"update",value:function(e){e*=this.timeScale;for(var t=this._actions,n=this._nActiveActions,r=this.time+=e,i=Math.sign(e),a=this._accuIndex^=1,o=0;o!==n;++o)t[o]._update(r,e,i,a);for(var s=this._bindings,l=this._nActiveBindings,u=0;u!==l;++u)s[u].apply(a);return this}},{key:"setTime",value:function(e){this.time=0;for(var t=0;t<this._actions.length;t++)this._actions[t].time=0;return this.update(e)}},{key:"getRoot",value:function(){return this._root}},{key:"uncacheClip",value:function(e){var t=this._actions,n=e.uuid,r=this._actionsByClip,i=r[n];if(void 0!==i){for(var a=i.knownActions,o=0,s=a.length;o!==s;++o){var l=a[o];this._deactivateAction(l);var u=l._cacheIndex,c=t[t.length-1];l._cacheIndex=null,l._byClipCacheIndex=null,c._cacheIndex=u,t[u]=c,t.pop(),this._removeInactiveBindingsForAction(l)}delete r[n]}}},{key:"uncacheRoot",value:function(e){var t=e.uuid,n=this._actionsByClip;for(var r in n){var i=n[r].actionByRoot[t];void 0!==i&&(this._deactivateAction(i),this._removeInactiveAction(i))}var a=this._bindingsByRootAndName[t];if(void 0!==a)for(var o in a){var s=a[o];s.restoreOriginalState(),this._removeInactiveBinding(s)}}},{key:"uncacheAction",value:function(e,t){var n=this.existingAction(e,t);null!==n&&(this._deactivateAction(n),this._removeInactiveAction(n))}}]),n}(xe);Kc.prototype._controlInterpolantsResultBuffer=new Float32Array(1);var Zc=function(){function e(t){(0,v.default)(this,e),"string"==typeof t&&(console.warn("THREE.Uniform: Type parameter is no longer needed."),t=arguments[1]),this.value=t}return(0,m.default)(e,[{key:"clone",value:function(){return new e(void 0===this.value.clone?this.value:this.value.clone())}}]),e}(),Jc=function(e){(0,d.default)(n,e);var t=b(n);function n(e,r){var i,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return(0,v.default)(this,n),(i=t.call(this,e,r)).meshPerAttribute=a,i}return(0,m.default)(n,[{key:"copy",value:function(e){return(0,u.default)((0,p.default)(n.prototype),"copy",this).call(this,e),this.meshPerAttribute=e.meshPerAttribute,this}},{key:"clone",value:function(e){var t=(0,u.default)((0,p.default)(n.prototype),"clone",this).call(this,e);return t.meshPerAttribute=this.meshPerAttribute,t}},{key:"toJSON",value:function(e){var t=(0,u.default)((0,p.default)(n.prototype),"toJSON",this).call(this,e);return t.isInstancedInterleavedBuffer=!0,t.meshPerAttribute=this.meshPerAttribute,t}}]),n}(_o);Jc.prototype.isInstancedInterleavedBuffer=!0;var Qc=function(){function e(t,n,r,i,a){(0,v.default)(this,e),this.buffer=t,this.type=n,this.itemSize=r,this.elementSize=i,this.count=a,this.version=0}return(0,m.default)(e,[{key:"needsUpdate",set:function(e){!0===e&&this.version++}},{key:"setBuffer",value:function(e){return this.buffer=e,this}},{key:"setType",value:function(e,t){return this.type=e,this.elementSize=t,this}},{key:"setItemSize",value:function(e){return this.itemSize=e,this}},{key:"setCount",value:function(e){return this.count=e,this}}]),e}();Qc.prototype.isGLBufferAttribute=!0;var $c=function(){function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1/0;(0,v.default)(this,e),this.ray=new wt(t,n),this.near=r,this.far=i,this.camera=null,this.layers=new It,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}}}return(0,m.default)(e,[{key:"set",value:function(e,t){this.ray.set(e,t)}},{key:"setFromCamera",value:function(e,t){t&&t.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(t.matrixWorld),this.ray.direction.set(e.x,e.y,.5).unproject(t).sub(this.ray.origin).normalize(),this.camera=t):t&&t.isOrthographicCamera?(this.ray.origin.set(e.x,e.y,(t.near+t.far)/(t.near-t.far)).unproject(t),this.ray.direction.set(0,0,-1).transformDirection(t.matrixWorld),this.camera=t):console.error("THREE.Raycaster: Unsupported camera type: "+t.type)}},{key:"intersectObject",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];return th(e,this,n,t),n.sort(eh),n}},{key:"intersectObjects",value:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=0,i=e.length;r<i;r++)th(e[r],this,n,t);return n.sort(eh),n}}]),e}();function eh(e,t){return e.distance-t.distance}function th(e,t,n,r){if(e.layers.test(t.layers)&&e.raycast(t,n),!0===r)for(var i=e.children,a=0,o=i.length;a<o;a++)th(i[a],t,n,!0)}var nh=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return(0,v.default)(this,e),this.radius=t,this.phi=n,this.theta=r,this}return(0,m.default)(e,[{key:"set",value:function(e,t,n){return this.radius=e,this.phi=t,this.theta=n,this}},{key:"copy",value:function(e){return this.radius=e.radius,this.phi=e.phi,this.theta=e.theta,this}},{key:"makeSafe",value:function(){var e=1e-6;return this.phi=Math.max(e,Math.min(Math.PI-e,this.phi)),this}},{key:"setFromVector3",value:function(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}},{key:"setFromCartesianCoords",value:function(e,t,n){return this.radius=Math.sqrt(e*e+t*t+n*n),0===this.radius?(this.theta=0,this.phi=0):(this.theta=Math.atan2(e,n),this.phi=Math.acos(Ae(t/this.radius,-1,1))),this}},{key:"clone",value:function(){return(new this.constructor).copy(this)}}]),e}(),rh=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return(0,v.default)(this,e),this.radius=t,this.theta=n,this.y=r,this}return(0,m.default)(e,[{key:"set",value:function(e,t,n){return this.radius=e,this.theta=t,this.y=n,this}},{key:"copy",value:function(e){return this.radius=e.radius,this.theta=e.theta,this.y=e.y,this}},{key:"setFromVector3",value:function(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}},{key:"setFromCartesianCoords",value:function(e,t,n){return this.radius=Math.sqrt(e*e+n*n),this.theta=Math.atan2(e,n),this.y=t,this}},{key:"clone",value:function(){return(new this.constructor).copy(this)}}]),e}(),ih=new Ie,ah=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Ie(1/0,1/0),n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Ie(-1/0,-1/0);(0,v.default)(this,e),this.min=t,this.max=n}return(0,m.default)(e,[{key:"set",value:function(e,t){return this.min.copy(e),this.max.copy(t),this}},{key:"setFromPoints",value:function(e){this.makeEmpty();for(var t=0,n=e.length;t<n;t++)this.expandByPoint(e[t]);return this}},{key:"setFromCenterAndSize",value:function(e,t){var n=ih.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(n),this.max.copy(e).add(n),this}},{key:"clone",value:function(){return(new this.constructor).copy(this)}},{key:"copy",value:function(e){return this.min.copy(e.min),this.max.copy(e.max),this}},{key:"makeEmpty",value:function(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this}},{key:"isEmpty",value:function(){return this.max.x<this.min.x||this.max.y<this.min.y}},{key:"getCenter",value:function(e){return this.isEmpty()?e.set(0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}},{key:"getSize",value:function(e){return this.isEmpty()?e.set(0,0):e.subVectors(this.max,this.min)}},{key:"expandByPoint",value:function(e){return this.min.min(e),this.max.max(e),this}},{key:"expandByVector",value:function(e){return this.min.sub(e),this.max.add(e),this}},{key:"expandByScalar",value:function(e){return this.min.addScalar(-e),this.max.addScalar(e),this}},{key:"containsPoint",value:function(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y)}},{key:"containsBox",value:function(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y}},{key:"getParameter",value:function(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y))}},{key:"intersectsBox",value:function(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y)}},{key:"clampPoint",value:function(e,t){return t.copy(e).clamp(this.min,this.max)}},{key:"distanceToPoint",value:function(e){return ih.copy(e).clamp(this.min,this.max).sub(e).length()}},{key:"intersect",value:function(e){return this.min.max(e.min),this.max.min(e.max),this}},{key:"union",value:function(e){return this.min.min(e.min),this.max.max(e.max),this}},{key:"translate",value:function(e){return this.min.add(e),this.max.add(e),this}},{key:"equals",value:function(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}]),e}();ah.prototype.isBox2=!0;var oh=new qe,sh=new qe,lh=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new qe,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new qe;(0,v.default)(this,e),this.start=t,this.end=n}return(0,m.default)(e,[{key:"set",value:function(e,t){return this.start.copy(e),this.end.copy(t),this}},{key:"copy",value:function(e){return this.start.copy(e.start),this.end.copy(e.end),this}},{key:"getCenter",value:function(e){return e.addVectors(this.start,this.end).multiplyScalar(.5)}},{key:"delta",value:function(e){return e.subVectors(this.end,this.start)}},{key:"distanceSq",value:function(){return this.start.distanceToSquared(this.end)}},{key:"distance",value:function(){return this.start.distanceTo(this.end)}},{key:"at",value:function(e,t){return this.delta(t).multiplyScalar(e).add(this.start)}},{key:"closestPointToPointParameter",value:function(e,t){oh.subVectors(e,this.start),sh.subVectors(this.end,this.start);var n=sh.dot(sh),r=sh.dot(oh)/n;return t&&(r=Ae(r,0,1)),r}},{key:"closestPointToPoint",value:function(e,t,n){var r=this.closestPointToPointParameter(e,t);return this.delta(n).multiplyScalar(r).add(this.start)}},{key:"applyMatrix4",value:function(e){return this.start.applyMatrix4(e),this.end.applyMatrix4(e),this}},{key:"equals",value:function(e){return e.start.equals(this.start)&&e.end.equals(this.end)}},{key:"clone",value:function(){return(new this.constructor).copy(this)}}]),e}(),uh=function(e){(0,d.default)(n,e);var t=b(n);function n(e){var r;return(0,v.default)(this,n),(r=t.call(this)).material=e,r.render=function(){},r.hasPositions=!1,r.hasNormals=!1,r.hasColors=!1,r.hasUvs=!1,r.positionArray=null,r.normalArray=null,r.colorArray=null,r.uvArray=null,r.count=0,r}return(0,m.default)(n)}(Yt);uh.prototype.isImmediateRenderObject=!0;var ch=new qe,hh=function(e){(0,d.default)(n,e);var t=b(n);function n(e,r){var i;(0,v.default)(this,n),(i=t.call(this)).light=e,i.light.updateMatrixWorld(),i.matrix=e.matrixWorld,i.matrixAutoUpdate=!1,i.color=r;for(var a=new zn,o=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1],s=0,l=1;s<32;s++,l++){var u=s/32*Math.PI*2,c=l/32*Math.PI*2;o.push(Math.cos(u),Math.sin(u),1,Math.cos(c),Math.sin(c),1)}a.setAttribute("position",new Ln(o,3));var h=new ns({fog:!1,toneMapped:!1});return i.cone=new hs(a,h),i.add(i.cone),i.update(),i}return(0,m.default)(n,[{key:"dispose",value:function(){this.cone.geometry.dispose(),this.cone.material.dispose()}},{key:"update",value:function(){this.light.updateMatrixWorld();var e=this.light.distance?this.light.distance:1e3,t=e*Math.tan(this.light.angle);this.cone.scale.set(t,t,e),ch.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(ch),void 0!==this.color?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)}}]),n}(Yt),dh=new qe,fh=new Tt,ph=new Tt,vh=function(e){(0,d.default)(n,e);var t=b(n);function n(e){var r;(0,v.default)(this,n);for(var i=mh(e),a=new zn,o=[],s=[],l=new vn(0,0,1),u=new vn(0,1,0),c=0;c<i.length;c++){var h=i[c];h.parent&&h.parent.isBone&&(o.push(0,0,0),o.push(0,0,0),s.push(l.r,l.g,l.b),s.push(u.r,u.g,u.b))}a.setAttribute("position",new Ln(o,3)),a.setAttribute("color",new Ln(s,3));var d=new ns({vertexColors:!0,depthTest:!1,depthWrite:!1,toneMapped:!1,transparent:!0});return(r=t.call(this,a,d)).type="SkeletonHelper",r.isSkeletonHelper=!0,r.root=e,r.bones=i,r.matrix=e.matrixWorld,r.matrixAutoUpdate=!1,r}return(0,m.default)(n,[{key:"updateMatrixWorld",value:function(e){var t=this.bones,r=this.geometry,i=r.getAttribute("position");ph.copy(this.root.matrixWorld).invert();for(var a=0,o=0;a<t.length;a++){var s=t[a];s.parent&&s.parent.isBone&&(fh.multiplyMatrices(ph,s.matrixWorld),dh.setFromMatrixPosition(fh),i.setXYZ(o,dh.x,dh.y,dh.z),fh.multiplyMatrices(ph,s.parent.matrixWorld),dh.setFromMatrixPosition(fh),i.setXYZ(o+1,dh.x,dh.y,dh.z),o+=2)}r.getAttribute("position").needsUpdate=!0,(0,u.default)((0,p.default)(n.prototype),"updateMatrixWorld",this).call(this,e)}}]),n}(hs);function mh(e){var t=[];e&&e.isBone&&t.push(e);for(var n=0;n<e.children.length;n++)t.push.apply(t,mh(e.children[n]));return t}var gh=function(e){(0,d.default)(n,e);var t=b(n);function n(e,r,i){var a;(0,v.default)(this,n);var o=new Nl(r,4,2),s=new mn({wireframe:!0,fog:!1,toneMapped:!1});return(a=t.call(this,o,s)).light=e,a.light.updateMatrixWorld(),a.color=i,a.type="PointLightHelper",a.matrix=a.light.matrixWorld,a.matrixAutoUpdate=!1,a.update(),a}return(0,m.default)(n,[{key:"dispose",value:function(){this.geometry.dispose(),this.material.dispose()}},{key:"update",value:function(){void 0!==this.color?this.material.color.set(this.color):this.material.color.copy(this.light.color)}}]),n}(ir),_h=new qe,yh=new vn,xh=new vn,bh=function(e){(0,d.default)(n,e);var t=b(n);function n(e,r,i){var a;(0,v.default)(this,n),(a=t.call(this)).light=e,a.light.updateMatrixWorld(),a.matrix=e.matrixWorld,a.matrixAutoUpdate=!1,a.color=i;var o=new Dl(r);o.rotateY(.5*Math.PI),a.material=new mn({wireframe:!0,fog:!1,toneMapped:!1}),void 0===a.color&&(a.material.vertexColors=!0);var s=o.getAttribute("position"),l=new Float32Array(3*s.count);return o.setAttribute("color",new yn(l,3)),a.add(new ir(o,a.material)),a.update(),a}return(0,m.default)(n,[{key:"dispose",value:function(){this.children[0].geometry.dispose(),this.children[0].material.dispose()}},{key:"update",value:function(){var e=this.children[0];if(void 0!==this.color)this.material.color.set(this.color);else{var t=e.geometry.getAttribute("color");yh.copy(this.light.color),xh.copy(this.light.groundColor);for(var n=0,r=t.count;n<r;n++){var i=n<r/2?yh:xh;t.setXYZ(n,i.r,i.g,i.b)}t.needsUpdate=!0}e.lookAt(_h.setFromMatrixPosition(this.light.matrixWorld).negate())}}]),n}(Yt),wh=function(e){(0,d.default)(n,e);var t=b(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:4473924,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:8947848;(0,v.default)(this,n),a=new vn(a),o=new vn(o);for(var s=i/2,l=r/i,u=r/2,c=[],h=[],d=0,f=0,p=-u;d<=i;d++,p+=l){c.push(-u,0,p,u,0,p),c.push(p,0,-u,p,0,u);var m=d===s?a:o;m.toArray(h,f),f+=3,m.toArray(h,f),f+=3,m.toArray(h,f),f+=3,m.toArray(h,f),f+=3}var g=new zn;g.setAttribute("position",new Ln(c,3)),g.setAttribute("color",new Ln(h,3));var _=new ns({vertexColors:!0,toneMapped:!1});return(e=t.call(this,g,_)).type="GridHelper",e}return(0,m.default)(n)}(hs),Th=function(e){(0,d.default)(n,e);var t=b(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:16,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:8,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:64,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:4473924,l=arguments.length>5&&void 0!==arguments[5]?arguments[5]:8947848;(0,v.default)(this,n),s=new vn(s),l=new vn(l);for(var u=[],c=[],h=0;h<=i;h++){var d=h/i*(2*Math.PI),f=Math.sin(d)*r,p=Math.cos(d)*r;u.push(0,0,0),u.push(f,0,p);var m=1&h?s:l;c.push(m.r,m.g,m.b),c.push(m.r,m.g,m.b)}for(var g=0;g<=a;g++)for(var _=1&g?s:l,y=r-r/a*g,x=0;x<o;x++){var b=x/o*(2*Math.PI),w=Math.sin(b)*y,T=Math.cos(b)*y;u.push(w,0,T),c.push(_.r,_.g,_.b),b=(x+1)/o*(2*Math.PI),w=Math.sin(b)*y,T=Math.cos(b)*y,u.push(w,0,T),c.push(_.r,_.g,_.b)}var M=new zn;M.setAttribute("position",new Ln(u,3)),M.setAttribute("color",new Ln(c,3));var S=new ns({vertexColors:!0,toneMapped:!1});return(e=t.call(this,M,S)).type="PolarGridHelper",e}return(0,m.default)(n)}(hs),Mh=new qe,Sh=new qe,Eh=new qe,Ah=function(e){(0,d.default)(n,e);var t=b(n);function n(e,r,i){var a;(0,v.default)(this,n),(a=t.call(this)).light=e,a.light.updateMatrixWorld(),a.matrix=e.matrixWorld,a.matrixAutoUpdate=!1,a.color=i,void 0===r&&(r=1);var o=new zn;o.setAttribute("position",new Ln([-r,r,0,r,r,0,r,-r,0,-r,-r,0,-r,r,0],3));var s=new ns({fog:!1,toneMapped:!1});return a.lightPlane=new ls(o,s),a.add(a.lightPlane),(o=new zn).setAttribute("position",new Ln([0,0,0,0,0,1],3)),a.targetLine=new ls(o,s),a.add(a.targetLine),a.update(),a}return(0,m.default)(n,[{key:"dispose",value:function(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()}},{key:"update",value:function(){Mh.setFromMatrixPosition(this.light.matrixWorld),Sh.setFromMatrixPosition(this.light.target.matrixWorld),Eh.subVectors(Sh,Mh),this.lightPlane.lookAt(Sh),void 0!==this.color?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)),this.targetLine.lookAt(Sh),this.targetLine.scale.z=Eh.length()}}]),n}(Yt),Lh=new qe,Ch=new hr,Rh=function(e){(0,d.default)(n,e);var t=b(n);function n(e){var r;(0,v.default)(this,n);var i=new zn,a=new ns({color:16777215,vertexColors:!0,toneMapped:!1}),o=[],s=[],l={},u=new vn(16755200),c=new vn(16711680),h=new vn(43775),d=new vn(16777215),f=new vn(3355443);function p(e,t,n){m(e,n),m(t,n)}function m(e,t){o.push(0,0,0),s.push(t.r,t.g,t.b),void 0===l[e]&&(l[e]=[]),l[e].push(o.length/3-1)}return p("n1","n2",u),p("n2","n4",u),p("n4","n3",u),p("n3","n1",u),p("f1","f2",u),p("f2","f4",u),p("f4","f3",u),p("f3","f1",u),p("n1","f1",u),p("n2","f2",u),p("n3","f3",u),p("n4","f4",u),p("p","n1",c),p("p","n2",c),p("p","n3",c),p("p","n4",c),p("u1","u2",h),p("u2","u3",h),p("u3","u1",h),p("c","t",d),p("p","c",f),p("cn1","cn2",f),p("cn3","cn4",f),p("cf1","cf2",f),p("cf3","cf4",f),i.setAttribute("position",new Ln(o,3)),i.setAttribute("color",new Ln(s,3)),(r=t.call(this,i,a)).type="CameraHelper",r.camera=e,r.camera.updateProjectionMatrix&&r.camera.updateProjectionMatrix(),r.matrix=e.matrixWorld,r.matrixAutoUpdate=!1,r.pointMap=l,r.update(),r}return(0,m.default)(n,[{key:"update",value:function(){var e=this.geometry,t=this.pointMap;Ch.projectionMatrixInverse.copy(this.camera.projectionMatrixInverse),kh("c",t,e,Ch,0,0,-1),kh("t",t,e,Ch,0,0,1),kh("n1",t,e,Ch,-1,-1,-1),kh("n2",t,e,Ch,1,-1,-1),kh("n3",t,e,Ch,-1,1,-1),kh("n4",t,e,Ch,1,1,-1),kh("f1",t,e,Ch,-1,-1,1),kh("f2",t,e,Ch,1,-1,1),kh("f3",t,e,Ch,-1,1,1),kh("f4",t,e,Ch,1,1,1),kh("u1",t,e,Ch,.7,1.1,-1),kh("u2",t,e,Ch,-.7,1.1,-1),kh("u3",t,e,Ch,0,2,-1),kh("cf1",t,e,Ch,-1,0,1),kh("cf2",t,e,Ch,1,0,1),kh("cf3",t,e,Ch,0,-1,1),kh("cf4",t,e,Ch,0,1,1),kh("cn1",t,e,Ch,-1,0,-1),kh("cn2",t,e,Ch,1,0,-1),kh("cn3",t,e,Ch,0,-1,-1),kh("cn4",t,e,Ch,0,1,-1),e.getAttribute("position").needsUpdate=!0}},{key:"dispose",value:function(){this.geometry.dispose(),this.material.dispose()}}]),n}(hs);function kh(e,t,n,r,i,a,o){Lh.set(i,a,o).unproject(r);var s=t[e];if(void 0!==s)for(var l=n.getAttribute("position"),u=0,c=s.length;u<c;u++)l.setXYZ(s[u],Lh.x,Lh.y,Lh.z)}var Ph,Dh,Ih=new Ke,Oh=function(e){(0,d.default)(n,e);var t=b(n);function n(e){var r,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:16776960;(0,v.default)(this,n);var a=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),o=new Float32Array(24),s=new zn;return s.setIndex(new yn(a,1)),s.setAttribute("position",new yn(o,3)),(r=t.call(this,s,new ns({color:i,toneMapped:!1}))).object=e,r.type="BoxHelper",r.matrixAutoUpdate=!1,r.update(),r}return(0,m.default)(n,[{key:"update",value:function(e){if(void 0!==e&&console.warn("THREE.BoxHelper: .update() has no longer arguments."),void 0!==this.object&&Ih.setFromObject(this.object),!Ih.isEmpty()){var t=Ih.min,n=Ih.max,r=this.geometry.attributes.position,i=r.array;i[0]=n.x,i[1]=n.y,i[2]=n.z,i[3]=t.x,i[4]=n.y,i[5]=n.z,i[6]=t.x,i[7]=t.y,i[8]=n.z,i[9]=n.x,i[10]=t.y,i[11]=n.z,i[12]=n.x,i[13]=n.y,i[14]=t.z,i[15]=t.x,i[16]=n.y,i[17]=t.z,i[18]=t.x,i[19]=t.y,i[20]=t.z,i[21]=n.x,i[22]=t.y,i[23]=t.z,r.needsUpdate=!0,this.geometry.computeBoundingSphere()}}},{key:"setFromObject",value:function(e){return this.object=e,this.update(),this}},{key:"copy",value:function(e){return hs.prototype.copy.call(this,e),this.object=e.object,this}}]),n}(hs),Fh=function(e){(0,d.default)(n,e);var t=b(n);function n(e){var r,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:16776960;(0,v.default)(this,n);var a=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),o=[1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],s=new zn;return s.setIndex(new yn(a,1)),s.setAttribute("position",new Ln(o,3)),(r=t.call(this,s,new ns({color:i,toneMapped:!1}))).box=e,r.type="Box3Helper",r.geometry.computeBoundingSphere(),r}return(0,m.default)(n,[{key:"updateMatrixWorld",value:function(e){var t=this.box;t.isEmpty()||(t.getCenter(this.position),t.getSize(this.scale),this.scale.multiplyScalar(.5),(0,u.default)((0,p.default)(n.prototype),"updateMatrixWorld",this).call(this,e))}}]),n}(hs),Nh=function(e){(0,d.default)(n,e);var t=b(n);function n(e){var r,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:16776960;(0,v.default)(this,n);var o=a,s=[1,-1,1,-1,1,1,-1,-1,1,1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,1,0,0,1,0,0,0],l=new zn;l.setAttribute("position",new Ln(s,3)),l.computeBoundingSphere(),(r=t.call(this,l,new ns({color:o,toneMapped:!1}))).type="PlaneHelper",r.plane=e,r.size=i;var u=[1,1,1,-1,1,1,-1,-1,1,1,1,1,-1,-1,1,1,-1,1],c=new zn;return c.setAttribute("position",new Ln(u,3)),c.computeBoundingSphere(),r.add(new ir(c,new mn({color:o,opacity:.2,transparent:!0,depthWrite:!1,toneMapped:!1}))),r}return(0,m.default)(n,[{key:"updateMatrixWorld",value:function(e){var t=-this.plane.constant;Math.abs(t)<1e-8&&(t=1e-8),this.scale.set(.5*this.size,.5*this.size,t),this.children[0].material.side=t<0?1:0,this.lookAt(this.plane.normal),(0,u.default)((0,p.default)(n.prototype),"updateMatrixWorld",this).call(this,e)}}]),n}(ls),Uh=new qe,Bh=function(e){(0,d.default)(n,e);var t=b(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new qe(0,0,1),i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new qe(0,0,0),a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:16776960,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:.2*a,l=arguments.length>5&&void 0!==arguments[5]?arguments[5]:.2*s;return(0,v.default)(this,n),(e=t.call(this)).type="ArrowHelper",void 0===Ph&&((Ph=new zn).setAttribute("position",new Ln([0,0,0,0,1,0],3)),(Dh=new Ss(0,.5,1,5,1)).translate(0,-.5,0)),e.position.copy(i),e.line=new ls(Ph,new ns({color:o,toneMapped:!1})),e.line.matrixAutoUpdate=!1,e.add(e.line),e.cone=new ir(Dh,new mn({color:o,toneMapped:!1})),e.cone.matrixAutoUpdate=!1,e.add(e.cone),e.setDirection(r),e.setLength(a,s,l),e}return(0,m.default)(n,[{key:"setDirection",value:function(e){if(e.y>.99999)this.quaternion.set(0,0,0,1);else if(e.y<-.99999)this.quaternion.set(1,0,0,0);else{Uh.set(e.z,0,-e.x).normalize();var t=Math.acos(e.y);this.quaternion.setFromAxisAngle(Uh,t)}}},{key:"setLength",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.2*e,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.2*t;this.line.scale.set(1,Math.max(1e-4,e-t),1),this.line.updateMatrix(),this.cone.scale.set(n,t,n),this.cone.position.y=e,this.cone.updateMatrix()}},{key:"setColor",value:function(e){this.line.material.color.set(e),this.cone.material.color.set(e)}},{key:"copy",value:function(e){return(0,u.default)((0,p.default)(n.prototype),"copy",this).call(this,e,!1),this.line.copy(e.line),this.cone.copy(e.cone),this}}]),n}(Yt),zh=function(e){(0,d.default)(n,e);var t=b(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;(0,v.default)(this,n);var i=[0,0,0,r,0,0,0,0,0,0,r,0,0,0,0,0,0,r],a=[1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],o=new zn;o.setAttribute("position",new Ln(i,3)),o.setAttribute("color",new Ln(a,3));var s=new ns({vertexColors:!0,toneMapped:!1});return(e=t.call(this,o,s)).type="AxesHelper",e}return(0,m.default)(n,[{key:"setColors",value:function(e,t,n){var r=new vn,i=this.geometry.attributes.color.array;return r.set(e),r.toArray(i,0),r.toArray(i,3),r.set(t),r.toArray(i,6),r.toArray(i,9),r.set(n),r.toArray(i,12),r.toArray(i,15),this.geometry.attributes.color.needsUpdate=!0,this}},{key:"dispose",value:function(){this.geometry.dispose(),this.material.dispose()}}]),n}(hs),Hh=new Float32Array(1),Gh=new Int32Array(Hh.buffer),Vh=function(){function e(){(0,v.default)(this,e)}return(0,m.default)(e,null,[{key:"toHalfFloat",value:function(e){Hh[0]=e;var t=Gh[0],n=t>>16&32768,r=t>>12&2047,i=t>>23&255;return i<103?n:i>142?(n|=31744,n|=(255==i?0:1)&&8388607&t):i<113?n|=((r|=2048)>>114-i)+(r>>113-i&1):(n|=i-112<<10|r>>1,n+=1&r)}}]),e}();Is.create=function(e,t){return console.log("THREE.Curve.create() has been deprecated"),e.prototype=Object.create(Is.prototype),e.prototype.constructor=e,e.prototype.getPoint=t,e},Ru.prototype.fromPoints=function(e){return console.warn("THREE.Path: .fromPoints() has been renamed to .setFromPoints()."),this.setFromPoints(e)},wh.prototype.setColors=function(){console.error("THREE.GridHelper: setColors() has been deprecated, pass them in the constructor instead.")},vh.prototype.update=function(){console.error("THREE.SkeletonHelper: update() no longer needs to be called.")},xu.prototype.extractUrlBase=function(e){return console.warn("THREE.Loader: .extractUrlBase() has been deprecated. Use THREE.LoaderUtils.extractUrlBase() instead."),Qu.extractUrlBase(e)},xu.Handlers={add:function(){console.error("THREE.Loader: Handlers.add() has been removed. Use LoadingManager.addHandler() instead.")},get:function(){console.error("THREE.Loader: Handlers.get() has been removed. Use LoadingManager.getHandler() instead.")}},ah.prototype.center=function(e){return console.warn("THREE.Box2: .center() has been renamed to .getCenter()."),this.getCenter(e)},ah.prototype.empty=function(){return console.warn("THREE.Box2: .empty() has been renamed to .isEmpty()."),this.isEmpty()},ah.prototype.isIntersectionBox=function(e){return console.warn("THREE.Box2: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(e)},ah.prototype.size=function(e){return console.warn("THREE.Box2: .size() has been renamed to .getSize()."),this.getSize(e)},Ke.prototype.center=function(e){return console.warn("THREE.Box3: .center() has been renamed to .getCenter()."),this.getCenter(e)},Ke.prototype.empty=function(){return console.warn("THREE.Box3: .empty() has been renamed to .isEmpty()."),this.isEmpty()},Ke.prototype.isIntersectionBox=function(e){return console.warn("THREE.Box3: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(e)},Ke.prototype.isIntersectionSphere=function(e){return console.warn("THREE.Box3: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(e)},Ke.prototype.size=function(e){return console.warn("THREE.Box3: .size() has been renamed to .getSize()."),this.getSize(e)},pt.prototype.empty=function(){return console.warn("THREE.Sphere: .empty() has been renamed to .isEmpty()."),this.isEmpty()},Tr.prototype.setFromMatrix=function(e){return console.warn("THREE.Frustum: .setFromMatrix() has been renamed to .setFromProjectionMatrix()."),this.setFromProjectionMatrix(e)},lh.prototype.center=function(e){return console.warn("THREE.Line3: .center() has been renamed to .getCenter()."),this.getCenter(e)},Fe.prototype.flattenToArrayOffset=function(e,t){return console.warn("THREE.Matrix3: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(e,t)},Fe.prototype.multiplyVector3=function(e){return console.warn("THREE.Matrix3: .multiplyVector3() has been removed. Use vector.applyMatrix3( matrix ) instead."),e.applyMatrix3(this)},Fe.prototype.multiplyVector3Array=function(){console.error("THREE.Matrix3: .multiplyVector3Array() has been removed.")},Fe.prototype.applyToBufferAttribute=function(e){return console.warn("THREE.Matrix3: .applyToBufferAttribute() has been removed. Use attribute.applyMatrix3( matrix ) instead."),e.applyMatrix3(this)},Fe.prototype.applyToVector3Array=function(){console.error("THREE.Matrix3: .applyToVector3Array() has been removed.")},Fe.prototype.getInverse=function(e){return console.warn("THREE.Matrix3: .getInverse() has been removed. Use matrixInv.copy( matrix ).invert(); instead."),this.copy(e).invert()},Tt.prototype.extractPosition=function(e){return console.warn("THREE.Matrix4: .extractPosition() has been renamed to .copyPosition()."),this.copyPosition(e)},Tt.prototype.flattenToArrayOffset=function(e,t){return console.warn("THREE.Matrix4: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(e,t)},Tt.prototype.getPosition=function(){return console.warn("THREE.Matrix4: .getPosition() has been removed. Use Vector3.setFromMatrixPosition( matrix ) instead."),(new qe).setFromMatrixColumn(this,3)},Tt.prototype.setRotationFromQuaternion=function(e){return console.warn("THREE.Matrix4: .setRotationFromQuaternion() has been renamed to .makeRotationFromQuaternion()."),this.makeRotationFromQuaternion(e)},Tt.prototype.multiplyToArray=function(){console.warn("THREE.Matrix4: .multiplyToArray() has been removed.")},Tt.prototype.multiplyVector3=function(e){return console.warn("THREE.Matrix4: .multiplyVector3() has been removed. Use vector.applyMatrix4( matrix ) instead."),e.applyMatrix4(this)},Tt.prototype.multiplyVector4=function(e){return console.warn("THREE.Matrix4: .multiplyVector4() has been removed. Use vector.applyMatrix4( matrix ) instead."),e.applyMatrix4(this)},Tt.prototype.multiplyVector3Array=function(){console.error("THREE.Matrix4: .multiplyVector3Array() has been removed.")},Tt.prototype.rotateAxis=function(e){console.warn("THREE.Matrix4: .rotateAxis() has been removed. Use Vector3.transformDirection( matrix ) instead."),e.transformDirection(this)},Tt.prototype.crossVector=function(e){return console.warn("THREE.Matrix4: .crossVector() has been removed. Use vector.applyMatrix4( matrix ) instead."),e.applyMatrix4(this)},Tt.prototype.translate=function(){console.error("THREE.Matrix4: .translate() has been removed.")},Tt.prototype.rotateX=function(){console.error("THREE.Matrix4: .rotateX() has been removed.")},Tt.prototype.rotateY=function(){console.error("THREE.Matrix4: .rotateY() has been removed.")},Tt.prototype.rotateZ=function(){console.error("THREE.Matrix4: .rotateZ() has been removed.")},Tt.prototype.rotateByAxis=function(){console.error("THREE.Matrix4: .rotateByAxis() has been removed.")},Tt.prototype.applyToBufferAttribute=function(e){return console.warn("THREE.Matrix4: .applyToBufferAttribute() has been removed. Use attribute.applyMatrix4( matrix ) instead."),e.applyMatrix4(this)},Tt.prototype.applyToVector3Array=function(){console.error("THREE.Matrix4: .applyToVector3Array() has been removed.")},Tt.prototype.makeFrustum=function(e,t,n,r,i,a){return console.warn("THREE.Matrix4: .makeFrustum() has been removed. Use .makePerspective( left, right, top, bottom, near, far ) instead."),this.makePerspective(e,t,r,n,i,a)},Tt.prototype.getInverse=function(e){return console.warn("THREE.Matrix4: .getInverse() has been removed. Use matrixInv.copy( matrix ).invert(); instead."),this.copy(e).invert()},xr.prototype.isIntersectionLine=function(e){return console.warn("THREE.Plane: .isIntersectionLine() has been renamed to .intersectsLine()."),this.intersectsLine(e)},je.prototype.multiplyVector3=function(e){return console.warn("THREE.Quaternion: .multiplyVector3() has been removed. Use is now vector.applyQuaternion( quaternion ) instead."),e.applyQuaternion(this)},je.prototype.inverse=function(){return console.warn("THREE.Quaternion: .inverse() has been renamed to invert()."),this.invert()},wt.prototype.isIntersectionBox=function(e){return console.warn("THREE.Ray: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(e)},wt.prototype.isIntersectionPlane=function(e){return console.warn("THREE.Ray: .isIntersectionPlane() has been renamed to .intersectsPlane()."),this.intersectsPlane(e)},wt.prototype.isIntersectionSphere=function(e){return console.warn("THREE.Ray: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(e)},on.prototype.area=function(){return console.warn("THREE.Triangle: .area() has been renamed to .getArea()."),this.getArea()},on.prototype.barycoordFromPoint=function(e,t){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),this.getBarycoord(e,t)},on.prototype.midpoint=function(e){return console.warn("THREE.Triangle: .midpoint() has been renamed to .getMidpoint()."),this.getMidpoint(e)},on.prototypenormal=function(e){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),this.getNormal(e)},on.prototype.plane=function(e){return console.warn("THREE.Triangle: .plane() has been renamed to .getPlane()."),this.getPlane(e)},on.barycoordFromPoint=function(e,t,n,r,i){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),on.getBarycoord(e,t,n,r,i)},on.normal=function(e,t,n,r){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),on.getNormal(e,t,n,r)},ku.prototype.extractAllPoints=function(e){return console.warn("THREE.Shape: .extractAllPoints() has been removed. Use .extractPoints() instead."),this.extractPoints(e)},ku.prototype.extrude=function(e){return console.warn("THREE.Shape: .extrude() has been removed. Use ExtrudeGeometry() instead."),new Cl(this,e)},ku.prototype.makeGeometry=function(e){return console.warn("THREE.Shape: .makeGeometry() has been removed. Use ShapeGeometry() instead."),new Fl(this,e)},Ie.prototype.fromAttribute=function(e,t,n){return console.warn("THREE.Vector2: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(e,t,n)},Ie.prototype.distanceToManhattan=function(e){return console.warn("THREE.Vector2: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(e)},Ie.prototype.lengthManhattan=function(){return console.warn("THREE.Vector2: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()},qe.prototype.setEulerFromRotationMatrix=function(){console.error("THREE.Vector3: .setEulerFromRotationMatrix() has been removed. Use Euler.setFromRotationMatrix() instead.")},qe.prototype.setEulerFromQuaternion=function(){console.error("THREE.Vector3: .setEulerFromQuaternion() has been removed. Use Euler.setFromQuaternion() instead.")},qe.prototype.getPositionFromMatrix=function(e){return console.warn("THREE.Vector3: .getPositionFromMatrix() has been renamed to .setFromMatrixPosition()."),this.setFromMatrixPosition(e)},qe.prototype.getScaleFromMatrix=function(e){return console.warn("THREE.Vector3: .getScaleFromMatrix() has been renamed to .setFromMatrixScale()."),this.setFromMatrixScale(e)},qe.prototype.getColumnFromMatrix=function(e,t){return console.warn("THREE.Vector3: .getColumnFromMatrix() has been renamed to .setFromMatrixColumn()."),this.setFromMatrixColumn(t,e)},qe.prototype.applyProjection=function(e){return console.warn("THREE.Vector3: .applyProjection() has been removed. Use .applyMatrix4( m ) instead."),this.applyMatrix4(e)},qe.prototype.fromAttribute=function(e,t,n){return console.warn("THREE.Vector3: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(e,t,n)},qe.prototype.distanceToManhattan=function(e){return console.warn("THREE.Vector3: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(e)},qe.prototype.lengthManhattan=function(){return console.warn("THREE.Vector3: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()},He.prototype.fromAttribute=function(e,t,n){return console.warn("THREE.Vector4: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(e,t,n)},He.prototype.lengthManhattan=function(){return console.warn("THREE.Vector4: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()},Yt.prototype.getChildByName=function(e){return console.warn("THREE.Object3D: .getChildByName() has been renamed to .getObjectByName()."),this.getObjectByName(e)},Yt.prototype.renderDepth=function(){console.warn("THREE.Object3D: .renderDepth has been removed. Use .renderOrder, instead.")},Yt.prototype.translate=function(e,t){return console.warn("THREE.Object3D: .translate() has been removed. Use .translateOnAxis( axis, distance ) instead."),this.translateOnAxis(t,e)},Yt.prototype.getWorldRotation=function(){console.error("THREE.Object3D: .getWorldRotation() has been removed. Use THREE.Object3D.getWorldQuaternion( target ) instead.")},Yt.prototype.applyMatrix=function(e){return console.warn("THREE.Object3D: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(e)},Object.defineProperties(Yt.prototype,{eulerOrder:{get:function(){return console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order},set:function(e){console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order=e}},useQuaternion:{get:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")},set:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")}}}),ir.prototype.setDrawMode=function(){console.error("THREE.Mesh: .setDrawMode() has been removed. The renderer now always assumes THREE.TrianglesDrawMode. Transform your geometry via BufferGeometryUtils.toTrianglesDrawMode() if necessary.")},Object.defineProperties(ir.prototype,{drawMode:{get:function(){return console.error("THREE.Mesh: .drawMode has been removed. The renderer now always assumes THREE.TrianglesDrawMode."),0},set:function(){console.error("THREE.Mesh: .drawMode has been removed. The renderer now always assumes THREE.TrianglesDrawMode. Transform your geometry via BufferGeometryUtils.toTrianglesDrawMode() if necessary.")}}}),jo.prototype.initBones=function(){console.error("THREE.SkinnedMesh: initBones() has been removed.")},dr.prototype.setLens=function(e,t){console.warn("THREE.PerspectiveCamera.setLens is deprecated. Use .setFocalLength and .filmGauge for a photographic setup."),void 0!==t&&(this.filmGauge=t),this.setFocalLength(e)},Object.defineProperties(Pu.prototype,{onlyShadow:{set:function(){console.warn("THREE.Light: .onlyShadow has been removed.")}},shadowCameraFov:{set:function(e){console.warn("THREE.Light: .shadowCameraFov is now .shadow.camera.fov."),this.shadow.camera.fov=e}},shadowCameraLeft:{set:function(e){console.warn("THREE.Light: .shadowCameraLeft is now .shadow.camera.left."),this.shadow.camera.left=e}},shadowCameraRight:{set:function(e){console.warn("THREE.Light: .shadowCameraRight is now .shadow.camera.right."),this.shadow.camera.right=e}},shadowCameraTop:{set:function(e){console.warn("THREE.Light: .shadowCameraTop is now .shadow.camera.top."),this.shadow.camera.top=e}},shadowCameraBottom:{set:function(e){console.warn("THREE.Light: .shadowCameraBottom is now .shadow.camera.bottom."),this.shadow.camera.bottom=e}},shadowCameraNear:{set:function(e){console.warn("THREE.Light: .shadowCameraNear is now .shadow.camera.near."),this.shadow.camera.near=e}},shadowCameraFar:{set:function(e){console.warn("THREE.Light: .shadowCameraFar is now .shadow.camera.far."),this.shadow.camera.far=e}},shadowCameraVisible:{set:function(){console.warn("THREE.Light: .shadowCameraVisible has been removed. Use new THREE.CameraHelper( light.shadow.camera ) instead.")}},shadowBias:{set:function(e){console.warn("THREE.Light: .shadowBias is now .shadow.bias."),this.shadow.bias=e}},shadowDarkness:{set:function(){console.warn("THREE.Light: .shadowDarkness has been removed.")}},shadowMapWidth:{set:function(e){console.warn("THREE.Light: .shadowMapWidth is now .shadow.mapSize.width."),this.shadow.mapSize.width=e}},shadowMapHeight:{set:function(e){console.warn("THREE.Light: .shadowMapHeight is now .shadow.mapSize.height."),this.shadow.mapSize.height=e}}}),Object.defineProperties(yn.prototype,{length:{get:function(){return console.warn("THREE.BufferAttribute: .length has been deprecated. Use .count instead."),this.array.length}},dynamic:{get:function(){return console.warn("THREE.BufferAttribute: .dynamic has been deprecated. Use .usage instead."),this.usage===_e},set:function(){console.warn("THREE.BufferAttribute: .dynamic has been deprecated. Use .usage instead."),this.setUsage(_e)}}}),yn.prototype.setDynamic=function(e){return console.warn("THREE.BufferAttribute: .setDynamic() has been deprecated. Use .setUsage() instead."),this.setUsage(!0===e?_e:ge),this},yn.prototype.copyIndicesArray=function(){console.error("THREE.BufferAttribute: .copyIndicesArray() has been removed.")},yn.prototype.setArray=function(){console.error("THREE.BufferAttribute: .setArray has been removed. Use BufferGeometry .setAttribute to replace/resize attribute buffers")},zn.prototype.addIndex=function(e){console.warn("THREE.BufferGeometry: .addIndex() has been renamed to .setIndex()."),this.setIndex(e)},zn.prototype.addAttribute=function(e,t){return console.warn("THREE.BufferGeometry: .addAttribute() has been renamed to .setAttribute()."),t&&t.isBufferAttribute||t&&t.isInterleavedBufferAttribute?"index"===e?(console.warn("THREE.BufferGeometry.addAttribute: Use .setIndex() for index attribute."),this.setIndex(t),this):this.setAttribute(e,t):(console.warn("THREE.BufferGeometry: .addAttribute() now expects ( name, attribute )."),this.setAttribute(e,new yn(arguments[1],arguments[2])))},zn.prototype.addDrawCall=function(e,t,n){void 0!==n&&console.warn("THREE.BufferGeometry: .addDrawCall() no longer supports indexOffset."),console.warn("THREE.BufferGeometry: .addDrawCall() is now .addGroup()."),this.addGroup(e,t)},zn.prototype.clearDrawCalls=function(){console.warn("THREE.BufferGeometry: .clearDrawCalls() is now .clearGroups()."),this.clearGroups()},zn.prototype.computeOffsets=function(){console.warn("THREE.BufferGeometry: .computeOffsets() has been removed.")},zn.prototype.removeAttribute=function(e){return console.warn("THREE.BufferGeometry: .removeAttribute() has been renamed to .deleteAttribute()."),this.deleteAttribute(e)},zn.prototype.applyMatrix=function(e){return console.warn("THREE.BufferGeometry: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(e)},Object.defineProperties(zn.prototype,{drawcalls:{get:function(){return console.error("THREE.BufferGeometry: .drawcalls has been renamed to .groups."),this.groups}},offsets:{get:function(){return console.warn("THREE.BufferGeometry: .offsets has been renamed to .groups."),this.groups}}}),_o.prototype.setDynamic=function(e){return console.warn("THREE.InterleavedBuffer: .setDynamic() has been deprecated. Use .setUsage() instead."),this.setUsage(!0===e?_e:ge),this},_o.prototype.setArray=function(){console.error("THREE.InterleavedBuffer: .setArray has been removed. Use BufferGeometry .setAttribute to replace/resize attribute buffers")},Cl.prototype.getArrays=function(){console.error("THREE.ExtrudeGeometry: .getArrays() has been removed.")},Cl.prototype.addShapeList=function(){console.error("THREE.ExtrudeGeometry: .addShapeList() has been removed.")},Cl.prototype.addShape=function(){console.error("THREE.ExtrudeGeometry: .addShape() has been removed.")},go.prototype.dispose=function(){console.error("THREE.Scene: .dispose() has been removed.")},Zc.prototype.onUpdate=function(){return console.warn("THREE.Uniform: .onUpdate() has been removed. Use object.onBeforeRender() instead."),this},Object.defineProperties(ln.prototype,{wrapAround:{get:function(){console.warn("THREE.Material: .wrapAround has been removed.")},set:function(){console.warn("THREE.Material: .wrapAround has been removed.")}},overdraw:{get:function(){console.warn("THREE.Material: .overdraw has been removed.")},set:function(){console.warn("THREE.Material: .overdraw has been removed.")}},wrapRGB:{get:function(){return console.warn("THREE.Material: .wrapRGB has been removed."),new vn}},shading:{get:function(){console.error("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead.")},set:function(e){console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=1===e}},stencilMask:{get:function(){return console.warn("THREE."+this.type+": .stencilMask has been removed. Use .stencilFuncMask instead."),this.stencilFuncMask},set:function(e){console.warn("THREE."+this.type+": .stencilMask has been removed. Use .stencilFuncMask instead."),this.stencilFuncMask=e}},vertexTangents:{get:function(){console.warn("THREE."+this.type+": .vertexTangents has been removed.")},set:function(){console.warn("THREE."+this.type+": .vertexTangents has been removed.")}}}),Object.defineProperties(cr.prototype,{derivatives:{get:function(){return console.warn("THREE.ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives},set:function(e){console.warn("THREE. ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives=e}}}),fo.prototype.clearTarget=function(e,t,n,r){console.warn("THREE.WebGLRenderer: .clearTarget() has been deprecated. Use .setRenderTarget() and .clear() instead."),this.setRenderTarget(e),this.clear(t,n,r)},fo.prototype.animate=function(e){console.warn("THREE.WebGLRenderer: .animate() is now .setAnimationLoop()."),this.setAnimationLoop(e)},fo.prototype.getCurrentRenderTarget=function(){return console.warn("THREE.WebGLRenderer: .getCurrentRenderTarget() is now .getRenderTarget()."),this.getRenderTarget()},fo.prototype.getMaxAnisotropy=function(){return console.warn("THREE.WebGLRenderer: .getMaxAnisotropy() is now .capabilities.getMaxAnisotropy()."),this.capabilities.getMaxAnisotropy()},fo.prototype.getPrecision=function(){return console.warn("THREE.WebGLRenderer: .getPrecision() is now .capabilities.precision."),this.capabilities.precision},fo.prototype.resetGLState=function(){return console.warn("THREE.WebGLRenderer: .resetGLState() is now .state.reset()."),this.state.reset()},fo.prototype.supportsFloatTextures=function(){return console.warn("THREE.WebGLRenderer: .supportsFloatTextures() is now .extensions.get( 'OES_texture_float' )."),this.extensions.get("OES_texture_float")},fo.prototype.supportsHalfFloatTextures=function(){return console.warn("THREE.WebGLRenderer: .supportsHalfFloatTextures() is now .extensions.get( 'OES_texture_half_float' )."),this.extensions.get("OES_texture_half_float")},fo.prototype.supportsStandardDerivatives=function(){return console.warn("THREE.WebGLRenderer: .supportsStandardDerivatives() is now .extensions.get( 'OES_standard_derivatives' )."),this.extensions.get("OES_standard_derivatives")},fo.prototype.supportsCompressedTextureS3TC=function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTextureS3TC() is now .extensions.get( 'WEBGL_compressed_texture_s3tc' )."),this.extensions.get("WEBGL_compressed_texture_s3tc")},fo.prototype.supportsCompressedTexturePVRTC=function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTexturePVRTC() is now .extensions.get( 'WEBGL_compressed_texture_pvrtc' )."),this.extensions.get("WEBGL_compressed_texture_pvrtc")},fo.prototype.supportsBlendMinMax=function(){return console.warn("THREE.WebGLRenderer: .supportsBlendMinMax() is now .extensions.get( 'EXT_blend_minmax' )."),this.extensions.get("EXT_blend_minmax")},fo.prototype.supportsVertexTextures=function(){return console.warn("THREE.WebGLRenderer: .supportsVertexTextures() is now .capabilities.vertexTextures."),this.capabilities.vertexTextures},fo.prototype.supportsInstancedArrays=function(){return console.warn("THREE.WebGLRenderer: .supportsInstancedArrays() is now .extensions.get( 'ANGLE_instanced_arrays' )."),this.extensions.get("ANGLE_instanced_arrays")},fo.prototype.enableScissorTest=function(e){console.warn("THREE.WebGLRenderer: .enableScissorTest() is now .setScissorTest()."),this.setScissorTest(e)},fo.prototype.initMaterial=function(){console.warn("THREE.WebGLRenderer: .initMaterial() has been removed.")},fo.prototype.addPrePlugin=function(){console.warn("THREE.WebGLRenderer: .addPrePlugin() has been removed.")},fo.prototype.addPostPlugin=function(){console.warn("THREE.WebGLRenderer: .addPostPlugin() has been removed.")},fo.prototype.updateShadowMap=function(){console.warn("THREE.WebGLRenderer: .updateShadowMap() has been removed.")},fo.prototype.setFaceCulling=function(){console.warn("THREE.WebGLRenderer: .setFaceCulling() has been removed.")},fo.prototype.allocTextureUnit=function(){console.warn("THREE.WebGLRenderer: .allocTextureUnit() has been removed.")},fo.prototype.setTexture=function(){console.warn("THREE.WebGLRenderer: .setTexture() has been removed.")},fo.prototype.setTexture2D=function(){console.warn("THREE.WebGLRenderer: .setTexture2D() has been removed.")},fo.prototype.setTextureCube=function(){console.warn("THREE.WebGLRenderer: .setTextureCube() has been removed.")},fo.prototype.getActiveMipMapLevel=function(){return console.warn("THREE.WebGLRenderer: .getActiveMipMapLevel() is now .getActiveMipmapLevel()."),this.getActiveMipmapLevel()},Object.defineProperties(fo.prototype,{shadowMapEnabled:{get:function(){return this.shadowMap.enabled},set:function(e){console.warn("THREE.WebGLRenderer: .shadowMapEnabled is now .shadowMap.enabled."),this.shadowMap.enabled=e}},shadowMapType:{get:function(){return this.shadowMap.type},set:function(e){console.warn("THREE.WebGLRenderer: .shadowMapType is now .shadowMap.type."),this.shadowMap.type=e}},shadowMapCullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")}},context:{get:function(){return console.warn("THREE.WebGLRenderer: .context has been removed. Use .getContext() instead."),this.getContext()}},vr:{get:function(){return console.warn("THREE.WebGLRenderer: .vr has been renamed to .xr"),this.xr}},gammaInput:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaInput has been removed. Set the encoding for textures via Texture.encoding instead."),!1},set:function(){console.warn("THREE.WebGLRenderer: .gammaInput has been removed. Set the encoding for textures via Texture.encoding instead.")}},gammaOutput:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaOutput has been removed. Set WebGLRenderer.outputEncoding instead."),!1},set:function(e){console.warn("THREE.WebGLRenderer: .gammaOutput has been removed. Set WebGLRenderer.outputEncoding instead."),this.outputEncoding=!0===e?ce:ue}},toneMappingWhitePoint:{get:function(){return console.warn("THREE.WebGLRenderer: .toneMappingWhitePoint has been removed."),1},set:function(){console.warn("THREE.WebGLRenderer: .toneMappingWhitePoint has been removed.")}}}),Object.defineProperties(to.prototype,{cullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")}},renderReverseSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")}},renderSingleSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")}}}),Object.defineProperties(Ge.prototype,{wrapS:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS},set:function(e){console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS=e}},wrapT:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT},set:function(e){console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT=e}},magFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter},set:function(e){console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter=e}},minFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter},set:function(e){console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter=e}},anisotropy:{get:function(){return console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy},set:function(e){console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy=e}},offset:{get:function(){return console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset},set:function(e){console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset=e}},repeat:{get:function(){return console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat},set:function(e){console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat=e}},format:{get:function(){return console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format},set:function(e){console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format=e}},type:{get:function(){return console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type},set:function(e){console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type=e}},generateMipmaps:{get:function(){return console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps},set:function(e){console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps=e}}}),Ac.prototype.load=function(e){console.warn("THREE.Audio: .load has been deprecated. Use THREE.AudioLoader instead.");var t=this;return(new pc).load(e,(function(e){t.setBuffer(e)})),this},Dc.prototype.getData=function(){return console.warn("THREE.AudioAnalyser: .getData() is now .getFrequencyData()."),this.getFrequencyData()},pr.prototype.updateCubeMap=function(e,t){return console.warn("THREE.CubeCamera: .updateCubeMap() is now .update()."),this.update(e,t)},pr.prototype.clear=function(e,t,n,r){return console.warn("THREE.CubeCamera: .clear() is now .renderTarget.clear()."),this.renderTarget.clear(e,t,n,r)},Ne.crossOrigin=void 0,Ne.loadTexture=function(e,t,n,r){console.warn("THREE.ImageUtils.loadTexture has been deprecated. Use THREE.TextureLoader() instead.");var i=new Lu;i.setCrossOrigin(this.crossOrigin);var a=i.load(e,n,void 0,r);return t&&(a.mapping=t),a},Ne.loadTextureCube=function(e,t,n,r){console.warn("THREE.ImageUtils.loadTextureCube has been deprecated. Use THREE.CubeTextureLoader() instead.");var i=new Eu;i.setCrossOrigin(this.crossOrigin);var a=i.load(e,n,void 0,r);return t&&(a.mapping=t),a},Ne.loadCompressedTexture=function(){console.error("THREE.ImageUtils.loadCompressedTexture has been removed. Use THREE.DDSLoader instead.")},Ne.loadCompressedTextureCube=function(){console.error("THREE.ImageUtils.loadCompressedTextureCube has been removed. Use THREE.DDSLoader instead.")};var Wh={createMultiMaterialObject:function(){console.error("THREE.SceneUtils has been moved to /examples/jsm/utils/SceneUtils.js")},detach:function(){console.error("THREE.SceneUtils has been moved to /examples/jsm/utils/SceneUtils.js")},attach:function(){console.error("THREE.SceneUtils has been moved to /examples/jsm/utils/SceneUtils.js")}};"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:n}})),"undefined"!=typeof window&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=n),e.ACESFilmicToneMapping=4,e.AddEquation=r,e.AddOperation=2,e.AdditiveAnimationBlendMode=le,e.AdditiveBlending=2,e.AlphaFormat=1021,e.AlwaysDepth=1,e.AlwaysStencilFunc=519,e.AmbientLight=Xu,e.AmbientLightProbe=mc,e.AnimationClip=vu,e.AnimationLoader=Tu,e.AnimationMixer=Kc,e.AnimationObjectGroup=Xc,e.AnimationUtils=nu,e.ArcCurve=Fs,e.ArrayCamera=ao,e.ArrowHelper=Bh,e.Audio=Ac,e.AudioAnalyser=Dc,e.AudioContext=fc,e.AudioListener=Ec,e.AudioLoader=pc,e.AxesHelper=zh,e.AxisHelper=function(e){return console.warn("THREE.AxisHelper has been renamed to THREE.AxesHelper."),new zh(e)},e.BackSide=1,e.BasicDepthPacking=3200,e.BasicShadowMap=0,e.BinaryTextureLoader=function(e){return console.warn("THREE.BinaryTextureLoader has been renamed to THREE.DataTextureLoader."),new Au(e)},e.Bone=qo,e.BooleanKeyframeTrack=lu,e.BoundingBoxHelper=function(e,t){return console.warn("THREE.BoundingBoxHelper has been deprecated. Creating a THREE.BoxHelper instead."),new Oh(e,t)},e.Box2=ah,e.Box3=Ke,e.Box3Helper=Fh,e.BoxBufferGeometry=or,e.BoxGeometry=or,e.BoxHelper=Oh,e.BufferAttribute=yn,e.BufferGeometry=zn,e.BufferGeometryLoader=tc,e.ByteType=1010,e.Cache=gu,e.Camera=hr,e.CameraHelper=Rh,e.CanvasRenderer=function(){console.error("THREE.CanvasRenderer has been removed")},e.CanvasTexture=ws,e.CatmullRomCurve3=Gs,e.CineonToneMapping=3,e.CircleBufferGeometry=Ms,e.CircleGeometry=Ms,e.ClampToEdgeWrapping=E,e.Clock=xc,e.Color=vn,e.ColorKeyframeTrack=uu,e.CompressedTexture=bs,e.CompressedTextureLoader=Mu,e.ConeBufferGeometry=Es,e.ConeGeometry=Es,e.CubeCamera=pr,e.CubeReflectionMapping=a,e.CubeRefractionMapping=g,e.CubeTexture=vr,e.CubeTextureLoader=Eu,e.CubeUVReflectionMapping=T,e.CubeUVRefractionMapping=M,e.CubicBezierCurve=qs,e.CubicBezierCurve3=Xs,e.CubicInterpolant=iu,e.CullFaceBack=1,e.CullFaceFront=2,e.CullFaceFrontBack=3,e.CullFaceNone=0,e.Curve=Is,e.CurvePath=Cu,e.CustomBlending=5,e.CustomToneMapping=5,e.CylinderBufferGeometry=Ss,e.CylinderGeometry=Ss,e.Cylindrical=rh,e.DataTexture=Xo,e.DataTexture2DArray=_i,e.DataTexture3D=yi,e.DataTextureLoader=Au,e.DataUtils=Vh,e.DecrementStencilOp=7683,e.DecrementWrapStencilOp=34056,e.DefaultLoadingManager=yu,e.DepthFormat=G,e.DepthStencilFormat=V,e.DepthTexture=Ts,e.DirectionalLight=qu,e.DirectionalLightHelper=Ah,e.DiscreteInterpolant=ou,e.DodecahedronBufferGeometry=Ls,e.DodecahedronGeometry=Ls,e.DoubleSide=2,e.DstAlphaFactor=206,e.DstColorFactor=208,e.DynamicBufferAttribute=function(e,t){return console.warn("THREE.DynamicBufferAttribute has been removed. Use new THREE.BufferAttribute().setUsage( THREE.DynamicDrawUsage ) instead."),new yn(e,t).setUsage(_e)},e.DynamicCopyUsage=35050,e.DynamicDrawUsage=_e,e.DynamicReadUsage=35049,e.EdgesGeometry=Ds,e.EdgesHelper=function(e,t){return console.warn("THREE.EdgesHelper has been removed. Use THREE.EdgesGeometry instead."),new hs(new Ds(e.geometry),new ns({color:void 0!==t?t:16777215}))},e.EllipseCurve=Os,e.EqualDepth=4,e.EqualStencilFunc=514,e.EquirectangularReflectionMapping=y,e.EquirectangularRefractionMapping=w,e.Euler=Dt,e.EventDispatcher=xe,e.ExtrudeBufferGeometry=Cl,e.ExtrudeGeometry=Cl,e.FaceColors=1,e.FileLoader=wu,e.FlatShading=1,e.Float16BufferAttribute=An,e.Float32Attribute=function(e,t){return console.warn("THREE.Float32Attribute has been removed. Use new THREE.Float32BufferAttribute() instead."),new Ln(e,t)},e.Float32BufferAttribute=Ln,e.Float64Attribute=function(e,t){return console.warn("THREE.Float64Attribute has been removed. Use new THREE.Float64BufferAttribute() instead."),new Cn(e,t)},e.Float64BufferAttribute=Cn,e.FloatType=N,e.Fog=mo,e.FogExp2=vo,e.Font=lc,e.FontLoader=dc,e.FrontSide=0,e.Frustum=Tr,e.GLBufferAttribute=Qc,e.GLSL1="100",e.GLSL3=ye,e.GammaEncoding=he,e.GreaterDepth=6,e.GreaterEqualDepth=5,e.GreaterEqualStencilFunc=518,e.GreaterStencilFunc=516,e.GridHelper=wh,e.Group=oo,e.HalfFloatType=U,e.HemisphereLight=Du,e.HemisphereLightHelper=bh,e.HemisphereLightProbe=vc,e.IcosahedronBufferGeometry=kl,e.IcosahedronGeometry=kl,e.ImageBitmapLoader=oc,e.ImageLoader=Su,e.ImageUtils=Ne,e.ImmediateRenderObject=uh,e.IncrementStencilOp=7682,e.IncrementWrapStencilOp=34055,e.InstancedBufferAttribute=ec,e.InstancedBufferGeometry=$u,e.InstancedInterleavedBuffer=Jc,e.InstancedMesh=ts,e.Int16Attribute=function(e,t){return console.warn("THREE.Int16Attribute has been removed. Use new THREE.Int16BufferAttribute() instead."),new Tn(e,t)},e.Int16BufferAttribute=Tn,e.Int32Attribute=function(e,t){return console.warn("THREE.Int32Attribute has been removed. Use new THREE.Int32BufferAttribute() instead."),new Sn(e,t)},e.Int32BufferAttribute=Sn,e.Int8Attribute=function(e,t){return console.warn("THREE.Int8Attribute has been removed. Use new THREE.Int8BufferAttribute() instead."),new xn(e,t)},e.Int8BufferAttribute=xn,e.IntType=1013,e.InterleavedBuffer=_o,e.InterleavedBufferAttribute=xo,e.Interpolant=ru,e.InterpolateDiscrete=te,e.InterpolateLinear=ne,e.InterpolateSmooth=re,e.InvertStencilOp=5386,e.JSONLoader=function(){console.error("THREE.JSONLoader has been removed.")},e.KeepStencilOp=me,e.KeyframeTrack=su,e.LOD=Bo,e.LatheBufferGeometry=Pl,e.LatheGeometry=Pl,e.Layers=It,e.LensFlare=function(){console.error("THREE.LensFlare has been moved to /examples/jsm/objects/Lensflare.js")},e.LessDepth=2,e.LessEqualDepth=3,e.LessEqualStencilFunc=515,e.LessStencilFunc=513,e.Light=Pu,e.LightProbe=Zu,e.Line=ls,e.Line3=lh,e.LineBasicMaterial=ns,e.LineCurve=Ys,e.LineCurve3=Ks,e.LineDashedMaterial=eu,e.LineLoop=ds,e.LinePieces=1,e.LineSegments=hs,e.LineStrip=0,e.LinearEncoding=ue,e.LinearFilter=k,e.LinearInterpolant=au,e.LinearMipMapLinearFilter=1008,e.LinearMipMapNearestFilter=1007,e.LinearMipmapLinearFilter=D,e.LinearMipmapNearestFilter=P,e.LinearToneMapping=1,e.Loader=xu,e.LoaderUtils=Qu,e.LoadingManager=_u,e.LogLuvEncoding=3003,e.LoopOnce=2200,e.LoopPingPong=2202,e.LoopRepeat=ee,e.LuminanceAlphaFormat=1025,e.LuminanceFormat=1024,e.MOUSE={LEFT:0,MIDDLE:1,RIGHT:2,ROTATE:0,DOLLY:1,PAN:2},e.Material=ln,e.MaterialLoader=Ju,e.Math=De,e.MathUtils=De,e.Matrix3=Fe,e.Matrix4=Tt,e.MaxEquation=104,e.Mesh=ir,e.MeshBasicMaterial=mn,e.MeshDepthMaterial=$a,e.MeshDistanceMaterial=eo,e.MeshFaceMaterial=function(e){return console.warn("THREE.MeshFaceMaterial has been removed. Use an Array instead."),e},e.MeshLambertMaterial=Ql,e.MeshMatcapMaterial=$l,e.MeshNormalMaterial=Jl,e.MeshPhongMaterial=Kl,e.MeshPhysicalMaterial=Yl,e.MeshStandardMaterial=Xl,e.MeshToonMaterial=Zl,e.MinEquation=103,e.MirroredRepeatWrapping=A,e.MixOperation=1,e.MultiMaterial=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return console.warn("THREE.MultiMaterial has been removed. Use an Array instead."),e.isMultiMaterial=!0,e.materials=e,e.clone=function(){return e.slice()},e},e.MultiplyBlending=4,e.MultiplyOperation=0,e.NearestFilter=L,e.NearestMipMapLinearFilter=1005,e.NearestMipMapNearestFilter=1004,e.NearestMipmapLinearFilter=R,e.NearestMipmapNearestFilter=C,e.NeverDepth=0,e.NeverStencilFunc=512,e.NoBlending=0,e.NoColors=0,e.NoToneMapping=0,e.NormalAnimationBlendMode=se,e.NormalBlending=1,e.NotEqualDepth=7,e.NotEqualStencilFunc=517,e.NumberKeyframeTrack=cu,e.Object3D=Yt,e.ObjectLoader=nc,e.ObjectSpaceNormalMap=1,e.OctahedronBufferGeometry=Dl,e.OctahedronGeometry=Dl,e.OneFactor=201,e.OneMinusDstAlphaFactor=207,e.OneMinusDstColorFactor=209,e.OneMinusSrcAlphaFactor=205,e.OneMinusSrcColorFactor=203,e.OrthographicCamera=Fr,e.PCFShadowMap=1,e.PCFSoftShadowMap=2,e.PMREMGenerator=ni,e.ParametricBufferGeometry=Il,e.ParametricGeometry=Il,e.Particle=function(e){return console.warn("THREE.Particle has been renamed to THREE.Sprite."),new Oo(e)},e.ParticleBasicMaterial=function(e){return console.warn("THREE.ParticleBasicMaterial has been renamed to THREE.PointsMaterial."),new fs(e)},e.ParticleSystem=function(e,t){return console.warn("THREE.ParticleSystem has been renamed to THREE.Points."),new _s(e,t)},e.ParticleSystemMaterial=function(e){return console.warn("THREE.ParticleSystemMaterial has been renamed to THREE.PointsMaterial."),new fs(e)},e.Path=Ru,e.PerspectiveCamera=dr,e.Plane=xr,e.PlaneBufferGeometry=Er,e.PlaneGeometry=Er,e.PlaneHelper=Nh,e.PointCloud=function(e,t){return console.warn("THREE.PointCloud has been renamed to THREE.Points."),new _s(e,t)},e.PointCloudMaterial=function(e){return console.warn("THREE.PointCloudMaterial has been renamed to THREE.PointsMaterial."),new fs(e)},e.PointLight=Wu,e.PointLightHelper=gh,e.Points=_s,e.PointsMaterial=fs,e.PolarGridHelper=Th,e.PolyhedronBufferGeometry=As,e.PolyhedronGeometry=As,e.PositionalAudio=Pc,e.PropertyBinding=qc,e.PropertyMixer=Ic,e.QuadraticBezierCurve=Zs,e.QuadraticBezierCurve3=Js,e.Quaternion=je,e.QuaternionKeyframeTrack=du,e.QuaternionLinearInterpolant=hu,e.REVISION=n,e.RGBADepthPacking=3201,e.RGBAFormat=H,e.RGBAIntegerFormat=1033,e.RGBA_ASTC_10x10_Format=37819,e.RGBA_ASTC_10x5_Format=37816,e.RGBA_ASTC_10x6_Format=37817,e.RGBA_ASTC_10x8_Format=37818,e.RGBA_ASTC_12x10_Format=37820,e.RGBA_ASTC_12x12_Format=37821,e.RGBA_ASTC_4x4_Format=37808,e.RGBA_ASTC_5x4_Format=37809,e.RGBA_ASTC_5x5_Format=37810,e.RGBA_ASTC_6x5_Format=37811,e.RGBA_ASTC_6x6_Format=37812,e.RGBA_ASTC_8x5_Format=37813,e.RGBA_ASTC_8x6_Format=37814,e.RGBA_ASTC_8x8_Format=37815,e.RGBA_BPTC_Format=36492,e.RGBA_ETC2_EAC_Format=$,e.RGBA_PVRTC_2BPPV1_Format=J,e.RGBA_PVRTC_4BPPV1_Format=Z,e.RGBA_S3TC_DXT1_Format=j,e.RGBA_S3TC_DXT3_Format=q,e.RGBA_S3TC_DXT5_Format=X,e.RGBDEncoding=ve,e.RGBEEncoding=de,e.RGBEFormat=1023,e.RGBFormat=z,e.RGBIntegerFormat=1032,e.RGBM16Encoding=pe,e.RGBM7Encoding=fe,e.RGB_ETC1_Format=36196,e.RGB_ETC2_Format=Q,e.RGB_PVRTC_2BPPV1_Format=K,e.RGB_PVRTC_4BPPV1_Format=Y,e.RGB_S3TC_DXT1_Format=W,e.RGFormat=1030,e.RGIntegerFormat=1031,e.RawShaderMaterial=Nr,e.Ray=wt,e.Raycaster=$c,e.RectAreaLight=Yu,e.RedFormat=1028,e.RedIntegerFormat=1029,e.ReinhardToneMapping=2,e.RepeatWrapping=S,e.ReplaceStencilOp=7681,e.ReverseSubtractEquation=102,e.RingBufferGeometry=Ol,e.RingGeometry=Ol,e.SRGB8_ALPHA8_ASTC_10x10_Format=37851,e.SRGB8_ALPHA8_ASTC_10x5_Format=37848,e.SRGB8_ALPHA8_ASTC_10x6_Format=37849,e.SRGB8_ALPHA8_ASTC_10x8_Format=37850,e.SRGB8_ALPHA8_ASTC_12x10_Format=37852,e.SRGB8_ALPHA8_ASTC_12x12_Format=37853,e.SRGB8_ALPHA8_ASTC_4x4_Format=37840,e.SRGB8_ALPHA8_ASTC_5x4_Format=37841,e.SRGB8_ALPHA8_ASTC_5x5_Format=37842,e.SRGB8_ALPHA8_ASTC_6x5_Format=37843,e.SRGB8_ALPHA8_ASTC_6x6_Format=37844,e.SRGB8_ALPHA8_ASTC_8x5_Format=37845,e.SRGB8_ALPHA8_ASTC_8x6_Format=37846,e.SRGB8_ALPHA8_ASTC_8x8_Format=37847,e.Scene=go,e.SceneUtils=Wh,e.ShaderChunk=Ar,e.ShaderLib=Cr,e.ShaderMaterial=cr,e.ShadowMaterial=ql,e.Shape=ku,e.ShapeBufferGeometry=Fl,e.ShapeGeometry=Fl,e.ShapePath=sc,e.ShapeUtils=El,e.ShortType=1011,e.Skeleton=Zo,e.SkeletonHelper=vh,e.SkinnedMesh=jo,e.SmoothShading=2,e.Sphere=pt,e.SphereBufferGeometry=Nl,e.SphereGeometry=Nl,e.Spherical=nh,e.SphericalHarmonics3=Ku,e.SplineCurve=Qs,e.SpotLight=Bu,e.SpotLightHelper=hh,e.Sprite=Oo,e.SpriteMaterial=wo,e.SrcAlphaFactor=204,e.SrcAlphaSaturateFactor=210,e.SrcColorFactor=202,e.StaticCopyUsage=35046,e.StaticDrawUsage=ge,e.StaticReadUsage=35045,e.StereoCamera=yc,e.StreamCopyUsage=35042,e.StreamDrawUsage=35040,e.StreamReadUsage=35041,e.StringKeyframeTrack=fu,e.SubtractEquation=101,e.SubtractiveBlending=3,e.TOUCH={ROTATE:0,PAN:1,DOLLY_PAN:2,DOLLY_ROTATE:3},e.TangentSpaceNormalMap=0,e.TetrahedronBufferGeometry=Ul,e.TetrahedronGeometry=Ul,e.TextBufferGeometry=Bl,e.TextGeometry=Bl,e.Texture=Be,e.TextureLoader=Lu,e.TorusBufferGeometry=zl,e.TorusGeometry=zl,e.TorusKnotBufferGeometry=Hl,e.TorusKnotGeometry=Hl,e.Triangle=on,e.TriangleFanDrawMode=2,e.TriangleStripDrawMode=1,e.TrianglesDrawMode=0,e.TubeBufferGeometry=Gl,e.TubeGeometry=Gl,e.UVMapping=i,e.Uint16Attribute=function(e,t){return console.warn("THREE.Uint16Attribute has been removed. Use new THREE.Uint16BufferAttribute() instead."),new Mn(e,t)},e.Uint16BufferAttribute=Mn,e.Uint32Attribute=function(e,t){return console.warn("THREE.Uint32Attribute has been removed. Use new THREE.Uint32BufferAttribute() instead."),new En(e,t)},e.Uint32BufferAttribute=En,e.Uint8Attribute=function(e,t){return console.warn("THREE.Uint8Attribute has been removed. Use new THREE.Uint8BufferAttribute() instead."),new bn(e,t)},e.Uint8BufferAttribute=bn,e.Uint8ClampedAttribute=function(e,t){return console.warn("THREE.Uint8ClampedAttribute has been removed. Use new THREE.Uint8ClampedBufferAttribute() instead."),new wn(e,t)},e.Uint8ClampedBufferAttribute=wn,e.Uniform=Zc,e.UniformsLib=Lr,e.UniformsUtils=ur,e.UnsignedByteType=I,e.UnsignedInt248Type=B,e.UnsignedIntType=F,e.UnsignedShort4444Type=1017,e.UnsignedShort5551Type=1018,e.UnsignedShort565Type=1019,e.UnsignedShortType=O,e.VSMShadowMap=3,e.Vector2=Ie,e.Vector3=qe,e.Vector4=He,e.VectorKeyframeTrack=pu,e.Vertex=function(e,t,n){return console.warn("THREE.Vertex has been removed. Use THREE.Vector3 instead."),new qe(e,t,n)},e.VertexColors=2,e.VideoTexture=xs,e.WebGL1Renderer=po,e.WebGLCubeRenderTarget=mr,e.WebGLMultipleRenderTargets=Ve,e.WebGLMultisampleRenderTarget=We,e.WebGLRenderTarget=Ge,e.WebGLRenderTargetCube=function(e,t,n){return console.warn("THREE.WebGLRenderTargetCube( width, height, options ) is now WebGLCubeRenderTarget( size, options )."),new mr(e,n)},e.WebGLRenderer=fo,e.WebGLUtils=io,e.WireframeGeometry=Vl,e.WireframeHelper=function(e,t){return console.warn("THREE.WireframeHelper has been removed. Use THREE.WireframeGeometry instead."),new hs(new Vl(e.geometry),new ns({color:void 0!==t?t:16777215}))},e.WrapAroundEnding=oe,e.XHRLoader=function(e){return console.warn("THREE.XHRLoader has been renamed to THREE.FileLoader."),new wu(e)},e.ZeroCurvatureEnding=ie,e.ZeroFactor=200,e.ZeroSlopeEnding=ae,e.ZeroStencilOp=0,e.sRGBEncoding=ce,Object.defineProperty(e,"__esModule",{value:!0})},"object"===(void 0===n?"undefined":(0,g.default)(n))&&void 0!==t?i(n):"function"==typeof define&&define.amd?define(["exports"],i):i((r="undefined"!=typeof globalThis?globalThis:r||self).THREE={})},{"@babel/runtime/helpers/assertThisInitialized":4,"@babel/runtime/helpers/asyncToGenerator":5,"@babel/runtime/helpers/classCallCheck":6,"@babel/runtime/helpers/createClass":7,"@babel/runtime/helpers/defineProperty":8,"@babel/runtime/helpers/get":9,"@babel/runtime/helpers/getPrototypeOf":10,"@babel/runtime/helpers/inherits":11,"@babel/runtime/helpers/interopRequireDefault":12,"@babel/runtime/helpers/possibleConstructorReturn":17,"@babel/runtime/helpers/slicedToArray":19,"@babel/runtime/helpers/typeof":22,"@babel/runtime/regenerator":24}],64:[function(e,t,n){"use strict";var r=e("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var i=r(e("@babel/runtime/helpers/createClass")),a=r(e("@babel/runtime/helpers/classCallCheck")),o=r(e("@babel/runtime/helpers/defineProperty")),s=(e("./AudioItem").default,e("../core/properties")),l=e("../utils/math"),u=e("min-signal"),c=(0,i.default)((function e(){var t=this;(0,a.default)(this,e),(0,o.default)(this,"fadeToVolume",(function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;t._volumeFrom=t.volume,t.targetVolume=e,t._volumeTime=0,t._volumeDuration=n,0===n&&(t.volume=t.targetVolume,t.onFadeCompleted.dispatch(t.volume))})),(0,o.default)(this,"add",(function(e){t.children.push(e)})),(0,o.default)(this,"addSingle",(function(e){t.children.push(e),t._isSingle=!0,t.onFadeCompleted.add((function(t){0===t&&e.stop()}))})),(0,o.default)(this,"playSingle",(function(){t.children[0].play()})),(0,o.default)(this,"stopSingle",(function(){t.children[0].stop()})),(0,o.default)(this,"stop",(function(){t.children.forEach((function(e){return e.stop()}))})),(0,o.default)(this,"setFinalVolume",(function(e){t.volume!==t.targetVolume&&(t._volumeDuration?(t._volumeTime=Math.min(t._volumeDuration,t._volumeTime+s.deltaTime),t.volume=l.mix(t._volumeFrom,t.targetVolume,t._volumeTime/t._volumeDuration)):t.volume=t.targetVolume,t.volume==t.targetVolume&&t.onFadeCompleted.dispatch(t.volume)),e*=t.volume,t.children.forEach((function(t){t.setFinalVolume(e)}))})),this.children=[],this.volume=1,this.targetVolume=1,this._volumeFrom=0,this._volumeDuration=0,this._volumeTime=0,this._isSingle=!1,this._isVideo=!1,this.onFadeCompleted=new u}));n.default=c},{"../core/properties":71,"../utils/math":104,"./AudioItem":65,"@babel/runtime/helpers/classCallCheck":6,"@babel/runtime/helpers/createClass":7,"@babel/runtime/helpers/defineProperty":8,"@babel/runtime/helpers/interopRequireDefault":12,"min-signal":29}],65:[function(e,t,n){"use strict";var r=e("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var i=r(e("@babel/runtime/helpers/classCallCheck")),a=r(e("@babel/runtime/helpers/createClass")),o=r(e("@babel/runtime/helpers/defineProperty")),s=e("three"),l=e("../core/properties"),u=e("../core/settings"),c=e("min-signal"),h=function(){function e(t){var n=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=r.preload,h=void 0===a||a,d=r.isPositional,f=void 0!==d&&d,p=r.autoplay,v=void 0!==p&&p,m=r.loop,g=void 0!==m&&m,_=r.isMutable,y=void 0!==_&&_,x=r.fileSize,b=void 0===x?100:x,w=r.elem,T=void 0===w?null:w;(0,i.default)(this,e),(0,o.default)(this,"load",(function(e){if(n.elem)n.elem.src=n.url;else{var t=n.preload?"add":"load";l.loader[t](n.url,{weight:n.fileSize,type:"xhr",responseType:"arraybuffer",hasLoading:!0,onLoad:function(t){n._buffer=t,n.hasInitialized&&n._decodeAudioData(),e&&e()}})}})),(0,o.default)(this,"init",(function(e){n.hasInitialized||(n.hasInitialized=!0,n.audioObject=n.isPositional?new s.PositionalAudio(e):new s.Audio(e),n.positionObjectParent&&n.positionObjectParent.add(n.audioObject),n._orginalOnEnd=n.audioObject.onEnded.bind(n.audioObject),n.audioObject.onEnded=n.onEnd.bind(n),n.isPositional&&n.setRefDistance(n.refDistance),n.elem?(n.elem.loop=n.loop,n.audioObject.setMediaElementSource(n.elem),n.elem.addEventListener("ended",n.onEnd.bind(n)),n.autoplay&&n.play()):(n.audioObject.setLoop(n.loop),n._buffer&&n._decodeAudioData()))})),(0,o.default)(this,"onEnd",(function(){n._orginalOnEnd&&n._orginalOnEnd(),n.onEnded.dispatch()})),(0,o.default)(this,"setFinalVolume",(function(e){var t;null===(t=n.audioObject)||void 0===t||t.setVolume(e*n.volume)})),(0,o.default)(this,"_decodeAudioData",(function(){var e=n._buffer.slice(0);s.AudioContext.getContext().decodeAudioData(e,(function(e){n.audioObject.setBuffer(e),n.autoplay&&n.play()}))})),(0,o.default)(this,"setRefDistance",(function(e){n.refDistance=e,n.isPositional&&n.audioObject&&n.audioObject.setRefDistance(n.refDistance)})),(0,o.default)(this,"play",(function(){n.autoplay=!0,n.audioObject&&!n.audioObject.isPlaying&&(n.elem?(n.elem.play(),n.elem.currentTime=.01,n.audioObject.isPlaying=!0):n.audioObject.play(),n.onPlayed.dispatch())})),(0,o.default)(this,"stop",(function(){n.autoplay=!1,n.audioObject&&n.audioObject.isPlaying&&(n.elem?(n.elem.pause(),n.audioObject.isPlaying=!1):n.audioObject.stop(),n.onEnded.dispatch())})),this.url=u.AUDIO_PATH+t,this.preload=h,this.isPositional=!!f,this.positionObjectParent=null,this.autoplay=v,this.loop=g,this.isMutable=y,this.elem=T,this.audioObject=null,this.hasInitialized=!1,this.volume=1,this.fileSize=b,this.refDistance=1,this._buffer=null,this._orginalOnEnd=null,this.onPlayed=new c,this.onEnded=new c}return(0,a.default)(e,[{key:"setPositionObjectParent",value:function(e){this.hasInitialized?e?e.add(this.audioObject):this.audioObject.parent&&this.audioObject.parent.remove(this.audioObject):this.positionObjectParent=e}}]),e}();n.default=h},{"../core/properties":71,"../core/settings":72,"@babel/runtime/helpers/classCallCheck":6,"@babel/runtime/helpers/createClass":7,"@babel/runtime/helpers/defineProperty":8,"@babel/runtime/helpers/interopRequireDefault":12,"min-signal":29,three:63}],66:[function(e,t,n){"use strict";var r=e("../core/properties"),i=e("../utils/math"),a=e("../input/input"),o=e("./AudioGroup").default,s=e("./AudioItem").default,l=e("three"),u=e("min-signal");n.preInit=function(){for(var e=0;e<T.length;e++){var t=T[e],r=n.groups[t]=new o;n.master.add(r)}window.addEventListener("blur",M),window.addEventListener("focus",S),a.onDowned.add(A),f=document.querySelectorAll(".audio__bar"),(d=document.querySelector(".header-more--audio")).addEventListener("click",R),d.addEventListener("mouseenter",k),d.style.pointerEvents="auto",L("bgm","ui",!1,!0,!1,!0),L("transition","ui",!0),L("hover_0","ui",!0),L("hover_1","ui",!0),L("change_0","ui",!0),L("change_1","ui",!0)},n.init=function(){D((function(e){for(var t in x)x[t].init(e);x.bgm.play()}))},n.play=C,n.playTap=function(){0},n.playHover=E,n.playChange=function(){return C("change_"+ ++w%2)},n.enable=P,n.getListener=D,n.update=I,n.master=new o,n.groups={},n.uiGroup=new o,n.sceneGroup=new o;var c,h,d,f,p=0,v=!1,m=!0,g=!1,_=new u,y=0,x=n.audioItems={},b=0,w=0,T=["ui","scene"];function M(){m=!1,I(0),g=!0}function S(){p=0,m=!0,I(1),g=!1}function E(){return C("hover_"+ ++b%2)}function A(e){a.onDowned.remove(A),c=new l.AudioListener,h=c.context.createBiquadFilter(),c.setFilter(h),r.camera.add(c),_.dispatch(c),P(!0)}function L(e,t,r,i,a,o){var l;o&&(l=document.createElement("audio"));var u=x[e]=new s(e+".mp3",{preload:!!r,loop:i,elem:l,isPositional:!!a});return n.groups[t].add(u),u.load(),u}function C(e){return v&&x[e].play(),x[e]}function R(){P(!v)}function k(){E()}function P(e){v=!!e}function D(e){c?e(c):_.add(e)}function I(e){if(c){var t=v?1:-1;p=i.saturate(p+t*e*.5);var a=m&&!g;n.master.setFinalVolume(p*(m?1:0),a),y+=12*e;for(var o=0;o<f.length;o++)f[o].style.transform="translate3d(0, 0, 0) scale3d(1, "+((3+11*(.5*Math.sin(y+23.2512*o)+.5)*p)/14).toFixed(4)+",1)";var s=c.context.sampleRate/2,l=Math.log(s/40)/Math.LN2,u=Math.pow(2,l*i.fit(r.cinematicRatio,0,1,1,-.7));h.frequency.value=i.clamp(s*u,40,s),h.gain.value=i.fit(r.cinematicRatio,0,1,0,5)}}},{"../core/properties":71,"../input/input":83,"../utils/math":104,"./AudioGroup":64,"./AudioItem":65,"min-signal":29,three:63}],67:[function(e,t,n){"use strict";var r=e("three");t.exports=r.DeviceOrientationControls=function(e){var t=this;this.object=e,this.object.rotation.reorder("YXZ"),this.enabled=!0,this.hasValue=!1,this.deviceOrientation={},this.screenOrientation=0,this.alphaOffset=0;var n,i,a,o,s=function(e){t.deviceOrientation=e},l=function(){t.screenOrientation=window.orientation||0},u=(n=new r.Vector3(0,0,1),i=new r.Euler,a=new r.Quaternion,o=new r.Quaternion(-Math.sqrt(.5),0,0,Math.sqrt(.5)),function(e,t,r,s,l){i.set(r,t,-s,"YXZ"),e.setFromEuler(i),e.multiply(o),e.multiply(a.setFromAxisAngle(n,-l))});this.connect=function(){l(),void 0!==window.DeviceOrientationEvent&&"function"==typeof window.DeviceOrientationEvent.requestPermission?window.DeviceOrientationEvent.requestPermission().then((function(e){"granted"==e&&(window.addEventListener("orientationchange",l,!1),window.addEventListener("deviceorientation",s,!1))})).catch((function(e){})):(window.addEventListener("orientationchange",l,!1),window.addEventListener("deviceorientation",s,!1)),t.enabled=!0},this.disconnect=function(){window.removeEventListener("orientationchange",l,!1),window.removeEventListener("deviceorientation",s,!1),t.enabled=!1},this.update=function(){if(!1!==t.enabled){var e=t.deviceOrientation;if(e){var n=e.alpha?r.Math.degToRad(e.alpha)+t.alphaOffset:0,i=e.beta?r.Math.degToRad(e.beta):0,a=e.gamma?r.Math.degToRad(e.gamma):0,o=t.screenOrientation?r.Math.degToRad(t.screenOrientation):0;u(t.object.quaternion,n,i,a,o),t.hasValue=e.alpha&&e.beta&&e.gamma}}},this.dispose=function(){t.disconnect()},this.connect()}},{three:63}],68:[function(e,t,n){"use strict";var r=e("three");t.exports=r.OrbitControls=function(e,t){var n,i,a,o,s;this.object=e,this.domElement=void 0!==t?t:document,this.enabled=!0,this.target=new r.Vector3,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.enableDamping=!1,this.dampingFactor=.05,this.enableZoom=!0,this.zoomSpeed=1,this.enableRotate=!0,this.rotateSpeed=1,this.enablePan=!0,this.panSpeed=1,this.screenSpacePanning=!1,this.keyPanSpeed=7,this.autoRotate=!1,this.autoRotateSpeed=2,this.enableKeys=!0,this.keys={LEFT:37,UP:38,RIGHT:39,BOTTOM:40},this.mouseButtons={LEFT:r.MOUSE.ROTATE,MIDDLE:r.MOUSE.DOLLY,RIGHT:r.MOUSE.PAN},this.touches={ONE:r.TOUCH.ROTATE,TWO:r.TOUCH.DOLLY_PAN},this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this.getPolarAngle=function(){return v.phi},this.getAzimuthalAngle=function(){return v.theta},this.saveState=function(){l.target0.copy(l.target),l.position0.copy(l.object.position),l.zoom0=l.object.zoom},this.reset=function(){l.target.copy(l.target0),l.object.position.copy(l.position0),l.object.zoom=l.zoom0,l.object.updateProjectionMatrix(),l.dispatchEvent(u),l.update(),f=d.NONE},this.update=(n=new r.Vector3,i=(new r.Quaternion).setFromUnitVectors(e.up,new r.Vector3(0,1,0)),a=i.clone().invert(),o=new r.Vector3,s=new r.Quaternion,function(){var e=l.object.position;return n.copy(e).sub(l.target),n.applyQuaternion(i),v.setFromVector3(n),l.autoRotate&&f===d.NONE&&R(2*Math.PI/60/60*l.autoRotateSpeed),l.enableDamping?(v.theta+=m.theta*l.dampingFactor,v.phi+=m.phi*l.dampingFactor):(v.theta+=m.theta,v.phi+=m.phi),v.theta=Math.max(l.minAzimuthAngle,Math.min(l.maxAzimuthAngle,v.theta)),v.phi=Math.max(l.minPolarAngle,Math.min(l.maxPolarAngle,v.phi)),v.makeSafe(),v.radius*=g,v.radius=Math.max(l.minDistance,Math.min(l.maxDistance,v.radius)),!0===l.enableDamping?l.target.addScaledVector(_,l.dampingFactor):l.target.add(_),n.setFromSpherical(v),n.applyQuaternion(a),e.copy(l.target).add(n),l.object.lookAt(l.target),!0===l.enableDamping?(m.theta*=1-l.dampingFactor,m.phi*=1-l.dampingFactor,_.multiplyScalar(1-l.dampingFactor)):(m.set(0,0,0),_.set(0,0,0)),g=1,!!(y||o.distanceToSquared(l.object.position)>p||8*(1-s.dot(l.object.quaternion))>p)&&(l.dispatchEvent(u),o.copy(l.object.position),s.copy(l.object.quaternion),y=!1,!0)}),this.dispose=function(){l.domElement.removeEventListener("contextmenu",ee,!1),l.domElement.removeEventListener("mousedown",q,!1),l.domElement.removeEventListener("wheel",K,!1),l.domElement.removeEventListener("touchstart",J,!1),l.domElement.removeEventListener("touchend",$,!1),l.domElement.removeEventListener("touchmove",Q,!1),document.removeEventListener("mousemove",X,!1),document.removeEventListener("mouseup",Y,!1),window.removeEventListener("keydown",Z,!1)};var l=this,u={type:"change"},c={type:"start"},h={type:"end"},d={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6},f=d.NONE,p=1e-6,v=new r.Spherical,m=new r.Spherical,g=1,_=new r.Vector3,y=!1,x=new r.Vector2,b=new r.Vector2,w=new r.Vector2,T=new r.Vector2,M=new r.Vector2,S=new r.Vector2,E=new r.Vector2,A=new r.Vector2,L=new r.Vector2;function C(){return Math.pow(.95,l.zoomSpeed)}function R(e){m.theta-=e}function k(e){m.phi-=e}var P,D=(P=new r.Vector3,function(e,t){P.setFromMatrixColumn(t,0),P.multiplyScalar(-e),_.add(P)}),I=function(){var e=new r.Vector3;return function(t,n){!0===l.screenSpacePanning?e.setFromMatrixColumn(n,1):(e.setFromMatrixColumn(n,0),e.crossVectors(l.object.up,e)),e.multiplyScalar(t),_.add(e)}}(),O=function(){var e=new r.Vector3;return function(t,n){var r=l.domElement===document?l.domElement.body:l.domElement;if(l.object.isPerspectiveCamera){var i=l.object.position;e.copy(i).sub(l.target);var a=e.length();a*=Math.tan(l.object.fov/2*Math.PI/180),D(2*t*a/r.clientHeight,l.object.matrix),I(2*n*a/r.clientHeight,l.object.matrix)}else l.object.isOrthographicCamera?(D(t*(l.object.right-l.object.left)/l.object.zoom/r.clientWidth,l.object.matrix),I(n*(l.object.top-l.object.bottom)/l.object.zoom/r.clientHeight,l.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),l.enablePan=!1)}}();function F(e){l.object.isPerspectiveCamera?g/=e:l.object.isOrthographicCamera?(l.object.zoom=Math.max(l.minZoom,Math.min(l.maxZoom,l.object.zoom*e)),l.object.updateProjectionMatrix(),y=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),l.enableZoom=!1)}function N(e){l.object.isPerspectiveCamera?g*=e:l.object.isOrthographicCamera?(l.object.zoom=Math.max(l.minZoom,Math.min(l.maxZoom,l.object.zoom/e)),l.object.updateProjectionMatrix(),y=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),l.enableZoom=!1)}function U(e){x.set(e.clientX,e.clientY)}function B(e){T.set(e.clientX,e.clientY)}function z(e){if(1==e.touches.length)x.set(e.touches[0].pageX,e.touches[0].pageY);else{var t=.5*(e.touches[0].pageX+e.touches[1].pageX),n=.5*(e.touches[0].pageY+e.touches[1].pageY);x.set(t,n)}}function H(e){if(1==e.touches.length)T.set(e.touches[0].pageX,e.touches[0].pageY);else{var t=.5*(e.touches[0].pageX+e.touches[1].pageX),n=.5*(e.touches[0].pageY+e.touches[1].pageY);T.set(t,n)}}function G(e){var t=e.touches[0].pageX-e.touches[1].pageX,n=e.touches[0].pageY-e.touches[1].pageY,r=Math.sqrt(t*t+n*n);E.set(0,r)}function V(e){if(1==e.touches.length)b.set(e.touches[0].pageX,e.touches[0].pageY);else{var t=.5*(e.touches[0].pageX+e.touches[1].pageX),n=.5*(e.touches[0].pageY+e.touches[1].pageY);b.set(t,n)}w.subVectors(b,x).multiplyScalar(l.rotateSpeed);var r=l.domElement===document?l.domElement.body:l.domElement;R(2*Math.PI*w.x/r.clientHeight),k(2*Math.PI*w.y/r.clientHeight),x.copy(b)}function W(e){if(1==e.touches.length)M.set(e.touches[0].pageX,e.touches[0].pageY);else{var t=.5*(e.touches[0].pageX+e.touches[1].pageX),n=.5*(e.touches[0].pageY+e.touches[1].pageY);M.set(t,n)}S.subVectors(M,T).multiplyScalar(l.panSpeed),O(S.x,S.y),T.copy(M)}function j(e){var t=e.touches[0].pageX-e.touches[1].pageX,n=e.touches[0].pageY-e.touches[1].pageY,r=Math.sqrt(t*t+n*n);A.set(0,r),L.set(0,Math.pow(A.y/E.y,l.zoomSpeed)),F(L.y),E.copy(A)}function q(e){if(!1!==l.enabled){switch(e.preventDefault(),l.domElement.focus?l.domElement.focus():window.focus(),e.button){case 0:switch(l.mouseButtons.LEFT){case r.MOUSE.ROTATE:if(e.ctrlKey||e.metaKey||e.shiftKey){if(!1===l.enablePan)return;B(e),f=d.PAN}else{if(!1===l.enableRotate)return;U(e),f=d.ROTATE}break;case r.MOUSE.PAN:if(e.ctrlKey||e.metaKey||e.shiftKey){if(!1===l.enableRotate)return;U(e),f=d.ROTATE}else{if(!1===l.enablePan)return;B(e),f=d.PAN}break;default:f=d.NONE}break;case 1:if(l.mouseButtons.MIDDLE===r.MOUSE.DOLLY){if(!1===l.enableZoom)return;!function(e){E.set(e.clientX,e.clientY)}(e),f=d.DOLLY}else f=d.NONE;break;case 2:switch(l.mouseButtons.RIGHT){case r.MOUSE.ROTATE:if(!1===l.enableRotate)return;U(e),f=d.ROTATE;break;case r.MOUSE.PAN:if(!1===l.enablePan)return;B(e),f=d.PAN;break;default:f=d.NONE}}f!==d.NONE&&(document.addEventListener("mousemove",X,!1),document.addEventListener("mouseup",Y,!1),l.dispatchEvent(c))}}function X(e){if(!1!==l.enabled)switch(e.preventDefault(),f){case d.ROTATE:if(!1===l.enableRotate)return;!function(e){b.set(e.clientX,e.clientY),w.subVectors(b,x).multiplyScalar(l.rotateSpeed);var t=l.domElement===document?l.domElement.body:l.domElement;R(2*Math.PI*w.x/t.clientHeight),k(2*Math.PI*w.y/t.clientHeight),x.copy(b),l.update()}(e);break;case d.DOLLY:if(!1===l.enableZoom)return;!function(e){A.set(e.clientX,e.clientY),L.subVectors(A,E),L.y>0?F(C()):L.y<0&&N(C()),E.copy(A),l.update()}(e);break;case d.PAN:if(!1===l.enablePan)return;!function(e){M.set(e.clientX,e.clientY),S.subVectors(M,T).multiplyScalar(l.panSpeed),O(S.x,S.y),T.copy(M),l.update()}(e)}}function Y(e){!1!==l.enabled&&(document.removeEventListener("mousemove",X,!1),document.removeEventListener("mouseup",Y,!1),l.dispatchEvent(h),f=d.NONE)}function K(e){!1===l.enabled||!1===l.enableZoom||f!==d.NONE&&f!==d.ROTATE||(e.stopPropagation(),l.dispatchEvent(c),function(e){e.deltaY<0?N(C()):e.deltaY>0&&F(C()),l.update()}(e),l.dispatchEvent(h))}function Z(e){!1!==l.enabled&&!1!==l.enableKeys&&!1!==l.enablePan&&function(e){var t=!1;switch(e.keyCode){case l.keys.UP:O(0,l.keyPanSpeed),t=!0;break;case l.keys.BOTTOM:O(0,-l.keyPanSpeed),t=!0;break;case l.keys.LEFT:O(l.keyPanSpeed,0),t=!0;break;case l.keys.RIGHT:O(-l.keyPanSpeed,0),t=!0}t&&(e.preventDefault(),l.update())}(e)}function J(e){if(!1!==l.enabled){switch(e.preventDefault(),e.touches.length){case 1:switch(l.touches.ONE){case r.TOUCH.ROTATE:if(!1===l.enableRotate)return;z(e),f=d.TOUCH_ROTATE;break;case r.TOUCH.PAN:if(!1===l.enablePan)return;H(e),f=d.TOUCH_PAN;break;default:f=d.NONE}break;case 2:switch(l.touches.TWO){case r.TOUCH.DOLLY_PAN:if(!1===l.enableZoom&&!1===l.enablePan)return;!function(e){l.enableZoom&&G(e),l.enablePan&&H(e)}(e),f=d.TOUCH_DOLLY_PAN;break;case r.TOUCH.DOLLY_ROTATE:if(!1===l.enableZoom&&!1===l.enableRotate)return;!function(e){l.enableZoom&&G(e),l.enableRotate&&z(e)}(e),f=d.TOUCH_DOLLY_ROTATE;break;default:f=d.NONE}break;default:f=d.NONE}f!==d.NONE&&l.dispatchEvent(c)}}function Q(e){if(!1!==l.enabled)switch(e.preventDefault(),e.stopPropagation(),f){case d.TOUCH_ROTATE:if(!1===l.enableRotate)return;V(e),l.update();break;case d.TOUCH_PAN:if(!1===l.enablePan)return;W(e),l.update();break;case d.TOUCH_DOLLY_PAN:if(!1===l.enableZoom&&!1===l.enablePan)return;!function(e){l.enableZoom&&j(e),l.enablePan&&W(e)}(e),l.update();break;case d.TOUCH_DOLLY_ROTATE:if(!1===l.enableZoom&&!1===l.enableRotate)return;!function(e){l.enableZoom&&j(e),l.enableRotate&&V(e)}(e),l.update();break;default:f=d.NONE}}function $(e){!1!==l.enabled&&(l.dispatchEvent(h),f=d.NONE)}function ee(e){!1!==l.enabled&&e.preventDefault()}l.domElement.addEventListener("contextmenu",ee,!1),l.domElement.addEventListener("mousedown",q,!1),l.domElement.addEventListener("wheel",K,!1),l.domElement.addEventListener("touchstart",J,!1),l.domElement.addEventListener("touchend",$,!1),l.domElement.addEventListener("touchmove",Q,!1),window.addEventListener("keydown",Z,!1),this.update()},r.OrbitControls.prototype=Object.create(r.EventDispatcher.prototype),r.OrbitControls.prototype.constructor=r.OrbitControls,Object.defineProperties(r.OrbitControls.prototype,{center:{get:function(){return console.warn("THREE.OrbitControls: .center has been renamed to .target"),this.target}},noZoom:{get:function(){return console.warn("THREE.OrbitControls: .noZoom has been deprecated. Use .enableZoom instead."),!this.enableZoom},set:function(e){console.warn("THREE.OrbitControls: .noZoom has been deprecated. Use .enableZoom instead."),this.enableZoom=!e}},noRotate:{get:function(){return console.warn("THREE.OrbitControls: .noRotate has been deprecated. Use .enableRotate instead."),!this.enableRotate},set:function(e){console.warn("THREE.OrbitControls: .noRotate has been deprecated. Use .enableRotate instead."),this.enableRotate=!e}},noPan:{get:function(){return console.warn("THREE.OrbitControls: .noPan has been deprecated. Use .enablePan instead."),!this.enablePan},set:function(e){console.warn("THREE.OrbitControls: .noPan has been deprecated. Use .enablePan instead."),this.enablePan=!e}},noKeys:{get:function(){return console.warn("THREE.OrbitControls: .noKeys has been deprecated. Use .enableKeys instead."),!this.enableKeys},set:function(e){console.warn("THREE.OrbitControls: .noKeys has been deprecated. Use .enableKeys instead."),this.enableKeys=!e}},staticMoving:{get:function(){return console.warn("THREE.OrbitControls: .staticMoving has been deprecated. Use .enableDamping instead."),!this.enableDamping},set:function(e){console.warn("THREE.OrbitControls: .staticMoving has been deprecated. Use .enableDamping instead."),this.enableDamping=!e}},dynamicDampingFactor:{get:function(){return console.warn("THREE.OrbitControls: .dynamicDampingFactor has been renamed. Use .dampingFactor instead."),this.dampingFactor},set:function(e){console.warn("THREE.OrbitControls: .dynamicDampingFactor has been renamed. Use .dampingFactor instead."),this.dampingFactor=e}}}),r.MapControls=function(e,t){r.OrbitControls.call(this,e,t),this.mouseButtons.LEFT=r.MOUSE.PAN,this.mouseButtons.RIGHT=r.MOUSE.ROTATE,this.touches.ONE=r.TOUCH.PAN,this.touches.TWO=r.TOUCH.DOLLY_ROTATE},r.MapControls.prototype=Object.create(r.EventDispatcher.prototype),r.MapControls.prototype.constructor=r.MapControls},{three:63}],69:[function(e,t,n){"use strict";var r,i,a,o,s,l,u,c=e("../core/browser"),h=e("../core/properties"),d=e("../motions/BrownianMotion"),f=e("../utils/ease"),p=e("three"),v=(e("glslify"),e("./DeviceOrientationControls")),m=e("./OrbitControls");n.preInit=function(){var e=h.camera;w=new p.Vector3,T=new p.Vector3,e.position.copy(_),r=h.brownianMotion=new d,a=h.orbitCamera=e.clone(),(i=h.orbitControls=new m(a,document.body)).target0.copy(y),i.reset(),c.isMobile&&(u=new p.Camera,s=new p.Quaternion,l=new p.Quaternion,o=new v(u))},n.init=function(){},n.resize=function(e,t){},n.update=function(e){var t=h.camera;t.matrix.identity(),t.matrix.decompose(t.position,t.quaternion,t.scale),t.position.copy(_),i.update(),a.updateMatrix(),a.matrix.decompose(t.position,t.quaternion,t.scale),w.set(0,0,-1).applyQuaternion(t.quaternion);var n=T.copy(i.target).sub(t.position).dot(w);t.filmGauge=70,t.setFocalLength(30);var d=t.fov;t.fov=d+h.cameraDollyZoomFovOffset+10*f.easeInOutCubic(h.cinematicRatio);var p=n;p=p*Math.tan(d/360*Math.PI/2)/Math.tan(t.fov/360*Math.PI/2)-p,t.translateZ(p),h.cameraDollyZoomZOffset=p,h.cameraDollyZoomFovOffset*=.975,t.updateProjectionMatrix(),t.fov=d,t.translateZ(-n),c.isMobile&&(o.update(),o.hasValue&&(g||(l.copy(u.quaternion),s.copy(u.quaternion)),l.slerp(u.quaternion,.02),s.slerp(l,.02),g=!0),x.copy(s).invert().multiply(l),t.quaternion.multiply(x));b.set(h.cameraLookX,h.cameraLookY,0),x.setFromEuler(b),t.quaternion.multiply(x),t.translateZ(n),t.matrix.compose(t.position,t.quaternion,t.scale),r.positionAmplitude=h.cameraShakePositionStrength,r.positionFrequency=h.cameraShakePositionSpeed,r.rotationAmplitude=h.cameraShakeRotationStrength,r.rotationFrequency=h.cameraShakeRotationSpeed,r.update(e),t.matrix.multiply(r.matrix),t.matrix.decompose(t.position,t.quaternion,t.scale),w.set(0,0,-1).applyQuaternion(t.quaternion),h.cameraDistance=T.copy(i.target).sub(t.position).dot(w)},n.container=null;var g=!1,_=new p.Vector3(0,0,5),y=new p.Vector3(0,.5,0),x=new p.Quaternion,b=new p.Euler,w=new p.Vector3,T=new p.Vector3},{"../core/browser":70,"../core/properties":71,"../motions/BrownianMotion":89,"../utils/ease":103,"./DeviceOrientationControls":67,"./OrbitControls":68,glslify:26,three:63}],70:[function(e,t,n){"use strict";var r;Object.defineProperty(n,"__esModule",{value:!0}),n.videoFormat=n.transitionStyle=n.transformStyle=n.transformPerspectiveStyle=n.transformOriginStyle=n.transform3dStyle=n.isSupportOpacity=n.isSafari=n.isRetina=n.isMobile=n.isIOS=n.isIFrame=n.isIE=n.isFirefox=n.isEdge=n.isChrome=n.filterStyle=n.devicePixelRatio=n.cpuCoreCount=n.baseUrl=n.audioFormat=n.WebAudioContext=void 0;var i="Webkit Moz O ms".split(" "),a=document.createElement("div").style,o=window,s=document,l=(navigator.userAgent||navigator.vendor||window.opera).toLowerCase(),u=k("video",["video/mp4","video/ogv"]);n.videoFormat=u;var c=k("audio",["audio/mp3","audio/ogg"]);n.audioFormat=c;var h=o.self!==o.top;n.isIFrame=h;var d=o.devicePixelRatio&&o.devicePixelRatio>=1.5;n.isRetina=d;var f=a.opacity!==r;n.isSupportOpacity=f;var p=navigator.hardwareConcurrency||1;n.cpuCoreCount=p;var v=l.indexOf("edge")>-1;n.isEdge=v;var m=l.indexOf("msie")>-1;n.isIE=m;var g=l.indexOf("firefox")>-1;n.isFirefox=g;var _=!v&&l.indexOf("chrome")>-1;n.isChrome=_;var y=!v&&!_&&l.indexOf("safari")>-1;n.isSafari=y;var x=/(iPad|iPhone|Android)/i.test(l);n.isMobile=x;var b=/(iPad|iPhone)/i.test(l);n.isIOS=b;var w=m?r:P("filter");n.filterStyle=w;var T=P("transition");n.transitionStyle=T;var M=P("transform");n.transformStyle=M;var S=P("transform","perspective");n.transform3dStyle=S;var E=P("perspective");n.transformPerspectiveStyle=E;var A=P("transformOrigin");n.transformOriginStyle=A;var L=o.AudioContext||o.webkitAudioContext;n.WebAudioContext=L;var C=document.location.origin;n.baseUrl=C;var R=window.devicePixelRatio||1;function k(e,t){var n,r;try{switch(e){case"video":n=new o.Video;break;case"audio":n=new o.Audio}}catch(t){n=s.createElement(e)}for(var i=0,a=t.length;i<a;i++)if(n.canPlayType&&n.canPlayType(t[i])){r=t[i].substr(t[i].indexOf("/")+1);break}return r}function P(e,t){return function(e,t){return t>1?i[t-2]+e.charAt(0).toUpperCase()+e.slice(1):1===t&&e}(e,function(e){var t=e.charAt(0).toUpperCase()+e.slice(1),n=i.length;for(;n--;)if(a[i[n]+t]!==r)return n+2;if(a[e]!==r)return 1;return 0}(t||e))}n.devicePixelRatio=R},{}],71:[function(e,t,n){"use strict";var r=e("min-signal"),i=e("../visuals/stage0/themeData/themeData");n.loader=e("quick-loader").create(),n.gl=null,n.isSupportWebGL=null,n.isAudioActive=!1,n.renderer=null,n.scene=null,n.camera=null,n.postprocessing=null,n.sharedUniforms={u_resolution:{value:null},u_bgColor:{value:null},u_time:{value:0}},n.resolution=null,n.isStageReady=!1,n.hasInitialized=!1,n.domElement=null,n.rawWidth=0,n.rawHeight=0,n.width=0,n.height=0,n.time=0,n.visualTimeScale=1,n.cinematicRatio=0,n.showAnimation=0,n.bloom=null,n.final=null,n.hitTestList=[],n.bgColorHex="#000000",n.opacity=0,n.bloomAmount=1.4,n.bloomRadius=0,n.bloomThreshold=.2,n.bloomSmoothWidth=.75,n.haloWidth=.8,n.haloRGBShift=.03,n.haloStrength=.3,n.haloMaskInner=.8255,n.haloMaskOuter=1,n.vignetteFrom=.6,n.vignetteTo=1.6,n.vignetteColorHex="#878A8C",n.saturation=1,n.contrast=0,n.brightness=1,n.tintColorHex="#0044ef",n.tintOpacity=.1,n.bokehAutoDistance=!0,n.bokehAmount=0,n.bokehFNumber=.181,n.bokehFocusDistance=2.515,n.bokehFocalLength=.344,n.bokehKFilmHeight=19.26,n.cameraShakeBlurAmount=0,n.orbitControls=null,n.orbitCamera=null,n.cameraLookX=0,n.cameraLookY=0,n.cameraLookStrength=.05,n.cameraLookEaseDamp=.075,n.cameraDollyZoomFovOffset=0,n.cameraDollyZoomZOffset=0,n.cameraDistance=3,n.cameraShakePositionStrength=0,n.cameraShakePositionSpeed=.3,n.cameraShakeRotationStrength=0,n.cameraShakeRotationSpeed=.3,n.stage0_changeColors=new r,n.cinematicIsActive=new r,n.cacheBlendRatio=0,n.cacheBlendDirection=1,n.stage0_activeThemeData=i[4],n.sky={topColor:n.stage0_activeThemeData.sky.topColor,bottomColor:n.stage0_activeThemeData.sky.bottomColor,offset:n.stage0_activeThemeData.sky.offset,exponent:n.stage0_activeThemeData.sky.exponent},n.ground={mainColor:n.stage0_activeThemeData.ground.mainColor,diffLightColor:n.stage0_activeThemeData.ground.diffLightColor,diffLightIntensity:n.stage0_activeThemeData.ground.diffLightIntensity,maskStrength:n.stage0_activeThemeData.ground.maskStrength},n.lightning={topColor:n.stage0_activeThemeData.lightning.topColor,bottomColor:n.stage0_activeThemeData.lightning.bottomColor,intensity:n.stage0_activeThemeData.lightning.intensity},n.trails={color:n.stage0_activeThemeData.trails.color,speed:n.stage0_activeThemeData.trails.speed,metalness:n.stage0_activeThemeData.trails.metalness,roughness:n.stage0_activeThemeData.trails.roughness,envMapIntensity:n.stage0_activeThemeData.envMapIntensitytrails},n.leo={color:n.stage0_activeThemeData.leo.color,emissive:n.stage0_activeThemeData.leo.emissive}},{"../visuals/stage0/themeData/themeData":114,"min-signal":29,"quick-loader":50}],72:[function(e,t,n){"use strict";var r=e("mout/lang/isBoolean"),i=e("mout/lang/isInteger"),a=e("mout/queryString/parse")(window.location.href),o=e("./browser");for(var s in n.AUDIO_PATH="assets/audios/",n.MODEL_PATH="assets/models/",n.IMAGE_PATH="assets/images/",n.TEXTURE_PATH="assets/textures/",n.GLOBAL_ID="webglApi",n.canvas=null,n.gl=null,n.webglOpts={antialias:!1,alpha:!1,xrCompatible:!0},n.RENDER_TARGET_FLOAT_TYPE=null,n.DATA_FLOAT_TYPE=null,n.USE_FLOAT_PACKING=!1,n.USE_WEBGL2=!1,//!(browser.isSafari || browser.isIOS);
n.DPR=Math.min(1.5,o.devicePixelRatio)||1,n.MAX_PIXEL_COUNT=3686400,n.CROSS_ORIGINS={},n.SKIP_ANIMATION=!1,n.LOOK_DEV_MODE=!1,n.DEFAULT_STAGE_INDEX=-1,n.STAGE_0_ID="motion",n.STAGE_1_ID="style",a)if(void 0!==n[s]){var l=a[s];r(n[s])?n[s]=!(0==l):i(n[s])&&(n[s]=parseInt(l,10))}var u=window.location.href.indexOf(n.STAGE_0_ID)>-1,c=window.location.href.indexOf(n.STAGE_1_ID)>-1;n.DEFAULT_STAGE_INDEX=u||c?u?0:1:-1===n.DEFAULT_STAGE_INDEX?Math.random()>.5?1:0:n.DEFAULT_STAGE_INDEX},{"./browser":70,"mout/lang/isBoolean":33,"mout/lang/isInteger":34,"mout/queryString/parse":48}],73:[function(e,t,n){"use strict";var r=e("../../core/properties"),i=e("../../core/settings"),a=e("../../helpers/shaderHelper"),o=e("three"),s=e("glslify");n.preInit=function(){var e=new o.Texture;e.generateMipmaps=!1,e.minFilter=e.magFilter=o.LinearFilter,e.wrapS=e.wrapT=o.RepeatWrapping;var t=new o.Texture(r.loader.add(i.TEXTURE_PATH+"LDR_RGB1_0.png",{weight:55,onLoad:function(){t.needsUpdate=!0,e.needsUpdate=!0}}).content);e.image=t.image,t.generateMipmaps=!1,t.minFilter=t.magFilter=o.NearestFilter,t.wrapS=t.wrapT=o.RepeatWrapping,u.u_blueNoiseTexture.value=t,u.u_blueNoiseLinearTexture.value=e,u.u_blueNoiseTexelSize.value=new o.Vector2(1/128,1/128),u.u_blueNoiseCoordOffset.value=l=new o.Vector2,a.addChunk("getBlueNoise",s(["#define GLSLIFY 1\nuniform sampler2D u_blueNoiseTexture;\nuniform vec2 u_blueNoiseTexelSize;\nuniform vec2 u_blueNoiseCoordOffset;\n\n// getBlueNoise(gl_FragCoord.xy)\nvec3 getBlueNoise (vec2 coord) {\n\treturn texture2D(u_blueNoiseTexture, coord * u_blueNoiseTexelSize + u_blueNoiseCoordOffset).rgb;\n}\n// getStaticBlueNoise(gl_FragCoord.xy)\nvec3 getStaticBlueNoise (vec2 coord) {\n\treturn texture2D(u_blueNoiseTexture, coord * u_blueNoiseTexelSize).rgb;\n}"]))},n.update=function(e){l.set(Math.random(),Math.random())};var l,u=n.sharedUniforms={u_blueNoiseTexture:{value:null},u_blueNoiseLinearTexture:{value:null},u_blueNoiseTexelSize:{value:null},u_blueNoiseCoordOffset:{value:null}}},{"../../core/properties":71,"../../core/settings":72,"../../helpers/shaderHelper":80,glslify:26,three:63}],74:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.blur=m,n.blur9=function(e,t,n,r,i,a){m(v(),.25,e,t,n,r,i,a)},n.blur9RGBA=function(e,t,n,r,i,a){m(v(!0),.25,e,t,n,r,i,a)},n.getBlur9DepthMaterial=function(e,t){t=!!t;var n=(e=!!e)?t?o:l:t?s:u,i=d.MAX_VARYING_VECTORS>8;n||(n=new f.RawShaderMaterial({uniforms:{u_texture:{type:"t",value:r},u_delta:{type:"v2",value:new f.Vector2}},vertexShader:i?d.precisionPrefix+p(["#define GLSLIFY 1\nattribute vec3 position;\n\nuniform vec2 u_delta;\nvarying vec2 v_uv[9];\n\nvoid main() {\n    vec2 uv = position.xy * 0.5 + 0.5;\n\n    v_uv[0] = uv;\n\n    vec2 delta = u_delta;\n    v_uv[1] = uv - delta;\n    v_uv[2] = uv + delta;\n\n    delta += u_delta;\n    v_uv[3] = uv - delta;\n    v_uv[4] = uv + delta;\n\n    delta += u_delta;\n    v_uv[5] = uv - delta;\n    v_uv[6] = uv + delta;\n\n    delta += u_delta;\n    v_uv[7] = uv - delta;\n    v_uv[8] = uv + delta;\n\n    gl_Position = vec4( position, 1.0 );\n\n}\n"]):d.vertexShader,fragmentShader:d.precisionPrefix+p(i?["#define GLSLIFY 1\n#include <packing>\n\nuniform sampler2D u_texture;\nuniform float u_cameraFarSubNear;\nuniform float u_cameraNearMulFar;\nuniform float u_cameraNear;\nuniform float u_cameraFar;\n\nvarying vec2 v_uv[9];\n\n#if FROM_LINEAR\nfloat tap (vec2 uv) {\n    return unpackRGBAToDepth(texture2D(u_texture, uv));\n}\n#else\nfloat tap (vec2 uv) {\n    return u_cameraNearMulFar / (unpackRGBAToDepth(texture2D(u_texture, uv) * u_cameraFarSubNear - u_cameraFar);\n}\n#endif\n\n#if TO_LINEAR\nfloat encode (float depth) {\n    return packDepthToRGBA(depth);\n}\n#else\nfloat encode (float depth) {\n    return packDepthToRGBA((u_cameraNear + depth) * u_cameraFar) / (u_cameraFarSubNear * viewZ);\n}\n#endif\n\nvoid main() {\n        vec4 color = tap(v_uv[0]) * 0.1633;\n        color += tap( v_uv[1]) * 0.1531;\n        color += tap( v_uv[2]) * 0.1531;\n        color += tap( v_uv[3]) * 0.12245;\n        color += tap( v_uv[4]) * 0.12245;\n        color += tap( v_uv[5]) * 0.0918;\n        color += tap( v_uv[6]) * 0.0918;\n        color += tap( v_uv[7]) * 0.051;\n        color += tap( v_uv[8]) * 0.051;\n\n        gl_FragColor = encode(color);\n}\n"]:["#define GLSLIFY 1\n#include <packing>\n\nuniform sampler2D u_texture;\nuniform vec2 u_delta;\nuniform float u_cameraFarSubNear;\nuniform float u_cameraNearMulFar;\nuniform float u_cameraNear;\nuniform float u_cameraFar;\n\nvarying vec2 v_uv;\n\n#if FROM_LINEAR\nfloat tap (vec2 uv) {\n    return unpackRGBAToDepth(texture2D(u_texture, uv));\n}\n#else\nfloat tap (vec2 uv) {\n    return u_cameraNearMulFar / (unpackRGBAToDepth(texture2D(u_texture, uv) * u_cameraFarSubNear - u_cameraFar);\n}\n#endif\n\n#if TO_LINEAR\nfloat encode (float depth) {\n    return packDepthToRGBA(depth);\n}\n#else\nfloat encode (float depth) {\n    return packDepthToRGBA((u_cameraNear + depth) * u_cameraFar) / (u_cameraFarSubNear * viewZ);\n}\n#endif\n\nvoid main() {\n        vec4 color = tap(v_uv) * 0.1633;\n\n        vec2 delta = u_delta;\n        color += tap(v_uv - delta) * 0.1531;\n        color += tap(v_uv + delta) * 0.1531;\n\n        delta += u_delta;\n        color += tap(v_uv - delta) * 0.12245;\n        color += tap(v_uv + delta) * 0.12245;\n\n        delta += u_delta;\n        color += tap(v_uv - delta) * 0.0918;\n        color += tap(v_uv + delta) * 0.0918;\n\n        delta += u_delta;\n        color += tap(v_uv - delta) * 0.051;\n        color += tap(v_uv + delta) * 0.051;\n\n        gl_FragColor = encode(color);\n}\n"]),blending:f.NoBlending,transparent:!0,defines:{FROM_LINEAR:e,TO_LINEAR:t}}));e?t?o=n:l=n:t?s=n:u=n;return n},n.getBlur9Material=v;var r,i,a,o,s,l,u,c,h,d=e("../../helpers/fboHelper"),f=e("three"),p=e("glslify");function v(e){var t=(e=!!e)?a:i,n=d.MAX_VARYING_VECTORS>8;return t||(t=new f.RawShaderMaterial({uniforms:{u_texture:{type:"t",value:r},u_delta:{type:"v2",value:new f.Vector2}},vertexShader:n?d.precisionPrefix+p(["#define GLSLIFY 1\nattribute vec3 position;\n\nuniform vec2 u_delta;\nvarying vec2 v_uv[9];\n\nvoid main() {\n    vec2 uv = position.xy * 0.5 + 0.5;\n\n    v_uv[0] = uv;\n\n    vec2 delta = u_delta;\n    v_uv[1] = uv - delta;\n    v_uv[2] = uv + delta;\n\n    delta += u_delta;\n    v_uv[3] = uv - delta;\n    v_uv[4] = uv + delta;\n\n    delta += u_delta;\n    v_uv[5] = uv - delta;\n    v_uv[6] = uv + delta;\n\n    delta += u_delta;\n    v_uv[7] = uv - delta;\n    v_uv[8] = uv + delta;\n\n    gl_Position = vec4( position, 1.0 );\n\n}\n"]):d.vertexShader,fragmentShader:d.precisionPrefix+p(n?["#define GLSLIFY 1\nuniform sampler2D u_texture;\nvarying vec2 v_uv[9];\n\nvoid main() {\n\n    #ifdef USE_RGBA\n        vec4 color = texture2D( u_texture, v_uv[0] ) * 0.1633;\n        color += texture2D( u_texture,  v_uv[1] ) * 0.1531;\n        color += texture2D( u_texture,  v_uv[2] ) * 0.1531;\n        color += texture2D( u_texture,  v_uv[3] ) * 0.12245;\n        color += texture2D( u_texture,  v_uv[4] ) * 0.12245;\n        color += texture2D( u_texture,  v_uv[5] ) * 0.0918;\n        color += texture2D( u_texture,  v_uv[6] ) * 0.0918;\n        color += texture2D( u_texture,  v_uv[7] ) * 0.051;\n        color += texture2D( u_texture,  v_uv[8] ) * 0.051;\n\n        gl_FragColor = color;\n    #else\n        vec4 center = texture2D( u_texture, v_uv[0] );\n        vec3 color = center.rgb * 0.1633;\n        color += texture2D( u_texture,  v_uv[1] ).rgb * 0.1531;\n        color += texture2D( u_texture,  v_uv[2] ).rgb * 0.1531;\n        color += texture2D( u_texture,  v_uv[3] ).rgb * 0.12245;\n        color += texture2D( u_texture,  v_uv[4] ).rgb * 0.12245;\n        color += texture2D( u_texture,  v_uv[5] ).rgb * 0.0918;\n        color += texture2D( u_texture,  v_uv[6] ).rgb * 0.0918;\n        color += texture2D( u_texture,  v_uv[7] ).rgb * 0.051;\n        color += texture2D( u_texture,  v_uv[8] ).rgb * 0.051;\n\n        gl_FragColor = vec4(color, center.a);\n    #endif\n\n}\n"]:["#define GLSLIFY 1\nuniform sampler2D u_texture;\nuniform vec2 u_delta;\n\nvarying vec2 v_uv;\n\nvoid main() {\n\n    #ifdef USE_RGBA\n        vec4 color = texture2D( u_texture, v_uv ) * 0.1633;\n\n        vec2 delta = u_delta;\n        color += texture2D( u_texture,  v_uv - delta ) * 0.1531;\n        color += texture2D( u_texture,  v_uv + delta ) * 0.1531;\n\n        delta += u_delta;\n        color += texture2D( u_texture,  v_uv - delta ) * 0.12245;\n        color += texture2D( u_texture,  v_uv + delta ) * 0.12245;\n\n        delta += u_delta;\n        color += texture2D( u_texture,  v_uv - delta ) * 0.0918;\n        color += texture2D( u_texture,  v_uv + delta ) * 0.0918;\n\n        delta += u_delta;\n        color += texture2D( u_texture,  v_uv - delta ) * 0.051;\n        color += texture2D( u_texture,  v_uv + delta ) * 0.051;\n\n        gl_FragColor = color;\n\n    #else\n        vec4 center = texture2D( u_texture, v_uv );\n        vec3 color = center.rgb * 0.1633;\n\n        vec2 delta = u_delta;\n        color += texture2D( u_texture,  v_uv - delta ).rgb * 0.1531;\n        color += texture2D( u_texture,  v_uv + delta ).rgb * 0.1531;\n\n        delta += u_delta;\n        color += texture2D( u_texture,  v_uv - delta ).rgb * 0.12245;\n        color += texture2D( u_texture,  v_uv + delta ).rgb * 0.12245;\n\n        delta += u_delta;\n        color += texture2D( u_texture,  v_uv - delta ).rgb * 0.0918;\n        color += texture2D( u_texture,  v_uv + delta ).rgb * 0.0918;\n\n        delta += u_delta;\n        color += texture2D( u_texture,  v_uv - delta ).rgb * 0.051;\n        color += texture2D( u_texture,  v_uv + delta ).rgb * 0.051;\n\n        gl_FragColor = vec4(color, center.a);\n\n    #endif\n\n}\n"]),blending:f.NoBlending,transparent:e,defines:{USE_RGBA:e}}),e?a=t:i=t),t}function m(e,t,n,r,i,a,o,s){var l=Math.ceil(i.width*r)||0,u=Math.ceil(i.height*r)||0;a||(e.transparent?(h||(h=d.createRenderTarget(1,1,!0)),a=h):(c||(c=d.createRenderTarget(1,1)),a=c)),a.setSize(l,u),o?s||o.setSize(i.width,i.height):o=i,e.uniforms.u_texture.value=i.texture||i,e.uniforms.u_delta.value.set(n/l*t,0),d.render(e,a),e.uniforms.u_texture.value=a.texture||a,e.uniforms.u_delta.value.set(0,n/u*t),d.render(e,o)}},{"../../helpers/fboHelper":79,glslify:26,three:63}],75:[function(e,t,n){t.exports="uniform vec2 u_glPositionOffset;\n\nvec4 glPositionOffset (vec4 glPosition) {\n\treturn glPosition + vec4(u_glPositionOffset * glPosition.w, 0.0, 0.0);\n}"},{}],76:[function(e,t,n){"use strict";var r=e("../../helpers/shaderHelper"),i=e("three");n.init=function(){o.u_glPositionOffset.value=a=new i.Vector2,r.addChunk("glPositionOffset",e("./glPositionOffset.glsl"))},n.setOffset=function(e,t){return a.set(e,t)};var a,o=n.sharedUniforms={u_glPositionOffset:{value:null}}},{"../../helpers/shaderHelper":80,"./glPositionOffset.glsl":75,three:63}],77:[function(e,t,n){"use strict";var r=e("three"),i=e("glslify"),a=e("../../utils/math"),o=e("../../helpers/fboHelper"),s=e("../../helpers/shaderHelper");(n=t.exports=function(e,t){this.tmpRenderTarget=o.createRenderTarget(1,1,!0),this.fixedMaxMipmapLevel=e||16,this.maxMipmapLevel=0,this.needsBlur=!!t,this.textureSize=new r.Vector2;var n=c+1;this.geometry=h(n),this.oddGeometry=h(n),this.clampCache=new Float32Array(4*n),this.needsBlur&&(u||(u=new r.RawShaderMaterial({uniforms:{u_texture:{value:null},u_loClamp:{value:new r.Vector2},u_hiClamp:{value:new r.Vector2},u_texelSize:{value:new r.Vector2}},vertexShader:o.precisionPrefix+i(["#define GLSLIFY 1\nattribute vec3 position;\nattribute vec2 uv;\n\nuniform vec2 u_texelSize;\n\nvarying vec2 v_uvE;\nvarying vec2 v_uvS;\nvarying vec2 v_uvW;\nvarying vec2 v_uvN;\n\nvoid main() {\n    v_uvE = uv + vec2(u_texelSize.x, 0.0);\n    v_uvS = uv - vec2(0.0, u_texelSize.y);\n    v_uvW = uv - vec2(u_texelSize.x, 0.0);\n    v_uvN = uv + vec2(0.0, u_texelSize.y);\n    gl_Position = vec4(position, 1.0 );\n}\n"]),fragmentShader:o.precisionPrefix+i(["#define GLSLIFY 1\nuniform sampler2D u_texture;\n\nuniform vec2 u_loClamp;\nuniform vec2 u_hiClamp;\n\nvarying vec2 v_uvE;\nvarying vec2 v_uvS;\nvarying vec2 v_uvW;\nvarying vec2 v_uvN;\n\nvoid main () {\n\n\tvec4 e = texture2D(u_texture, clamp(v_uvE, u_loClamp, u_hiClamp));\n\tvec4 s = texture2D(u_texture, clamp(v_uvS, u_loClamp, u_hiClamp));\n\tvec4 w = texture2D(u_texture, clamp(v_uvW, u_loClamp, u_hiClamp));\n\tvec4 n = texture2D(u_texture, clamp(v_uvN, u_loClamp, u_hiClamp));\n\n    gl_FragColor = (e + s + w + n) * 0.25;\n}\n"]),depthTest:!1,depthWrite:!1,blending:r.NoBlending})))}).init=function(){s.addChunk("lodMipmapSample",i(["#define GLSLIFY 1\nvec2 getMipUv (vec2 uv, float lod, vec2 mipmapTextureSize) {\n\tvec2 textureSize = mipmapTextureSize * vec2(0.666666667, 1.0);\n\tfloat isNonZeroLod = step(0.5, lod);\n\tvec2 xy = vec2(\n\t\tisNonZeroLod * textureSize.x / mipmapTextureSize.x,\n\t\t1.0 - 1.0 / pow(2.0, max(0.0, lod - 1.0))\n\t);\n\tvec2 wh = (max(vec2(1.0), floor(textureSize / pow(2.0, lod))));\n\treturn xy + uv * wh / mipmapTextureSize;\n}\n\nvec2 getMipUv (vec2 uv, float lod, vec2 mipmapTextureSize, out vec4 clampRect) {\n\tvec2 textureSize = mipmapTextureSize * vec2(0.666666667, 1.0);\n\tfloat isNonZeroLod = step(0.5, lod);\n\tvec2 xy = vec2(\n\t\tisNonZeroLod * textureSize.x / mipmapTextureSize.x,\n\t\t1.0 - 1.0 / pow(2.0, max(0.0, lod - 1.0))\n\t);\n\tvec2 wh = (max(vec2(1.0), floor(textureSize / pow(2.0, lod))));\n\tvec2 halfTexelSize = 0.5 / mipmapTextureSize;\n\n\tclampRect = vec4(\n\t\txy + halfTexelSize,\n\t\txy + halfTexelSize + (wh - 1.0) / mipmapTextureSize\n\t);\n\t\n\treturn xy + uv * wh / mipmapTextureSize;\n}\n\nvec4 lodMipmapSampleNearestCubic (sampler2D tex, vec2 uv, float lod, vec2 mipmapTextureSize) {\n\tvec4 clampRect;\n\tuv = getMipUv(uv, lod, mipmapTextureSize, clampRect);\n\treturn textureBicubic(tex, uv, mipmapTextureSize, clampRect);\n}\n\nvec4 lodMipmapSampleNearest (sampler2D tex, vec2 uv, float lod, vec2 mipmapTextureSize) {\n\treturn texture2D(tex, getMipUv(uv, lod, mipmapTextureSize));\n}\n\nvec4 lodMipmapSampleCubic (sampler2D tex, vec2 uv, float lod, vec2 mipmapTextureSize) {\n\tfloat lodFloor = floor(lod);\n\tfloat lodCeil = lodFloor + 1.0;\n\tfloat lodFract = lod - lodFloor;\n\n\tvec4 loClamp, hiClamp;\n\tvec2 loUv = getMipUv(uv, lodFloor, mipmapTextureSize, loClamp);\n\tvec2 hiUv = getMipUv(uv, lodCeil, mipmapTextureSize, hiClamp);\n\treturn mix(\n\t\ttextureBicubic(tex, loUv, mipmapTextureSize, loClamp),\n\t\ttextureBicubic(tex, hiUv, mipmapTextureSize, hiClamp),\n\t\tlodFract\n\t);\n}\n\nvec4 lodMipmapSample (sampler2D tex, vec2 uv, float lod, vec2 mipmapTextureSize) {\n\tfloat lodFloor = floor(lod);\n\tfloat lodCeil = lodFloor + 1.0;\n\tfloat lodFract = lod - lodFloor;\n\treturn mix(\n\t\ttexture2D(tex, getMipUv(uv, lodFloor, mipmapTextureSize)),\n\t\ttexture2D(tex, getMipUv(uv, lodCeil, mipmapTextureSize)),\n\t\tlodFract\n\t);\n}\n"]))};var l=n.prototype;l.resize=function(e,t,n,r){var i=a.powerTwoFloorBase(t);this.maxMipmapLevel=Math.min(i,this.fixedMaxMipmapLevel),this.tmpRenderTarget.setSize(n,r),this.textureSize.set(n,r);for(var o=this.geometry.attributes.position.array,s=this.geometry.attributes.uv.array,l=this.clampCache,u=0,c=0,h=0,d=i;h<d;h++){var f=(h>0?e:0)/n,p=(r-(r>>Math.max(0,h-1)))/r,v=Math.max(1,e>>h)/n,m=Math.max(1,t>>h)/r;s[c+0]=f,s[c+1]=p+m,s[c+2]=f,s[c+3]=p,s[c+4]=f+v,s[c+5]=p+m,s[c+6]=f+v,s[c+7]=p+m,s[c+8]=f,s[c+9]=p,s[c+10]=f+v,s[c+11]=p,l[u+0]=f+.5/n,l[u+1]=p+.5/r,l[u+2]=l[u+0]+v-1/n,l[u+3]=l[u+1]+m-1/r,u+=4,c+=12}var g=this.oddGeometry.attributes.uv.array,_=this.oddGeometry.attributes.position.array;c=0;for(var y=0,x=0,b=0,w=0,T=i-1;w<T;w++)o[y+0]=2*s[c+12]-1,o[y+1]=2*s[c+13]-1,o[y+3]=2*s[c+14]-1,o[y+4]=2*s[c+15]-1,o[y+6]=2*s[c+16]-1,o[y+7]=2*s[c+17]-1,o[y+9]=2*s[c+18]-1,o[y+10]=2*s[c+19]-1,o[y+12]=2*s[c+20]-1,o[y+13]=2*s[c+21]-1,o[y+15]=2*s[c+22]-1,o[y+16]=2*s[c+23]-1,(w+1)%2&&(_[b+0]=2*(g[x+0]=s[c+12])-1,_[b+1]=2*(g[x+1]=s[c+13])-1,_[b+3]=2*(g[x+2]=s[c+14])-1,_[b+4]=2*(g[x+3]=s[c+15])-1,_[b+6]=2*(g[x+4]=s[c+16])-1,_[b+7]=2*(g[x+5]=s[c+17])-1,_[b+9]=2*(g[x+6]=s[c+18])-1,_[b+10]=2*(g[x+7]=s[c+19])-1,_[b+12]=2*(g[x+8]=s[c+20])-1,_[b+13]=2*(g[x+9]=s[c+21])-1,_[b+15]=2*(g[x+10]=s[c+22])-1,_[b+16]=2*(g[x+11]=s[c+23])-1,x+=12,b+=18),c+=12,y+=18;this.geometry.attributes.uv.needsUpdate=!0,this.geometry.attributes.position.needsUpdate=!0,this.oddGeometry.attributes.uv.needsUpdate=!0,this.oddGeometry.attributes.position.needsUpdate=!0},l.render=function(e){var t=o.getColorState(),n=o.uvCopyMaterial,r=n;this.textureSize.x==e.width&&this.textureSize.y==e.height||(e.setSize(e.width,e.height),this.resize(Math.round(e.width/3*2),e.height,e.width,e.height));this.needsBlur&&(r=u,u.uniforms.u_texelSize.value.set(1/e.width,1/e.height));o.renderer.autoClear=!1;for(var i=e,a=this.tmpRenderTarget,s=0,l=this.clampCache,c=0,h=this.maxMipmapLevel-1;c<h;c++){if(r.uniforms.u_texture.value=i.texture,this.geometry.drawRange.start=6*c,this.geometry.drawRange.count=6,this.needsBlur){var d=l[4*c+0],f=l[4*c+1],p=l[4*c+2],v=l[4*c+3];u.uniforms.u_loClamp.value.set(d,f),u.uniforms.u_hiClamp.value.set(p,v)}o.renderGeometry(this.geometry,r,a),a===this.tmpRenderTarget&&s++;var m=a;a=i,i=m}this.oddGeometry.drawRange.start=0,this.oddGeometry.drawRange.count=6*s,n.uniforms.u_texture.value=this.tmpRenderTarget.texture,o.renderGeometry(this.oddGeometry,n,e),o.setColorState(t)};var u,c=14;function h(e){var t=new Float32Array(6*e*2),n=new Float32Array(6*e*3),i=new r.BufferGeometry;return i.setAttribute("position",new r.BufferAttribute(n,3)),i.setAttribute("uv",new r.BufferAttribute(t,2)),i}},{"../../helpers/fboHelper":79,"../../helpers/shaderHelper":80,"../../utils/math":104,glslify:26,three:63}],78:[function(e,t,n){"use strict";var r=e("@babel/runtime/helpers/interopRequireDefault"),i=r(e("@babel/runtime/regenerator")),a=r(e("@babel/runtime/helpers/asyncToGenerator")),o=e("gsap/gsap-core").gsap,s=e("three");function l(){return(l=(0,a.default)(i.default.mark((function e(t,n,r,a){var l,u;return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return l=new s.Color(t.value),u=new s.Color(n),e.abrupt("return",o.to(l,{delay:a,r:u.r,g:u.g,b:u.b,duration:r,ease:Power2.easeInOut,onUpdate:function(){t.value=l}}));case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function u(){return(u=(0,a.default)(i.default.mark((function e(t,n,r,a,l){var u,c;return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return u=new s.Color(n),c=new s.Color(r),e.abrupt("return",o.to(u,{delay:l,r:c.r,g:c.g,b:c.b,duration:a,ease:Power2.easeInOut,onUpdate:function(){t.color=u}}));case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}n.fadeShaderColor=function(e,t,n,r){return l.apply(this,arguments)},n.fadeMaterialColor=function(e,t,n,r){var i=new s.Color(e.color.getHex()),a=new s.Color(t);o.to(i,{delay:r,r:a.r,g:a.g,b:a.b,duration:n,ease:Power2.easeInOut,onUpdate:function(){e.color=i}})},n.fadeLightColor=function(e,t,n,r,i){return u.apply(this,arguments)}},{"@babel/runtime/helpers/asyncToGenerator":5,"@babel/runtime/helpers/interopRequireDefault":12,"@babel/runtime/regenerator":24,"gsap/gsap-core":28,three:63}],79:[function(e,t,n){"use strict";var r=e("three"),i=e("glslify"),a=e("../core/browser");n.init=function(e,t){h=n.renderer=e,n.floatType=t,n.scene=new r.Scene,n.camera=new r.Camera,n.camera.position.z=1,o=new r.Color,(d=n.triGeom=new r.BufferGeometry).setAttribute("position",new r.BufferAttribute(new Float32Array([-1,-1,0,4,-1,0,-1,4,0]),3)),n.quadGeom=new r.PlaneBufferGeometry(2,2),(f=n.tri=new r.Mesh(d)).frustumCulled=!1,n.scene.add(n.tri);var a=n.precisionPrefix="precision "+h.capabilities.precision+" float;\n";n.precisionPrefix2="#version 300 es\nprecision "+h.capabilities.precision+" float;\nprecision "+h.capabilities.precision+" int;\n#define IS_WEBGL2 true\n";n.vertexShader=a+i(["#define GLSLIFY 1\nattribute vec3 position;\nvarying vec2 v_uv;\n\nvoid main() {\n    v_uv = position.xy * 0.5 + 0.5;\n    gl_Position = vec4(position, 1.0 );\n}\n"]),n.copyMaterial=new r.RawShaderMaterial({uniforms:{u_texture:{value:null}},vertexShader:n.vertexShader,fragmentShader:a+i(["#define GLSLIFY 1\nuniform sampler2D u_texture;\n\nvarying vec2 v_uv;\n\nvoid main () {\n    gl_FragColor = texture2D(u_texture, v_uv);\n}\n"]),depthTest:!1,depthWrite:!1,blending:r.NoBlending}),n.uvCopyMaterial=new r.RawShaderMaterial({uniforms:{u_texture:{value:null}},vertexShader:a+i(["#define GLSLIFY 1\nattribute vec3 position;\nattribute vec2 uv;\nvarying vec2 v_uv;\n\nvoid main() {\n    v_uv = uv;\n    gl_Position = vec4(position, 1.0 );\n}\n"]),fragmentShader:a+i(["#define GLSLIFY 1\nuniform sampler2D u_texture;\n\nvarying vec2 v_uv;\n\nvoid main () {\n    gl_FragColor = texture2D(u_texture, v_uv);\n}\n"]),depthTest:!1,depthWrite:!1,blending:r.NoBlending}),n.clearMaterial=new r.RawShaderMaterial({uniforms:{u_color:{value:new r.Vector4(1,1,1,1)}},vertexShader:n.vertexShader,fragmentShader:a+i(["#define GLSLIFY 1\nuniform vec4 u_color;\n\nvarying vec2 v_uv;\n\nvoid main () {\n    gl_FragColor = u_color;\n}\n"]),depthTest:!1,depthWrite:!1,transparent:!0,blending:r.NoBlending}),s=new r.Scene;var c=new r.PlaneBufferGeometry(1,1);c.translate(.5,-.5,0),u=new r.RawShaderMaterial({uniforms:{u_texture:{value:null},u_transform:{value:new r.Vector4(0,0,1,1)}},vertexShader:a+i(["#define GLSLIFY 1\nattribute vec3 position;\nattribute vec2 uv;\n\nuniform vec4 u_transform;\n\nvarying vec2 v_uv;\n\nvoid main() {\n    v_uv = uv;\n    gl_Position = vec4( position.xy * u_transform.zw + u_transform.xy, 0.0, 1.0 );\n}\n"]),fragmentShader:a+i(["#define GLSLIFY 1\nuniform sampler2D u_texture;\n\nvarying vec2 v_uv;\n\nvoid main () {\n    gl_FragColor = texture2D(u_texture, v_uv);\n}\n"]),depthTest:!1,depthWrite:!1,blending:r.NoBlending}),l=new r.Mesh(c,u),s.frustumCulled=!1,s.add(l)},n.copy=function(e,t){var r=n.copyMaterial;r.uniforms.u_texture.value=e,p(r,t)},n.uvCopy=function(e,t){var r=n.uvCopyMaterial;r.uniforms.u_texture.value=e,p(r,t)},n.render=p,n.renderGeometry=function(e,t,n){f.geometry=e,p(t,n),f.geometry=d},n.renderMesh=function(e,t){f.visible=!1,n.scene.add(e),t&&h.setRenderTarget(t||null);h.render(n.scene,n.camera),t&&h.setRenderTarget(null);n.scene.remove(e),f.visible=!0},n.debugTo=function(e,t,i,a,o){t=t||e.width||e.image.width,i=i||e.height||e.image.height,a=a||0,o=o||0;var l=h.getSize(new r.Vector2);a=a/l.width*2-1,o=1-o/l.height*2,t=t/l.width*2,i=i/l.height*2,u.uniforms.u_texture.value=e,u.uniforms.u_transform.value.set(a,o,t,i);var c=v();h.autoClearColor=!1,h.setRenderTarget(null),h.render(s,n.camera),m(c)},n.clearColor=function(e,t,i,a,o){var s=n.clearMaterial;s.uniforms.u_color.value.set(e,t,i,a),s.transparent=a<1,s.blending=a<1?r.NormalBlending:r.NoBlending,p(n.clearMaterial,o),s.transparent=!1,s.blending=r.NoBlending},n.getColorState=v,n.setColorState=m,n.createRenderTarget=g,n.createMultisampleRenderTarget=function(e,t,i,o,s){var l=arguments.length>5&&void 0!==arguments[5]?arguments[5]:4;if(!h.capabilities.isWebGL2||a.isSafari||a.isIOS)return g(e,t,i,o,s);var u=new r.WebGLMultisampleRenderTarget(e,t,{wrapS:r.ClampToEdgeWrapping,wrapT:r.ClampToEdgeWrapping,magFilter:o?r.NearestFilter:r.LinearFilter,minFilter:o?r.NearestFilter:r.LinearFilter,format:i?r.RGBAFormat:r.RGBFormat,type:s?n.floatType:r.UnsignedByteType,anisotropy:0,encoding:r.LinearEncoding,depthBuffer:!1,stencilBuffer:!1});c||(c=h.getContext().getParameter(h.getContext().MAX_SAMPLES));return u.samples=Math.min(l,c),u},n.clearMultisampleRenderTargetState=function(){var e=h.getRenderTarget();if(e&&e.isWebGLMultisampleRenderTarget){var t=h.properties.get(e),n=h.getContext();n.bindFramebuffer(n.READ_FRAMEBUFFER,t.__webglMultisampledFramebuffer),n.bindFramebuffer(n.DRAW_FRAMEBUFFER,t.__webglFramebuffer);var r=e.width,i=e.height,a=n.COLOR_BUFFER_BIT;e.depthBuffer&&(a|=n.DEPTH_BUFFER_BIT),e.stencilBuffer&&(a|=n.STENCIL_BUFFER_BIT),n.blitFramebuffer(0,0,r,i,0,0,r,i,a,n.NEAREST),n.bindFramebuffer(n.FRAMEBUFFER,t.__webglMultisampledFramebuffer)}};var o,s,l,u,c,h=n.renderer=null,d=(n.quadGeom=null,n.triGeom=null),f=n.tri=null;function p(e,t){f.material=e,t&&h.setRenderTarget(t),h.render(n.scene,n.camera),t&&h.setRenderTarget(null)}function v(){return{autoClear:h.autoClear,autoClearColor:h.autoClearColor,autoClearStencil:h.autoClearStencil,autoClearDepth:h.autoClearDepth,clearColor:h.getClearColor(o).getHex(),clearAlpha:h.getClearAlpha()}}function m(e){h.setClearColor(e.clearColor,e.clearAlpha),h.autoClear=e.autoClear,h.autoClearColor=e.autoClearColor,h.autoClearStencil=e.autoClearStencil,h.autoClearDepth=e.autoClearDepth}function g(e,t,i,a,o){return new r.WebGLRenderTarget(e,t,{wrapS:r.ClampToEdgeWrapping,wrapT:r.ClampToEdgeWrapping,magFilter:a?r.NearestFilter:r.LinearFilter,minFilter:a?r.NearestFilter:r.LinearFilter,format:i?r.RGBAFormat:r.RGBFormat,type:o?n.floatType:r.UnsignedByteType,anisotropy:0,encoding:r.LinearEncoding,depthBuffer:!1,stencilBuffer:!1})}n.clearMaterial=null,n.floatType=null,n.precisionPrefix="",n.precisionPrefix2="",n.vertexShader="",n.scene=null,n.camera=null},{"../core/browser":70,glslify:26,three:63}],80:[function(e,t,n){"use strict";var r=e("three");function i(e){return e.replace(/#define\sGLSLIFY\s./,"")}function a(e){return"#include <"+e+">"}n.glslifyStrip=i,n.addChunk=function(e,t){r.ShaderChunk[e]=i(t)},n.insertBefore=function(e,t,n,r){r&&(t=a(t));return e.replace(t,i(n)+"\n"+t)},n.insertAfter=function(e,t,n,r){r&&(t=a(t));return e.replace(t,t+"\n"+i(n)+"\n")},n.replace=function(e,t,n,r){r&&(t=a(t));return e.replace(t,"\n"+i(n)+"\n")}},{three:63}],81:[function(e,t,n){"use strict";var r=e("three");function i(e){new r.DataTexture(new Uint8Array(e)).format=r.RGBAFormat}n.init=function(){n.blackTexture=i([0,0,0,1]),n.whiteTexture=i([1,1,1,1]),n.transparentTexture=i([0,0,0,0])},n.blackTexture=null,n.whiteTexture=null,n.transparentTexture=null},{three:63}],82:[function(e,t,n){"use strict";var r,i,a,o,s=e("@babel/runtime/helpers/interopRequireDefault")(e("./ui/ui")),l=e("./core/browser"),u=e("./core/settings"),c=e("./core/properties"),h=e("./helpers/fboHelper"),d=e("./helpers/textureHelper"),f=e("./helpers/shaderHelper"),p=e("./input/input"),v=e("./audios/audios"),m=e("./post/Postprocessing"),g=e("./post/smaa/Smaa"),_=e("./post/bloom/Bloom"),y=e("./post/bokeh/Bokeh"),x=e("./post/cameraShakeBlur/CameraShakeBlur"),b=e("./post/final/Final"),w=e("./controls/cameraControls"),T=e("./visuals/visuals"),M=e("three"),S=e("glslify"),E=e("mout/object/mixIn"),A=e("./loaders/BufItem"),L=e("./loaders/TextureItem"),C=e("./effects/blueNoise/blueNoise"),R=e("./effects/mipmapper/Mipmapper"),k=+new Date/1e3;function P(e){E(u,e),u.USE_WEBGL2||g.updateTextures(),v.init(),w.init(),T.init(),s.default.init(),i.add(T.container),c.hasInitialized=!0,D(c.rawWidth,c.rawHeight),u.SKIP_ANIMATION?c.showAnimation=1:gsap.to(c,{showAnimation:1,duration:1}),s.default.start(),function(){if(u.LOOK_DEV_MODE&&window.dat){var e=new dat.GUI,t=e.addFolder("bloom");t.add(c,"bloomAmount",0,5,1e-5).listen(),t.add(c,"bloomRadius",-1,1,1e-5).listen(),t.add(c,"bloomThreshold",0,1,1e-5).listen(),t.add(c,"bloomSmoothWidth",0,2,1e-5).listen(),t.add(c,"haloWidth",0,2,1e-5).listen(),t.add(c,"haloRGBShift",0,.2,1e-5).listen(),t.add(c,"haloStrength",0,3,1e-5).listen(),t.add(c,"haloMaskInner",0,1,1e-5).listen(),t.add(c,"haloMaskOuter",0,1,1e-5).listen(),t.open();var n=e.addFolder("color");n.add(c,"vignetteFrom",0,3,1e-5).listen(),n.add(c,"vignetteTo",0,3,1e-5).listen(),n.addColor(c,"vignetteColorHex").listen(),n.add(c,"saturation",0,3,1e-5).listen(),n.add(c,"contrast",-1,3,1e-5).listen(),n.add(c,"brightness",0,2,1e-5).listen(),n.addColor(c,"tintColorHex").listen(),n.add(c,"tintOpacity",0,1,1e-5).listen(),n.open();var r=e.addFolder("bokeh");r.add(c,"bokehAmount",0,1,1e-5).listen(),r.add(c,"bokehFNumber",1e-4,1,1e-5).listen(),r.add(c,"bokehFocusDistance",0,20,1e-5).listen(),r.add(c,"bokehFocalLength",0,3,1e-5).listen(),r.add(c,"bokehKFilmHeight",1e-5,90,1e-5).listen(),r.add(c.bokeh,"quality",0,3,1).listen(),r.open()}}()}function D(e,t){if(c.isStageReady){var n=l.isMobile?Math.min(1.25,u.DPR):u.DPR,i=e*n,s=t*n;if(i*s>u.MAX_PIXEL_COUNT){var h=i/s;s=Math.sqrt(u.MAX_PIXEL_COUNT/h),i=Math.ceil(s*h),s=Math.ceil(s),c.final.useBicubicOut=!0}else c.final.useBicubicOut=!1;c.rawWidth=e,c.rawHeight=t,c.width=i,c.height=s,c.resolution.set(i,s),a.aspect=i/s,a.updateProjectionMatrix(),r.setSize(i,s),o.setSize(i,s),u.canvas.style.width=e+"px",u.canvas.style.height=t+"px",T.resize(i,s)}}function I(){D(window.innerWidth,window.innerHeight)}function O(){var e,t;requestAnimationFrame(O),e=+new Date/1e3,t=e-k,k=e,c.isStageReady&&(t=Math.min(1/30,t),c.dt=t,c.time+=t,c.sharedUniforms.u_time.value+=t,c.cameraLookX+=(p.mouseXY.y*c.cameraLookStrength-c.cameraLookX)*c.cameraLookEaseDamp,c.cameraLookY+=(-p.mouseXY.x*c.cameraLookStrength-c.cameraLookY)*c.cameraLookEaseDamp,c.bgColor.setStyle(c.bgColorHex),r.setClearColor(c.bgColor,1),w.update(t*c.visualTimeScale),C.update(t),s.default.update(t),c.hasInitialized&&T.update(t*c.visualTimeScale),c.bloom.amount=c.bloomAmount,c.bloom.radius=c.bloomRadius,c.bloom.threshold=c.bloomThreshold,c.bloom.smoothWidth=c.bloomSmoothWidth,c.bloom.haloWidth=.03*Math.cos(c.time)+c.haloWidth,c.bloom.haloRGBShift=c.haloRGBShift,c.bloom.haloStrength=c.haloStrength,c.bloom.haloMaskInner=c.haloMaskInner,c.bloom.haloMaskOuter=c.haloMaskOuter,c.final.vignetteFrom=c.vignetteFrom,c.final.vignetteTo=c.vignetteTo,c.final.vignetteColor.setStyle(c.vignetteColorHex),c.final.saturation=c.saturation,c.final.contrast=c.contrast,c.final.brightness=c.brightness,c.final.tintColor.setStyle(c.tintColorHex),c.final.tintOpacity=c.tintOpacity,c.final.bgColor.setStyle(c.bgColorHex),c.final.opacity=c.opacity,c.final.cacheBlendRatio=c.cacheBlendRatio,c.final.cacheBlendDirection=c.cacheBlendDirection,c.bokeh.amount=c.bokehAmount,c.bokeh.fNumber=c.bokehFNumber,c.bokeh.focusDistance=c.bokehFocusDistance,c.bokeh.focalLength=c.bokehFocalLength,c.bokeh.kFilmHeight=c.bokehKFilmHeight,c.cameraShakeBlur.amount=c.cameraShakeBlurAmount,o.render(i,a,!0),window.___debugTexture&&h.debugTo(window.___debugTexture),v.update(t),p.update(t))}(function(e){if(u.canvas=e,u.USE_WEBGL2&&window.WebGL2RenderingContext)try{return u.gl=e.getContext("webgl2",u.webglOpts),u.RENDER_TARGET_FLOAT_TYPE=M.FloatType,u.DATA_FLOAT_TYPE=M.FloatType,!0}catch(e){}if(u.USE_WEBGL2=!1,window.WebGLRenderingContext)try{var t=u.gl=e.getContext("webgl",u.webglOpts)||e.getContext("experimental-webgl",u.webglOpts);return(t.getExtension("OES_texture_float")||t.getExtension("OES_texture_half_float"))&&t.getParameter(t.MAX_VERTEX_TEXTURE_IMAGE_UNITS)?(u.RENDER_TARGET_FLOAT_TYPE=l.isIOS||!t.getExtension("OES_texture_float")?M.HalfFloatType:M.FloatType,u.DATA_FLOAT_TYPE=M.FloatType):(u.USE_FLOAT_PACKING=!0,u.RENDER_TARGET_FLOAT_TYPE=u.DATA_FLOAT_TYPE=M.UnsignedByteType),!0}catch(e){return!1}return!1})(document.getElementById("app"))&&function(){document.documentElement.classList.add("is-"+(l.isMobile?"mobile":"desktop"));for(var e=0;e<u.CROSS_ORIGINS.length;e++){var t=u.CROSS_ORIGINS[e];n.loader.setCrossOrigin(t.baseUrl,t.value)}c.loader.register(A),c.loader.register(L),r=c.renderer=new M.WebGLRenderer({canvas:u.canvas,context:u.gl,stencil:!1,depth:!1,powerPreference:"high-performance"}),f.addChunk("textureBicubic",S(["#define GLSLIFY 1\nvec4 cubic(float v) {\n    vec4 n = vec4(1.0, 2.0, 3.0, 4.0) - v;\n    vec4 s = n * n * n;\n    float x = s.x;\n    float y = s.y - 4.0 * s.x;\n    float z = s.z - 4.0 * s.y + 6.0 * s.x;\n    float w = 6.0 - x - y - z;\n    return vec4(x, y, z, w);\n}\n\n// https://stackoverflow.com/questions/13501081/efficient-bicubic-filtering-code-in-glsl\nvec4 textureBicubic(sampler2D t, vec2 texCoords, vec2 textureSize) {\n   vec2 invTexSize = 1.0 / textureSize;\n   texCoords = texCoords * textureSize - 0.5;\n\n    vec2 fxy = fract(texCoords);\n    texCoords -= fxy;\n    vec4 xcubic = cubic(fxy.x);\n    vec4 ycubic = cubic(fxy.y);\n\n    vec4 c = texCoords.xxyy + vec2 (-0.5, 1.5).xyxy;\n\n    vec4 s = vec4(xcubic.xz + xcubic.yw, ycubic.xz + ycubic.yw);\n    vec4 offset = c + vec4 (xcubic.yw, ycubic.yw) / s;\n\n    offset *= invTexSize.xxyy;\n\n    vec4 sample0 = texture2D(t, offset.xz);\n    vec4 sample1 = texture2D(t, offset.yz);\n    vec4 sample2 = texture2D(t, offset.xw);\n    vec4 sample3 = texture2D(t, offset.yw);\n\n    float sx = s.x / (s.x + s.y);\n    float sy = s.z / (s.z + s.w);\n\n    return mix(\n       mix(sample3, sample2, sx), mix(sample1, sample0, sx)\n    , sy);\n}\n\nvec4 textureBicubic(sampler2D t, vec2 texCoords, vec2 textureSize, vec4 clampRect) {\n   vec2 invTexSize = 1.0 / textureSize;\n   texCoords = texCoords * textureSize - 0.5;\n\n    vec2 fxy = fract(texCoords);\n    texCoords -= fxy;\n    vec4 xcubic = cubic(fxy.x);\n    vec4 ycubic = cubic(fxy.y);\n\n    vec4 c = texCoords.xxyy + vec2 (-0.5, 1.5).xyxy;\n\n    vec4 s = vec4(xcubic.xz + xcubic.yw, ycubic.xz + ycubic.yw);\n    vec4 offset = c + vec4 (xcubic.yw, ycubic.yw) / s;\n\n    offset *= invTexSize.xxyy;\n\n    vec4 sample0 = texture2D(t, clamp(offset.xz, clampRect.xy, clampRect.zw));\n    vec4 sample1 = texture2D(t, clamp(offset.yz, clampRect.xy, clampRect.zw));\n    vec4 sample2 = texture2D(t, clamp(offset.xw, clampRect.xy, clampRect.zw));\n    vec4 sample3 = texture2D(t, clamp(offset.yw, clampRect.xy, clampRect.zw));\n\n    float sx = s.x / (s.x + s.y);\n    float sy = s.z / (s.z + s.w);\n\n    return mix(\n       mix(sample3, sample2, sx), mix(sample1, sample0, sx)\n    , sy);\n}"])),i=c.scene=new M.Scene,a=c.camera=new M.PerspectiveCamera(60,1,.1,100),i.add(a),c.sharedUniforms.u_resolution.value=c.resolution=new M.Vector2,c.sharedUniforms.u_bgColor.value=c.bgColor=new M.Color,h.init(r,u.RENDER_TARGET_FLOAT_TYPE),d.init(),o=c.postprocessing=new m(!0),C.preInit(),R.init(),c.bokeh=new y,o.useDepthTexture&&!l.isMobile&&o.queue.push(c.bokeh),o.useDepthTexture&&o.queue.push(c.cameraShakeBlur=new x),r.capabilities.isWebGL2||(g.setTextures(c.loader.add(u.TEXTURE_PATH+"smaa-area.png",{weight:32}).content,c.loader.add(u.TEXTURE_PATH+"smaa-search.png",{weight:.1}).content),o.queue.push(c.smaa=new g)),o.queue.push(c.bloom=new _),o.queue.push(c.final=new b),c.isStageReady=!0,v.preInit(),p.init(document.body,u.canvas),w.preInit(),T.preInit(),s.default.preInit(P),window.addEventListener("resize",I),I(),O()}()},{"./audios/audios":66,"./controls/cameraControls":69,"./core/browser":70,"./core/properties":71,"./core/settings":72,"./effects/blueNoise/blueNoise":73,"./effects/mipmapper/Mipmapper":77,"./helpers/fboHelper":79,"./helpers/shaderHelper":80,"./helpers/textureHelper":81,"./input/input":83,"./loaders/BufItem":87,"./loaders/TextureItem":88,"./post/Postprocessing":91,"./post/bloom/Bloom":92,"./post/bokeh/Bokeh":93,"./post/cameraShakeBlur/CameraShakeBlur":94,"./post/final/Final":95,"./post/smaa/Smaa":96,"./ui/ui":102,"./visuals/visuals":123,"@babel/runtime/helpers/interopRequireDefault":12,glslify:26,"mout/object/mixIn":45,three:63}],83:[function(e,t,n){"use strict";var r=e("three"),i=e("min-signal");n.init=function(){var e=document;e.addEventListener("mousedown",s),e.addEventListener("touchstart",c(s)),e.addEventListener("mousemove",l),e.addEventListener("touchmove",c(l)),e.addEventListener("pointermove",l),e.addEventListener("mouseup",u),e.addEventListener("touchend",c(u)),e.addEventListener("mousewheel",o,!0),e.addEventListener("DOMMouseScroll",o,!0)},n.update=function(e){n.prevThroughElems.length=0,n.prevThroughElems.concat(n.currThroughElems),n.wheelDelta=0},n.hasThroughElem=function(e,t){var r=n[t+"ThroughElems"]||n.currThroughElems,i=r.length;for(;i--;)if(r[i]===e)return!0;return!1},n.hasThroughElemWithClass=function(e,t){var r=n[t+"ThroughElems"]||n.currThroughElems,i=r.length;for(;i--;)if(r[i].classList.contains(e))return r[i];return null},n.onDowned=new i,n.onMoved=new i,n.onUped=new i,n.onClicked=new i,n.onWheeled=new i,n.hasInteracted=!1,n.wasDown=!1,n.isDown=!0,n.downTime=0,n.downXY=new r.Vector2,n.downPixelXY=new r.Vector2,n.hasClicked=!1,n.mouseXY=new r.Vector2,n.mousePixelXY=new r.Vector2,n.wheelDelta=0,n.downThroughElems=[],n.currThroughElems=[],n.prevThroughElems=[],n.clickThroughElems=[];var a=0;function o(e){var t=+new Date;if(!(t-a<35)){a=t;var r=(e=e||_win.event).wheelDelta;r?r/=40:r=-e.detail,n.wheelDelta+=Math.min(3,Math.max(r,-3)),n.onWheeled.dispatch(e.target,n.wheelDelta)}}function s(e){n.isDown=!0,n.downTime=+new Date,n.prevThroughElems.length=0,f(e,n.downThroughElems),h(e,n.downXY),d(e,n.downPixelXY),n.onDowned.dispatch(e),l(e)}function l(e){n.hasInteracted=!0,h(e,n.mouseXY),d(e,n.mousePixelXY),f(e,n.currThroughElems),n.onMoved.dispatch(e)}function u(e){var t=e.clientX-n.downPixelXY.x,r=e.clientY-n.downPixelXY.y;Math.sqrt(t*t+r*r)<40&&+new Date-n.downTime<300&&(f(e,n.clickThroughElems),h(e,n.mouseXY),n.hasClicked=!0,n.onClicked.dispatch(e)),n.isDown=!1,n.onUped.dispatch(e)}function c(e,t){return function(n){t&&n.usePreventDefault(),e.call(this,n.changedTouches[0]||n.touches[0])}}function h(e,t){return t.set(e.clientX/window.innerWidth*2-1,1-e.clientY/window.innerHeight*2),t}function d(e,t){t.set(e.clientX,e.clientY)}function f(e,t){var n=e.target;for(t.length=0;n.parentNode;)t.push(n),n=n.parentNode}},{"min-signal":29,three:63}],84:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=n.CustomEase=void 0;var r,i=e("./utils/paths.js"),a=e("gsap"),o=function(){a.gsap?(a.gsap.registerEase("_CE",h.create),r=1):console.warn("Please gsap.registerPlugin(CustomEase)")},s=function(e){return~~(1e3*e+(e<0?-.5:.5))/1e3},l=/[-+=\.]*\d+[\.e\-\+]*\d*[e\-\+]*\d*/gi,u=/[cLlsSaAhHvVtTqQ]/g,c=function e(t,n,r,i,a,o,s,l,u,c,h){var d,f=(t+r)/2,p=(n+i)/2,v=(r+a)/2,m=(i+o)/2,g=(a+s)/2,_=(o+l)/2,y=(f+v)/2,x=(p+m)/2,b=(v+g)/2,w=(m+_)/2,T=(y+b)/2,M=(x+w)/2,S=s-t,E=l-n,A=Math.abs((r-s)*E-(i-l)*S),L=Math.abs((a-s)*E-(o-l)*S);return c||(c=[{x:t,y:n},{x:s,y:l}],h=1),c.splice(h||c.length-1,0,{x:T,y:M}),(A+L)*(A+L)>u*(S*S+E*E)&&(d=c.length,e(t,n,f,p,y,x,T,M,u,c,h),e(T,M,b,w,g,_,s,l,u,c,h+1+(c.length-d))),c},h=function(){function e(e,t,n){r||o(),this.id=e,this.setData(t,n)}var t=e.prototype;return t.setData=function(e,t){t=t||{};var n,r,o,s,h,d,f,p,v,m=(e=e||"0,0,1,1").match(l),g=1,_=[],y=[],x=t.precision||1,b=x<=1;if(this.data=e,(u.test(e)||~e.indexOf("M")&&e.indexOf("C")<0)&&(m=(0,i.stringToRawPath)(e)[0]),4===(n=m.length))m.unshift(0,0),m.push(1,1),n=8;else if((n-2)%6)throw"Invalid CustomEase";for(0==+m[0]&&1==+m[n-2]||function(e,t,n){n||0===n||(n=Math.max(+e[e.length-1],+e[1]));var r,i=-1*+e[0],a=-n,o=e.length,s=1/(+e[o-2]+i),l=-t||(Math.abs(+e[o-1]-+e[1])<.01*(+e[o-2]-+e[0])?function(e){var t,n=e.length,r=1e20;for(t=1;t<n;t+=6)+e[t]<r&&(r=+e[t]);return r}(e)+a:+e[o-1]+a);for(l=l?1/l:-s,r=0;r<o;r+=2)e[r]=(+e[r]+i)*s,e[r+1]=(+e[r+1]+a)*l}(m,t.height,t.originY),this.segment=m,s=2;s<n;s+=6)r={x:+m[s-2],y:+m[s-1]},o={x:+m[s+4],y:+m[s+5]},_.push(r,o),c(r.x,r.y,+m[s],+m[s+1],+m[s+2],+m[s+3],o.x,o.y,1/(2e5*x),_,_.length-1);for(n=_.length,s=0;s<n;s++)f=_[s],p=_[s-1]||f,(f.x>p.x||p.y!==f.y&&p.x===f.x||f===p)&&f.x<=1?(p.cx=f.x-p.x,p.cy=f.y-p.y,p.n=f,p.nx=f.x,b&&s>1&&Math.abs(p.cy/p.cx-_[s-2].cy/_[s-2].cx)>2&&(b=0),p.cx<g&&(p.cx?g=p.cx:(p.cx=.001,s===n-1&&(p.x-=.001,g=Math.min(g,.001),b=0)))):(_.splice(s--,1),n--);if(h=1/(n=1/g+1|0),d=0,f=_[0],b){for(s=0;s<n;s++)v=s*h,f.nx<v&&(f=_[++d]),r=f.y+(v-f.x)/f.cx*f.cy,y[s]={x:v,cx:h,y:r,cy:0,nx:9},s&&(y[s-1].cy=r-y[s-1].y);y[n-1].cy=_[_.length-1].y-r}else{for(s=0;s<n;s++)f.nx<s*h&&(f=_[++d]),y[s]=f;d<_.length-1&&(y[s-1]=_[_.length-2])}return this.ease=function(e){var t=y[e*n|0]||y[n-1];return t.nx<e&&(t=t.n),t.y+(e-t.x)/t.cx*t.cy},this.ease.custom=this,this.id&&a.gsap.registerEase(this.id,this.ease),this},t.getSVGData=function(t){return e.getSVGData(this,t)},e.create=function(t,n,r){return new e(t,n,r).ease},e.register=function(e){o()},e.get=function(e){return a.gsap.parseEase(e)},e.getSVGData=function(t,n){var r,o,l,u,c,h,d,f,p,v,m=(n=n||{}).width||100,g=n.height||100,_=n.x||0,y=(n.y||0)+g,x=a.gsap.utils.toArray(n.path)[0];if(n.invert&&(g=-g,y=0),"string"==typeof t&&(t=a.gsap.parseEase(t)),t.custom&&(t=t.custom),t instanceof e)r=(0,i.rawPathToString)((0,i.transformRawPath)([t.segment],m,0,0,-g,_,y));else{for(r=[_,y],u=1/(d=Math.max(5,200*(n.precision||1))),f=5/(d+=2),p=s(_+u*m),o=((v=s(y+t(u)*-g))-y)/(p-_),l=2;l<d;l++)c=s(_+l*u*m),h=s(y+t(l*u)*-g),(Math.abs((h-v)/(c-p)-o)>f||l===d-1)&&(r.push(p,v),o=(h-v)/(c-p)),p=c,v=h;r="M"+r.join(",")}return x&&x.setAttribute("d",r),r},e}();n.default=n.CustomEase=h,a.gsap.registerPlugin(h),h.version="3.6.1"},{"./utils/paths.js":85,gsap:27}],85:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.bezierToPoints=function e(t,n,r,i,a,o,s,l,u,c,h){var f,p=(t+r)/2,v=(n+i)/2,m=(r+a)/2,g=(i+o)/2,_=(a+s)/2,y=(o+l)/2,x=(p+m)/2,b=(v+g)/2,w=(m+_)/2,T=(g+y)/2,M=(x+w)/2,S=(b+T)/2,E=s-t,A=l-n,L=d((r-s)*A-(i-l)*E),C=d((a-s)*A-(o-l)*E);c||(c=[t,n,s,l],h=2);c.splice(h||c.length-2,0,M,S),(L+C)*(L+C)>u*(E*E+A*A)&&(f=c.length,e(t,n,p,v,x,b,M,S,u,c,h),e(M,S,w,T,_,y,s,l,u,c,h+2+(c.length-f)));return c},n.cacheRawPathMeasurements=P,n.convertToPath=function(e,t){var n,r,i,o,s,l,u,c,h,d,f,p,v,m,g,_,y,x,b,w,T,M,S=e.tagName.toLowerCase(),E=.552284749831;if("path"===S||!e.getBBox)return e;l=function(e,t){var n,r=document.createElementNS("http://www.w3.org/2000/svg","path"),i=[].slice.call(e.attributes),a=i.length;t=","+t+",";for(;--a>-1;)n=i[a].nodeName.toLowerCase(),t.indexOf(","+n+",")<0&&r.setAttributeNS(null,n,i[a].nodeValue);return r}(e,"x,y,width,height,cx,cy,rx,ry,r,x1,x2,y1,y2,points"),M=function(e,t){var n=t?t.split(","):[],r={},i=n.length;for(;--i>-1;)r[n[i]]=+e.getAttribute(n[i])||0;return r}(e,C[S]),"rect"===S?(o=M.rx,s=M.ry||o,r=M.x,i=M.y,d=M.width-2*o,f=M.height-2*s,n=o||s?"M"+(_=(m=(v=r+o)+d)+o)+","+(x=i+s)+" V"+(b=x+f)+" C"+[_,w=b+s*E,g=m+o*E,T=b+s,m,T,m-(m-v)/3,T,v+(m-v)/3,T,v,T,p=r+o*(1-E),T,r,w,r,b,r,b-(b-x)/3,r,x+(b-x)/3,r,x,r,y=i+s*(1-E),p,i,v,i,v+(m-v)/3,i,m-(m-v)/3,i,m,i,g,i,_,y,_,x].join(",")+"z":"M"+(r+d)+","+i+" v"+f+" h"+-d+" v"+-f+" h"+d+"z"):"circle"===S||"ellipse"===S?("circle"===S?(o=s=M.r,c=o*E):(o=M.rx,s=M.ry,c=s*E),r=M.cx,i=M.cy,n="M"+(r+o)+","+i+" C"+[r+o,i+c,r+(u=o*E),i+s,r,i+s,r-u,i+s,r-o,i+c,r-o,i,r-o,i-c,r-u,i-s,r,i-s,r+u,i-s,r+o,i-c,r+o,i].join(",")+"z"):"line"===S?n="M"+M.x1+","+M.y1+" L"+M.x2+","+M.y2:"polyline"!==S&&"polygon"!==S||(h=(e.getAttribute("points")+"").match(a)||[],r=h.shift(),i=h.shift(),n="M"+r+","+i+" L"+h.join(","),"polygon"===S&&(n+=","+r+","+i+"z"));l.setAttribute("d",B(l._gsRawPath=F(n))),t&&e.parentNode&&(e.parentNode.insertBefore(l,e),e.parentNode.removeChild(e));return l},n.copyRawPath=A,n.flatPointsToSegment=function(e,t){void 0===t&&(t=1);for(var n=e[0],r=0,i=[n,r],a=2;a<e.length;a+=2)i.push(n,r,e[a],r=(e[a]-n)*t/2,n=e[a],-r);return i},n.getClosestData=function(e,t,n,i){var a,o,s,l,u={j:0,i:0,t:0},c=v;for(o=0;o<e.length;o++)for(l=e[o],a=0;a<l.length;a+=6)s=U(1,t,n,0,1,i||20,l[a],l[a+1],l[a+2],l[a+3],l[a+4],l[a+5],l[a+6],l[a+7]),c>r&&(c=r,u.j=o,u.i=a,u.t=s);return u},n.getPositionOnPath=function(e,t,n,r){var i,a,o,s,l,u,c,h,d,f=e[0],p=r||{};(t<0||t>1)&&(t=b(t));if(e.length>1){for(o=e.totalLength*t,l=u=0;(l+=e[u++].totalLength)<o;)f=e[u];s=l-f.totalLength,t=(o-s)/(l-s)||0}i=f.samples,a=f.resolution,o=f.totalLength*t,u=f.lookup[t<1?~~(o/f.minLength):f.lookup.length-1]||0,s=u?i[u-1]:0,(l=i[u])<o&&(s=l,l=i[++u]);d=1-(c=1/a*((o-s)/(l-s)+u%a)||0),h=f[u=6*~~(u/a)],p.x=w((c*c*(f[u+6]-h)+3*d*(c*(f[u+4]-h)+d*(f[u+2]-h)))*c+h),p.y=w((c*c*(f[u+7]-(h=f[u+1]))+3*d*(c*(f[u+5]-h)+d*(f[u+3]-h)))*c+h),n&&(p.angle=f.totalLength?R(f,u,c>=1?1-1e-9:c||1e-9):f.angle||0);return p},n.getRawPath=function(e){var t,n=(e=m(e)&&s.test(e)&&document.querySelector(e)||e).getAttribute?e:0;if(n&&(e=e.getAttribute("d")))return n._gsPath||(n._gsPath={}),(t=n._gsPath[e])&&!t._dirty?t:n._gsPath[e]=F(e);return e?m(e)?F(e):g(e[0])?[e]:e:console.warn("Expecting a <path> element or an SVG path data string")},n.getRotationAtProgress=function(e,t){var n=I(e,t>=1?1-1e-9:t||1e-9);return R(n.segment,n.i,n.t)},n.pointsToSegment=function(e,t,n){d(e[0]-e[2])<1e-4&&d(e[1]-e[3])<1e-4&&(e=e.slice(2));var r,i,a,o,s,l,u,v,m,g,_,y,x,b,T=e.length-2,M=+e[0],S=+e[1],E=+e[2],A=+e[3],L=[M,S,M,S],C=E-M,R=A-S,k=Math.abs(e[T]-M)<.001&&Math.abs(e[T+1]-S)<.001;isNaN(n)&&(n=Math.PI/10);k&&(e.push(E,A),E=M,A=S,M=e[T-2],S=e[T-1],e.unshift(M,S),T+=4);for(t=t||0===t?+t:1,s=2;s<T;s+=2)r=M,i=S,M=E,S=A,E=+e[s+2],A=+e[s+3],M===E&&S===A||(y=(l=C)*l+(v=R)*v,x=(C=E-M)*C+(R=A-S)*R,b=(u=E-r)*u+(m=A-i)*m,a=Math.acos((y+x-b)/f(4*y*x)),_=a/Math.PI*t,g=f(y)*_,_*=f(x),M===r&&S===i||(a>n?(o=p(m,u),L.push(w(M-h(o)*g),w(S-c(o)*g),w(M),w(S),w(M+h(o)*_),w(S+c(o)*_))):(o=p(v,l),L.push(w(M-h(o)*g),w(S-c(o)*g)),o=p(R,C),L.push(w(M),w(S),w(M+h(o)*_),w(S+c(o)*_)))));M!==E||S!==A||L.length<4?L.push(w(E),w(A),w(E),w(A)):L.length-=2,k&&(L.splice(0,6),L.length=L.length-6);return L},n.rawPathToString=B,n.reverseSegment=L,n.simplifyPoints=function(e,t){var n,r,i,a,o,s,l,u=parseFloat(e[0]),c=parseFloat(e[1]),h=[u,c],d=e.length-2;for(t=Math.pow(t||1,2),n=2;n<d;n+=2)r=parseFloat(e[n]),i=parseFloat(e[n+1]),(a=u-r)*a+(o=c-i)*o>t&&(h.push(r,i),u=r,c=i);return h.push(parseFloat(e[d]),parseFloat(e[d+1])),l=h.length-2,s=[h[0],h[1]],N(h,0,l,t,s),s.push(h[l],h[l+1]),s},n.sliceRawPath=function(e,t,n){r=n,n=void 0===r?1:T(n)||0,t=T(t)||0;var r;var i=Math.max(0,~~(d(n-t)-1e-8)),a=A(e);t>n&&(t=1-t,n=1-n,function(e,t){var n=e.length;t||e.reverse();for(;n--;)e[n].reversed||L(e[n])}(a),a.totalLength=0);if(t<0||n<0){var o=Math.abs(~~Math.min(t,n))+1;t+=o,n+=o}a.totalLength||P(a);var s,l,u,c,h,f,p,v,m=n>1,g=I(a,t,_,!0),x=I(a,n,y),b=x.segment,w=g.segment,S=x.segIndex,C=g.segIndex,k=x.i,O=g.i,F=C===S,N=k===O&&F;if(m||i){for(s=S<C||F&&k<O||N&&x.t<g.t,M(a,C,O,g.t)&&(C++,s||(S++,N?(x.t=(x.t-g.t)/(1-g.t),k=0):F&&(k-=O))),1-(n-t)<1e-5?S=C-1:!x.t&&S?S--:M(a,S,k,x.t)&&s&&C++,1===g.t&&(C=(C+1)%a.length),h=[],f=a.length,p=1+f*i,v=C,p+=(f-C+S)%f,c=0;c<p;c++)E(h,a[v++%f]);a=h}else if(u=1===x.t?6:D(b,k,x.t),t!==n)for(l=D(w,O,N?g.t/x.t:g.t),F&&(u+=l),b.splice(k+u+2),(l||O)&&w.splice(0,O+l),c=a.length;c--;)(c<C||c>S)&&a.splice(c,1);else b.angle=R(b,k+u,0),g=b[k+=u],x=b[k+1],b.length=b.totalLength=0,b.totalPoints=a.totalPoints=8,b.push(g,x,g,x,g,x,g,x);return a.totalLength=0,a},n.stringToRawPath=F,n.subdivideSegment=D,n.subdivideSegmentNear=function(e,t,n,i,a){var o,s,l=n.length,u=v,c=0,h=0;for(i=i||20,a=a||3,s=0;s<l;s+=6)o=U(1,e,t,0,1,i,n[s],n[s+1],n[s+2],n[s+3],n[s+4],n[s+5],n[s+6],n[s+7]),u>r&&(u=r,c=o,h=s);return o=U(a,e,t,c-.05,c+.05,i,n[h],n[h+1],n[h+2],n[h+3],n[h+4],n[h+5],n[h+6],n[h+7]),D(n,h,o),h+6},n.transformRawPath=function(e,t,n,r,i,a,o){var s,l,u,c,h,d=e.length;for(;--d>-1;)for(s=e[d],l=s.length,u=0;u<l;u+=2)c=s[u],h=s[u+1],s[u]=c*t+h*r+a,s[u+1]=c*n+h*i+o;return e._dirty=1,e};
/*!
 * paths 3.6.1
 * https://greensock.com
 *
 * Copyright 2008-2021, GreenSock. All rights reserved.
 * Subject to the terms at https://greensock.com/standard-license or for
 * Club GreenSock members, the agreement issued with that membership.
 * @author: Jack Doyle, jack@greensock.com
 */
var r,i=/[achlmqstvz]|(-?\d*\.?\d*(?:e[\-+]?\d+)?)[0-9]/gi,a=/(?:(-)?\d*\.?\d*(?:e[\-+]?\d+)?)[0-9]/gi,o=/[\+\-]?\d*\.?\d+e[\+\-]?\d+/gi,s=/(^[#\.][a-z]|[a-y][a-z])/i,l=Math.PI/180,u=180/Math.PI,c=Math.sin,h=Math.cos,d=Math.abs,f=Math.sqrt,p=Math.atan2,v=1e8,m=function(e){return"string"==typeof e},g=function(e){return"number"==typeof e},_={},y={},x=1e5,b=function(e){return Math.round((e+v)%1*x)/x||(e<0?0:1)},w=function(e){return Math.round(e*x)/x||0},T=function(e){return Math.round(1e10*e)/1e10||0},M=function(e,t,n,r){var i=e[t],a=1===r?6:D(i,n,r);if(a&&a+n+2<i.length)return e.splice(t,0,i.slice(0,n+a+2)),i.splice(0,n+a),1},S=function(e,t){return t.totalLength=e.totalLength,e.samples?(t.samples=e.samples.slice(0),t.lookup=e.lookup.slice(0),t.minLength=e.minLength,t.resolution=e.resolution):e.totalPoints&&(t.totalPoints=e.totalPoints),t},E=function(e,t){var n=e.length,r=e[n-1]||[],i=r.length;n&&t[0]===r[i-2]&&t[1]===r[i-1]&&(t=r.concat(t.slice(2)),n--),e[n]=t};function A(e){for(var t=[],n=0;n<e.length;n++)t[n]=S(e[n],e[n].slice(0));return S(e,t)}function L(e){var t,n=0;for(e.reverse();n<e.length;n+=2)t=e[n],e[n]=e[n+1],e[n+1]=t;e.reversed=!e.reversed}var C={rect:"rx,ry,x,y,width,height",circle:"r,cx,cy",ellipse:"rx,ry,cx,cy",line:"x1,x2,y1,y2"};function R(e,t,n){var r,i=e[t],a=e[t+2],o=e[t+4];return i+=(a-i)*n,i+=((a+=(o-a)*n)-i)*n,r=a+(o+(e[t+6]-o)*n-a)*n-i,i=e[t+1],i+=((a=e[t+3])-i)*n,i+=((a+=((o=e[t+5])-a)*n)-i)*n,w(p(a+(o+(e[t+7]-o)*n-a)*n-i,r)*u)}function k(e,t,n){t=t||0,e.samples||(e.samples=[],e.lookup=[]);var r,i,a,o,s,l,u,c,h,p,m,g,_,y,x,b,w,T=~~e.resolution||12,M=1/T,S=n?t+6*n+1:e.length,E=e[t],A=e[t+1],L=t?t/6*T:0,C=e.samples,R=e.lookup,k=(t?e.minLength:v)||v,P=C[L+n*T-1],D=t?C[L-1]:0;for(C.length=R.length=0,i=t+2;i<S;i+=6){if(a=e[i+4]-E,o=e[i+2]-E,s=e[i]-E,c=e[i+5]-A,h=e[i+3]-A,p=e[i+1]-A,l=u=m=g=0,d(a)<1e-5&&d(c)<1e-5&&d(s)+d(p)<1e-5)e.length>8&&(e.splice(i,6),i-=6,S-=6);else for(r=1;r<=T;r++)l=u-(u=((y=M*r)*y*a+3*(_=1-y)*(y*o+_*s))*y),m=g-(g=(y*y*c+3*_*(y*h+_*p))*y),(b=f(m*m+l*l))<k&&(k=b),D+=b,C[L++]=D;E+=a,A+=c}if(P)for(P-=D;L<C.length;L++)C[L]+=P;if(C.length&&k)for(e.totalLength=w=C[C.length-1]||0,e.minLength=k,b=x=0,r=0;r<w;r+=k)R[b++]=C[x]<r?++x:x;else e.totalLength=C[0]=0;return t?D-C[t/2-1]:D}function P(e,t){var n,r,i;for(i=n=r=0;i<e.length;i++)e[i].resolution=~~t||12,r+=e[i].length,n+=k(e[i]);return e.totalPoints=r,e.totalLength=n,e}function D(e,t,n){if(n<=0||n>=1)return 0;var r=e[t],i=e[t+1],a=e[t+2],o=e[t+3],s=e[t+4],l=e[t+5],u=r+(a-r)*n,c=a+(s-a)*n,h=i+(o-i)*n,d=o+(l-o)*n,f=u+(c-u)*n,p=h+(d-h)*n,v=s+(e[t+6]-s)*n,m=l+(e[t+7]-l)*n;return c+=(v-c)*n,d+=(m-d)*n,e.splice(t+2,4,w(u),w(h),w(f),w(p),w(f+(c-f)*n),w(p+(d-p)*n),w(c),w(d),w(v),w(m)),e.samples&&e.samples.splice(t/6*e.resolution|0,0,0,0,0,0,0,0),6}function I(e,t,n,r){n=n||{},e.totalLength||P(e),(t<0||t>1)&&(t=b(t));var i,a,o,s,l,u,c,h=0,d=e[0];if(t)if(1===t)c=1,u=(d=e[h=e.length-1]).length-8;else{if(e.length>1){for(o=e.totalLength*t,l=u=0;(l+=e[u++].totalLength)<o;)h=u;t=(o-(s=l-(d=e[h]).totalLength))/(l-s)||0}i=d.samples,a=d.resolution,o=d.totalLength*t,s=(u=d.lookup[~~(o/d.minLength)]||0)?i[u-1]:0,(l=i[u])<o&&(s=l,l=i[++u]),c=1/a*((o-s)/(l-s)+u%a),u=6*~~(u/a),r&&1===c&&(u+6<d.length?(u+=6,c=0):h+1<e.length&&(u=c=0,d=e[++h]))}else c=u=h=0,d=e[0];return n.t=c,n.i=u,n.path=e,n.segment=d,n.segIndex=h,n}function O(e,t,n,r,i,a,o,s,u){if(e!==s||t!==u){n=d(n),r=d(r);var p=i%360*l,v=h(p),m=c(p),g=Math.PI,_=2*g,y=(e-s)/2,x=(t-u)/2,b=v*y+m*x,w=-m*y+v*x,T=b*b,M=w*w,S=T/(n*n)+M/(r*r);S>1&&(n=f(S)*n,r=f(S)*r);var E=n*n,A=r*r,L=(E*A-E*M-A*T)/(E*M+A*T);L<0&&(L=0);var C=(a===o?-1:1)*f(L),R=C*(n*w/r),k=C*(-r*b/n),P=(e+s)/2+(v*R-m*k),D=(t+u)/2+(m*R+v*k),I=(b-R)/n,O=(w-k)/r,F=(-b-R)/n,N=(-w-k)/r,U=I*I+O*O,B=(O<0?-1:1)*Math.acos(I/f(U)),z=(I*N-O*F<0?-1:1)*Math.acos((I*F+O*N)/f(U*(F*F+N*N)));isNaN(z)&&(z=g),!o&&z>0?z-=_:o&&z<0&&(z+=_),B%=_,z%=_;var H,G=Math.ceil(d(z)/(_/4)),V=[],W=z/G,j=4/3*c(W/2)/(1+h(W/2)),q=v*n,X=m*n,Y=m*-r,K=v*r;for(H=0;H<G;H++)b=h(i=B+H*W),w=c(i),I=h(i+=W),O=c(i),V.push(b-j*w,w+j*b,I+j*O,O-j*I,I,O);for(H=0;H<V.length;H+=2)b=V[H],w=V[H+1],V[H]=b*q+w*Y+P,V[H+1]=b*X+w*K+D;return V[H-2]=s,V[H-1]=u,V}}function F(e){var t,n,r,a,s,l,u,c,h,f,p,v,m,g,_,y=(e+"").replace(o,(function(e){var t=+e;return t<1e-4&&t>-1e-4?0:t})).match(i)||[],x=[],b=0,w=0,T=2/3,M=y.length,S=0,E="ERROR: malformed path: "+e,A=function(e,t,n,r){f=(n-e)/3,p=(r-t)/3,u.push(e+f,t+p,n-f,r-p,n,r)};if(!e||!isNaN(y[0])||isNaN(y[1]))return console.log(E),x;for(t=0;t<M;t++)if(m=s,isNaN(y[t])?l=(s=y[t].toUpperCase())!==y[t]:t--,r=+y[t+1],a=+y[t+2],l&&(r+=b,a+=w),t||(c=r,h=a),"M"===s)u&&(u.length<8?x.length-=1:S+=u.length),b=c=r,w=h=a,u=[r,a],x.push(u),t+=2,s="L";else if("C"===s)u||(u=[0,0]),l||(b=w=0),u.push(r,a,b+1*y[t+3],w+1*y[t+4],b+=1*y[t+5],w+=1*y[t+6]),t+=6;else if("S"===s)f=b,p=w,"C"!==m&&"S"!==m||(f+=b-u[u.length-4],p+=w-u[u.length-3]),l||(b=w=0),u.push(f,p,r,a,b+=1*y[t+3],w+=1*y[t+4]),t+=4;else if("Q"===s)f=b+(r-b)*T,p=w+(a-w)*T,l||(b=w=0),b+=1*y[t+3],w+=1*y[t+4],u.push(f,p,b+(r-b)*T,w+(a-w)*T,b,w),t+=4;else if("T"===s)f=b-u[u.length-4],p=w-u[u.length-3],u.push(b+f,w+p,r+(b+1.5*f-r)*T,a+(w+1.5*p-a)*T,b=r,w=a),t+=2;else if("H"===s)A(b,w,b=r,w),t+=1;else if("V"===s)A(b,w,b,w=r+(l?w-b:0)),t+=1;else if("L"===s||"Z"===s)"Z"===s&&(r=c,a=h,u.closed=!0),("L"===s||d(b-r)>.5||d(w-a)>.5)&&(A(b,w,r,a),"L"===s&&(t+=2)),b=r,w=a;else if("A"===s){if(g=y[t+4],_=y[t+5],f=y[t+6],p=y[t+7],n=7,g.length>1&&(g.length<3?(p=f,f=_,n--):(p=_,f=g.substr(2),n-=2),_=g.charAt(1),g=g.charAt(0)),v=O(b,w,+y[t+1],+y[t+2],+y[t+3],+g,+_,(l?b:0)+1*f,(l?w:0)+1*p),t+=n,v)for(n=0;n<v.length;n++)u.push(v[n]);b=u[u.length-2],w=u[u.length-1]}else console.log(E);return(t=u.length)<6?(x.pop(),t=0):u[0]===u[t-2]&&u[1]===u[t-1]&&(u.closed=!0),x.totalPoints=S+t,x}function N(e,t,n,r,i){var a,o,s,l,u,c,h,d,f,p,v,m,g=r,_=e[t],y=e[t+1],x=e[n],b=e[n+1];for(o=t+2;o<n;o+=2)l=e[o],u=e[o+1],p=void 0,v=void 0,m=void 0,m=(f=b)-(h=y),((v=(d=x)-(c=_))||m)&&((p=((l-c)*v+(u-h)*m)/(v*v+m*m))>1?(c=d,h=f):p>0&&(c+=v*p,h+=m*p)),(s=Math.pow(l-c,2)+Math.pow(u-h,2))>g&&(a=o,g=s);g>r&&(a-t>2&&N(e,t,a,r,i),i.push(e[a],e[a+1]),n-a>2&&N(e,a,n,r,i))}function U(e,t,n,i,a,o,s,l,u,c,h,d,f,p){var m,g,_,y,x=(a-i)/o,b=0,w=i;for(r=v;w<=a;)(m=(g=(y=1-w)*y*y*s+3*y*y*w*u+3*y*w*w*h+w*w*w*f-t)*g+(_=y*y*y*l+3*y*y*w*c+3*y*w*w*d+w*w*w*p-n)*_)<r&&(r=m,b=w),w+=x;return e>1?U(e-1,t,n,Math.max(b-x,0),Math.min(b+x,1),o,s,l,u,c,h,d,f,p):b}function B(e){g(e[0])&&(e=[e]);var t,n,r,i,a="",o=e.length;for(n=0;n<o;n++){for(i=e[n],a+="M"+w(i[0])+","+w(i[1])+" C",t=i.length,r=2;r<t;r++)a+=w(i[r++])+","+w(i[r++])+" "+w(i[r++])+","+w(i[r++])+" "+w(i[r++])+","+w(i[r])+" ";i.closed&&(a+="z")}return a}},{}],86:[function(e,t,n){"use strict";var r=e("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(n,"__esModule",{value:!0}),n.splitText=n.byWord=n.byLetter=void 0;var i=r(e("@babel/runtime/helpers/toConsumableArray")),a=function(e,t){var n=document.createElement("span");return n.textContent=e,n.style.setProperty("--index",t),n},o=function(e){return(0,i.default)(e).map(a)};n.byLetter=o;var s=function(e){return e.split(" ").map(a)};n.byWord=s;n.splitText=function(){document.querySelectorAll("[split-by]").forEach((function(e){var t=e.getAttribute("split-by"),n=null,r=[],a=0;if(e.innerHTML=e.innerHTML.replace(/<a.+?<\/a>/g,(function(e){var t="%"+a+++"%";return r[r.length]=e,t})),"letter"===t?n=o(e.textContent):"word"===t&&(n=s(e.textContent)),n){var l;(l=e.firstChild).replaceWith.apply(l,(0,i.default)(n));for(var u=e.innerHTML,c=0;c<a;c++)u=u.replace("%"+c+"%",r[c]);e.innerHTML=u}}))}},{"@babel/runtime/helpers/interopRequireDefault":12,"@babel/runtime/helpers/toConsumableArray":21}],87:[function(e,t,n){"use strict";var r=e("../core/properties"),i=e("three"),a=r.loader.ITEM_CLASSES.xhr;function o(e,t){e&&(t.responseType="arraybuffer",s.constructor.apply(this,arguments))}t.exports=o,o.type="buf",o.extensions=["buf"];var s=a.prototype,l=o.prototype=new a;l.constructor=o,l._onLoad=function(){if(!this.content){for(var e=this.xmlhttp.response,t=new Uint32Array(e,0,1)[0],n=JSON.parse(String.fromCharCode.apply(null,new Uint8Array(e,4,t))),r=n.vertexCount,a=n.indexCount,o=4+t,l=new i.BufferGeometry,u=n.attributes,c=0,h=u.length;c<h;c++){var d=u[c],f=d.id,p="indices"===f?a:r,v=d.componentSize,m=window[d.storageType],g=new m(e,o,p*v),_=m.BYTES_PER_ELEMENT,y=void 0;if(d.needsPack){var x=d.packedComponents,b=x.length,w=0===d.storageType.indexOf("Int"),T=1<<8*_,M=w?.5*T:0,S=1/T;y=new Float32Array(p*v);for(var E=0,A=0;E<p;E++)for(var L=0;L<b;L++){var C=x[L];y[A]=(g[A]+M)*S*C.delta+C.from,A++}}else y=g;"normal"===f&&!0,"indices"===f?l.setIndex(new i.BufferAttribute(y,1)):l.setAttribute(f,new i.BufferAttribute(y,v)),o+=p*v*_}this.content=l}this.xmlhttp=void 0,s._onLoad.call(this)},o.retrieve=function(){return!1}},{"../core/properties":71,three:63}],88:[function(e,t,n){"use strict";var r=e("@babel/runtime/helpers/interopRequireDefault")(e("../core/properties")),i=e("three"),a=r.default.loader.ITEM_CLASSES.image,o=a.prototype.constructor;function s(e,t){if(e){var n=t.content||new i.Texture(new Image);switch(t.content=n.image,n.minFilter=t.minFilter||i.LinearMipMapLinearFilter,n.minFilter){case i.NearestMipMapNearestFilter:case i.NearestMipMapLinearFilter:case i.LinearMipMapNearestFilter:case i.LinearMipMapLinearFilter:n.generateMipmaps=!0,n.anisotropy=t.anisotropy||r.default.renderer.capabilities.getMaxAnisotropy();break;default:n.generateMipmaps=!1}n.flipY=void 0===t.flipY||t.flipY,t.wrap?n.wrapS=n.wrapT=t.wrap:(t.wrapS&&(n.wrapS=t.wrapS),t.wrapT&&(n.wrapT=t.wrapT)),l.constructor.apply(this,arguments),this.content=n}}t.exports=s,s.type="texture",s.extensions=[];var l=a.prototype,u=s.prototype=new a;u.constructor=s,u.load=function(){o.prototype.load.apply(this,arguments);var e=this.content.image;e.onload=this.boundOnLoad,e.src=this.url},u._onLoad=function(){delete this.content.image.onload,this.width=this.content.image.width,this.height=this.content.image.height,this.content.needsUpdate=!0,o.prototype._onLoad.call(this)},s.retrieve=function(){return!1}},{"../core/properties":71,"@babel/runtime/helpers/interopRequireDefault":12,three:63}],89:[function(e,t,n){"use strict";var r=e("three");function i(){this.position=new r.Vector3,this.rotation=new r.Quaternion,this.scale=new r.Vector3(1,1,1),this.matrix=new r.Matrix4,this.enablePositionNoise=!0,this.enableRotationNoise=!0,this.positionFrequency=.25,this.rotationFrequency=.25,this.positionAmplitude=.3,this.rotationAmplitude=.003,this.positionScale=new r.Vector3(1,1,1),this.rotationScale=new r.Vector3(1,1,0),this.positionFractalLevel=4,this.rotationFractalLevel=4,this.times=new Float32Array(6),this.rehash()}t.exports=i;var a=i.prototype;a.rehash=function(){for(var e=0;e<6;e++)this.times[e]=-1e4*Math.random()},a.update=function(e){var t;if(e=void 0===e?1e3/60:e,this.enablePositionNoise){for(t=0;t<3;t++)this.times[t]+=this.positionFrequency*e;s.set(c(this.times[0],this.positionFractalLevel),c(this.times[1],this.positionFractalLevel),c(this.times[2],this.positionFractalLevel)),s.multiply(this.positionScale),s.multiplyScalar(this.positionAmplitude*l),this.position.copy(s)}if(this.enableRotationNoise){for(t=0;t<3;t++)this.times[t+3]+=this.rotationFrequency*e;s.set(c(this.times[3],this.rotationFractalLevel),c(this.times[4],this.rotationFractalLevel),c(this.times[5],this.rotationFractalLevel)),s.multiply(this.rotationScale),s.multiplyScalar(this.rotationAmplitude*l),o.set(s.x,s.y,s.z),this.rotation.setFromEuler(o)}this.matrix.compose(this.position,this.rotation,this.scale)};var o=new r.Euler,s=new r.Vector3,l=1/.75;var u=new function(){for(var e=1,t=1,n=[],r=0;r<256;++r)n.push(Math.random()-.5);var i=function(e,t,n){return e*(1-n)+t*n};return{getVal:function(r){var a=r*t,o=Math.floor(a),s=a-o,l=s*s*(3-2*s),u=255&o,c=u+1&255;return i(n[u],n[c],l)*e},setAmplitude:function(t){e=t},setScale:function(e){t=e}}};function c(e,t){for(var n=0,r=.5,i=0;i<t;i++)n+=r*u.getVal(e),e*=2,r*=.5;return n}},{three:63}],90:[function(e,t,n){"use strict";var r=e("three"),i=e("mout/object/deepMixIn"),a=e("../helpers/fboHelper");function o(e){i(this,{uniforms:{u_texture:{},u_resolution:{value:null},u_fullResolution:{value:null},u_isVR:{value:!1}},defines:{},enabled:!0,vertexShader:"",fragmentShader:"",isRawMaterial:!0,depthTest:!1,depthWrite:!1,blending:r.NoBlending,transparent:!0},e),this.vertexShader||(this.vertexShader=a.vertexShader),this.addRawShaderPrefix&&this.isRawMaterial&&(this.vertexShader=a.precisionPrefix+this.vertexShader,this.fragmentShader=a.precisionPrefix+this.fragmentShader),this.material=new(this.isRawMaterial?r.RawShaderMaterial:r.ShaderMaterial)({uniforms:this.uniforms,vertexShader:this.vertexShader,fragmentShader:this.fragmentShader,defines:this.defines,depthTest:this.depthTest,depthWrite:this.depthWrite,blending:this.blending,transparent:this.transparent})}t.exports=o;var s=o.prototype;s.setPostprocessing=function(e){this.uniforms.u_resolution.value=e.resolution},s.dispose=function(){},s.needsRender=function(){return!0},s.render=function(e,t){this.uniforms.u_texture.value=e.fromTexture,e.renderMaterial(this.material,t?null:e.toRenderTarget),e.swap()}},{"../helpers/fboHelper":79,"mout/object/deepMixIn":40,three:63}],91:[function(e,t,n){"use strict";var r=e("three"),i=e("../helpers/fboHelper"),a=e("min-signal");function o(e){var t;(l||n.init(),this.width=1,this.height=1,this.scene=null,this.camera=null,this.resolution=new r.Vector2(0,0),this.texelSize=new r.Vector2(0,0),this.aspect=new r.Vector2(1,1),this.onBeforeSceneRendered=new a,this.onAfterSceneRendered=new a,this.onAfterRendered=new a,this.sceneRenderTarget=i.createMultisampleRenderTarget(1,1,!0),this.sceneRenderTarget.depthBuffer=!0,this.fromRenderTarget=i.createRenderTarget(1,1,!0),this.toRenderTarget=this.fromRenderTarget.clone(),this.useDepthTexture=!!e&&(i.renderer.capabilities.isWebGL2||i.renderer.extensions.get("WEBGL_depth_texture")),this.fromTexture=this.fromRenderTarget.texture,this.toTexture=this.toRenderTarget.texture,this.sceneTexture=this.sceneRenderTarget.texture,this.mesh=new r.Mesh,this.queue=[],this.sharedUniforms={u_sceneTexture:{value:this.sceneRenderTarget.texture},u_sceneDepthTexture:{value:null},u_cameraNear:{value:0},u_cameraFar:{value:1},u_cameraFovRad:{value:1},u_resolution:{value:this.resolution},u_texelSize:{value:this.texelSize},u_aspect:{value:this.aspect}},this.useDepthTexture)&&((t=new r.DepthTexture).type=r.UnsignedShortType,i.renderer.capabilities.isWebGL2&&(t.type=r.UnsignedIntType),t.minFilter=r.NearestFilter,t.magFilter=r.NearestFilter,i.renderer.capabilities.isWebGL2||(t.format=r.DepthStencilFormat,t.type=r.UnsignedInt248Type),this.sceneRenderTarget.depthTexture=t,this.depthTexture=this.sharedUniforms.u_sceneDepthTexture.value=t)}var s=o.prototype;n=t.exports=o,s.swap=function(){var e=this.fromRenderTarget;this.fromRenderTarget=this.toRenderTarget,this.toRenderTarget=e,this.fromTexture=this.fromRenderTarget.texture,this.toTexture=this.toRenderTarget.texture},s.setSize=function(e,t){this.width=e,this.height=t,this.resolution.set(e,t),this.texelSize.set(1/e,1/t);var n=t/Math.sqrt(e*e+t*t)*2;this.aspect.set(e/t*n,n),this.sceneRenderTarget.setSize(e,t),this.fromRenderTarget.setSize(e,t),this.toRenderTarget.setSize(e,t)},s.dispose=function(){this.fromRenderTarget&&this.fromRenderTarget.dispose();this.toRenderTarget&&this.toRenderTarget.dispose();this.prevSceneRenderTarget&&this.prevSceneRenderTarget.dispose();this.sceneRenderTarget&&this.sceneRenderTarget.dispose()},s.renderMaterial=function(e,t){this.mesh.material=e,i.renderMesh(this.mesh,t)},s.render=function(e,t,n){this.scene=e,this.camera=t,this.mesh.geometry=i.renderer.xr.enabled?u:l;var r,a=this.queue.filter(c),o=this.sharedUniforms;if(o.u_sceneTexture.value=this.sceneRenderTarget.texture,o.u_cameraNear.value=t.near,o.u_cameraFar.value=t.far,o.u_cameraFovRad.value=t.fov/180*Math.PI,this.onBeforeSceneRendered.dispatch(),a.length){i.renderer.setRenderTarget(this.sceneRenderTarget),i.renderer.render(e,t),i.renderer.setRenderTarget(null),i.copy(this.sceneRenderTarget.texture,this.fromRenderTarget),this.onAfterSceneRendered.dispatch(this.sceneRenderTarget);var s=i.getColorState();i.renderer.autoClear=!1;for(var h=0,d=a.length;h<d;h++){var f=h===d-1&&n;(r=a[h]).setPostprocessing(this),r.render(this,f)}i.setColorState(s)}else i.renderer.render(e,t),this.onAfterSceneRendered.dispatch();this.onAfterRendered.dispatch()};var l=n.geom=null,u=n.vrGeom=null;function c(e){return e.enabled&&e.needsRender()}n.init=function(){(l=n.geom=n.geom||new r.BufferGeometry).setAttribute("position",new r.BufferAttribute(new Float32Array([-1,-1,0,4,-1,0,-1,4,0]),3)),l.setAttribute("a_uvClamp",new r.BufferAttribute(new Float32Array([0,0,1,1,0,0,1,1,0,0,1,1]),4)),(u=n.vrGeom=n.vrGeom||new r.BufferGeometry).setAttribute("position",new r.BufferAttribute(new Float32Array([-4,-1,0,0,-1,0,0,4,0,0,-1,0,4,-1,0,0,4,0]),3)),u.setAttribute("a_uvClamp",new r.BufferAttribute(new Float32Array([0,0,.5,1,0,0,.5,1,0,0,.5,1,.5,0,1,1,.5,0,1,1,.5,0,1,1]),4))}},{"../helpers/fboHelper":79,"min-signal":29,three:63}],92:[function(e,t,n){"use strict";var r=e("../PostEffect"),i=e("../../helpers/fboHelper"),a=e("../../utils/math"),o=e("mout/object/merge"),s=e("three"),l=e("glslify");function u(e){var t=(e=o({useHighPass:!0,ITERATION:5,amount:4,radius:.1,threshold:.2,smoothWidth:1,haloWidth:.7,haloRGBShift:.03,haloStrength:.21,haloMaskInner:.3,haloMaskOuter:.5},e)).ITERATION;this.directionX=new s.Vector2(1,0),this.directionY=new s.Vector2(0,1);var n=this.highPassRenderTarget=i.createRenderTarget(1,1,!0);this.renderTargetsHorizontal=[],this.renderTargetsVertical=[],this.blurMaterials=[];for(var r=0;r<t;r++)this.renderTargetsHorizontal.push(n.clone()),this.renderTargetsVertical.push(n.clone());for(var a={u_bloomStrength:{value:1},u_bloomWeights:{value:[]}},u=0;u<t;u++)a["u_blurTexture"+u]={value:this.renderTargetsVertical[u].texture};c.constructor.call(this,o({uniforms:a,defines:{ITERATION:t},fragmentShader:i.precisionPrefix+l(["#define GLSLIFY 1\nvarying vec2 v_uv;\nuniform sampler2D u_texture;\n\nuniform sampler2D u_blurTexture0;\n#if ITERATION > 1\nuniform sampler2D u_blurTexture1;\n#endif\n#if ITERATION > 2\nuniform sampler2D u_blurTexture2;\n#endif\n#if ITERATION > 3\nuniform sampler2D u_blurTexture3;\n#endif\n#if ITERATION > 4\nuniform sampler2D u_blurTexture4;\n#endif\nuniform float u_bloomWeights[ITERATION];\n\n#include <common>\n\t// based on https://www.shadertoy.com/view/MslGR8\n\tvec3 dithering( vec3 color ) {\n\t\t//Calculate grid position\n\t\tfloat grid_position = rand( gl_FragCoord.xy );\n\n\t\t//Shift the individual colors differently, thus making it even harder to see the dithering pattern\n\t\tvec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );\n\n\t\t//modify shift acording to grid position.\n\t\tdither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );\n\n\t\t//shift the color by dither_shift\n\t\treturn color + dither_shift_RGB;\n\t}\n\nvoid main() {\n\tvec4 c = texture2D(u_texture, v_uv);\n\tvec3 luma = vec3( 0.299, 0.587, 0.114 );\n\tfloat v = dot( c.xyz, luma );\n\tfloat a = 1.0 - v;//max(0.0, 1.2 - v);//mix(1.0, 0.1, v);\n\n\tgl_FragColor = c + (\n\t\tu_bloomWeights[0] * texture2D(u_blurTexture0, v_uv)\n\t\t#if ITERATION > 1\n\t\t+ u_bloomWeights[1] * texture2D(u_blurTexture1, v_uv)\n\t\t#endif\n\t\t#if ITERATION > 2\n\t\t+ u_bloomWeights[2] * texture2D(u_blurTexture2, v_uv)\n\t\t#endif\n\t\t#if ITERATION > 3\n\t\t+ u_bloomWeights[3] * texture2D(u_blurTexture3, v_uv)\n\t\t#endif\n\t\t#if ITERATION > 4\n\t\t+ u_bloomWeights[4] * texture2D(u_blurTexture4, v_uv)\n\t\t#endif\n\t) * a;\n\n    gl_FragColor.rgb = dithering( gl_FragColor.rgb );\n\tgl_FragColor.a = 1.0;\n}\n"]),blending:s.NoBlending},e)),this.highPassMaterial=new s.RawShaderMaterial({uniforms:{u_texture:{value:null},u_luminosityThreshold:{value:1},u_smoothWidth:{value:1},u_haloWidth:{value:1},u_haloRGBShift:{value:1},u_haloStrength:{value:1},u_haloMaskInner:{value:1},u_haloMaskOuter:{value:1},u_texelSize:null,u_aspect:null},vertexShader:i.precisionPrefix+i.vertexShader,fragmentShader:i.precisionPrefix+l(["#define GLSLIFY 1\nuniform sampler2D u_texture;\n\nuniform float u_luminosityThreshold;\nuniform float u_smoothWidth;\n\n#ifdef USE_HALO\nuniform vec2 u_texelSize;\nuniform vec2 u_aspect;\nuniform float u_haloWidth;\nuniform float u_haloRGBShift;\nuniform float u_haloStrength;\nuniform float u_haloMaskInner;\nuniform float u_haloMaskOuter;\n#endif\n\nvarying vec2 v_uv;\n\nvoid main() {\n\n\tvec4 texel = texture2D( u_texture, v_uv );\n\tvec3 luma = vec3( 0.299, 0.587, 0.114 );\n\tfloat v = dot( texel.xyz, luma );\n\tvec4 outputColor = vec4(0.0, 0.0, 0.0, 1.0);\n\tfloat alpha = smoothstep( u_luminosityThreshold, u_luminosityThreshold + u_smoothWidth, v );\n\toutputColor = mix( outputColor, texel, alpha );\n\tgl_FragColor = vec4(outputColor.rgb, 1.0);\n\n\t#ifdef USE_HALO\n\t\tvec2 toCenter = (v_uv - 0.5) * u_aspect;\n\n\t\tvec2 ghostUv = 1.0 - (toCenter + 0.5);\n\t\tvec2 ghostVec = (vec2(0.5) - ghostUv);\n\n\t\tvec2 direction = normalize(ghostVec);\n\t\tvec2 haloVec = direction * u_haloWidth;\n\n\t\tvec3 distortion = vec3(-u_texelSize.x, 0.0, u_texelSize.x) * u_haloRGBShift;\n\t\tvec2 uv = ghostUv + haloVec;\n\n\t\tgl_FragColor.rgb += vec3(\n\t\t\ttexture2D(u_texture, uv + direction * distortion.r).r,\n\t\t\ttexture2D(u_texture, uv + direction * distortion.g).g,\n\t\t\ttexture2D(u_texture, uv + direction * distortion.b).b\n\t\t) * u_haloStrength * smoothstep(u_haloMaskInner, u_haloMaskOuter, length(toCenter));\n\t#endif\n}\n"])});for(var h=0;h<this.ITERATION;h++){var d=3+2*h;this.blurMaterials[h]=new s.RawShaderMaterial({uniforms:{u_texture:{value:null},u_resolution:{value:new s.Vector2},u_direction:{value:null}},vertexShader:i.precisionPrefix+i.vertexShader,fragmentShader:i.precisionPrefix+l(["#define GLSLIFY 1\nvarying vec2 v_uv;\nuniform sampler2D u_texture;\nuniform vec2 u_resolution;\nuniform vec2 u_direction;\n\nfloat gaussianPdf(in float x, in float sigma) {\n  return 0.39894 * exp( -0.5 * x * x/( sigma * sigma))/sigma;\n}\nvoid main() {\n  vec2 invSize = 1.0 / u_resolution;\n  float fSigma = float(SIGMA);\n  float weightSum = gaussianPdf(0.0, fSigma);\n  vec3 diffuseSum = texture2D( u_texture, v_uv).rgb * weightSum;\n  for( int i = 1; i < KERNEL_RADIUS; i ++ ) {\n    float x = float(i);\n    float w = gaussianPdf(x, fSigma);\n    vec2 uvOffset = u_direction * invSize * x;\n    vec3 sample1 = texture2D( u_texture, v_uv + uvOffset).rgb;\n    vec3 sample2 = texture2D( u_texture, v_uv - uvOffset).rgb;\n    diffuseSum += (sample1 + sample2) * w;\n    weightSum += 2.0 * w;\n  }\n  gl_FragColor = vec4(diffuseSum/weightSum, 1.0);\n}\n"]),defines:{KERNEL_RADIUS:d,SIGMA:d}})}}var c=r.prototype,h=u.prototype=Object.create(c);h.constructor=u,h.setPostprocessing=function(e){c.setPostprocessing.call(this,e);var t=e.width,n=e.height,r=Math.ceil(t/2),i=Math.ceil(n/2);this.highPassRenderTarget.setSize(r,i);for(var a=0;a<this.ITERATION;a++)this.renderTargetsHorizontal[a].setSize(r,i),this.renderTargetsVertical[a].setSize(r,i),this.blurMaterials[a].uniforms.u_resolution.value=new s.Vector2(r,i),r=Math.ceil(r/2),i=Math.ceil(i/2)},h.dispose=function(){this.highPassRenderTarget&&this.highPassRenderTarget.dispose();for(var e=0;e<this.ITERATION;e++)this.renderTargetsHorizontal[e]&&this.renderTargetsHorizontal[e].dispose(),this.renderTargetsVertical[e]&&this.renderTargetsVertical[e].dispose()},h.needsRender=function(){return!!this.amount},h.render=function(e,t){var n=this.ITERATION;if(this.useHighPass){this.highPassMaterial.uniforms.u_texture.value=e.fromTexture,this.highPassMaterial.uniforms.u_luminosityThreshold.value=this.threshold,this.highPassMaterial.uniforms.u_smoothWidth.value=this.smoothWidth,this.highPassMaterial.uniforms.u_haloWidth.value=this.haloWidth,this.highPassMaterial.uniforms.u_haloRGBShift.value=this.haloRGBShift*e.width,this.highPassMaterial.uniforms.u_haloStrength.value=this.haloStrength,this.highPassMaterial.uniforms.u_haloMaskInner.value=this.haloMaskInner,this.highPassMaterial.uniforms.u_haloMaskOuter.value=this.haloMaskOuter,this.highPassMaterial.uniforms.u_texelSize=e.sharedUniforms.u_texelSize,this.highPassMaterial.uniforms.u_aspect=e.sharedUniforms.u_aspect;var r=this.haloStrength>0;this.highPassMaterial.defines.USE_HALO!==r&&(this.highPassMaterial.defines.USE_HALO=r,this.highPassMaterial.needsUpdate=!0),e.renderMaterial(this.highPassMaterial,this.highPassRenderTarget)}for(var i=this.useHighPass?this.highPassRenderTarget:e.fromRenderTarget,o=0;o<n;o++){var s=this.blurMaterials[o];s.uniforms.u_texture.value=i.texture,s.uniforms.u_direction.value=this.directionX,e.renderMaterial(s,this.renderTargetsHorizontal[o]),s.uniforms.u_texture.value=this.renderTargetsHorizontal[o].texture,s.uniforms.u_direction.value=this.directionY,e.renderMaterial(s,this.renderTargetsVertical[o]),i=this.renderTargetsVertical[o]}this.material.uniforms.u_texture.value=e.fromTexture;for(var l=0;l<n;l++){var u=(n-l)/n;this.uniforms.u_bloomWeights.value[l]=this.amount*a.mix(u,1.2-u,this.radius)/Math.pow(2,n-l-1)}c.render.call(this,e,t)},t.exports=u},{"../../helpers/fboHelper":79,"../../utils/math":104,"../PostEffect":90,glslify:26,"mout/object/merge":44,three:63}],93:[function(e,t,n){"use strict";var r=e("../PostEffect"),i=e("../../helpers/fboHelper"),a=(e("../../utils/math"),e("mout/object/mixIn")),o=e("glslify"),s=e("three");function l(e){e=a({amount:1,fNumber:.07,focusDistance:5,useCameraFov:!1,focalLength:.463,kFilmHeight:36,quality:1,_prevQuality:-1,useFloatTexture:!1,_prevUseFloatTexture:null,useAdditionalBlur:!0,_halfWidth:0,_halfHeight:0},e),this.sharedUniforms={u_depthTexture:{value:null},u_texelSize:{value:null},u_focusDistance:{value:0},u_fNumber:{value:0},u_lensCoeff:{value:0},u_maxCoC:{value:0},u_rcpMaxCoC:{value:0},u_rcpAspect:{value:0},u_cameraNear:{value:0},u_cameraFar:{value:0},u_amount:{value:0},u_halfTexelSize:{value:new s.Vector2}},this.rt2=i.createRenderTarget(1,1,!0),this.rt3=i.createRenderTarget(1,1,!0),this.cocMaterial=new s.RawShaderMaterial({uniforms:{u_texture:{value:null},u_hashNoise:{value:0},u_depthTexture:this.sharedUniforms.u_depthTexture,u_texelSize:this.sharedUniforms.u_texelSize,u_focusDistance:this.sharedUniforms.u_focusDistance,u_lensCoeff:this.sharedUniforms.u_lensCoeff,u_maxCoC:this.sharedUniforms.u_maxCoC,u_rcpMaxCoC:this.sharedUniforms.u_rcpMaxCoC,u_cameraNear:this.sharedUniforms.u_cameraNear,u_cameraFar:this.sharedUniforms.u_cameraFar},vertexShader:i.precisionPrefix+i.vertexShader,fragmentShader:i.precisionPrefix+o(["#define GLSLIFY 1\nuniform sampler2D u_texture;\nuniform sampler2D u_depthTexture;\nuniform vec2 u_texelSize;\nuniform float u_focusDistance;\nuniform float u_lensCoeff;\nuniform float u_maxCoC;\nuniform float u_rcpMaxCoC;\nuniform float u_cameraNear;\nuniform float u_cameraFar;\n\nvarying vec2 v_uv;\n\n// Max between three components\nfloat max3(vec3 xyz) { return max(xyz.x, max(xyz.y, xyz.z)); }\n\n#ifndef USE_FLOAT\nuniform float u_hashNoise;\nfloat hash13(vec3 p3) {\n\tp3  = fract(p3 * .1031);\n    p3 += dot(p3, p3.yzx + 33.33);\n    return fract((p3.x + p3.y) * p3.z);\n}\n#endif\n\n// Fragment shader: Downsampling, prefiltering and CoC calculation\nfloat getViewZ (vec2 uv) {\n\tfloat depth = texture2D(u_depthTexture, uv).r * 2.0 - 1.0;\n\treturn 2.0 * u_cameraNear * u_cameraFar / (u_cameraFar + u_cameraNear - depth * (u_cameraFar - u_cameraNear));\n}\n\nvoid main () {\n    // Sample source colors.\n    vec3 duv = u_texelSize.xyx * vec3(0.5, 0.5, -0.5);\n    vec3 c0 = texture2D(u_texture, v_uv - duv.xy).rgb;\n    vec3 c1 = texture2D(u_texture, v_uv - duv.zy).rgb;\n    vec3 c2 = texture2D(u_texture, v_uv + duv.zy).rgb;\n    vec3 c3 = texture2D(u_texture, v_uv + duv.xy).rgb;\n\n    // Sample linear depths.\n\tvec2 uvAlt = v_uv; // yFlippedUV? https://github.com/keijiro/KinoBokeh/blob/master/Assets/Kino/Bokeh/Shader/Common.cginc\n    float d0 = getViewZ(uvAlt - duv.xy);\n    float d1 = getViewZ(uvAlt - duv.zy);\n    float d2 = getViewZ(uvAlt + duv.zy);\n    float d3 = getViewZ(uvAlt + duv.xy);\n    vec4 depths = vec4(d0, d1, d2, d3);\n\n    // Calculate the radiuses of CoCs at these sample points.\n    float focusDistance = u_focusDistance;\n    // focusDistance = getViewZ(vec2(0.5));\n    \n\n    vec4 cocs = (depths - focusDistance) * u_lensCoeff / depths;\n    cocs = clamp(cocs, -u_maxCoC, u_maxCoC);\n\n    // Premultiply CoC to reduce background bleeding.\n    vec4 weights = clamp(abs(cocs) * u_rcpMaxCoC, vec4(0.0), vec4(1.0));\n\n// #if defined(PREFILTER_LUMA_WEIGHT)\n    // Apply luma weights to reduce flickering.\n    // Inspired by goo.gl/j1fhLe goo.gl/mfuZ4h\n    weights.x *= 1.0 / (max3(c0) + 1.0);\n    weights.y *= 1.0 / (max3(c1) + 1.0);\n    weights.z *= 1.0 / (max3(c2) + 1.0);\n    weights.w *= 1.0 / (max3(c3) + 1.0);\n// #endif\n\n    // Weighted average of the color samples\n    vec3 avg = c0 * weights.x + c1 * weights.y + c2 * weights.z + c3 * weights.w;\n    avg /= dot(weights, vec4(1.0));\n\n    // Output CoC = average of CoCs\n    float coc = dot(cocs, vec4(0.25));\n\n    // Premultiply CoC again.\n    avg *= smoothstep(0.0, u_texelSize.y * 2.0, abs(coc));\n\n    gl_FragColor = vec4(avg, coc);\n    #ifndef USE_FLOAT\n    gl_FragColor = sign(gl_FragColor) * sqrt(abs(gl_FragColor));\n    gl_FragColor = gl_FragColor * 0.5 + 0.5 + hash13(vec3(gl_FragCoord.xy, u_hashNoise)) / 255.0;\n    #endif\n}"])}),this.simMaterial=new s.RawShaderMaterial({uniforms:{u_cocTexture:{value:null},u_cocTexelSize:this.sharedUniforms.u_halfTexelSize,u_rcpAspect:this.sharedUniforms.u_rcpAspect,u_maxCoC:this.sharedUniforms.u_maxCoC},vertexShader:i.precisionPrefix+i.vertexShader,fragmentShader:i.precisionPrefix+o(["#define GLSLIFY 1\n#if QUALITY == 0\n\n// rings = 2\n// points per ring = 5\nconst int kSampleCount = 16;\nvec2 kDiskKernel[kSampleCount];\n\nvoid initKernel () {\n    kDiskKernel[0] = vec2(0.0,0.0);\n    kDiskKernel[1] = vec2(0.54545456,0.0);\n    kDiskKernel[2] = vec2(0.16855472,0.5187581);\n    kDiskKernel[3] = vec2(-0.44128203,0.3206101);\n    kDiskKernel[4] = vec2(-0.44128197,-0.3206102);\n    kDiskKernel[5] = vec2(0.1685548,-0.5187581);\n    kDiskKernel[6] = vec2(1.0,0.0);\n    kDiskKernel[7] = vec2(0.809017,0.58778524);\n    kDiskKernel[8] = vec2(0.30901697,0.95105654);\n    kDiskKernel[9] = vec2(-0.30901703,0.9510565);\n    kDiskKernel[10] = vec2(-0.80901706,0.5877852);\n    kDiskKernel[11] = vec2(-1.0,0.0);\n    kDiskKernel[12] = vec2(-0.80901694,-0.58778536);\n    kDiskKernel[13] = vec2(-0.30901664,-0.9510566);\n    kDiskKernel[14] = vec2(0.30901712,-0.9510565);\n    kDiskKernel[15] = vec2(0.80901694,-0.5877853);\n}\n\n#endif\n\n#if QUALITY == 1\n\n// rings = 3\n// points per ring = 7\nconst int kSampleCount = 22;\nvec2 kDiskKernel[kSampleCount];\n\nvoid initKernel () {\n    kDiskKernel[0] = vec2(0.0,0.0);\n    kDiskKernel[1] = vec2(0.53333336,0.0);\n    kDiskKernel[2] = vec2(0.3325279,0.4169768);\n    kDiskKernel[3] = vec2(-0.11867785,0.5199616);\n    kDiskKernel[4] = vec2(-0.48051673,0.2314047);\n    kDiskKernel[5] = vec2(-0.48051673,-0.23140468);\n    kDiskKernel[6] = vec2(-0.11867763,-0.51996166);\n    kDiskKernel[7] = vec2(0.33252785,-0.4169769);\n    kDiskKernel[8] = vec2(1.0,0.0);\n    kDiskKernel[9] = vec2(0.90096885,0.43388376);\n    kDiskKernel[10] = vec2(0.6234898,0.7818315);\n    kDiskKernel[11] = vec2(0.22252098,0.9749279);\n    kDiskKernel[12] = vec2(-0.22252095,0.9749279);\n    kDiskKernel[13] = vec2(-0.62349,0.7818314);\n    kDiskKernel[14] = vec2(-0.90096885,0.43388382);\n    kDiskKernel[15] = vec2(-1.0,0.0);\n    kDiskKernel[16] = vec2(-0.90096885,-0.43388376);\n    kDiskKernel[17] = vec2(-0.6234896,-0.7818316);\n    kDiskKernel[18] = vec2(-0.22252055,-0.974928);\n    kDiskKernel[19] = vec2(0.2225215,-0.9749278);\n    kDiskKernel[20] = vec2(0.6234897,-0.7818316);\n    kDiskKernel[21] = vec2(0.90096885,-0.43388376);\n}\n\n#endif\n\n#if QUALITY == 2\n\n// rings = 4\n// points per ring = 7\nconst int kSampleCount = 43;\nvec2 kDiskKernel[kSampleCount];\n\nvoid initKernel () {\n    kDiskKernel[0] = vec2(0.0,0.0);\n    kDiskKernel[1] = vec2(0.36363637,0.0);\n    kDiskKernel[2] = vec2(0.22672357,0.28430238);\n    kDiskKernel[3] = vec2(-0.08091671,0.35451925);\n    kDiskKernel[4] = vec2(-0.32762504,0.15777594);\n    kDiskKernel[5] = vec2(-0.32762504,-0.15777591);\n    kDiskKernel[6] = vec2(-0.08091656,-0.35451928);\n    kDiskKernel[7] = vec2(0.22672352,-0.2843024);\n    kDiskKernel[8] = vec2(0.6818182,0.0);\n    kDiskKernel[9] = vec2(0.614297,0.29582983);\n    kDiskKernel[10] = vec2(0.42510667,0.5330669);\n    kDiskKernel[11] = vec2(0.15171885,0.6647236);\n    kDiskKernel[12] = vec2(-0.15171883,0.6647236);\n    kDiskKernel[13] = vec2(-0.4251068,0.53306687);\n    kDiskKernel[14] = vec2(-0.614297,0.29582986);\n    kDiskKernel[15] = vec2(-0.6818182,0);\n    kDiskKernel[16] = vec2(-0.614297,-0.29582983);\n    kDiskKernel[17] = vec2(-0.42510656,-0.53306705);\n    kDiskKernel[18] = vec2(-0.15171856,-0.66472363);\n    kDiskKernel[19] = vec2(0.1517192,-0.6647235);\n    kDiskKernel[20] = vec2(0.4251066,-0.53306705);\n    kDiskKernel[21] = vec2(0.614297,-0.29582983);\n    kDiskKernel[22] = vec2(1.0,0.0);\n    kDiskKernel[23] = vec2(0.9555728,0.2947552);\n    kDiskKernel[24] = vec2(0.82623875,0.5633201);\n    kDiskKernel[25] = vec2(0.6234898,0.7818315);\n    kDiskKernel[26] = vec2(0.36534098,0.93087375);\n    kDiskKernel[27] = vec2(0.07473,0.9972038);\n    kDiskKernel[28] = vec2(-0.22252095,0.9749279);\n    kDiskKernel[29] = vec2(-0.50000006,0.8660254);\n    kDiskKernel[30] = vec2(-0.73305196,0.6801727);\n    kDiskKernel[31] = vec2(-0.90096885,0.43388382);\n    kDiskKernel[32] = vec2(-0.98883086,0.14904208);\n    kDiskKernel[33] = vec2(-0.9888308,-0.14904249);\n    kDiskKernel[34] = vec2(-0.90096885,-0.43388376);\n    kDiskKernel[35] = vec2(-0.73305184,-0.6801728);\n    kDiskKernel[36] = vec2(-0.4999999,-0.86602545);\n    kDiskKernel[37] = vec2(-0.222521,-0.9749279);\n    kDiskKernel[38] = vec2(0.07473029,-0.99720377);\n    kDiskKernel[39] = vec2(0.36534148,-0.9308736);\n    kDiskKernel[40] = vec2(0.6234897,-0.7818316);\n    kDiskKernel[41] = vec2(0.8262388,-0.56332);\n    kDiskKernel[42] = vec2(0.9555729,-0.29475483);\n}\n\n#endif\n\n#if QUALITY == 3\n\n// rings = 5\n// points per ring = 7\nconst int kSampleCount = 71;\nvec2 kDiskKernel[kSampleCount];\n\nvoid initKernel () {\n    kDiskKernel[0] = vec2(0,0);\n    kDiskKernel[1] = vec2(0.2758621,0.0);\n    kDiskKernel[2] = vec2(0.1719972,0.21567768);\n    kDiskKernel[3] = vec2(-0.061385095,0.26894566);\n    kDiskKernel[4] = vec2(-0.24854316,0.1196921);\n    kDiskKernel[5] = vec2(-0.24854316,-0.11969208);\n    kDiskKernel[6] = vec2(-0.061384983,-0.2689457);\n    kDiskKernel[7] = vec2(0.17199717,-0.21567771);\n    kDiskKernel[8] = vec2(0.51724136,0.0);\n    kDiskKernel[9] = vec2(0.46601835,0.22442262);\n    kDiskKernel[10] = vec2(0.32249472,0.40439558);\n    kDiskKernel[11] = vec2(0.11509705,0.50427306);\n    kDiskKernel[12] = vec2(-0.11509704,0.50427306);\n    kDiskKernel[13] = vec2(-0.3224948,0.40439552);\n    kDiskKernel[14] = vec2(-0.46601835,0.22442265);\n    kDiskKernel[15] = vec2(-0.51724136,0.0);\n    kDiskKernel[16] = vec2(-0.46601835,-0.22442262);\n    kDiskKernel[17] = vec2(-0.32249463,-0.40439564);\n    kDiskKernel[18] = vec2(-0.11509683,-0.5042731);\n    kDiskKernel[19] = vec2(0.11509732,-0.504273);\n    kDiskKernel[20] = vec2(0.32249466,-0.40439564);\n    kDiskKernel[21] = vec2(0.46601835,-0.22442262);\n    kDiskKernel[22] = vec2(0.7586207,0.0);\n    kDiskKernel[23] = vec2(0.7249173,0.22360738);\n    kDiskKernel[24] = vec2(0.6268018,0.4273463);\n    kDiskKernel[25] = vec2(0.47299224,0.59311354);\n    kDiskKernel[26] = vec2(0.27715522,0.7061801);\n    kDiskKernel[27] = vec2(0.056691725,0.75649947);\n    kDiskKernel[28] = vec2(-0.168809,0.7396005);\n    kDiskKernel[29] = vec2(-0.3793104,0.65698475);\n    kDiskKernel[30] = vec2(-0.55610836,0.51599306);\n    kDiskKernel[31] = vec2(-0.6834936,0.32915324);\n    kDiskKernel[32] = vec2(-0.7501475,0.113066405);\n    kDiskKernel[33] = vec2(-0.7501475,-0.11306671);\n    kDiskKernel[34] = vec2(-0.6834936,-0.32915318);\n    kDiskKernel[35] = vec2(-0.5561083,-0.5159932);\n    kDiskKernel[36] = vec2(-0.37931028,-0.6569848);\n    kDiskKernel[37] = vec2(-0.16880904,-0.7396005);\n    kDiskKernel[38] = vec2(0.056691945,-0.7564994);\n    kDiskKernel[39] = vec2(0.2771556,-0.7061799);\n    kDiskKernel[40] = vec2(0.47299215,-0.59311366);\n    kDiskKernel[41] = vec2(0.62680185,-0.4273462);\n    kDiskKernel[42] = vec2(0.72491735,-0.22360711);\n    kDiskKernel[43] = vec2(1.0,0.0);\n    kDiskKernel[44] = vec2(0.9749279,0.22252093);\n    kDiskKernel[45] = vec2(0.90096885,0.43388376);\n    kDiskKernel[46] = vec2(0.7818315,0.6234898);\n    kDiskKernel[47] = vec2(0.6234898,0.7818315);\n    kDiskKernel[48] = vec2(0.43388364,0.9009689);\n    kDiskKernel[49] = vec2(0.22252098,0.9749279);\n    kDiskKernel[50] = vec2(0.0,1.0);\n    kDiskKernel[51] = vec2(-0.22252095,0.9749279);\n    kDiskKernel[52] = vec2(-0.43388385,0.90096885);\n    kDiskKernel[53] = vec2(-0.62349,0.7818314);\n    kDiskKernel[54] = vec2(-0.7818317,0.62348956);\n    kDiskKernel[55] = vec2(-0.90096885,0.43388382);\n    kDiskKernel[56] = vec2(-0.9749279,0.22252093);\n    kDiskKernel[57] = vec2(-1.0,0.0);\n    kDiskKernel[58] = vec2(-0.9749279,-0.22252087);\n    kDiskKernel[59] = vec2(-0.90096885,-0.43388376);\n    kDiskKernel[60] = vec2(-0.7818314,-0.6234899);\n    kDiskKernel[61] = vec2(-0.6234896,-0.7818316);\n    kDiskKernel[62] = vec2(-0.43388346,-0.900969);\n    kDiskKernel[63] = vec2(-0.22252055,-0.974928);\n    kDiskKernel[64] = vec2(0.0,-1.0);\n    kDiskKernel[65] = vec2(0.2225215,-0.9749278);\n    kDiskKernel[66] = vec2(0.4338835,-0.90096897);\n    kDiskKernel[67] = vec2(0.6234897,-0.7818316);\n    kDiskKernel[68] = vec2(0.78183144,-0.62348986);\n    kDiskKernel[69] = vec2(0.90096885,-0.43388376);\n    kDiskKernel[70] = vec2(0.9749279,-0.22252086);\n}\n\n#endif\n\nuniform sampler2D u_cocTexture;\nuniform vec2 u_cocTexelSize;\n\n// Camera parameters\nuniform float u_rcpAspect;\nuniform float u_maxCoC;\n// uniform float u_rcpMaxCoC;\n\nvarying vec2 v_uv;\n\nvoid main () {\n\tinitKernel();\n\n\tvec4 samp0 = texture2D(u_cocTexture, v_uv);\n    #ifndef USE_FLOAT\n    samp0 = samp0 * 2.0 - 1.0;\n    samp0 = sign(samp0) * samp0 * samp0;\n    #endif\n\n    vec4 bgAcc = vec4(0.0); // Background: far field bokeh\n    vec4 fgAcc = vec4(0.0); // Foreground: near field bokeh\n\n    for (int si = 0; si < kSampleCount; si++) {\n        vec2 disp = kDiskKernel[si] * u_maxCoC;\n        float dist = length(disp);\n\n        vec2 duv = vec2(disp.x * u_rcpAspect, disp.y);\n        vec4 samp = texture2D(u_cocTexture, v_uv + duv);\n        #ifndef USE_FLOAT\n        samp = samp * 2.0 - 1.0;\n        samp = sign(samp) * samp * samp;\n        #endif\n\n        // BG: Compare CoC of the current sample and the center sample\n        // and select smaller one.\n        float bgCoC = max(min(samp0.a, samp.a), 0.0);\n\n        // Compare the CoC to the sample distance.\n        // Add a small margin to smooth out.\n        float margin = u_cocTexelSize.y * 2.0;\n        float bgWeight = clamp((bgCoC   - dist + margin) / margin, 0.0, 1.0);\n        float fgWeight = clamp((-samp.a - dist + margin) / margin, 0.0, 1.0);\n\n        // Cut influence from focused areas because they're darkened by CoC\n        // premultiplying. This is only needed for near field.\n        fgWeight *= step(u_cocTexelSize.y, -samp.a);\n\n        // Accumulation\n        bgAcc += vec4(samp.rgb, 1.0) * bgWeight;\n        fgAcc += vec4(samp.rgb, 1.0) * fgWeight;\n    }\n\n    // Get the weighted average.\n    // bgAcc.rgb /= bgAcc.a + (bgAcc.a == 0); // zero-div guard\n    // fgAcc.rgb /= fgAcc.a + (fgAcc.a == 0);\n    bgAcc.rgb /= bgAcc.a + step(bgAcc.a, 0.0); // zero-div guard\n    fgAcc.rgb /= fgAcc.a + step(fgAcc.a, 0.0);\n\n    // BG: Calculate the alpha value only based on the center CoC.\n    // This is a rather aggressive approximation but provides stable results.\n    bgAcc.a = smoothstep(u_cocTexelSize.y, u_cocTexelSize.y * 2.0, samp0.a);\n\n    // FG: Normalize the total of the weights.\n    fgAcc.a *= 3.14159265359 / float(kSampleCount);\n\n    // Alpha premultiplying\n    vec3 rgb = vec3(0.0);\n    rgb = mix(rgb, bgAcc.rgb, clamp(bgAcc.a, 0.0, 1.0));\n    rgb = mix(rgb, fgAcc.rgb, clamp(fgAcc.a, 0.0, 1.0));\n\n    // Combined alpha value\n    float alpha = (1.0 - clamp(bgAcc.a, 0.0, 1.0)) * (1.0 - clamp(fgAcc.a, 0.0, 1.0));\n\n    gl_FragColor = vec4(rgb, alpha);\n}"])}),this.blurMaterial=new s.RawShaderMaterial({uniforms:{u_bokehTexture:{value:null},u_bokehTexelSize:this.sharedUniforms.u_halfTexelSize},vertexShader:i.precisionPrefix+i.vertexShader,fragmentShader:i.precisionPrefix+o(["#define GLSLIFY 1\nuniform sampler2D u_bokehTexture;\nuniform vec2 u_bokehTexelSize;\n\nvarying vec2 v_uv;\n\nvoid main () {\n    // 9-tap tent filter\n    vec4 duv = u_bokehTexelSize.xyxy * vec4(1.0, 1.0, -1.0, 0.0);\n    vec4 acc;\n\n    acc  = texture2D(u_bokehTexture, v_uv - duv.xy);\n    acc += texture2D(u_bokehTexture, v_uv - duv.wy) * 2.0;\n    acc += texture2D(u_bokehTexture, v_uv - duv.zy);\n\n    acc += texture2D(u_bokehTexture, v_uv + duv.zw) * 2.0;\n    acc += texture2D(u_bokehTexture, v_uv ) * 4.0;\n    acc += texture2D(u_bokehTexture, v_uv + duv.xw) * 2.0;\n\n    acc += texture2D(u_bokehTexture, v_uv + duv.zy);\n    acc += texture2D(u_bokehTexture, v_uv + duv.wy) * 2.0;\n    acc += texture2D(u_bokehTexture, v_uv + duv.xy);\n\n    gl_FragColor = acc * 0.0625;\n}"])}),u.constructor.call(this,a({uniforms:{u_blurTexture:{value:null},u_amount:this.sharedUniforms.u_amount},fragmentShader:i.precisionPrefix+o(["#define GLSLIFY 1\nvarying vec2 v_uv;\nuniform sampler2D u_texture;\nuniform sampler2D u_blurTexture;\nuniform float u_amount;\n\nvoid main() {\n\tvec4 cs = texture2D(u_texture, v_uv);\n\tvec4 cb = texture2D(u_blurTexture, v_uv);\n\tvec3 rgb = cs.rgb * cb.a + cb.rgb;\n\n\tgl_FragColor =  mix(cs, vec4(rgb, cs.a), u_amount);\n}\n"]),blending:s.NoBlending},e))}var u=r.prototype,c=l.prototype=Object.create(u);c.constructor=l,c.setPostprocessing=function(e){u.setPostprocessing.call(this,e);var t=e.width,n=e.height,r=Math.ceil(t/2),i=Math.ceil(n/2);this._halfWidth=r,this._halfHeight=i,this.rt1&&this.rt1.setSize(r,i);this.rt2.setSize(r,i),this.rt3.setSize(r,i),this.sharedUniforms.u_halfTexelSize.value.set(1/r,1/i)},c.dispose=function(){this.rt1&&this.rt1.dispose();this.rt2.dispose(),this.rt3.dispose()},c.needsRender=function(){return this.amount>0},c.render=function(e,t){var n=this._prevQuality!==this.quality,r=this._prevUseFloatTexture!==this.useFloatTexture,a=this.useCameraFov?(v=e.sharedUniforms.u_cameraFovRad.value,m=e.camera.getFilmHeight(),.5*m/Math.tan(.5*v)):this.focalLength,o=this.focusDistance,l=this.fNumber,c=a*a/(l*(o-a)*this.kFilmHeight*2),h=(d=e.height,f=this.quality,p=4*f+6,Math.min(.05,p/d));var d,f,p;var v,m;this.sharedUniforms.u_amount.value=this.amount,this.sharedUniforms.u_texelSize.value=e.sharedUniforms.u_texelSize.value,this.sharedUniforms.u_depthTexture.value=e.sharedUniforms.u_sceneDepthTexture.value,this.sharedUniforms.u_cameraNear.value=e.sharedUniforms.u_cameraNear.value,this.sharedUniforms.u_cameraFar.value=e.sharedUniforms.u_cameraFar.value,this.sharedUniforms.u_focusDistance.value=o,this.sharedUniforms.u_fNumber.value=l,this.sharedUniforms.u_lensCoeff.value=c,this.sharedUniforms.u_maxCoC.value=h,this.sharedUniforms.u_rcpMaxCoC.value=1/h,this.sharedUniforms.u_rcpAspect.value=e.height/e.width,r&&(this.rt1&&this.rt1.dispose(),this.rt1=i.createRenderTarget(this._halfWidth,this._halfHeight,!0,!1,this.useFloatTexture));e.fromTexture.minFilter=e.fromTexture.magFilter=s.NearestFilter,r&&(this.cocMaterial.defines.USE_FLOAT=this.useFloatTexture,this.cocMaterial.needsUpdate=!0);this.cocMaterial.uniforms.u_hashNoise.value=(this.cocMaterial.uniforms.u_hashNoise.value+1.2415)%100,this.cocMaterial.uniforms.u_texture.value=e.fromTexture,e.renderMaterial(this.cocMaterial,this.rt1),e.fromTexture.minFilter=e.fromTexture.magFilter=s.LinearFilter,this.simMaterial.defines.QUALITY=this.quality,this.simMaterial.uniforms.u_cocTexture.value=this.rt1.texture,n&&(this.simMaterial.needsUpdate=!0);r&&(this.simMaterial.defines.USE_FLOAT=this.useFloatTexture,this.simMaterial.needsUpdate=!0);e.renderMaterial(this.simMaterial,this.rt2),this.useAdditionalBlur&&(this.blurMaterial.uniforms.u_bokehTexture.value=this.rt2.texture,e.renderMaterial(this.blurMaterial,this.rt3));this.material.uniforms.u_blurTexture.value=this.useAdditionalBlur?this.rt3.texture:this.rt2.texture,this._prevQuality=this.quality,this._prevUseFloatTexture=this.useFloatTexture,u.render.call(this,e,t,e.fromTexture)},t.exports=l},{"../../helpers/fboHelper":79,"../../utils/math":104,"../PostEffect":90,glslify:26,"mout/object/mixIn":45,three:63}],94:[function(e,t,n){"use strict";var r=e("../PostEffect"),i=e("../../helpers/fboHelper"),a=(e("../../utils/math"),e("mout/object/mixIn")),o=e("../../effects/blueNoise/blueNoise"),s=e("../../core/properties"),l=e("glslify"),u=e("three"),c=new u.Matrix4,h=new u.Matrix4;function d(e){e=a({amount:20,_prevSampleCount:-1,projectionViewMatrix:new u.Matrix4,prevProjectionViewMatrix:new u.Matrix4,projectionViewInverseMatrix:new u.Matrix4,prevProjectionViewInverseMatrix:new u.Matrix4,prevShakeMatrix:new u.Matrix4},e),f.constructor.call(this,a({uniforms:a({u_prevTexture:{value:null},u_depthTexture:{value:null},u_amount:{value:1},u_projectionViewInverseMatrix:{value:e.projectionViewInverseMatrix},u_prevProjectionViewMatrix:{value:e.prevProjectionViewMatrix}},o.sharedUniforms),fragmentShader:i.precisionPrefix+l(["#define GLSLIFY 1\nuniform sampler2D u_texture;\nuniform sampler2D u_depthTexture;\n\nuniform mat4 u_projectionViewInverseMatrix;\nuniform mat4 u_prevProjectionViewMatrix;\nuniform float u_amount;\n\nvarying vec2 v_uv;\n\n#include <getBlueNoise>\n\nvoid main () {\n\tvec3 bnoise = getBlueNoise(gl_FragCoord.xy);\n\tvec2 uv = v_uv;\n\tfloat depth = texture2D(u_depthTexture, uv).r;\n\n\tvec4 ndc =  vec4(\n\t\tuv.xy * 2.0 - 1.0,\n\t\tdepth,\n\t\t1.0\n\t);\n\n\tvec4 worldPos = u_projectionViewInverseMatrix * ndc;\n\n\tvec4 prevPos = u_prevProjectionViewMatrix * worldPos;\n\tprevPos /= prevPos.w;\n\tprevPos.xy = prevPos.xy * 0.5 + 0.5;\n\n\tvec2 velocity = (prevPos.xy - uv) / 9.0 * u_amount * (0.5 + bnoise.x * 0.5);\n\n\t// vec4 color = texture2D(u_texture, uv);\n\t// uv += velocity;\n\t// for(int i = 1; i < SAMPLE_COUNT; ++i) {\n\t// \tcolor += texture2D(u_texture, uv);\n\t// \tuv += velocity;\n\t// }\n\t// gl_FragColor = color / fSampleCount;\n\tvec4 color = texture2D(u_texture, uv) * 0.051;\n\tuv += velocity;\n\tcolor += texture2D(u_texture, uv) * 0.0918;\n\tuv += velocity;\n\tcolor += texture2D(u_texture, uv) * 0.12245;\n\tuv += velocity;\n\tcolor += texture2D(u_texture, uv) * 0.1531;\n\tuv += velocity;\n\tcolor += texture2D(u_texture, uv) * 0.1633;\n\tuv += velocity;\n\tcolor += texture2D(u_texture, uv) * 0.1531;\n\tuv += velocity;\n\tcolor += texture2D(u_texture, uv) * 0.12245;\n\tuv += velocity;\n\tcolor += texture2D(u_texture, uv) * 0.0918;\n\tuv += velocity;\n\tcolor += texture2D(u_texture, uv) * 0.051;\n\n\tgl_FragColor = color;\n}"]),blending:u.NoBlending},e)),this.needsRefresh=!0}t.exports=d;var f=r.prototype,p=d.prototype=Object.create(f);p.constructor=d,p.needsRender=function(e){return this.amount>0},p.refresh=function(){this.needsRefresh=!0},p.render=function(e,t){this.uniforms.u_depthTexture.value=e.sharedUniforms.u_sceneDepthTexture.value,this.uniforms.u_amount.value=this.amount;var n=e.camera;this.projectionViewMatrix.multiplyMatrices(n.projectionMatrix,n.matrixWorldInverse),this.projectionViewInverseMatrix.copy(this.projectionViewMatrix).invert(),h.copy(s.brownianMotion.matrix).invert().premultiply(this.prevShakeMatrix),c.copy(n.matrix).multiply(h).invert(),this.prevProjectionViewMatrix.multiplyMatrices(n.projectionMatrix,c),this.prevProjectionViewInverseMatrix.copy(this.prevProjectionViewMatrix).invert(),this.prevShakeMatrix.copy(s.brownianMotion.matrix),(this.needsRefresh||e.temporalEffectNeedsReset)&&(this.prevProjectionViewMatrix.copy(this.projectionViewMatrix),this.prevProjectionViewInverseMatrix.copy(this.projectionViewInverseMatrix),this.needsRefresh=!1);this.sampleCount!==this._prevSampleCount&&(this.material.needsUpdate=!0,this._prevSampleCount=this.sampleCount);f.render.call(this,e,t)}},{"../../core/properties":71,"../../effects/blueNoise/blueNoise":73,"../../helpers/fboHelper":79,"../../utils/math":104,"../PostEffect":90,glslify:26,"mout/object/mixIn":45,three:63}],95:[function(e,t,n){"use strict";var r=e("../PostEffect"),i=e("../../helpers/fboHelper"),a=(e("../../utils/math"),e("mout/object/merge")),o=e("glslify"),s=e("three"),l=e("../../effects/blueNoise/blueNoise"),u=e("mout/object/mixIn");function c(e){e=a({bgColor:new s.Color(0),vignetteFrom:.6,vignetteTo:1.6,vignetteAspect:new s.Vector2,vignetteColor:new s.Color(0),saturation:1,contrast:0,brightness:1,tintColor:new s.Color(0),tintOpacity:1,opacity:1,cacheBlendRatio:0,cacheBlendDirection:1,cacheRenderTarget:i.createRenderTarget(1,1),hasCache:!1},e),this.transitionMaterial=new s.RawShaderMaterial({uniforms:u({u_texture:{value:null},u_cacheTexture:{value:e.cacheRenderTarget.texture},u_cacheBlendDirection:{value:0},u_cacheBlendRatio:{value:0}},l.sharedUniforms),vertexShader:i.precisionPrefix+i.vertexShader,fragmentShader:i.precisionPrefix+o(["#define GLSLIFY 1\nvarying vec2 v_uv;\n\nuniform sampler2D u_texture;\nuniform sampler2D u_cacheTexture;\nuniform float u_cacheBlendRatio;\nuniform float u_cacheBlendDirection;\n\n#include <getBlueNoise>\n\nfloat range(float vmin, float vmax, float value) {\n\treturn clamp((value - vmin) / (vmax - vmin), 0.0, 1.0);\n}\n\nvoid main() {\n\tvec3 bnoise = getBlueNoise(gl_FragCoord.xy);\n\n\tvec2 uv = v_uv;\n\tvec3 color = vec3(0.0);\n\tvec3 cacheColor = vec3(0.0);\n\n\tvec2 colorUv = uv;\n\tvec2 cacheColorUv = uv;\n\n\tfloat direction = u_cacheBlendDirection;\n\n\tfloat blendRatio = range(bnoise.x * 0.05, 0.95 + bnoise.y * 0.05, u_cacheBlendRatio);\n\n\tfloat colorUvOffsetRatio = direction > 0.0 ? 1.0 - uv.x : uv.x;\n\tfloat cacheColorUvOffsetRatio = direction < 0.0 ? 1.0 - uv.x : uv.x;\n\n\tfloat colorUvOffsetDist = (colorUvOffsetRatio * colorUvOffsetRatio * 0.95);\n\tfloat cacheColorUvOffsetDist = (cacheColorUvOffsetRatio * cacheColorUvOffsetRatio * 0.95);\n\n\tvec2 colorUvOffset = vec2((colorUvOffsetDist + 0.5) * direction, colorUvOffsetDist * (0.5 - uv.y) * 2.0) * blendRatio / 16.0;\n\tvec2 cacheColorUvOffset = vec2((cacheColorUvOffsetDist + 0.5) * -direction, cacheColorUvOffsetDist * (0.5 - uv.y) * 2.0) * (1.0 - blendRatio) / 16.0;\n\n\tcolorUv += colorUvOffset ;\n\tcacheColorUv += cacheColorUvOffset;\n\n\tfor (int i = 0; i < 16; i++) {\n\t\tcolor += texture2D(u_texture, colorUv).rgb;\n\t\tcacheColor += texture2D(u_cacheTexture, cacheColorUv).rgb;\n\t\tcolorUv += colorUvOffset;\n\t\tcacheColorUv += cacheColorUvOffset;\n\t}\n\n\tcolor /= 16.0;\n\tcacheColor /= 16.0;\n\t\n\tcolor = mix(color, cacheColor, clamp(blendRatio * 2.0 - colorUvOffsetRatio * colorUvOffsetRatio, 0.0, 1.0));\n\t\n\tgl_FragColor = vec4(color, 1.0);\n}\n"])}),h.constructor.call(this,a({uniforms:{u_vignetteFrom:{value:0},u_vignetteTo:{value:0},u_vignetteAspect:{value:e.vignetteAspect},u_vignetteColor:{value:e.vignetteColor},u_saturation:{value:0},u_contrast:{value:0},u_brightness:{value:0},u_tintColor:{value:e.tintColor},u_tintOpacity:{value:0},u_bgColor:{value:e.bgColor},u_opacity:{value:0},u_ditherSeed:{value:0}},fragmentShader:i.precisionPrefix+o(["#define GLSLIFY 1\nvarying vec2 v_uv;\nuniform sampler2D u_texture;\nuniform vec3 u_bgColor;\nuniform float u_opacity;\n\nuniform float u_vignetteFrom;\nuniform float u_vignetteTo;\nuniform vec2 u_vignetteAspect;\nuniform vec3 u_vignetteColor;\n\nuniform float u_saturation;\nuniform float u_contrast;\nuniform float u_brightness;\n\nuniform vec3 u_tintColor;\nuniform float u_tintOpacity;\nuniform float u_ditherSeed;\n\nfloat hash13(vec3 p3) {\n\tp3  = fract(p3 * .1031);\n    p3 += dot(p3, p3.yzx + 33.33);\n    return fract((p3.x + p3.y) * p3.z);\n}\n\nvec3 screen (vec3 cb, vec3 cs) {\n\treturn cb + cs - (cb * cs);\n}\n\nvec3 colorDodge (vec3 cb, vec3 cs) {\n\treturn mix(\n\t\tmin(vec3(1.0), cb / (1.0 - cs)),\n\t\tvec3(1.0),\n\t\tstep(vec3(1.0), cs)\n\t);\n}\nvoid main() {\n\tvec2 uv = v_uv;\n\tvec3 color = texture2D(u_texture, uv).rgb;\n\n\tfloat luma = dot(color, vec3(0.299, 0.587, 0.114));\n\n\tcolor = mix(vec3(luma), color, 1.0 + u_saturation);\n\tcolor = 0.5 + (1.0 + u_contrast) * (color - 0.5);\n\tcolor += u_brightness;\n\n\t// linear dodge add\n\tcolor = mix(color, screen(colorDodge(color, u_tintColor), u_tintColor), u_tintOpacity);\n\n\tfloat d = length((uv - 0.5) * u_vignetteAspect) * 2.0;\n\tcolor = mix(color, u_vignetteColor, smoothstep(u_vignetteFrom, u_vignetteTo, d));\n\t\n\tgl_FragColor = vec4(mix(u_bgColor, color, u_opacity) + hash13(vec3(gl_FragCoord.xy, u_ditherSeed)) / 255.0, 1.0);\n}\n"]),blending:s.NoBlending},e))}t.exports=c;var h=r.prototype,d=c.prototype=Object.create(h);d.constructor=c,d.cachePreviousFrame=function(e){var t=e.width,n=e.height;this.cacheRenderTarget.setSize(t,n),this.uniforms.u_texture.value=e.toTexture,e.renderMaterial(this.material,e.fromRenderTarget),i.copy(e.fromRenderTarget.texture,this.cacheRenderTarget),e.swap()},d.needsRender=function(){return!0},d.render=function(e,t){var n=e.width,r=e.height;this.uniforms.u_vignetteFrom.value=this.vignetteFrom,this.uniforms.u_vignetteTo.value=this.vignetteTo,this.uniforms.u_vignetteAspect.value.set(n/r,1).multiplyScalar(r/Math.sqrt(n*n+r*r)),this.uniforms.u_saturation.value=this.saturation-1,this.uniforms.u_contrast.value=this.contrast,this.uniforms.u_brightness.value=this.brightness-1,this.uniforms.u_tintOpacity.value=this.tintOpacity,this.uniforms.u_opacity.value=this.opacity,this.uniforms.u_ditherSeed.value=1e3*Math.random();var i=this.hasCache?0:this.cacheBlendRatio,a=i>0;this.uniforms.u_texture.value=e.fromTexture,e.renderMaterial(this.material,t&&!a?null:e.toRenderTarget),a&&(e.swap(),this.transitionMaterial.uniforms.u_texture.value=e.fromTexture,this.transitionMaterial.uniforms.u_cacheBlendDirection.value=this.cacheBlendDirection,this.transitionMaterial.uniforms.u_cacheBlendRatio.value=i,e.renderMaterial(this.transitionMaterial,t?null:e.toRenderTarget));e.swap()}},{"../../effects/blueNoise/blueNoise":73,"../../helpers/fboHelper":79,"../../utils/math":104,"../PostEffect":90,glslify:26,"mout/object/merge":44,"mout/object/mixIn":45,three:63}],96:[function(e,t,n){"use strict";var r=e("../../helpers/fboHelper"),i=e("../PostEffect"),a=e("mout/object/merge"),o=e("three"),s=e("glslify");function l(e){e=a({},e),this.edgesRenderTarget=r.createRenderTarget(1,1),this.weightsRenderTarget=r.createRenderTarget(1,1,!0),this.uResolutionInv={value:new o.Vector2},u.constructor.call(this,a({uniforms:{u_weightsTexture:{value:this.weightsRenderTarget.texture},u_resolutionInv:this.uResolutionInv},vertexShader:r.precisionPrefix+s(["#define GLSLIFY 1\nattribute vec3 position;\n\nuniform vec2 u_resolutionInv;\n\nvarying vec2 v_uv;\nvarying vec4 v_offsets[ 2 ];\n\nvoid SMAANeighborhoodBlendingVS( vec2 texcoord ) {\n  v_offsets[ 0 ] = texcoord.xyxy + u_resolutionInv.xyxy * vec4( -1.0, 0.0, 0.0, 1.0 ); // WebGL port note: Changed sign in W component\n  v_offsets[ 1 ] = texcoord.xyxy + u_resolutionInv.xyxy * vec4( 1.0, 0.0, 0.0, -1.0 ); // WebGL port note: Changed sign in W component\n}\n\nvoid main() {\n\tv_uv = position.xy * 0.5 + 0.5;\n\n  SMAANeighborhoodBlendingVS( v_uv );\n\n  // gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n  gl_Position = vec4( position, 1.0 );\n\n}\n"]),fragmentShader:r.precisionPrefix+s(["#define GLSLIFY 1\nuniform sampler2D u_weightsTexture;\nuniform sampler2D u_texture;\nuniform vec2 u_resolutionInv;\n\nvarying vec2 v_uv;\nvarying vec4 v_offsets[ 2 ];\n\nvec4 SMAANeighborhoodBlendingPS( vec2 texcoord, vec4 offset[ 2 ], sampler2D colorTex, sampler2D blendTex ) {\n  // Fetch the blending weights for current pixel:\n  vec4 a;\n  a.xz = texture2D( blendTex, texcoord ).xz;\n  a.y = texture2D( blendTex, offset[ 1 ].zw ).g;\n  a.w = texture2D( blendTex, offset[ 1 ].xy ).a;\n\n  // Is there any blending weight with a value greater than 0.0?\n  if ( dot(a, vec4( 1.0, 1.0, 1.0, 1.0 )) < 1e-5 ) {\n    return texture2D( colorTex, texcoord, 0.0 );\n  } else {\n    // Up to 4 lines can be crossing a pixel (one through each edge). We\n    // favor blending by choosing the line with the maximum weight for each\n    // direction:\n    vec2 offset;\n    offset.x = a.a > a.b ? a.a : -a.b; // left vs. right\n    offset.y = a.g > a.r ? -a.g : a.r; // top vs. bottom // WebGL port note: Changed signs\n\n    // Then we go in the direction that has the maximum weight:\n    if ( abs( offset.x ) > abs( offset.y )) { // horizontal vs. vertical\n      offset.y = 0.0;\n    } else {\n      offset.x = 0.0;\n    }\n\n    // Fetch the opposite color and lerp by hand:\n    vec4 C = texture2D( colorTex, texcoord, 0.0 );\n    texcoord += sign( offset ) * u_resolutionInv;\n    vec4 Cop = texture2D( colorTex, texcoord, 0.0 );\n    float s = abs( offset.x ) > abs( offset.y ) ? abs( offset.x ) : abs( offset.y );\n\n    // WebGL port note: Added gamma correction\n    C.xyz = pow(abs(C.xyz), vec3(2.2));\n    Cop.xyz = pow(abs(Cop.xyz), vec3(2.2));\n    vec4 mixed = mix(C, Cop, s);\n    mixed.xyz = pow(abs(mixed.xyz), vec3(1.0 / 2.2));\n\n    return mixed;\n  }\n}\n\nvoid main() {\n\n  gl_FragColor = SMAANeighborhoodBlendingPS( v_uv, v_offsets, u_texture, u_weightsTexture );\n}\n"])},e)),this.edgesMaterial=new o.RawShaderMaterial({uniforms:{u_texture:{value:null},u_resolutionInv:this.uResolutionInv},vertexShader:r.precisionPrefix+s(["#define GLSLIFY 1\nattribute vec3 position;\n\nuniform vec2 u_resolutionInv;\n\nvarying vec2 v_uv;\nvarying vec4 v_offsets[ 3 ];\n\nvoid SMAAEdgeDetectionVS( vec2 texcoord ) {\n  v_offsets[ 0 ] = texcoord.xyxy + u_resolutionInv.xyxy * vec4( -1.0, 0.0, 0.0,  1.0 ); // WebGL port note: Changed sign in W component\n  v_offsets[ 1 ] = texcoord.xyxy + u_resolutionInv.xyxy * vec4(  1.0, 0.0, 0.0, -1.0 ); // WebGL port note: Changed sign in W component\n  v_offsets[ 2 ] = texcoord.xyxy + u_resolutionInv.xyxy * vec4( -2.0, 0.0, 0.0,  2.0 ); // WebGL port note: Changed sign in W component\n}\n\nvoid main() {\n\n\tv_uv = position.xy * 0.5 + 0.5;\n\n  SMAAEdgeDetectionVS( v_uv );\n\n  // gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n  gl_Position = vec4( position, 1.0 );\n\n}\n"]),fragmentShader:r.precisionPrefix+s(["#define GLSLIFY 1\nuniform sampler2D u_texture;\n\nvarying vec2 v_uv;\nvarying vec4 v_offsets[ 3 ];\n\nvec4 SMAAColorEdgeDetectionPS( vec2 texcoord, vec4 offset[3], sampler2D colorTex ) {\n  vec2 threshold = vec2( SMAA_THRESHOLD, SMAA_THRESHOLD );\n\n  // Calculate color deltas:\n  vec4 delta;\n  vec3 C = texture2D( colorTex, texcoord ).rgb;\n\n  vec3 Cleft = texture2D( colorTex, offset[0].xy ).rgb;\n  vec3 t = abs( C - Cleft );\n  delta.x = max( max( t.r, t.g ), t.b );\n\n  vec3 Ctop = texture2D( colorTex, offset[0].zw ).rgb;\n  t = abs( C - Ctop );\n  delta.y = max( max( t.r, t.g ), t.b );\n\n  // We do the usual threshold:\n  vec2 edges = step( threshold, delta.xy );\n\n  // Then discard if there is no edge:\n  if ( dot( edges, vec2( 1.0, 1.0 ) ) == 0.0 )\n    discard;\n\n  // Calculate right and bottom deltas:\n  vec3 Cright = texture2D( colorTex, offset[1].xy ).rgb;\n  t = abs( C - Cright );\n  delta.z = max( max( t.r, t.g ), t.b );\n\n  vec3 Cbottom  = texture2D( colorTex, offset[1].zw ).rgb;\n  t = abs( C - Cbottom );\n  delta.w = max( max( t.r, t.g ), t.b );\n\n  // Calculate the maximum delta in the direct neighborhood:\n  float maxDelta = max( max( max( delta.x, delta.y ), delta.z ), delta.w );\n\n  // Calculate left-left and top-top deltas:\n  vec3 Cleftleft  = texture2D( colorTex, offset[2].xy ).rgb;\n  t = abs( C - Cleftleft );\n  delta.z = max( max( t.r, t.g ), t.b );\n\n  vec3 Ctoptop = texture2D( colorTex, offset[2].zw ).rgb;\n  t = abs( C - Ctoptop );\n  delta.w = max( max( t.r, t.g ), t.b );\n\n  // Calculate the final maximum delta:\n  maxDelta = max( max( maxDelta, delta.z ), delta.w );\n\n  // Local contrast adaptation in action:\n  edges.xy *= step( 0.5 * maxDelta, delta.xy );\n\n  return vec4( edges, 0.0, 0.0 );\n}\n\nvoid main() {\n\n  gl_FragColor = SMAAColorEdgeDetectionPS( v_uv, v_offsets, u_texture );\n\n}\n"]),defines:{SMAA_THRESHOLD:"0.1"},blending:o.NoBlending,depthTest:!1,depthWrite:!1}),this.weightsMaterial=new o.RawShaderMaterial({uniforms:{u_edgesTexture:{value:this.edgesRenderTarget.texture},u_areaTexture:h.u_areaTexture,u_searchTexture:h.u_searchTexture,u_resolutionInv:this.uResolutionInv},vertexShader:r.precisionPrefix+s(["#define GLSLIFY 1\nattribute vec3 position;\n\nuniform vec2 u_resolutionInv;\n\nvarying vec2 v_uv;\nvarying vec4 v_offsets[ 3 ];\nvarying vec2 v_pixcoord;\n\nvoid SMAABlendingWeightCalculationVS( vec2 texcoord ) {\n  v_pixcoord = texcoord / u_resolutionInv;\n\n  // We will use these offsets for the searches later on (see @PSEUDO_GATHER4):\n  v_offsets[ 0 ] = texcoord.xyxy + u_resolutionInv.xyxy * vec4( -0.25, 0.125, 1.25, 0.125 ); // WebGL port note: Changed sign in Y and W components\n  v_offsets[ 1 ] = texcoord.xyxy + u_resolutionInv.xyxy * vec4( -0.125, 0.25, -0.125, -1.25 ); // WebGL port note: Changed sign in Y and W components\n\n  // And these for the searches, they indicate the ends of the loops:\n  v_offsets[ 2 ] = vec4( v_offsets[ 0 ].xz, v_offsets[ 1 ].yw ) + vec4( -2.0, 2.0, -2.0, 2.0 ) * u_resolutionInv.xxyy * float( SMAA_MAX_SEARCH_STEPS );\n\n}\n\nvoid main() {\n\tv_uv = position.xy * 0.5 + 0.5;\n\n  SMAABlendingWeightCalculationVS( v_uv );\n\n  // gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n  gl_Position = vec4( position, 1.0 );\n\n}\n"]),fragmentShader:r.precisionPrefix+s(["#define GLSLIFY 1\n#define SMAASampleLevelZeroOffset( tex, coord, offset ) texture2D( tex, coord + float( offset ) * u_resolutionInv, 0.0 )\n\nuniform sampler2D u_edgesTexture;\nuniform sampler2D u_areaTexture;\nuniform sampler2D u_searchTexture;\nuniform vec2 u_resolutionInv;\n\nvarying vec2 v_uv;\nvarying vec4 v_offsets[3];\nvarying vec2 v_pixcoord;\n\nvec2 round( vec2 x ) {\n  return sign( x ) * floor( abs( x ) + 0.5 );\n}\n\nfloat SMAASearchLength( sampler2D searchTex, vec2 e, float bias, float scale ) {\n  // Not required if searchTex accesses are set to point:\n  // float2 SEARCH_TEX_PIXEL_SIZE = 1.0 / float2(66.0, 33.0);\n  // e = float2(bias, 0.0) + 0.5 * SEARCH_TEX_PIXEL_SIZE +\n  //     e * float2(scale, 1.0) * float2(64.0, 32.0) * SEARCH_TEX_PIXEL_SIZE;\n  e.r = bias + e.r * scale;\n  return 255.0 * texture2D( searchTex, e, 0.0 ).r;\n}\n\nfloat SMAASearchXLeft( sampler2D edgesTex, sampler2D searchTex, vec2 texcoord, float end ) {\n  /**\n  * @PSEUDO_GATHER4\n  * This texcoord has been offset by (-0.25, -0.125) in the vertex shader to\n  * sample between edge, thus fetching four edges in a row.\n  * Sampling with different offsets in each direction allows to disambiguate\n  * which edges are active from the four fetched ones.\n  */\n  vec2 e = vec2( 0.0, 1.0 );\n\n  for ( int i = 0; i < SMAA_MAX_SEARCH_STEPS; i ++ ) { // WebGL port note: Changed while to for\n    e = texture2D( edgesTex, texcoord, 0.0 ).rg;\n    texcoord -= vec2( 2.0, 0.0 ) * u_resolutionInv;\n    if ( ! ( texcoord.x > end && e.g > 0.8281 && e.r == 0.0 ) ) break;\n  }\n\n  // We correct the previous (-0.25, -0.125) offset we applied:\n  texcoord.x += 0.25 * u_resolutionInv.x;\n\n  // The searches are bias by 1, so adjust the coords accordingly:\n  texcoord.x += u_resolutionInv.x;\n\n  // Disambiguate the length added by the last step:\n  texcoord.x += 2.0 * u_resolutionInv.x; // Undo last step\n  texcoord.x -= u_resolutionInv.x * SMAASearchLength(searchTex, e, 0.0, 0.5);\n\n  return texcoord.x;\n}\n\nfloat SMAASearchXRight( sampler2D edgesTex, sampler2D searchTex, vec2 texcoord, float end ) {\n  vec2 e = vec2( 0.0, 1.0 );\n\n  for ( int i = 0; i < SMAA_MAX_SEARCH_STEPS; i ++ ) { // WebGL port note: Changed while to for\n    e = texture2D( edgesTex, texcoord, 0.0 ).rg;\n    texcoord += vec2( 2.0, 0.0 ) * u_resolutionInv;\n    if ( ! ( texcoord.x < end && e.g > 0.8281 && e.r == 0.0 ) ) break;\n  }\n\n  texcoord.x -= 0.25 * u_resolutionInv.x;\n  texcoord.x -= u_resolutionInv.x;\n  texcoord.x -= 2.0 * u_resolutionInv.x;\n  texcoord.x += u_resolutionInv.x * SMAASearchLength( searchTex, e, 0.5, 0.5 );\n\n  return texcoord.x;\n}\n\nfloat SMAASearchYUp( sampler2D edgesTex, sampler2D searchTex, vec2 texcoord, float end ) {\n  vec2 e = vec2( 1.0, 0.0 );\n\n  for ( int i = 0; i < SMAA_MAX_SEARCH_STEPS; i ++ ) { // WebGL port note: Changed while to for\n    e = texture2D( edgesTex, texcoord, 0.0 ).rg;\n    texcoord += vec2( 0.0, 2.0 ) * u_resolutionInv; // WebGL port note: Changed sign\n    if ( ! ( texcoord.y > end && e.r > 0.8281 && e.g == 0.0 ) ) break;\n  }\n\n  texcoord.y -= 0.25 * u_resolutionInv.y; // WebGL port note: Changed sign\n  texcoord.y -= u_resolutionInv.y; // WebGL port note: Changed sign\n  texcoord.y -= 2.0 * u_resolutionInv.y; // WebGL port note: Changed sign\n  texcoord.y += u_resolutionInv.y * SMAASearchLength( searchTex, e.gr, 0.0, 0.5 ); // WebGL port note: Changed sign\n\n  return texcoord.y;\n}\n\nfloat SMAASearchYDown( sampler2D edgesTex, sampler2D searchTex, vec2 texcoord, float end ) {\n  vec2 e = vec2( 1.0, 0.0 );\n\n  for ( int i = 0; i < SMAA_MAX_SEARCH_STEPS; i ++ ) { // WebGL port note: Changed while to for\n    e = texture2D( edgesTex, texcoord, 0.0 ).rg;\n    texcoord -= vec2( 0.0, 2.0 ) * u_resolutionInv; // WebGL port note: Changed sign\n    if ( ! ( texcoord.y < end && e.r > 0.8281 && e.g == 0.0 ) ) break;\n  }\n\n  texcoord.y += 0.25 * u_resolutionInv.y; // WebGL port note: Changed sign\n  texcoord.y += u_resolutionInv.y; // WebGL port note: Changed sign\n  texcoord.y += 2.0 * u_resolutionInv.y; // WebGL port note: Changed sign\n  texcoord.y -= u_resolutionInv.y * SMAASearchLength( searchTex, e.gr, 0.5, 0.5 ); // WebGL port note: Changed sign\n\n  return texcoord.y;\n}\n\nvec2 SMAAArea( sampler2D areaTex, vec2 dist, float e1, float e2, float offset ) {\n  // Rounding prevents precision errors of bilinear filtering:\n  vec2 texcoord = float( SMAA_AREATEX_MAX_DISTANCE ) * round( 4.0 * vec2( e1, e2 ) ) + dist;\n\n  // We do a scale and bias for mapping to texel space:\n  texcoord = SMAA_AREATEX_PIXEL_SIZE * texcoord + ( 0.5 * SMAA_AREATEX_PIXEL_SIZE );\n\n  // Move to proper place, according to the subpixel offset:\n  texcoord.y += SMAA_AREATEX_SUBTEX_SIZE * offset;\n\n  return texture2D( areaTex, texcoord, 0.0 ).rg;\n}\n\nvec4 SMAABlendingWeightCalculationPS( vec2 texcoord, vec2 pixcoord, vec4 offset[ 3 ], sampler2D edgesTex, sampler2D areaTex, sampler2D searchTex, ivec4 subsampleIndices ) {\n  vec4 weights = vec4( 0.0, 0.0, 0.0, 0.0 );\n\n  vec2 e = texture2D( edgesTex, texcoord ).rg;\n\n  if ( e.g > 0.0 ) { // Edge at north\n    vec2 d;\n\n    // Find the distance to the left:\n    vec2 coords;\n    coords.x = SMAASearchXLeft( edgesTex, searchTex, offset[ 0 ].xy, offset[ 2 ].x );\n    coords.y = offset[ 1 ].y; // offset[1].y = texcoord.y - 0.25 * u_resolutionInv.y (@CROSSING_OFFSET)\n    d.x = coords.x;\n\n    // Now fetch the left crossing edges, two at a time using bilinear\n    // filtering. Sampling at -0.25 (see @CROSSING_OFFSET) enables to\n    // discern what value each edge has:\n    float e1 = texture2D( edgesTex, coords, 0.0 ).r;\n\n    // Find the distance to the right:\n    coords.x = SMAASearchXRight( edgesTex, searchTex, offset[ 0 ].zw, offset[ 2 ].y );\n    d.y = coords.x;\n\n    // We want the distances to be in pixel units (doing this here allow to\n    // better interleave arithmetic and memory accesses):\n    d = d / u_resolutionInv.x - pixcoord.x;\n\n    // SMAAArea below needs a sqrt, as the areas texture is compressed\n    // quadratically:\n    vec2 sqrt_d = sqrt( abs( d ) );\n\n    // Fetch the right crossing edges:\n    coords.y -= 1.0 * u_resolutionInv.y; // WebGL port note: Added\n    float e2 = SMAASampleLevelZeroOffset( edgesTex, coords, ivec2( 1, 0 ) ).r;\n\n    // Ok, we know how this pattern looks like, now it is time for getting\n    // the actual area:\n    weights.rg = SMAAArea( areaTex, sqrt_d, e1, e2, float( subsampleIndices.y ) );\n  }\n\n  if ( e.r > 0.0 ) { // Edge at west\n    vec2 d;\n\n    // Find the distance to the top:\n    vec2 coords;\n\n    coords.y = SMAASearchYUp( edgesTex, searchTex, offset[ 1 ].xy, offset[ 2 ].z );\n    coords.x = offset[ 0 ].x; // offset[1].x = texcoord.x - 0.25 * u_resolutionInv.x;\n    d.x = coords.y;\n\n    // Fetch the top crossing edges:\n    float e1 = texture2D( edgesTex, coords, 0.0 ).g;\n\n    // Find the distance to the bottom:\n    coords.y = SMAASearchYDown( edgesTex, searchTex, offset[ 1 ].zw, offset[ 2 ].w );\n    d.y = coords.y;\n\n    // We want the distances to be in pixel units:\n    d = d / u_resolutionInv.y - pixcoord.y;\n\n    // SMAAArea below needs a sqrt, as the areas texture is compressed\n    // quadratically:\n    vec2 sqrt_d = sqrt( abs( d ) );\n\n    // Fetch the bottom crossing edges:\n    coords.y -= 1.0 * u_resolutionInv.y; // WebGL port note: Added\n    float e2 = SMAASampleLevelZeroOffset( edgesTex, coords, ivec2( 0, 1 ) ).g;\n\n    // Get the area for this direction:\n    weights.ba = SMAAArea( areaTex, sqrt_d, e1, e2, float( subsampleIndices.x ) );\n  }\n\n  return weights;\n}\n\nvoid main() {\n\n  gl_FragColor = SMAABlendingWeightCalculationPS( v_uv, v_pixcoord, v_offsets, u_edgesTexture, u_areaTexture, u_searchTexture, ivec4( 0.0 ) );\n\n}\n"]),defines:{SMAA_MAX_SEARCH_STEPS:"8",SMAA_AREATEX_MAX_DISTANCE:"16",SMAA_AREATEX_PIXEL_SIZE:"( 1.0 / vec2( 160.0, 560.0 ) )",SMAA_AREATEX_SUBTEX_SIZE:"( 1.0 / 7.0 )"},transparent:!0,blending:o.NoBlending,depthTest:!1,depthWrite:!1})}var u=i.prototype,c=l.prototype=Object.create(u);c.constructor=l,c.setPostprocessing=function(e){u.setPostprocessing.call(this,e);var t=e.width,n=e.height;this.edgesRenderTarget.setSize(t,n),this.weightsRenderTarget.setSize(t,n),this.uResolutionInv.value.set(1/t,1/n)},c.dispose=function(){this.edgesRenderTarget&&this.edgesRenderTarget.dispose();this.weightsRenderTarget&&this.weightsRenderTarget.dispose()},c.needsRender=function(){return!h.u_areaTexture.value.needsUpdate},c.render=function(e,t){var n=r.getColorState();h.u_searchTexture.value||console.warn("You need to use Smaa.setImages() to set the smaa textures manually and assign to this class.");var i=r.renderer;i.autoClear=!0,i.setClearColor(0,0),this.edgesMaterial.uniforms.u_texture.value=e.fromTexture,e.renderMaterial(this.edgesMaterial,this.edgesRenderTarget,!0),e.renderMaterial(this.weightsMaterial,this.weightsRenderTarget,!0),r.setColorState(n),this.material.uniforms.u_texture.value=e.fromTexture,u.render.call(this,e,t)},(n=t.exports=l).setTextures=function(e,t){var n;(n=h.u_areaTexture.value=d(e)).format=o.RGBFormat,n.minFilter=o.LinearFilter,(n=h.u_searchTexture.value=d(t)).magFilter=o.NearestFilter,n.minFilter=o.NearestFilter},n.updateTextures=function(){h.u_areaTexture.value.needsUpdate=!0,h.u_searchTexture.value.needsUpdate=!0};var h={u_areaTexture:{value:null},u_searchTexture:{value:null}};function d(e){var t=new o.Texture(e);return t.generateMipmaps=!1,t.flipY=!1,t}},{"../../helpers/fboHelper":79,"../PostEffect":90,glslify:26,"mout/object/merge":44,three:63}],97:[function(e,t,n){"use strict";var r=e("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(n,"__esModule",{value:!0}),n.Cinematic=void 0;var i=r(e("@babel/runtime/helpers/classCallCheck")),a=r(e("@babel/runtime/helpers/createClass")),o=r(e("@babel/runtime/helpers/defineProperty")),s=e("./RandomText"),l=e("../../input/input"),u=e("../../core/properties"),c=e("../../utils/math"),h=e("../../core/settings"),d=function(){function e(){(0,i.default)(this,e),(0,o.default)(this,"_header",void 0),(0,o.default)(this,"_stageNavBtns",void 0),(0,o.default)(this,"_footer",void 0),(0,o.default)(this,"_cinematicBars",void 0),(0,o.default)(this,"_cinematicHeadline",void 0),(0,o.default)(this,"_cinematicHeader",void 0),(0,o.default)(this,"_cinematicGrid",void 0),(0,o.default)(this,"_cinematicFooter",void 0),(0,o.default)(this,"_cinematicText",void 0),(0,o.default)(this,"_cinematicDataLinesAndBars",void 0),(0,o.default)(this,"_cinematicGridRects",void 0),(0,o.default)(this,"_arrayTextAnimation",[]),(0,o.default)(this,"_cinematicPointerDataCopies",void 0),(0,o.default)(this,"_time",void 0),(0,o.default)(this,"_isActive",void 0),(0,o.default)(this,"_timeout",void 0),(0,o.default)(this,"_tlFadeIn",gsap.timeline({paused:!0}))}return(0,a.default)(e,[{key:"preInit",value:function(){this._header=document.querySelector("header"),this._stageNavBtns=document.querySelectorAll(".stage-nav-btn"),this._footer=document.querySelector("footer"),this._cinematicBars=document.querySelectorAll(".cinematic-bar"),this._cinematicHeadline=document.querySelector("#cinematic-header-headline h2"),this._cinematicHeader=document.getElementById("cinematic-header"),this._cinematicGrid=document.getElementById("cinematic-grid"),this._cinematicFooter=document.getElementById("cinematic-footer"),this._cinematicText=document.querySelectorAll(".cinematic-copy"),this._cinematicGridRects=document.querySelectorAll(".grid-rect"),this._cinematicPointerDataCopies=document.getElementById("cinematic-footer-pointerData").getElementsByClassName("cinematic-copy"),this._cinematicDataLinesAndBars=document.querySelectorAll(".data-lines-and-bars"),this._time=document.getElementById("cinematic-time"),u.cinematicRatio=0,this.init()}},{key:"init",value:function(){this._initFadeInAnimation(),this._createRandomText()}},{key:"_initFadeInAnimation",value:function(){this._tlFadeIn.to(this._header,{opacity:0,y:10,duration:.12},0).to(this._stageNavBtns,{opacity:0,duration:.12},0).to(this._footer,{opacity:0,y:-10,duration:.12},0).to(this._cinematicBars,{y:0,duration:.4},.2).to(this._cinematicGrid,{opacity:1},.25).to(this._cinematicDataLinesAndBars,{opacity:1,scaleX:1,duration:.35,ease:"Power2.easeInOut",stagger:{each:.2}},.26).to(this._cinematicHeader,{opacity:1},.27).to(this._cinematicFooter,{opacity:1},.28)}},{key:"_createRandomText",value:function(){var e=this;this._cinematicText.forEach((function(t){var n=new s.RandomText;n.init({elem:t});var r=t.innerHTML;n.changeText(r),e._arrayTextAnimation.push(n)}))}},{key:"show",value:function(){var e=this;this._isActive=!0,this._tlFadeIn.play(),clearTimeout(this._timeout),this._timeout=setTimeout((function(){for(var t=0;t<e._arrayTextAnimation.length;t++)e._arrayTextAnimation[t].show()}),250),u.cinematicIsActive.dispatch()}},{key:"hide",value:function(){var e=this;this._isActive=!1,this._tlFadeIn.reverse(),clearTimeout(this._timeout),this._timeout=setTimeout((function(){for(var t=0;t<e._arrayTextAnimation.length;t++)e._arrayTextAnimation[t].hide()}),800)}},{key:"setHeadline",value:function(e){this._cinematicHeadline.innerText="IN ".concat(h["STAGE_".concat(e.index,"_ID")]," VIEW").toUpperCase()}},{key:"updateTime",value:function(){this._time.innerText=u.time.toFixed(2)}},{key:"updatePointerData",value:function(){this._cinematicPointerDataCopies[1].innerText=l.mousePixelXY.x.toFixed(3),this._cinematicPointerDataCopies[2].innerText=l.mousePixelXY.y.toFixed(3)}},{key:"updateRectsPosition",value:function(){this._cinematicGridRects.forEach((function(e,t){var n=5*Math.random(),r=(Math.random(),100+100*l.mouseXY.x*Math.max(t,.75)),i=-100*l.mouseXY.y*Math.max(t,.75)-100;e.style.transform="translate3d( ".concat(r,"px, ").concat(i,"px, 0)"),e.style.opacity=c.clamp(n,0,.5)}))}},{key:"update",value:function(e){u.cinematicRatio=c.saturate(u.cinematicRatio+(this._isActive?e:-e));for(var t=0;t<this._arrayTextAnimation.length;t++)this._arrayTextAnimation[t].update(e);this._isActive&&(this.updateTime(),this.updatePointerData())}}]),e}();n.Cinematic=d},{"../../core/properties":71,"../../core/settings":72,"../../input/input":83,"../../utils/math":104,"./RandomText":99,"@babel/runtime/helpers/classCallCheck":6,"@babel/runtime/helpers/createClass":7,"@babel/runtime/helpers/defineProperty":8,"@babel/runtime/helpers/interopRequireDefault":12}],98:[function(e,t,n){"use strict";var r=e("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(n,"__esModule",{value:!0}),n.Hold=void 0;var i=r(e("@babel/runtime/helpers/classCallCheck")),a=r(e("@babel/runtime/helpers/createClass")),o=r(e("@babel/runtime/helpers/defineProperty")),s=e("../../utils/math"),l=r(e("../../input/input")),u=e("min-signal"),c=function(){function e(){(0,i.default)(this,e),(0,o.default)(this,"_uiEle",void 0),(0,o.default)(this,"_btn",void 0),(0,o.default)(this,"_innerCicle",void 0),(0,o.default)(this,"_outerCircle",void 0),(0,o.default)(this,"_circlePath",void 0),(0,o.default)(this,"_text",void 0),(0,o.default)(this,"_allowAnimation",!1),(0,o.default)(this,"_hasStarted",!1),(0,o.default)(this,"state",{isHolding:!1,position:{},x:{previous:0,current:0},y:{previous:0,current:0},x2:{previous:0,current:0},y2:{previous:0,current:0},scale:{previous:1,current:1},angle:{previous:0,current:0},squeeze:{previous:0,current:0}}),(0,o.default)(this,"onMouseDown",new u),(0,o.default)(this,"onMouseUp",new u),(0,o.default)(this,"_tlHoldIn",gsap.timeline({paused:!0}))}return(0,a.default)(e,[{key:"preInit",value:function(){var e=this;this._uiEl=document.getElementById("ui"),this._btn=document.querySelector(".hold-interaction"),this._outerCicleGroup=document.querySelector(".holdOuterCircle"),this._innerCircleGroup=document.querySelector(".holdInnerCircle"),this._outerCircle=document.querySelector(".hold__outerCircle"),this._circlePath=document.querySelector(".hold__outerCirclePath"),this._text=document.querySelector(".hold-interaction--text"),this._links=document.querySelectorAll(".link"),l.default.onDowned.add(this.onPointerdown,this),l.default.onUped.add(this.onPointerup,this),this._links.forEach((function(t){t.addEventListener("mouseenter",(function(t){return e.hide(t)})),t.addEventListener("mouseleave",(function(t){return e.show(t)}))})),this.init()}},{key:"init",value:function(){this.initHoldAnimation(),this.getPosition()}},{key:"initHoldAnimation",value:function(){var e=this;this._tlHoldIn.to(this._circlePath,{strokeDashoffset:0}).to(this._outerCicleGroup,{opacity:1,duration:.5}).to(this._text,{opacity:1,ease:"Power3.easeInOut",onComplete:function(){e.state.isHolding=!0}},0)}},{key:"getPosition",value:function(){this.state.position=this._outerCicleGroup.getBoundingClientRect()}},{key:"getSqueeze",value:function(e,t){var n=(0,s.distanceTo)(e,t);return 10*Math.min(n/1500,.1)}},{key:"onPointerdown",value:function(e){e.target===this._uiEl&&(this.state.isHolding=!0,this.onMouseDown.dispatch(),this._tlHoldIn.play())}},{key:"onPointerup",value:function(){this.state.isHolding&&(this.state.isHolding=!1,this.onMouseUp.dispatch(),this._tlHoldIn.reverse())}},{key:"show",value:function(e){this.state.scale.current=1}},{key:"hide",value:function(e){this.state.scale.current=0}},{key:"update",value:function(){var e=this.state.position,t=e.width,n=e.height;for(var r in this.state.x.current=this.state.x2.current=l.default.mousePixelXY.x-t/2,this.state.y.current=this.state.y2.current=l.default.mousePixelXY.y-n/2,this.state)Math.abs(this.state[r].previous-this.state[r].current)>.001&&(this._allowAnimation=!0,this.state[r].previous=(0,s.lerp)(this.state[r].previous,this.state[r].current,"x2"==r||"y2"==r?.08:.15));!this._hasStarted&&l.default.hasInteracted&&(this._hasStarted=!0,this._allowAnimation=!0,this._btn.style.opacity=1,this.state.x.previous=this.state.x.current,this.state.y.previous=this.state.y.current,this.state.x2.previous=this.state.x2.current,this.state.y2.previous=this.state.y2.current);var i=Math.round(this.state.x.current-this.state.x.previous),a=Math.round(this.state.y.current-this.state.y.previous);this.state.squeeze.current=this.getSqueeze(i,a),this.state.angle.current=(0,s.getAngle)(i,a);var o="translateX(".concat(this.state.x.previous,"px) translateY(").concat(this.state.y.previous,"px) scale(").concat(this.state.scale.previous,")"),u="translateX(".concat(this.state.x2.previous,"px) translateY(").concat(this.state.y2.previous,"px) scale(").concat(this.state.scale.previous,")"),c="scale(".concat(1+.35*this.state.squeeze.current,", ").concat(1+.35*this.state.squeeze.current,")"),h="scale(".concat(1+this.state.squeeze.current,", ").concat(1-.5*this.state.squeeze.current,")"),d="rotate(".concat(this.state.angle.current,"deg)");this._allowAnimation&&(this._innerCircleGroup.style.transform=o+d+h,this._text.style.transform=u,this.state.isHolding?this._outerCicleGroup.style.transform=u:this._outerCicleGroup.style.transform=u+c)}}]),e}();n.Hold=c},{"../../input/input":83,"../../utils/math":104,"@babel/runtime/helpers/classCallCheck":6,"@babel/runtime/helpers/createClass":7,"@babel/runtime/helpers/defineProperty":8,"@babel/runtime/helpers/interopRequireDefault":12,"min-signal":29}],99:[function(e,t,n){"use strict";var r=e("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(n,"__esModule",{value:!0}),n.default=n.RandomText=void 0;var i=r(e("@babel/runtime/helpers/classCallCheck")),a=r(e("@babel/runtime/helpers/createClass")),o=r(e("@babel/runtime/helpers/defineProperty")),s=e("../../utils/math"),l=function(){function e(){(0,i.default)(this,e),(0,o.default)(this,"elem",null),(0,o.default)(this,"cps",60),(0,o.default)(this,"maxTextDuration",1),(0,o.default)(this,"useBlinkEffect",!0),(0,o.default)(this,"blinkDuration",1),(0,o.default)(this,"_text",""),(0,o.default)(this,"_isActive",!1),(0,o.default)(this,"_charTime",0),(0,o.default)(this,"_blinkRatio",0),(0,o.default)(this,"_prevText",""),(0,o.default)(this,"_prevOpacity",-1)}return(0,a.default)(e,[{key:"init",value:function(e){Object.assign(this,e),this.changeText(this.elem.innerHTML)}},{key:"changeText",value:function(e){this._text=e||"",this._charTime=0,this.elem.innerHTML=e||""}},{key:"toggleVisibility",value:function(){this._isActive?this.hide():this.show()}},{key:"show",value:function(){this._isActive=!0}},{key:"hide",value:function(){this._isActive=!1}},{key:"update",value:function(e){e=this._isActive?e:-e;var t=Math.max(this.cps,this._text.length/this.maxTextDuration);this._charTime=s.clamp(this._charTime+e,0,this._text.length/t);var n,r=Math.min(this._text.length,this._charTime*t);if(n=0==r?"":r<this._text.length?this._text.substr(0,r)+String.fromCharCode(33+~~(94*Math.random())):this._text,this._prevText!==n&&(this.elem.innerHTML=n,this._prevText=n),this.useBlinkEffect){this._blinkRatio=s.clamp(this._blinkRatio+e/this.blinkDuration,0,1);var i=s.clamp(this._blinkRatio+Math.random()*Math.random()*s.smoothstep(0,.5,this._blinkRatio),0,1);this._prevOpacity!==i&&(this.elem.style.opacity=i,this._prevOpacity=i)}}}]),e}();n.RandomText=l;var u=new l;n.default=u},{"../../utils/math":104,"@babel/runtime/helpers/classCallCheck":6,"@babel/runtime/helpers/createClass":7,"@babel/runtime/helpers/defineProperty":8,"@babel/runtime/helpers/interopRequireDefault":12}],100:[function(e,t,n){"use strict";var r=e("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(n,"__esModule",{value:!0}),n.About=void 0;var i=r(e("@babel/runtime/helpers/classCallCheck")),a=r(e("@babel/runtime/helpers/createClass")),o=r(e("@babel/runtime/helpers/defineProperty")),s=e("gsap"),l=e("../../libs/gsap/CustomEase").default,u=e("../../core/browser"),c=e("../../audios/audios"),h=function(){function e(){(0,i.default)(this,e),(0,o.default)(this,"_about",void 0),(0,o.default)(this,"_aboutCloseBtn",void 0),(0,o.default)(this,"_aboutStar",void 0),(0,o.default)(this,"_aboutExploreBtn",void 0),(0,o.default)(this,"_aboutExploreBtnArrow",void 0),(0,o.default)(this,"_aboutExploreBtnText",void 0),(0,o.default)(this,"_hideTimeout",void 0),(0,o.default)(this,"_tlFadeIn",s.gsap.timeline({paused:!0})),(0,o.default)(this,"_tlFadeOut",s.gsap.timeline({paused:!0})),(0,o.default)(this,"_tlHover",s.gsap.timeline({paused:!0}))}return(0,a.default)(e,[{key:"preInit",value:function(){var e=this;this._about=document.getElementById("about"),this._aboutCloseBtn=document.getElementById("about-exit--close-btn"),this._aboutStar=document.getElementById("about-star"),this._aboutExploreBtn=document.querySelector(".explore-btn"),this._aboutExploreBtnArrow=document.querySelector(".explore-btn--arrow"),this._aboutExploreBtnText=document.querySelector(".explore-btn--text"),this._aboutExploreBtn.addEventListener("mouseenter",(function(){return e._onMouseEnter()}),!1),this._aboutExploreBtn.addEventListener("mouseleave",(function(){return e._onMouseLeave()}),!1),this._aboutCloseBtn.addEventListener("click",(function(){return e._hide()}),!1),this.init()}},{key:"init",value:function(){this._initFadeInAnimation(),this._initFadeOutAnimation(),this._initHoverAnimation()}},{key:"addLinkHoverEvents",value:function(){for(var e=this,t=this._about.querySelectorAll("a"),n=function(){return e._onLinkHover()},r=0,i=t.length;r<i;r++)t[r].addEventListener("mouseenter",n,!1);this._aboutCloseBtn.addEventListener("mouseenter",n,!1)}},{key:"_onLinkHover",value:function(){c.playHover()}},{key:"_initFadeInAnimation",value:function(){this._tlFadeIn.set(this._aboutStar,{y:u.isMobile?-60:-90}).to(this._about,{opacity:1}).to(this._aboutStar,{y:0,duration:.3,ease:"Power3.EaseInOut"}).fromTo(this._aboutExploreBtn,{opacity:0,y:20},{opacity:1,y:0})}},{key:"_initFadeOutAnimation",value:function(){this._tlFadeOut.to(this._aboutStar,{y:u.isMobile?-60:-90,duration:.3,ease:"Power3.EaseInOut"}).to(this._about,{opacity:0})}},{key:"_initHoverAnimation",value:function(){this._tlHover.to(this._aboutExploreBtnArrow,{x:30,duration:1,ease:l.create("easeCubic","0.42, 0, 0, 0.99")},0).to(this._aboutExploreBtnText,{x:35,duration:.85,ease:l.create("easeCubic","0.42, 0, 0, 0.99")},.2)}},{key:"_show",value:function(){clearTimeout(this._hideTimeout),this._about.style.pointerEvents="auto",this._about.style.display="inline-block",this._tlFadeIn.restart()}},{key:"_hide",value:function(){var e=this;clearTimeout(this._hideTimeout),this._about.style.pointerEvents="none",this._tlFadeOut.restart(),this._hideTimeout=setTimeout((function(){e._about.style.display="none"}),1e3)}},{key:"_onClickClose",value:function(e){}},{key:"_onMouseEnter",value:function(){this._tlHover.play()}},{key:"_onMouseLeave",value:function(){this._tlHover.pause(),this._tlHover.reverse()}},{key:"update",value:function(){}},{key:"resize",value:function(){}}]),e}();n.About=h},{"../../audios/audios":66,"../../core/browser":70,"../../libs/gsap/CustomEase":84,"@babel/runtime/helpers/classCallCheck":6,"@babel/runtime/helpers/createClass":7,"@babel/runtime/helpers/defineProperty":8,"@babel/runtime/helpers/interopRequireDefault":12,gsap:27}],101:[function(e,t,n){"use strict";var r=e("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(n,"__esModule",{value:!0}),n.Preloader=void 0;var i=r(e("@babel/runtime/helpers/classCallCheck")),a=r(e("@babel/runtime/helpers/createClass")),o=r(e("@babel/runtime/helpers/defineProperty")),s=e("gsap"),l=e("../../core/settings"),u=e("../../core/properties"),c=function(){function e(){(0,i.default)(this,e),(0,o.default)(this,"_percent",0),(0,o.default)(this,"_targetPercent",0),(0,o.default)(this,"_cb",void 0),(0,o.default)(this,"_container",void 0),(0,o.default)(this,"_logo",void 0),(0,o.default)(this,"_text",void 0),(0,o.default)(this,"_startPreloadAnimation",!1),(0,o.default)(this,"_isCompleted",!1)}return(0,a.default)(e,[{key:"preInit",value:function(e){var t=this;this._container=document.getElementById("preloader"),this._logo=document.getElementById("preloader-logo-title"),this._text=document.getElementById("preloader-text"),this._cb=e,u.loader.start((function(e){t._targetPercent=e})),this.show()}},{key:"show",value:function(){var e=this;this._container.classList.add("is-active"),s.gsap.set(this._text,{x:-20,force3D:!0}),s.gsap.to(this._text,{duration:.4,delay:.5,x:0,opacity:1,ease:Cubic.easeOut,onComplete:function(){e._startPreloadAnimation=!0}}),l.SKIP_ANIMATION&&(this._startPreloadAnimation=!0)}},{key:"hide",value:function(){var e=this;this._container.classList.remove("is-active"),s.gsap.to(this._logo,{duration:.75,x:-10,opacity:0,ease:Cubic.easeIn}),s.gsap.to(this._text,{duration:.4,delay:.5,x:20,opacity:0,ease:Cubic.easeOutIn}),s.gsap.to(this._container,{opacity:0,onComplete:function(){e._container.remove()}})}},{key:"update",value:function(e){this._percent=Math.min(this._targetPercent,this._percent+(l.SKIP_ANIMATION?1:e/1.5)),1==this._percent&&(this._isCompleted||(this._isCompleted=!0,document.documentElement.classList.add("is-ready"),this.hide(),this._cb()))}}]),e}();n.Preloader=c},{"../../core/properties":71,"../../core/settings":72,"@babel/runtime/helpers/classCallCheck":6,"@babel/runtime/helpers/createClass":7,"@babel/runtime/helpers/defineProperty":8,"@babel/runtime/helpers/interopRequireDefault":12,gsap:27}],102:[function(e,t,n){"use strict";var r,i,a,o,s,l,u,c=e("./pages/AboutPage"),h=e("./pages/PreloaderPage"),d=e("./components/CinematicOverlay"),f=e("./components/Hold"),p=e("../libs/splitting"),v=e("../core/browser"),m=(e("../core/settings"),e("../core/properties")),g=e("../visuals/stages"),_=e("../audios/audios"),y=e("../utils/math"),x=e("../utils/ease");function b(){if(l){var e=+this.dataset.id;l.index!=e&&_.playHover()}}function w(){if(l){var e=+this.dataset.id;l.index!=e&&g.changeTo(e)}}function T(e){if(l=e,u.setHeadline(l),o){var t=o;t.style.pointerEvents="none",gsap.to(s,{duration:.3,stagger:-.05,opacity:0,force3D:!0,x:-20,onComplete:function(){t.parentNode.removeChild(t)}});for(var n=0;n<s.length;n++){var r=s[n];r.__data=null,r.removeEventListener("click",S),v.isMobile||r.addEventListener("mouseenter",M)}}(o=document.createElement("div")).className="themes-selector-options-wrapper";for(var i=e.getThemes(),c="",h=0;h<i.length;h++)c+='<div class="themes-selector-option"><div class="themes-selector-option-color"></div></div>';o.innerHTML=c,s=o.querySelectorAll(".themes-selector-option-color"),gsap.set(s,{opacity:0,force3D:!0,x:-30}),gsap.to(s,{duration:.3,stagger:-.05,opacity:1,force3D:!0,x:0});for(var d=0;d<i.length;d++){var f=i[d],p=s[d];p.style.background="linear-gradient(126deg, ".concat(f.color1," 0%, ").concat(f.color2," 100%)"),p.dataset.color=f.color,p.classList.toggle("is-selected",!!f.isSelected),p.__data=f,p.addEventListener("click",S),v.isMobile||p.addEventListener("mouseenter",M)}a.appendChild(o)}function M(){this.classList.contains("is-selected")||_.playHover()}function S(){if((0!==l.index||!l.changeThemeIsActive)&&l.changeTheme(this.__data)){_.playChange();for(var e=0;e<s.length;e++){var t=s[e],n=this.__data===t.__data;t.__data.isSelected=n,t.classList.toggle("is-selected",n)}}}n.preInit=function(e){this._preloader=new h.Preloader,this._about=new c.About,u=new d.Cinematic,this._holdBtn=new f.Hold,this._preloader.preInit(e),this._about.preInit(),u.preInit(),this._holdBtn.preInit(),this._aboutBtn=document.querySelector(".header-more--about"),(0,p.splitText)()},n.init=function(){var e=this;r=document.querySelectorAll(".stage-nav-btn"),i=document.querySelectorAll(".stage-nav-btn-text-wrapper"),r.forEach((function(e){e.addEventListener("click",w),e.addEventListener("mouseenter",b)})),a=document.getElementById("themes-selector"),this._aboutBtn.addEventListener("click",(function(){e._about._show()}),!1),this._aboutBtn.addEventListener("mouseenter",(function(){_.playHover()}),!1),g.onChangeStarted.add(T),this._holdBtn.onMouseDown.add((function(){return u.show()})),this._holdBtn.onMouseUp.add((function(){return u.hide()})),this._about.addLinkHoverEvents()},n.start=function(){gsap.fromTo("#header-logo-title",{x:-20},{x:0,opacity:1,duration:.5})},n.resize=function(){u.resize()},n.update=function(e){if(this._preloader.update(e),u.update(e),m.hasInitialized){this._holdBtn.update(),r[0].style.transform="translate3d("+y.fit(g.currentIndexRatio-(1-m.showAnimation),.4,.8,-104,0,x.easeInOutCubic)+"%,0,0)",r[1].style.transform="translate3d("+y.fit(g.currentIndexRatio+(1-m.showAnimation),.2,.6,0,104,x.easeInOutCubic)+"%,0,0)";var t=v.isMobile?150:250;i[0].style.width=Math.min(m.showAnimation*t,y.fit(g.currentIndexRatio,.6,1,0,t,x.easeInOutCubic))+"px",i[1].style.width=Math.min(m.showAnimation*t,y.fit(g.currentIndexRatio,0,.4,t,0,x.easeInOutCubic))+"px"}}},{"../audios/audios":66,"../core/browser":70,"../core/properties":71,"../core/settings":72,"../libs/splitting":86,"../utils/ease":103,"../utils/math":104,"../visuals/stages":122,"./components/CinematicOverlay":97,"./components/Hold":98,"./pages/AboutPage":100,"./pages/PreloaderPage":101}],103:[function(e,t,n){"use strict";var r,i,a={Linear:{None:function(e){return e}},Quad:{In:function(e){return e*e},Out:function(e){return e*(2-e)},InOut:function(e){return(e*=2)<1?.5*e*e:-.5*(--e*(e-2)-1)}},Cubic:{In:function(e){return e*e*e},Out:function(e){return--e*e*e+1},InOut:function(e){return(e*=2)<1?.5*e*e*e:.5*((e-=2)*e*e+2)}},Quart:{In:function(e){return e*e*e*e},Out:function(e){return 1- --e*e*e*e},InOut:function(e){return(e*=2)<1?.5*e*e*e*e:-.5*((e-=2)*e*e*e-2)}},Quint:{In:function(e){return e*e*e*e*e},Out:function(e){return--e*e*e*e*e+1},InOut:function(e){return(e*=2)<1?.5*e*e*e*e*e:.5*((e-=2)*e*e*e*e+2)}},Sine:{In:function(e){return 1-Math.cos(e*Math.PI/2)},Out:function(e){return Math.sin(e*Math.PI/2)},InOut:function(e){return.5*(1-Math.cos(Math.PI*e))}},Expo:{In:function(e){return 0===e?0:Math.pow(1024,e-1)},Out:function(e){return 1===e?1:1-Math.pow(2,-10*e)},InOut:function(e){return 0===e?0:1===e?1:(e*=2)<1?.5*Math.pow(1024,e-1):.5*(2-Math.pow(2,-10*(e-1)))}},Circ:{In:function(e){return 1-Math.sqrt(1-e*e)},Out:function(e){return Math.sqrt(1- --e*e)},InOut:function(e){return(e*=2)<1?-.5*(Math.sqrt(1-e*e)-1):.5*(Math.sqrt(1-(e-=2)*e)+1)}},Elastic:{In:function(e){var t,n=.1;return 0===e?0:1===e?1:(!n||n<1?(n=1,t=.1):t=.4*Math.asin(1/n)/(2*Math.PI),-n*Math.pow(2,10*(e-=1))*Math.sin(2*(e-t)*Math.PI/.4))},Out:function(e){var t,n=.1;return 0===e?0:1===e?1:(!n||n<1?(n=1,t=.1):t=.4*Math.asin(1/n)/(2*Math.PI),n*Math.pow(2,-10*e)*Math.sin(2*(e-t)*Math.PI/.4)+1)},InOut:function(e){var t,n=.1,r=.4;return 0===e?0:1===e?1:(!n||n<1?(n=1,t=.1):t=r*Math.asin(1/n)/(2*Math.PI),(e*=2)<1?-.5*n*Math.pow(2,10*(e-=1))*Math.sin(2*(e-t)*Math.PI/r):n*Math.pow(2,-10*(e-=1))*Math.sin(2*(e-t)*Math.PI/r)*.5+1)}},Back:{In:function(e){var t=1.70158;return e*e*((t+1)*e-t)},Out:function(e){var t=1.70158;return--e*e*((t+1)*e+t)+1},InOut:function(e){var t=2.5949095;return(e*=2)<1?.5*e*e*((t+1)*e-t):.5*((e-=2)*e*((t+1)*e+t)+2)}},Bounce:{In:function(e){return 1-a.Bounce.Out(1-e)},Out:function(e){return e<1/2.75?7.5625*e*e:e<2/2.75?7.5625*(e-=1.5/2.75)*e+.75:e<2.5/2.75?7.5625*(e-=2.25/2.75)*e+.9375:7.5625*(e-=2.625/2.75)*e+.984375},InOut:function(e){return e<.5?.5*a.Bounce.In(2*e):.5*a.Bounce.Out(2*e-1)+.5}}};for(r in n.basic=a,n.linear=a.Linear,a)"Linear"!==r&&(i=a[r],n["easeIn"+r]=i.In,n["easeOut"+r]=i.Out,n["easeInOut"+r]=i.InOut)},{}],104:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.unMix=n.step=n.smoothstep=n.sign=n.saturate=n.powerTwoFloorBase=n.powerTwoFloor=n.powerTwoCeilingBase=n.powerTwoCeiling=n.normalize=n.mix=n.map=n.lerp=n.latLngDistance=n.latLngBearing=n.isPowerOfTwo=n.hash2=n.hash=n.getRandomFloat=n.getAngle=n.fract=n.fit=n.distanceTo3=n.distanceTo=n.distanceSqrTo3=n.distanceSqrTo=n.cubicBezierFn=n.cubicBezier=n.closestAngleTo=n.clamp=n.cUnMix=n.cMix=n.cMap=n.RAD2DEG=n.PI2=n.PI=n.HALF_PI=n.DEG2RAD=void 0;var r=Math.PI;n.PI=r;var i=2*r;n.PI2=i;var a=.5*r;n.HALF_PI=a;var o=r/180;n.DEG2RAD=o;var s=180/r;n.RAD2DEG=s;n.step=function(e,t){return t<e?0:1};var l=function(e,t,n){return e<t?t:e>n?n:e};n.clamp=l;n.mix=function(e,t,n){return e+(t-e)*n};n.cMix=function(e,t,n){return e+(t-e)*l(n,0,1)};n.unMix=function(e,t,n){return(n-e)/(t-e)};var u=function(e,t,n){return l((n-e)/(t-e),0,1)};n.cUnMix=u;n.saturate=function(e){return l(e,0,1)};var c=function(e,t,n,r,i){return r+(i-r)*(e-t)/(n-t)};n.map=c;n.cMap=function(e,t,n,r,i){return r+(i-r)*l((e-t)/(n-t),0,1)};n.fit=function(e,t,n,r,i,a){return e=u(t,n,e),a&&(e=a(e)),r+e*(i-r)};n.normalize=function(e,t,n){return c(e,t,n,0,1)};n.smoothstep=function(e,t,n){return(n=u(e,t,n))*n*(3-2*n)};var h=function(e){return e-Math.floor(e)};n.fract=h;n.hash=function(e){return h(43758.5453123*Math.sin(e))};n.hash2=function(e,t){return h(43758.5453*Math.sin(12.9898*e+4.1414*t))};n.sign=function(e){return e?e<0?-1:1:0};var d=function(e){return(e&-e)===e};n.isPowerOfTwo=d;var f=function(e){return Math.ceil(Math.log(e)/Math.log(2))};n.powerTwoCeilingBase=f;n.powerTwoCeiling=function(e){return d(e)?e:1<<f(e)};var p=function(e){return Math.floor(Math.log(e)/Math.log(2))};n.powerTwoFloorBase=p;n.powerTwoFloor=function(e){return d(e)?e:1<<p(e)};n.latLngBearing=function(e,t,n,r){var i=Math.sin(r-t)*Math.cos(n),a=Math.cos(e)*Math.sin(n)-Math.sin(e)*Math.cos(n)*Math.cos(r-t);return Math.atan2(i,a)};n.distanceTo=function(e,t){return Math.sqrt(e*e+t*t)};n.distanceSqrTo=function(e,t){return e*e+t*t};n.distanceTo3=function(e,t,n){return Math.sqrt(e*e+t*t+n*n)};n.distanceSqrTo3=function(e,t,n){return e*e+t*t+n*n};n.latLngDistance=function(e,t,n,r){var i=Math.sin((n-e)/2),a=Math.sin((r-t)/2),o=i*i+Math.cos(e)*Math.cos(n)*a*a;return 2*Math.atan2(Math.sqrt(o),Math.sqrt(1-o))};n.cubicBezier=function(e,t,n,r,i){var a=3*(t-e),o=3*(n-t)-a,s=i*i;return(r-e-a-o)*(s*i)+o*s+a*i+e};n.cubicBezierFn=function(e,t,n,r){var i=3*(t-e),a=3*(n-t)-i,o=r-e-i-a;return function(t){var n=t*t;return o*(n*t)+a*n+i*t+e}};n.closestAngleTo=function(e,t){var n=t-e;return n=(n+=r)<0?i-Math.abs(n%i):n%i,e+(n-=r)};n.getRandomFloat=function(e,t){return Math.random()*(t-e)+e};n.lerp=function(e,t,n){return(1-n)*e+n*t};n.getAngle=function(e,t){return 180*Math.atan2(t,e)/Math.PI}},{}],105:[function(e,t,n){"use strict";var r=e("@babel/runtime/helpers/interopRequireDefault"),i=r(e("@babel/runtime/helpers/classCallCheck")),a=r(e("@babel/runtime/helpers/createClass")),o=r(e("@babel/runtime/helpers/defineProperty")),s=e("../core/properties"),l=e("./VisualProfile"),u=e("three"),c=function(){function e(t,n){(0,i.default)(this,e),(0,o.default)(this,"container",null),(0,o.default)(this,"index",null),(0,o.default)(this,"visualProfile",null),(0,o.default)(this,"isActive",!1),(0,o.default)(this,"activeRatio",0),this.index=t,this.visualProfile=new l(n),this.container=new u.Object3D,this.container.visible=!1,this.container.matrixAutoUpdate=!1,this.container.userData.name="stage_".concat(t)}return(0,a.default)(e,[{key:"preInit",value:function(){}},{key:"init",value:function(){}},{key:"resize",value:function(e,t){}},{key:"update",value:function(e){}},{key:"getThemes",value:function(){return[]}},{key:"changeTheme",value:function(e){return!0}},{key:"show",value:function(){this.container.visible=!0,this.isActive=!0,this.visualProfile.apply(),s.orbitCamera.position.set(3,0,4)}},{key:"hide",value:function(){this.container.visible=!1,this.isActive=!1}},{key:"onDown",value:function(){}}]),e}();t.exports=c},{"../core/properties":71,"./VisualProfile":106,"@babel/runtime/helpers/classCallCheck":6,"@babel/runtime/helpers/createClass":7,"@babel/runtime/helpers/defineProperty":8,"@babel/runtime/helpers/interopRequireDefault":12,three:63}],106:[function(e,t,n){"use strict";var r=e("@babel/runtime/helpers/interopRequireDefault"),i=r(e("@babel/runtime/helpers/classCallCheck")),a=r(e("@babel/runtime/helpers/createClass")),o=r(e("@babel/runtime/helpers/defineProperty")),s=e("../core/properties"),l=e("mout/object/mixIn"),u=function(){function e(t){(0,i.default)(this,e),(0,o.default)(this,"config",{}),l(this.config,{bgColorHex:"#000000",opacity:1,bloomAmount:1.4,bloomRadius:0,bloomThreshold:.2,bloomSmoothWidth:.75,vignetteFrom:.6,vignetteTo:1.6,vignetteColorHex:"#000000",saturation:1,contrast:0,brightness:1,tintColorHex:"#0044ef",tintOpacity:.1,bokehAutoDistance:!1,bokehAmount:0,bokehFNumber:.181,bokehFocusDistance:2.515,bokehFocalLength:.344,bokehKFilmHeight:19.26,cameraLookX:0,cameraLookY:0,cameraLookStrength:.05,cameraLookEaseDamp:.075,cameraDistance:3,cameraShakePositionStrength:.06,cameraShakePositionSpeed:.3,cameraShakeRotationStrength:.03,cameraShakeRotationSpeed:.3,cameraShakeBlurAmount:0},t)}return(0,a.default)(e,[{key:"apply",value:function(){l(s,this.config)}}]),e}();t.exports=u},{"../core/properties":71,"@babel/runtime/helpers/classCallCheck":6,"@babel/runtime/helpers/createClass":7,"@babel/runtime/helpers/defineProperty":8,"@babel/runtime/helpers/interopRequireDefault":12,"mout/object/mixIn":45}],107:[function(e,t,n){"use strict";t.exports={frontLeft:{x:.901386,y:.374643,z:1.67812,isFlipped:!1},frontRight:{x:-.85745,y:.374643,z:1.67812,isFlipped:!0},backLeft:{x:.901386,y:.374643,z:-1.2346,isFlipped:!1},backRight:{x:-.85745,y:.374643,z:-1.2346,isFlipped:!0}}},{}],108:[function(e,t,n){"use strict";var r=e("@babel/runtime/helpers/interopRequireDefault"),i=r(e("@babel/runtime/regenerator")),a=r(e("@babel/runtime/helpers/asyncToGenerator")),o=e("../../../core/settings"),s=e("../../../core/properties"),l=e("three"),u=e("glslify"),c=e("../../../helpers/fboHelper"),h=e("../../../helpers/colorHelper"),d=e("gsap/gsap-core").gsap;n.preInit=function(){s.loader.add(o.TEXTURE_PATH+"gradient.jpg",{type:"texture",weight:200,onLoad:function(e){return m=e}}).content,s.loader.add(o.TEXTURE_PATH+"mask_gradient.jpg",{type:"texture",weight:200,onLoad:function(e){return g=e}}).content},n.init=function(e,t){p=new l.RawShaderMaterial({uniforms:x,vertexShader:c.vertexShader,fragmentShader:c.precisionPrefix+u(["#define GLSLIFY 1\n\nuniform float u_time;\nuniform float u_speed;\nuniform float u_size;\nuniform float u_resolution;\nvarying vec2 v_uv;\n\n//\n// Description : Array and textureless GLSL 2D/3D/4D simplex \n//               noise functions.\n//      Author : Ian McEwan, Ashima Arts.\n//  Maintainer : stegu\n//     Lastmod : 20110822 (ijm)\n//     License : Copyright (C) 2011 Ashima Arts. All rights reserved.\n//               Distributed under the MIT License. See LICENSE file.\n//               https://github.com/ashima/webgl-noise\n//               https://github.com/stegu/webgl-noise\n// \n\nvec3 mod289(vec3 x) {\n  return x - floor(x * (1.0 / 289.0)) * 289.0;\n}\n\nvec4 mod289(vec4 x) {\n  return x - floor(x * (1.0 / 289.0)) * 289.0;\n}\n\nvec4 permute(vec4 x) {\n     return mod289(((x*34.0)+1.0)*x);\n}\n\nvec4 taylorInvSqrt(vec4 r){\n  return 1.79284291400159 - 0.85373472095314 * r;\n}\n\nfloat snoise(vec3 v){ \n  const vec2  C = vec2(1.0/6.0, 1.0/3.0) ;\n  const vec4  D = vec4(0.0, 0.5, 1.0, 2.0);\n\n  // First corner\n  vec3 i  = floor(v + dot(v, C.yyy) );\n  vec3 x0 =   v - i + dot(i, C.xxx) ;\n\n  // Other corners\n  vec3 g = step(x0.yzx, x0.xyz);\n  vec3 l = 1.0 - g;\n  vec3 i1 = min( g.xyz, l.zxy );\n  vec3 i2 = max( g.xyz, l.zxy );\n\n  //   x0 = x0 - 0.0 + 0.0 * C.xxx;\n  //   x1 = x0 - i1  + 1.0 * C.xxx;\n  //   x2 = x0 - i2  + 2.0 * C.xxx;\n  //   x3 = x0 - 1.0 + 3.0 * C.xxx;\n  vec3 x1 = x0 - i1 + C.xxx;\n  vec3 x2 = x0 - i2 + C.yyy; // 2.0*C.x = 1/3 = C.y\n  vec3 x3 = x0 - D.yyy;      // -1.0+3.0*C.x = -0.5 = -D.y\n\n  // Permutations\n  i = mod289(i); \n  vec4 p = permute( permute( permute( \n             i.z + vec4(0.0, i1.z, i2.z, 1.0 ))\n           + i.y + vec4(0.0, i1.y, i2.y, 1.0 )) \n           + i.x + vec4(0.0, i1.x, i2.x, 1.0 ));\n\n  // Gradients: 7x7 points over a square, mapped onto an octahedron.\n  // The ring size 17*17 = 289 is close to a multiple of 49 (49*6 = 294)\n  float n_ = 0.142857142857; // 1.0/7.0\n  vec3  ns = n_ * D.wyz - D.xzx;\n\n  vec4 j = p - 49.0 * floor(p * ns.z * ns.z);  //  mod(p,7*7)\n\n  vec4 x_ = floor(j * ns.z);\n  vec4 y_ = floor(j - 7.0 * x_ );    // mod(j,N)\n\n  vec4 x = x_ *ns.x + ns.yyyy;\n  vec4 y = y_ *ns.x + ns.yyyy;\n  vec4 h = 1.0 - abs(x) - abs(y);\n\n  vec4 b0 = vec4( x.xy, y.xy );\n  vec4 b1 = vec4( x.zw, y.zw );\n\n  //vec4 s0 = vec4(lessThan(b0,0.0))*2.0 - 1.0;\n  //vec4 s1 = vec4(lessThan(b1,0.0))*2.0 - 1.0;\n  vec4 s0 = floor(b0)*2.0 + 1.0;\n  vec4 s1 = floor(b1)*2.0 + 1.0;\n  vec4 sh = -step(h, vec4(0.0));\n\n  vec4 a0 = b0.xzyw + s0.xzyw*sh.xxyy ;\n  vec4 a1 = b1.xzyw + s1.xzyw*sh.zzww ;\n\n  vec3 p0 = vec3(a0.xy,h.x);\n  vec3 p1 = vec3(a0.zw,h.y);\n  vec3 p2 = vec3(a1.xy,h.z);\n  vec3 p3 = vec3(a1.zw,h.w);\n\n  //Normalise gradients\n  vec4 norm = taylorInvSqrt(vec4(dot(p0,p0), dot(p1,p1), dot(p2, p2), dot(p3,p3)));\n  p0 *= norm.x;\n  p1 *= norm.y;\n  p2 *= norm.z;\n  p3 *= norm.w;\n\n  // Mix final noise value\n  vec4 m = max(0.6 - vec4(dot(x0,x0), dot(x1,x1), dot(x2,x2), dot(x3,x3)), 0.0);\n  m = m * m;\n  return 42.0 * dot( m*m, vec4( dot(p0,x0), dot(p1,x1), \n                                dot(p2,x2), dot(p3,x3) ) );\n}\n\nvoid main(){\t\n    //float val = snoise(vec3(uv.x * size, uv.y * size, iTime * speed)); lets see\n    float snoiseValue = snoise(vec3(v_uv.x * u_size - ( u_time * u_speed ), v_uv.y * u_size, 1.0)) * u_resolution;\n\n// snoiseValue *= smoothstep(0.001, 0.001, abs(snoiseValue)); // road stripe\n\n\t  gl_FragColor = vec4(snoiseValue);\n\n}"])}),v=c.createRenderTarget(120,120,!1);var r=function(){for(var e=[],t=120,n=120,r=y,i=0;i<t;i+=1)for(var a=0;a<n;a+=1){var o=new l.Vector3((i-t/2)*r,0,(a-n/2)*r);e.push(o)}return e}();if(_=function(e,t){var n=t.length,r=.125,i=new l.BoxBufferGeometry(r,r,r);i.translate(0,.0625,0);var a=new l.InstancedBufferGeometry;for(var o in i.attributes)a.setAttribute(o,i.attributes[o]);i.index&&a.setIndex(i.getIndex());for(var s=new Float32Array(3*n),h=0,d=0;h<n;h++){var p=t[h];s[d+0]=p.x,s[d+1]=p.y,s[d+2]=p.z,d+=3}return a.setAttribute("instancePositions",new l.InstancedBufferAttribute(s,3)),f=new l.InstancedMesh(a,new l.RawShaderMaterial({uniforms:{u_time:x.u_time,u_gridSize:x.u_gridSize,u_gridSpacing:x.u_gridSpacing,u_noiseTexture:{value:v.texture},u_diffLightPos:{value:new l.Vector3(0,12,0)},u_diffLightColor:{value:new l.Color(e.ground.diffLightColor)},u_diffLightIntensity:{value:e.ground.diffLightIntensity},u_mainColor:{value:new l.Color(e.ground.mainColor)},u_radialGradientTexture:{value:m},u_linearGradientTexture:{value:g},u_strength:{value:e.ground.maskStrength},u_progress:{value:0}},transparent:!0,vertexShader:u(["#define GLSLIFY 1\n\nattribute vec3 position; \nattribute vec3 normal; \nattribute vec3 instancePositions;\nattribute vec2 uv;\n\n//Built-in\nuniform mat4 modelViewMatrix;\nuniform mat4 projectionMatrix; \nuniform mat3 normalMatrix; \n\nuniform sampler2D u_noiseTexture;\nuniform float u_time;\nuniform float u_gridSize;\nuniform float u_gridSpacing;\n\nuniform sampler2D u_radialGradientTexture;\nuniform sampler2D u_linearGradientTexture;\n\nvarying vec3 v_viewPosition;\nvarying vec3 v_viewNormal;\nvarying float v_radialMaskValue;\nvarying float v_linearMaskValue;\nvarying vec3 v_position;\n//varying float v_ao;\n\nfloat getNoise (vec3 worldPos, sampler2D texture) {\n    vec2 noiseTextureUv =  worldPos.xz / (u_gridSize * u_gridSpacing) + 0.5;\n    noiseTextureUv.y = 1.0 - noiseTextureUv.y;\n    return texture2D(texture, noiseTextureUv).r;\n}\n\n// vec4 hash44(vec4 p4) {\n// \tp4 = fract(p4  * vec4(.1031, .1030, .0973, .1099));\n//     p4 += dot(p4, p4.wzxy+33.33);\n//     return fract((p4.xxyz+p4.yzzw)*p4.zywx);\n// }\n\nvoid main(){\n\n    vec3 offset = vec3(mod(u_time * 2.5, u_gridSpacing), 0.0, 0.0);\n\n    vec3 pos = position + offset;\n\n    // const int SAMPLE_COUNT = 16;\n    // float CUBE_SIZE = 0.125;\n\n    // float isBottom = pos.y < 0.01 ? 1.0 : 0.0;\n\n    float noiseValue = getNoise(instancePositions + offset, u_noiseTexture);\n\n    // if (pos.y < 0.01) {\n    //     vec3 heightSamplePosition = instancePositions;\n    //     heightSamplePosition += normal * CUBE_SIZE * isBottom;\n    //     noiseValue = min(getNoise(heightSamplePosition), noiseValue);\n    // }\n\n    v_radialMaskValue = getNoise(instancePositions + offset,u_radialGradientTexture);\n    v_linearMaskValue = getNoise(instancePositions + offset,u_linearGradientTexture);\n\n    pos.y += noiseValue;\n    pos += instancePositions;\n\n    // vec3 worldNormal = normal; // no rotation anyway\n\n    // float hitCount = 0.0;\n    // vec3 orgin = pos;\n    // for (int i = 0; i < SAMPLE_COUNT; i++) {\n    //     vec4 rand4 = hash44(vec4(pos.xzz + worldNormal, float(i)) * 10.0);\n\n    //     float sampleDist = (0.5 + pow(rand4.w, 1.0) * 5.0) * CUBE_SIZE;\n    //     vec3 sampleVec = normalize(worldNormal + normalize(rand4.xyz - 0.5) * 0.75);\n    //     sampleVec *= sampleDist;\n        \n    //     float sampleHeight = getNoise(orgin + sampleVec);\n    //     hitCount += step(noiseValue + 0.01, sampleHeight);\n    // }\n\n    // v_ao = 0.35 + pow((1.0 - float(hitCount) / float(SAMPLE_COUNT)), 0.5) * 0.65;\n\n    //Road strip\n    pos.y *= smoothstep(.75, 6.0, abs(pos.z)); \n    \n    v_position = pos;\n    \n    vec4 viewPosition = modelViewMatrix * vec4(pos, 1.0);\n    v_viewPosition = viewPosition.xyz;\n\n    v_viewNormal = normalMatrix * normal;\n    \n    gl_Position = projectionMatrix * modelViewMatrix * vec4( pos, 1.0 );\n}\n"]),fragmentShader:c.precisionPrefix+u(["#define GLSLIFY 1\nuniform vec3 u_diffLightPos;\nuniform vec3 u_diffLightColor;\nuniform float u_diffLightIntensity;\nuniform vec3 u_mainColor;\nuniform float u_progress;\nuniform float u_strength;\n\nvarying vec3 v_viewPosition;\nvarying vec3 v_viewNormal;\nvarying float v_radialMaskValue;\nvarying float v_linearMaskValue;\nvarying vec3 v_position;\n//varying float v_ao;\n\nvoid main(){\n  //vec3 color = vec3(v_ao);\n  vec3 viewNormal = normalize(v_viewNormal);\n\t\n  vec3 viewLightPos = u_diffLightPos;\n\tvec3 viewLightDir = normalize(viewLightPos - v_viewPosition);\n\n\tfloat diff = max(0.0, dot(viewNormal, viewLightDir)) * u_diffLightIntensity;\n  vec3 diffLight = diff * u_diffLightColor;\n  //float specLight = max(0.0, dot(reflect(normalize(v_viewPosition), viewNormal), viewLightDir));\n  \n\n  float range = 10.0 - u_progress * 10.0; \n  float visibility = (v_linearMaskValue - u_strength);\n  vec3 fadeColor = (u_mainColor.rgb + normalize((v_position.x) + range ) + visibility + u_progress) ;\n\n\tvec4 outputColor = vec4(mix(diffLight, fadeColor, 0.2),1.0);\n  \n  gl_FragColor = vec4(outputColor.rgb, v_radialMaskValue);\n\n  //gl_FragColor = vec4(outputColor.rgb + u_mainColor, v_radialMaskValue);\n\n\tfloat luma = dot(gl_FragColor.rgb, vec3(0.299, 0.587, 0.114));\n\n  float u_saturation = 0.5;\n  float u_contrast = 0.5;\n  float u_brightness = 0.0;\n\n\tgl_FragColor.rgb = mix(vec3(luma), gl_FragColor.rgb, 1.0 + u_saturation);\n\tgl_FragColor.rgb = 0.5 + (1.0 + u_contrast) * (gl_FragColor.rgb - 0.5);\n\tgl_FragColor.rgb += u_brightness;\n\n  if(gl_FragColor.a<.01)discard;\n}\n"])}),n)}(e,r),n.container.add(_),t){var i=t.addFolder("ground");i.addColor(s.ground,"mainColor").listen(),i.addColor(s.ground,"diffLightColor").listen(),i.add(s.ground,"diffLightIntensity",0,1,1e-5).listen(),i.add(s.ground,"maskStrength",0,2,1e-5).listen(),i.open()}},n.changeColors=function(e){return w.apply(this,arguments)},n.update=function(e){x.u_time.value+=e,c.render(p,v),o.LOOK_DEV_MODE&&window.dat&&(_.material.uniforms.u_diffLightColor.value.setStyle(s.ground.diffLightColor),_.material.uniforms.u_diffLightIntensity.value=s.ground.diffLightIntensity,_.material.uniforms.u_mainColor.value.setStyle(s.ground.mainColor),_.material.uniforms.u_strength.value=s.ground.maskStrength)},n.container=new l.Object3D,n.container.rotation.y=.5*Math.PI;var f,p,v,m,g,_,y=.125,x={u_time:{value:0},u_speed:{value:1},u_size:{value:4},u_resolution:{value:1},u_gridSize:{value:120},u_gridSpacing:{value:y}},b=!1;function w(){return(w=(0,a.default)(i.default.mark((function e(t){return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!b){e.next=2;break}return e.abrupt("return");case 2:return b=!0,s.ground.diffLightColor=t.ground.diffLightColor,s.ground.diffLightIntensity=t.ground.diffLightIntensity,s.ground.mainColor=t.ground.mainColor,s.ground.maskStrength=t.ground.maskStrength,e.abrupt("return",Promise.all([d.to(f.material.uniforms.u_strength,{value:1.25}),d.to(f.material.uniforms.u_strength,{value:0,duration:.5,delay:.5}),d.fromTo(f.material.uniforms.u_progress,{value:0},{value:2,duration:1,onComplete:function(){return b=!1}}),h.fadeShaderColor(f.material.uniforms.u_diffLightColor,t.ground.diffLightColor,1,0),h.fadeShaderColor(f.material.uniforms.u_mainColor,t.ground.mainColor,0,0)]));case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}},{"../../../core/properties":71,"../../../core/settings":72,"../../../helpers/colorHelper":78,"../../../helpers/fboHelper":79,"@babel/runtime/helpers/asyncToGenerator":5,"@babel/runtime/helpers/interopRequireDefault":12,"@babel/runtime/regenerator":24,glslify:26,"gsap/gsap-core":28,three:63}],109:[function(e,t,n){"use strict";var r,i=e("@babel/runtime/helpers/interopRequireDefault"),a=i(e("@babel/runtime/regenerator")),o=i(e("@babel/runtime/helpers/asyncToGenerator")),s=e("three"),l=e("../../../helpers/colorHelper"),u=e("../../../core/properties"),c=e("../../../core/settings");function h(){return(h=(0,o.default)(a.default.mark((function e(t){return a.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return u.lightning.topColor=t.lightning.topColor,u.lightning.bottomColor=t.lightning.bottomColor,u.lightning.intensity=t.lightning.intensity,r.color.setStyle(u.lightning.topColor),r.groundColor.setStyle(u.lightning.bottomColor),e.abrupt("return",Promise.all([l.fadeShaderColor(r,r.color,u.lightning.topColor,.5,0),l.fadeShaderColor(r,r.groundColor,u.lightning.bottomColor,.5,0),gsap.to(r,{intensity:u.lightning.intensity,duration:.5})]));case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}n.preInit=function(){n.container=new s.Object3D,r=new s.HemisphereLight,n.container.add(r)},n.init=function(e,t){if(t){u.lightning.topColor=e.lightning.topColor,u.lightning.bottomColor=e.lightning.bottomColor,u.lightning.intensity=e.lightning.intensity;var n=t.addFolder("light");n.addColor(u.lightning,"topColor").listen(),n.addColor(u.lightning,"bottomColor").listen(),n.add(u.lightning,"intensity",0,3,1e-5).listen(),n.open(),n.open()}},n.changeColors=function(e){return h.apply(this,arguments)},n.update=function(e){c.LOOK_DEV_MODE&&window.dat&&(r.color.setStyle(u.lightning.topColor),r.groundColor.setStyle(u.lightning.bottomColor),r.intensity=u.lightning.intensity)},n.container=null},{"../../../core/properties":71,"../../../core/settings":72,"../../../helpers/colorHelper":78,"@babel/runtime/helpers/asyncToGenerator":5,"@babel/runtime/helpers/interopRequireDefault":12,"@babel/runtime/regenerator":24,three:63}],110:[function(e,t,n){"use strict";var r,i=e("@babel/runtime/helpers/interopRequireDefault"),a=i(e("@babel/runtime/regenerator")),o=i(e("@babel/runtime/helpers/asyncToGenerator")),s=e("three"),l=e("glslify"),u=e("../../../helpers/colorHelper"),c=e("../../../core/properties"),h=e("../../../core/settings");function d(){return(d=(0,o.default)(a.default.mark((function e(t){return a.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c.sky.topColor=t.sky.topColor,c.sky.bottomColor=t.sky.bottomColor,c.sky.offset=t.sky.offset,c.sky.exponent=t.sky.exponent,e.abrupt("return",Promise.all([u.fadeShaderColor(r.material.uniforms.topColor,t.sky.topColor,.5,.15),u.fadeShaderColor(r.material.uniforms.bottomColor,t.sky.bottomColor,.5,.15)]));case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}n.preInit=function(){n.container=new s.Object3D,e={topColor:{value:new s.Color(c.sky.topColor)},bottomColor:{value:new s.Color(c.sky.bottomColor)},offset:{value:c.sky.offset},exponent:{value:c.sky.exponent}},t=new s.SphereBufferGeometry(45,32,32),i=new s.ShaderMaterial({transparent:!0,uniforms:e,vertexShader:l(["#define GLSLIFY 1\nvarying vec3 vWorldPosition;\nvarying vec2 v_uv;\n\nvoid main() {\n  v_uv = uv;\n  \n  vec4 worldPosition = modelMatrix * vec4( position, 1.0 );\n  \n  vWorldPosition = worldPosition.xyz;\n\n  gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}"]),fragmentShader:l(["#define GLSLIFY 1\nuniform vec3 topColor;\nuniform vec3 bottomColor;\nuniform float offset;\nuniform float exponent;\n\nvarying vec3 vWorldPosition;\nvarying vec2 v_uv;\n\nfloat NOISE_GRANULARITY = 0.5/255.0;\n\nfloat random(vec2 coords) {\n  return fract(sin(dot(coords.xy, vec2(12.9898,78.233))) * 43758.5453);\n}\n\nvoid main() {\n  float h = normalize( vWorldPosition + offset ).y;\n  vec4 colorGradient = vec4( mix( bottomColor, topColor, max( pow( max( h , 0.0), exponent ), 0.0 ) ), 1.0 );\n\n  float dithering = mix(-NOISE_GRANULARITY, NOISE_GRANULARITY, random(v_uv));\n  \n  vec4 outputColor =  colorGradient + dithering;\n  gl_FragColor = vec4(outputColor);\n}"]),side:s.BackSide}),a=new s.Mesh(t,i),a.matrixAutoUpdate=!1,a.updateMatrix(),r=a,n.container.add(r);var e,t,i,a},n.init=function(e,t){if(c.sky.topColor=e.sky.topColor,c.sky.bottomColor=e.sky.bottomColor,c.sky.offset=e.sky.offset,c.sky.exponent=e.sky.exponent,t){var n=t.addFolder("sky");n.addColor(c.sky,"topColor").listen(),n.addColor(c.sky,"bottomColor").listen(),n.add(c.sky,"offset",0,30,1e-5).listen(),n.add(c.sky,"exponent",0,10,1e-5).listen(),n.open()}},n.changeColors=function(e){return d.apply(this,arguments)},n.update=function(){h.LOOK_DEV_MODE&&window.dat&&(r.material.uniforms.topColor.value.setStyle(c.sky.topColor),r.material.uniforms.bottomColor.value.setStyle(c.sky.bottomColor),r.material.uniforms.offset.value=c.sky.offset,r.material.uniforms.exponent.value=c.sky.exponent)}},{"../../../core/properties":71,"../../../core/settings":72,"../../../helpers/colorHelper":78,"@babel/runtime/helpers/asyncToGenerator":5,"@babel/runtime/helpers/interopRequireDefault":12,"@babel/runtime/regenerator":24,glslify:26,three:63}],111:[function(e,t,n){"use strict";var r=e("@babel/runtime/helpers/interopRequireDefault"),i=r(e("@babel/runtime/regenerator")),a=r(e("@babel/runtime/helpers/asyncToGenerator")),o=r(e("@babel/runtime/helpers/defineProperty")),s=r(e("@babel/runtime/helpers/classCallCheck")),l=r(e("@babel/runtime/helpers/createClass")),u=r(e("@babel/runtime/helpers/get")),c=r(e("@babel/runtime/helpers/inherits")),h=r(e("@babel/runtime/helpers/possibleConstructorReturn")),d=r(e("@babel/runtime/helpers/getPrototypeOf"));function f(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=(0,d.default)(e);if(t){var i=(0,d.default)(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return(0,h.default)(this,n)}}var p=e("../Stage"),v=e("./trails/trails"),m=e("./lightning/lightning"),g=e("./ground/ground"),_=e("./sky/sky"),y=e("./stage0Car/stage0Car"),x=e("./stage0Leo/stage0Leo"),b=e("../../core/properties"),w=e("../../core/settings"),T=e("./themeData/themeData"),M=e("three"),S=function(e){(0,c.default)(r,e);var t,n=f(r);function r(){var e,t;return(0,s.default)(this,r),(t=n.call(this,0,(e={bloomAmount:.7,bokehAutoDistance:!0,bokehAmount:1,bokehFNumber:.12,haloWidth:.715,haloRGBShift:.016,haloStrength:1.5,haloMaskInner:0,haloMaskOuter:1,vignetteFrom:0,vignetteTo:1.6,vignetteColorHex:"#878A8C"},(0,o.default)(e,"haloMaskInner",b.stage0_activeThemeData.haloMaskInner),(0,o.default)(e,"contrast",b.stage0_activeThemeData.contrast),(0,o.default)(e,"brightness",b.stage0_activeThemeData.brightness),(0,o.default)(e,"tintColorHex",b.stage0_activeThemeData.tintColorHex),(0,o.default)(e,"tintOpacity",b.stage0_activeThemeData.tintOpacity),(0,o.default)(e,"cameraShakePositionStrength",.08),(0,o.default)(e,"cameraShakePositionSpeed",2),(0,o.default)(e,"cameraShakeRotationStrength",.045),(0,o.default)(e,"cameraShakeRotationSpeed",1.5),(0,o.default)(e,"cameraShakeBlurAmount",25),e))).activeThemeData=b.stage0_activeThemeData,t.changeThemeIsActive=!1,t}return(0,l.default)(r,[{key:"preInit",value:function(){(0,u.default)((0,d.default)(r.prototype),"preInit",this).call(this),b.loader.add(w.TEXTURE_PATH+"studio.jpg",{type:"texture",weight:200,onLoad:this.onEnvTextureLoaded.bind(this)}).content,_.preInit(),this.container.add(_.container),g.preInit(),this.container.add(g.container),m.preInit(),this.container.add(m.container),v.preInit(300),this.container.add(v.container),y.preInit(),this.container.add(y.container),x.preInit(),this.container.add(x.container)}},{key:"init",value:function(){(0,u.default)((0,d.default)(r.prototype),"init",this).call(this);var e=w.LOOK_DEV_MODE&&window.dat?new dat.GUI:null;_.init(this.activeThemeData,e),g.init(this.activeThemeData,e),m.init(this.activeThemeData,e),v.init(this.activeThemeData,e),x.init(this.activeThemeData,e)}},{key:"onEnvTextureLoaded",value:function(e){var t=new M.PMREMGenerator(b.renderer);t.compileEquirectangularShader(),b.scene.environment=t.fromEquirectangular(e).texture,t.dispose()}},{key:"setOrbitCamera",value:function(){b.orbitCamera.position.set(3,0,3)}},{key:"setOrbitControls",value:function(){var e=b.orbitControls;e.minPolarAngle=1.25,e.maxPolarAngle=1.45,e.minDistance=4.5,e.maxDistance=6,e.rotateSpeed=.2,e.enableDamping=!0,e.enablePan=!1}},{key:"getThemes",value:function(){return T}},{key:"changeTheme",value:(t=(0,a.default)(i.default.mark((function e(t){return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.changeThemeIsActive){e.next=2;break}return e.abrupt("return");case 2:return this.changeThemeIsActive=!0,this.activeThemeData=b.stage0_activeThemeData=t,e.next=6,Promise.all([gsap.to(b,{tintColorHex:this.activeThemeData.tintColorHex}),gsap.to(b,{tintOpacity:this.activeThemeData.tintOpacity}),gsap.to(b,{vignetteColorHex:this.activeThemeData.vignetteColorHex}),gsap.to(b,{haloMaskInner:this.activeThemeData.haloMaskInner}),gsap.to(b,{contrast:this.activeThemeData.contrast}),gsap.to(b,{brightness:this.activeThemeData.brightness}),_.changeColors(this.activeThemeData),g.changeColors(this.activeThemeData),m.changeColors(this.activeThemeData),v.changeColors(this.activeThemeData),x.changeColors(this.activeThemeData)]);case 6:return this.changeThemeIsActive=!1,e.abrupt("return",!0);case 8:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})},{key:"show",value:function(){(0,u.default)((0,d.default)(r.prototype),"show",this).call(this),this.setOrbitCamera(),this.setOrbitControls(),this.changeTheme(this.activeThemeData),b.vignetteColorHex=this.activeThemeData.vignetteColorHex,b.haloMaskInner=this.activeThemeData.haloMaskInner,b.contrast=this.activeThemeData.contrast,b.brightness=this.activeThemeData.brightness,b.tintColorHex=this.activeThemeData.tintColorHex,b.tintOpacity=this.activeThemeData.tintOpacity}},{key:"update",value:function(e){(0,u.default)((0,d.default)(r.prototype),"update",this).call(this,e),_.update(),g.update(e),m.update(e),v.update(e),y.update(e),x.update(e)}}]),r}(p);t.exports=new S},{"../../core/properties":71,"../../core/settings":72,"../Stage":105,"./ground/ground":108,"./lightning/lightning":109,"./sky/sky":110,"./stage0Car/stage0Car":112,"./stage0Leo/stage0Leo":113,"./themeData/themeData":114,"./trails/trails":115,"@babel/runtime/helpers/asyncToGenerator":5,"@babel/runtime/helpers/classCallCheck":6,"@babel/runtime/helpers/createClass":7,"@babel/runtime/helpers/defineProperty":8,"@babel/runtime/helpers/get":9,"@babel/runtime/helpers/getPrototypeOf":10,"@babel/runtime/helpers/inherits":11,"@babel/runtime/helpers/interopRequireDefault":12,"@babel/runtime/helpers/possibleConstructorReturn":17,"@babel/runtime/regenerator":24,three:63}],112:[function(e,t,n){"use strict";var r=e("@babel/runtime/helpers/interopRequireDefault"),i=r(e("@babel/runtime/helpers/defineProperty")),a=r(e("@babel/runtime/helpers/classCallCheck")),o=r(e("@babel/runtime/helpers/createClass")),s=e("../../../core/settings"),l=e("../../../core/properties"),u=e("three"),c=e("glslify"),h=e("mout/object/mixIn"),d=e("../../carTiresConfigs"),f=function(){function e(t,n,r){(0,a.default)(this,e),this.container=new u.Object3D,this.tireContainers=[],this.tireMeshes=[],this.cubeRenderTarget=null,this.cubeCamera=null,this.errorMaterial=new u.MeshBasicMaterial({color:"#ff0000"}),this.carBodyMesh=null,this.carWindowMesh=null}return(0,o.default)(e,[{key:"preInit",value:function(){this.setupCubeCamera(),this.loadModels()}},{key:"setupCubeCamera",value:function(){this.cubeRenderTarget=new u.WebGLCubeRenderTarget(1024,{format:u.RGBFormat,generateMipmaps:!1,minFilter:u.LinearFilter,magFilter:u.LinearFilter}),this.cubeCamera=new u.CubeCamera(1,100,this.cubeRenderTarget),this.cubeCamera.position.set(0,0,0),this.cubeCamera.lookAt(new u.Vector3(0,0,0)),window.cubeCamera=this.cubeCamera,this.container.add(this.cubeCamera)}},{key:"loadModels",value:function(){l.loader.add(s.MODEL_PATH+"full_body.buf",{weight:3282,onLoad:this.onCarBodyLoaded.bind(this,"full_body")}),l.loader.add(s.MODEL_PATH+"full_windows.buf",{weight:28,onLoad:this.onCarWindowsLoaded.bind(this,"full_windows")}),l.loader.add(s.MODEL_PATH+"full_tire.buf",{weight:86,onLoad:this.onCarTiresLoaded.bind(this,"full_tire")}),l.loader.add(s.TEXTURE_PATH+"carshadow.png",{type:"texture",weight:200,onLoad:this.onCarShadowLoaded.bind(this)})}},{key:"onCarBodyLoaded",value:function(e,t){"full_body"==e?(this.carBodyMesh=new u.Mesh(t,new u.MeshStandardMaterial({color:"#ffffff",envMap:this.cubeRenderTarget.texture,metalness:.05,roughness:0,envMapIntensity:4})),this.carBodyMesh.material.type="ShaderMaterial",this.carBodyMesh.material.uniforms=h(u.UniformsUtils.merge([u.ShaderLib.standard.uniforms]),{}),this.carBodyMesh.material.vertexShader=c(["#define GLSLIFY 1\n#define STANDARD\n\nattribute float isCarPaint;\nattribute float occlusion;\n//attribute float roughness; //naming conflicts with uniform\nattribute float specular;\n//attribute float diffuse; //naming conflicts with uniform\n\n//varying float v_isCarPaint;\nvarying float v_occlusion;\n//varying float v_roughness; //naming conflicts with uniform\n//varying float v_specular;\n//varying float v_diffuse;\n\nvarying vec3 vViewPosition;\n\n#ifndef FLAT_SHADED\n\n\tvarying vec3 vNormal;\n\n\t#ifdef USE_TANGENT\n\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\n\t#endif\n\n#endif\n\n#ifdef USE_TRANSMISSION\n\n\tvarying vec4 vWorldPosition;\n\n#endif\n\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\n\nvoid main() {\n\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\n#ifndef FLAT_SHADED // Normal computed with derivatives when FLAT_SHADED\n\n\tvNormal = normalize( transformedNormal );\n\n\t#ifdef USE_TANGENT\n\n\t\tvTangent = normalize( transformedTangent );\n\t\tvBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n\n\t#endif\n\n#endif\n\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\n\tvViewPosition = - mvPosition.xyz;\n\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n\n#ifdef USE_TRANSMISSION\n\n\tvWorldPosition = worldPosition;\n\n#endif\n\n\t//v_isCarPaint = isCarPaint;\n\tv_occlusion = occlusion;\n\t//v_roughness = roughness; //naming conflicts with uniform\n\t//v_specular = specular;\n\t//v_diffuse = diffuse; //naming conflicts with uniform\n}"]),this.carBodyMesh.material.fragmentShader=c(["#define GLSLIFY 1\n#define STANDARD\n\n//varying float v_isCarPaint;\nvarying float v_occlusion;\n//varying float v_roughness; //naming conflicts with uniform\n//varying float v_specular;\n// varying float v_diffuse; //naming conflicts with uniform\n\n#ifdef PHYSICAL\n\t#define REFLECTIVITY\n\t#define CLEARCOAT\n\t#define SPECULAR\n#endif\n\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n\n#ifdef USE_TRANSMISSION\n\tuniform float transmission;\n\tuniform float thickness;\n\tuniform float attenuationDistance;\n\tuniform vec3 attenuationTint;\n#endif\n\n#ifdef REFLECTIVITY\n\tuniform float reflectivity;\n#endif\n\n#ifdef SPECULAR\n\tuniform float specularIntensity;\n\tuniform vec3 specularTint;\n\n\t#ifdef USE_SPECULARINTENSITYMAP\n\t\tuniform sampler2D specularIntensityMap;\n\t#endif\n\n\t#ifdef USE_SPECULARTINTMAP\n\t\tuniform sampler2D specularTintMap;\n\t#endif\n#endif\n\n#ifdef CLEARCOAT\n\tuniform float clearcoat;\n\tuniform float clearcoatRoughness;\n#endif\n\n#ifdef USE_SHEEN\n\tuniform vec3 sheen;\n#endif\n\nvarying vec3 vViewPosition;\n\n#ifndef FLAT_SHADED\n\n\tvarying vec3 vNormal;\n\n\t#ifdef USE_TANGENT\n\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\n\t#endif\n\n#endif\n\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <bsdfs>\n#include <transmission_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_physical_pars_fragment>\n#include <fog_pars_fragment>\n#include <lights_pars_begin>\n#include <lights_physical_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <clearcoat_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\n\nvoid main() {\n\n\t#include <clipping_planes_fragment>\n\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <roughnessmap_fragment>\n\t#include <metalnessmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <clearcoat_normal_fragment_begin>\n\t#include <clearcoat_normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\n\t// accumulation\n\t#include <lights_physical_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\n\t// modulation\n\n\t// REMOVE THE INTERNAL AO SNIPPET\n\t// #_include <aomap_fragment> \n\n\t// ADD SOME VERTEX BASED CUSTOM AO\n\tfloat ambientOcclusion = 0.75 + v_occlusion * 0.25;\n\treflectedLight.indirectDiffuse *= ambientOcclusion;\n\t#if defined( USE_ENVMAP ) && defined( STANDARD )\n\t\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\t\treflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.specularRoughness );\n\t#endif\n\t\n\n\tvec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;\n\tvec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;\n\n\t#include <transmission_fragment>\n\n\tvec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;\n\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n\n}"]),this.carBodyMesh.updateMatrix(),this.carBodyMesh.matrixAutoUpdate=!1,this.container.add(this.carBodyMesh)):this.addErrorMesh(e,t)}},{key:"onCarWindowsLoaded",value:function(e,t){var n;"full_windows"==e?(this.carWindowMesh=new u.Mesh(t,new u.MeshBasicMaterial((n={envMap:this.cubeRenderTarget.texture,transparent:!0,opacity:.25,refractionRatio:.985},(0,i.default)(n,"transparent",!0),(0,i.default)(n,"depthWrite",!1),n))),this.carWindowMesh.updateMatrix(),this.carWindowMesh.matrixAutoUpdate=!1,this.container.add(this.carWindowMesh)):this.addErrorMesh(e,t)}},{key:"onCarTiresLoaded",value:function(e,t){if("full_tire"===e){var n=new u.MeshStandardMaterial({color:"#ffffff",envMap:this.cubeRenderTarget.texture,metalness:0,roughness:.1,envMapIntensity:4});for(var r in d){var i=new u.Object3D,a=new u.Mesh(t,n);a.material.type="ShaderMaterial",a.material.uniforms=h(u.UniformsUtils.merge([u.ShaderLib.standard.uniforms]),{}),a.material.vertexShader=c(["#define GLSLIFY 1\n#define STANDARD\n\nattribute float isCarPaint;\nattribute float occlusion;\n//attribute float roughness; //naming conflicts with uniform\nattribute float specular;\n//attribute float diffuse; //naming conflicts with uniform\n\n//varying float v_isCarPaint;\nvarying float v_occlusion;\n//varying float v_roughness; //naming conflicts with uniform\n//varying float v_specular;\n//varying float v_diffuse;\n\nvarying vec3 vViewPosition;\n\n#ifndef FLAT_SHADED\n\n\tvarying vec3 vNormal;\n\n\t#ifdef USE_TANGENT\n\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\n\t#endif\n\n#endif\n\n#ifdef USE_TRANSMISSION\n\n\tvarying vec4 vWorldPosition;\n\n#endif\n\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\n\nvoid main() {\n\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\n#ifndef FLAT_SHADED // Normal computed with derivatives when FLAT_SHADED\n\n\tvNormal = normalize( transformedNormal );\n\n\t#ifdef USE_TANGENT\n\n\t\tvTangent = normalize( transformedTangent );\n\t\tvBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n\n\t#endif\n\n#endif\n\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\n\tvViewPosition = - mvPosition.xyz;\n\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n\n#ifdef USE_TRANSMISSION\n\n\tvWorldPosition = worldPosition;\n\n#endif\n\n\t//v_isCarPaint = isCarPaint;\n\tv_occlusion = occlusion;\n\t//v_roughness = roughness; //naming conflicts with uniform\n\t//v_specular = specular;\n\t//v_diffuse = diffuse; //naming conflicts with uniform\n}"]),a.material.fragmentShader=c(["#define GLSLIFY 1\n#define STANDARD\n\n//varying float v_isCarPaint;\nvarying float v_occlusion;\n//varying float v_roughness; //naming conflicts with uniform\n//varying float v_specular;\n// varying float v_diffuse; //naming conflicts with uniform\n\n#ifdef PHYSICAL\n\t#define REFLECTIVITY\n\t#define CLEARCOAT\n\t#define SPECULAR\n#endif\n\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n\n#ifdef USE_TRANSMISSION\n\tuniform float transmission;\n\tuniform float thickness;\n\tuniform float attenuationDistance;\n\tuniform vec3 attenuationTint;\n#endif\n\n#ifdef REFLECTIVITY\n\tuniform float reflectivity;\n#endif\n\n#ifdef SPECULAR\n\tuniform float specularIntensity;\n\tuniform vec3 specularTint;\n\n\t#ifdef USE_SPECULARINTENSITYMAP\n\t\tuniform sampler2D specularIntensityMap;\n\t#endif\n\n\t#ifdef USE_SPECULARTINTMAP\n\t\tuniform sampler2D specularTintMap;\n\t#endif\n#endif\n\n#ifdef CLEARCOAT\n\tuniform float clearcoat;\n\tuniform float clearcoatRoughness;\n#endif\n\n#ifdef USE_SHEEN\n\tuniform vec3 sheen;\n#endif\n\nvarying vec3 vViewPosition;\n\n#ifndef FLAT_SHADED\n\n\tvarying vec3 vNormal;\n\n\t#ifdef USE_TANGENT\n\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\n\t#endif\n\n#endif\n\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <bsdfs>\n#include <transmission_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_physical_pars_fragment>\n#include <fog_pars_fragment>\n#include <lights_pars_begin>\n#include <lights_physical_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <clearcoat_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\n\nvoid main() {\n\n\t#include <clipping_planes_fragment>\n\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <roughnessmap_fragment>\n\t#include <metalnessmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <clearcoat_normal_fragment_begin>\n\t#include <clearcoat_normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\n\t// accumulation\n\t#include <lights_physical_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\n\t// modulation\n\n\t// REMOVE THE INTERNAL AO SNIPPET\n\t// #_include <aomap_fragment> \n\n\t// ADD SOME VERTEX BASED CUSTOM AO\n\tfloat ambientOcclusion = 0.75 + v_occlusion * 0.25;\n\treflectedLight.indirectDiffuse *= ambientOcclusion;\n\t#if defined( USE_ENVMAP ) && defined( STANDARD )\n\t\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\t\treflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.specularRoughness );\n\t#endif\n\t\n\n\tvec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;\n\tvec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;\n\n\t#include <transmission_fragment>\n\n\tvec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;\n\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n\n}"]),i.add(a),this.container.add(i);var o=d[r];a.userData.config=o,i.position.copy(o),i.rotation.y=o.isFlipped?Math.PI:0,this.tireContainers.push(i),this.tireMeshes.push(a)}}else this.addErrorMesh(e,t)}},{key:"onCarShadowLoaded",value:function(e){var t=new u.MeshBasicMaterial({map:e,transparent:!0,depthWrite:!1,opacity:.85}),n=new u.PlaneBufferGeometry(5.4,5.75,1,1),r=new u.Mesh(n,t);r.rotation.set(-Math.PI/2,0,0),r.position.set(.03,.01,.275),r.renderOrder=1,r.updateMatrix(),r.matrixAutoUpdate=!1,window.carshadowplane=r,this.container.add(r)}},{key:"addErrorMesh",value:function(e,t){var n=new u.Mesh(t,errorMaterial);this.container.add(n),console.log("[stage0Car] addErrorMesh() - error meshId: ",e)}},{key:"update",value:function(e){for(var t=0,n=this.tireMeshes.length;t<n;t++){var r=this.tireMeshes[t];r.visible=!1,r.rotation.x+=9*(r.userData.config.isFlipped?-e:e)}this.carBodyMesh.visible=!1,this.carWindowMesh.visible=!1,this.cubeCamera.update(l.renderer,l.scene),this.carBodyMesh.visible=!0,this.carWindowMesh.visible=!0;for(var i=0,a=this.tireMeshes.length;i<a;i++)this.tireMeshes[i].visible=!0}}]),e}();t.exports=new f},{"../../../core/properties":71,"../../../core/settings":72,"../../carTiresConfigs":107,"@babel/runtime/helpers/classCallCheck":6,"@babel/runtime/helpers/createClass":7,"@babel/runtime/helpers/defineProperty":8,"@babel/runtime/helpers/interopRequireDefault":12,glslify:26,"mout/object/mixIn":45,three:63}],113:[function(e,t,n){"use strict";var r=e("@babel/runtime/helpers/interopRequireDefault"),i=r(e("@babel/runtime/regenerator")),a=r(e("@babel/runtime/helpers/asyncToGenerator")),o=r(e("@babel/runtime/helpers/defineProperty")),s=r(e("@babel/runtime/helpers/classCallCheck")),l=r(e("@babel/runtime/helpers/createClass")),u=e("../../../core/settings"),c=e("../../../core/properties"),h=e("three"),d=e("glslify"),f=e("mout/object/mixIn"),p=e("../../../utils/math"),v=e("../../../utils/ease"),m=function(){function e(t,n,r){(0,s.default)(this,e),this.container=new h.Object3D,this.BONE_COUNT=36,this.FRAME_COUNT=20,this.FRAME_RATE=24,this.leoMeshMain=null,this.leoMeshClone=null,this.dissolveTexture=null,this.leoAnimationTexture=null,this.leoAnimationTextureSize=new h.Vector2,this.triggerCounter=0}var t;return(0,l.default)(e,[{key:"preInit",value:function(){var e=this;c.cinematicIsActive.add((function(){return e.onCinematicIsTriggered()})),c.loader.add(u.MODEL_PATH+"leo.buf",{weight:80,onLoad:this.onLeoBodyLoaded.bind(this,"full_body")}),c.loader.add(u.MODEL_PATH+"leo_run_animation.buf",{weight:16,onLoad:this.onLeoAnimaLoaded.bind(this,"animation")})}},{key:"init",value:function(e,t){if(t){var n=t.addFolder("leo");n.addColor(c.leo,"color").listen(),n.addColor(c.leo,"emissive").listen(),n.open()}this.leoMeshMain.material.uniforms.u_animationTexture.value=this.leoAnimationTexture,this.changeColors(e)}},{key:"onLeoBodyLoaded",value:function(e,t){var n=new h.LineSegments(t,new h.MeshStandardMaterial((0,o.default)({color:"#ffffff",metalness:.05,roughness:0,envMapIntensity:1,transparent:!0,blending:h.AdditiveBlending,opacity:0,emissiveIntensity:.25},"envMapIntensity",.5)));n.material.type="ShaderMaterial",n.material.uniforms=f(h.UniformsUtils.merge([h.ShaderLib.standard.uniforms]),{u_animationTexture:{value:null},u_animationTextureSize:{value:this.leoAnimationTextureSize},u_animationBoneCount:{value:this.BONE_COUNT},u_animationFrameCount:{value:this.FRAME_COUNT},u_animationFrameDataOffset1:{value:0},u_animationFrameDataOffset2:{value:0},u_animationFrameDataFract:{value:0},u_dissolveStrength:{value:0},u_time:c.sharedUniforms.u_time}),window.leomat=n.material,n.material.vertexShader=d(["#define GLSLIFY 1\n#define STANDARD\nvarying float v_activeRatio;\nuniform float u_dissolveStrength;\nuniform float u_time;\n\nattribute float isCarPaint;\nattribute float occlusion;\n//attribute float roughness; //naming conflicts with uniform\nattribute float specular;\n//attribute float diffuse; //naming conflicts with uniform\n\n//varying float v_isCarPaint;\nvarying float v_occlusion;\n//varying float v_roughness; //naming conflicts with uniform\n//varying float v_specular;\n//varying float v_diffuse;\n\nvarying vec3 vViewPosition;\n\n#ifndef FLAT_SHADED\n\n\tvarying vec3 vNormal;\n\n\t#ifdef USE_TANGENT\n\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\n\t#endif\n\n#endif\n\n#ifdef USE_TRANSMISSION\n\n\tvarying vec4 vWorldPosition;\n\n#endif\n\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\n\nattribute vec4 boneIndices;\nattribute vec4 boneWeights;\n\nuniform sampler2D u_animationTexture;\nuniform vec2 u_animationTextureSize;\nuniform float u_animationBoneCount;\nuniform float u_animationFrameCount;\nuniform float u_animationFrameDataOffset1;\nuniform float u_animationFrameDataOffset2;\nuniform float u_animationFrameDataFract;\n\nvec2 getAnimationUv(float pixelDataOffset) {\n\tpixelDataOffset += 0.5;\n\treturn (floor(vec2(\n\t\tmod(pixelDataOffset, u_animationTextureSize.x),\n\t\tpixelDataOffset / u_animationTextureSize.x\n\t)) + 0.5) / u_animationTextureSize;\n}\n\nvec3 qrotate(vec4 q, vec3 v) {\n\treturn v + 2.0 * cross(q.xyz, cross(q.xyz, v) + q.w * v);\n}\n\nvoid computeSkin (inout vec3 pos, inout vec3 nor, float offset) {\n\tvec4 pixelDataOffsets = (boneIndices + offset) * 2.0;\n\tvec2 animationUv0 = getAnimationUv(pixelDataOffsets.x);\n\tvec2 animationUv1 = getAnimationUv(pixelDataOffsets.y);\n\tvec2 animationUv2 = getAnimationUv(pixelDataOffsets.z);\n\tvec2 animationUv3 = getAnimationUv(pixelDataOffsets.w);\n\t\n\tpos = vec3(0.0);\n\tnor = vec3(0.0);\n\t\n\tvec2 orientOffset = vec2(1.0 / u_animationTextureSize.x, 0.0);\n\n\tvec4 quat0 = texture2D(u_animationTexture, animationUv0 + orientOffset);\n\tvec4 quat1 = texture2D(u_animationTexture, animationUv1 + orientOffset);\n\tvec4 quat2 = texture2D(u_animationTexture, animationUv2 + orientOffset);\n\tvec4 quat3 = texture2D(u_animationTexture, animationUv3 + orientOffset);\n\n\tpos += (qrotate(quat0, position) + texture2D(u_animationTexture, animationUv0).xyz) * boneWeights.x;\n\tpos += (qrotate(quat1, position) + texture2D(u_animationTexture, animationUv1).xyz) * boneWeights.y;\n\tpos += (qrotate(quat2, position) + texture2D(u_animationTexture, animationUv2).xyz) * boneWeights.z;\n\tpos += (qrotate(quat3, position) + texture2D(u_animationTexture, animationUv3).xyz) * boneWeights.w;\n\n\tnor += qrotate(quat0, normal) * boneWeights.x;\n\tnor += qrotate(quat1, normal) * boneWeights.y;\n\tnor += qrotate(quat2, normal) * boneWeights.z;\n\tnor += qrotate(quat3, normal) * boneWeights.w;\n\n\tnor = normalize(nor);\n}\n\nvec4 hash44(vec4 p4) {\n\tp4 = fract(p4  * vec4(.1031, .1030, .0973, .1099));\n    p4 += dot(p4, p4.wzxy+33.33);\n    return fract((p4.xxyz+p4.yzzw)*p4.zywx);\n}\n\nvoid main() {\n\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t// #include <color_vertex>\n\n// \t#include <beginnormal_vertex>\n// \t#include <morphnormal_vertex>\n// \t#include <skinbase_vertex>\n// \t#include <skinnormal_vertex>\n// \t#include <defaultnormal_vertex>\n\n// #ifndef FLAT_SHADED // Normal computed with derivatives when FLAT_SHADED\n\n// \tvNormal = normalize( transformedNormal );\n\n// \t#ifdef USE_TANGENT\n\n// \t\tvTangent = normalize( transformedTangent );\n// \t\tvBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n\n// \t#endif\n\n// #endif\n\n\t// #include <begin_vertex>\n\t// #include <morphtarget_vertex>\n\t// #include <skinning_vertex>\n\t// #include <displacementmap_vertex>\n\n\tvec3 pos1 = vec3(0.0);\n\tvec3 pos2 = vec3(0.0);\n\tvec3 nor1 = vec3(0.0);\n\tvec3 nor2 = vec3(0.0);\n\n\tcomputeSkin(pos1, nor1, u_animationFrameDataOffset1);\n\tcomputeSkin(pos2, nor2, u_animationFrameDataOffset2);\n\n\tvec3 transformed = mix(pos1, pos2, u_animationFrameDataFract);\n\n\tvec3 noisePos = transformed;\n\tnoisePos.z = 0.0;\n\tnoisePos.xy = floor(noisePos.xy * 10.0) / 10.0;\n\tvec3 offsetPos = hash44(vec4(noisePos, u_time)).xyz - 0.5;\n\n\tv_activeRatio = smoothstep(u_dissolveStrength * 2.0, u_dissolveStrength * 2.0 - 1.0, -position.x);\n\n\ttransformed.z += -abs(offsetPos.z) * (1.0 - v_activeRatio) * 2.0;\n\n\tvec3 transformedNormal = normalMatrix * normalize(mix(nor1, nor2, u_animationFrameDataFract));\n\tvNormal = transformedNormal;\n\t\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\n\tvViewPosition = - mvPosition.xyz;\n\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n\n#ifdef USE_TRANSMISSION\n\n\tvWorldPosition = worldPosition;\n\n#endif\n\n\t//v_isCarPaint = isCarPaint;\n\tv_occlusion = occlusion;\n\t//v_roughness = roughness; //naming conflicts with uniform\n\t//v_specular = specular;\n\t//v_diffuse = diffuse; //naming conflicts with uniform\n}"]),n.material.fragmentShader=d(["#define GLSLIFY 1\n#define STANDARD\n\n//varying float v_isCarPaint;\nvarying float v_occlusion;\nvarying float v_activeRatio;\n//varying float v_roughness; //naming conflicts with uniform\n//varying float v_specular;\n// varying float v_diffuse; //naming conflicts with uniform\n\nuniform float u_dissolveStrength;\n\n#ifdef PHYSICAL\n\t#define REFLECTIVITY\n\t#define CLEARCOAT\n\t#define SPECULAR\n#endif\n\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n\n#ifdef USE_TRANSMISSION\n\tuniform float transmission;\n\tuniform float thickness;\n\tuniform float attenuationDistance;\n\tuniform vec3 attenuationTint;\n#endif\n\n#ifdef REFLECTIVITY\n\tuniform float reflectivity;\n#endif\n\n#ifdef SPECULAR\n\tuniform float specularIntensity;\n\tuniform vec3 specularTint;\n\n\t#ifdef USE_SPECULARINTENSITYMAP\n\t\tuniform sampler2D specularIntensityMap;\n\t#endif\n\n\t#ifdef USE_SPECULARTINTMAP\n\t\tuniform sampler2D specularTintMap;\n\t#endif\n#endif\n\n#ifdef CLEARCOAT\n\tuniform float clearcoat;\n\tuniform float clearcoatRoughness;\n#endif\n\n#ifdef USE_SHEEN\n\tuniform vec3 sheen;\n#endif\n\nvarying vec3 vViewPosition;\n\n#ifndef FLAT_SHADED\n\n\tvarying vec3 vNormal;\n\n\t#ifdef USE_TANGENT\n\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\n\t#endif\n\n#endif\n\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <bsdfs>\n#include <transmission_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_physical_pars_fragment>\n#include <fog_pars_fragment>\n#include <lights_pars_begin>\n#include <lights_physical_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <clearcoat_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\n\nvoid main() {\n\n\t#include <clipping_planes_fragment>\n\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <roughnessmap_fragment>\n\t#include <metalnessmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <clearcoat_normal_fragment_begin>\n\t#include <clearcoat_normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\n\t// accumulation\n\t#include <lights_physical_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\n\t// modulation\n\n\t// REMOVE THE INTERNAL AO SNIPPET\n\t// #_include <aomap_fragment> \n\n\t// ADD SOME VERTEX BASED CUSTOM AO\n\tfloat ambientOcclusion = 0.75 + v_occlusion * 0.25;\n\treflectedLight.indirectDiffuse *= ambientOcclusion;\n\t#if defined( USE_ENVMAP ) && defined( STANDARD )\n\t\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\t\treflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.specularRoughness );\n\t#endif\n\t\n\n\tvec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;\n\tvec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;\n\n\t#include <transmission_fragment>\n\n\tvec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;\n\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n\n\t//DISSOLVING\n\tif (v_activeRatio < 0.1) {\n\t\tdiscard;\n\t}\n}"]),n.userData.frame=0,n.renderOrder=1,this.createLeopards(n)}},{key:"onLeoAnimaLoaded",value:function(e,t){var n=t.attributes.position.array,r=t.attributes.orient.array,i=this.FRAME_COUNT*this.BONE_COUNT,a=Math.ceil(Math.sqrt(i)),o=Math.ceil(i/a);a*=2,this.leoAnimationTextureSize.set(a,o);for(var s=new Float32Array(4*(a*o)),l=0,u=0,c=0,d=0;l<i;l++)s[d+0]=n[u+0],s[d+1]=n[u+1],s[d+2]=n[u+2],s[d+4]=r[c+0],s[d+5]=r[c+1],s[d+6]=r[c+2],s[d+7]=r[c+3],u+=3,c+=4,d+=8;this.leoAnimationTexture=new h.DataTexture(s,a,o,h.RGBAFormat,h.FloatType)}},{key:"createLeopards",value:function(e){this.leoMeshMain=e,this.leoMeshMain.position.set(1.75,.1,0),this.leoMeshMain.userData.startPos=-.5,this.container.add(this.leoMeshMain),this.leoMeshClone=e.clone(),this.leoMeshClone.position.set(-1.75,.1,0),this.leoMeshClone.userData.frame=this.FRAME_COUNT/2,this.leoMeshClone.userData.startPos=-.75,this.container.add(this.leoMeshClone)}},{key:"changeColors",value:(t=(0,a.default)(i.default.mark((function e(t){return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c.leo.color=t.leo.color,c.leo.emissive=t.leo.emissive,e.abrupt("return",Promise.resolve([this.leoMeshMain.material.color.setStyle(t.leo.color),this.leoMeshMain.material.emissive.setStyle(t.leo.emissive)]));case 3:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})},{key:"onCinematicIsTriggered",value:function(){c.cinematicRatio>0||(this.triggerCounter%2==0?(this.leoMeshMain.userData.startPos=-.25,this.leoMeshClone.userData.startPos=-1.75):(this.leoMeshMain.userData.startPos=-1.5,this.leoMeshClone.userData.startPos=-1),this.triggerCounter++)}},{key:"update",value:function(e){var t,n;this.leoMeshMain&&(t=(n=this.leoMeshMain).material.uniforms,n.userData.frame+=e*this.FRAME_RATE,n.userData.frame=this.leoMeshMain.userData.frame%this.FRAME_COUNT,t.u_animationFrameDataOffset1.value=Math.floor(this.leoMeshMain.userData.frame)%this.FRAME_COUNT*this.BONE_COUNT,t.u_animationFrameDataOffset2.value=Math.ceil(this.leoMeshMain.userData.frame)%this.FRAME_COUNT*this.BONE_COUNT,t.u_animationFrameDataFract.value=this.leoMeshMain.userData.frame%1,n.position.z=n.userData.startPos+t.u_dissolveStrength.value/5,t=(n=this.leoMeshClone).material.uniforms,n.userData.frame+=e*this.FRAME_RATE,n.userData.frame=this.leoMeshMain.userData.frame%this.FRAME_COUNT,t.u_animationFrameDataOffset1.value=Math.floor(this.leoMeshMain.userData.frame)%this.FRAME_COUNT*this.BONE_COUNT,t.u_animationFrameDataOffset2.value=Math.ceil(this.leoMeshMain.userData.frame)%this.FRAME_COUNT*this.BONE_COUNT,t.u_animationFrameDataFract.value=this.leoMeshMain.userData.frame%1,n.position.z=n.userData.startPos+t.u_dissolveStrength.value/2,t.u_dissolveStrength.value=p.fit(c.cinematicRatio+e,-.1,1,-.1,2.5,v.easeInOutCubic),n.material.opacity=p.clamp(c.cinematicRatio,.5,1));u.LOOK_DEV_MODE&&window.dat&&(this.leoMeshMain.material.color.setStyle(c.leo.color),this.leoMeshMain.material.emissive.setStyle(c.leo.emissive))}}]),e}();t.exports=new m},{"../../../core/properties":71,"../../../core/settings":72,"../../../utils/ease":103,"../../../utils/math":104,"@babel/runtime/helpers/asyncToGenerator":5,"@babel/runtime/helpers/classCallCheck":6,"@babel/runtime/helpers/createClass":7,"@babel/runtime/helpers/defineProperty":8,"@babel/runtime/helpers/interopRequireDefault":12,"@babel/runtime/regenerator":24,glslify:26,"mout/object/mixIn":45,three:63}],114:[function(e,t,n){"use strict";t.exports=[{color1:"#f2f5f8",color2:"#75777a",vignetteColorHex:"#000000",haloMaskInner:0,contrast:0,brightness:1,tintColorHex:"#0048ff",tintOpacity:.1,sky:{topColor:"#cccccc",bottomColor:"#474747",offset:20.67,exponent:2.691},ground:{mainColor:"#383838",diffLightColor:"#0a0707",diffLightIntensity:.55,maskStrength:.5},lightning:{topColor:"#ffffff",bottomColor:"#010101",intensity:0},trails:{color:"#ffffff",speed:1,metalness:0,roughness:1,envMapIntensity:1.345},leo:{color:"#000000",emissive:"#111111"}},{color1:"#DBCBBD",color2:"#FA9062",vignetteColorHex:"#010101",haloMaskInner:.622,contrast:.429,brightness:.9,tintColorHex:"#38a6b7",tintOpacity:.1,sky:{topColor:"#d8d8d8",bottomColor:"#f98600",offset:15,exponent:1},ground:{mainColor:"#ff9292",diffLightColor:"#d6bfbf",diffLightIntensity:.55,maskStrength:1.22},lightning:{topColor:"#4100ff",bottomColor:"#0038ff",intensity:.075},trails:{color:"#896318",speed:1,metalness:0,roughness:0,envMapIntensity:1},leo:{color:"#fc00d4",emissive:"#eeff00"}},{color1:"#c83c43",color2:"#f5c0b6",vignetteColorHex:"#010101",haloMaskInner:.622,contrast:.429,brightness:.891,tintColorHex:"#834CC9",tintOpacity:.4,sky:{topColor:"#646656",bottomColor:"#f93b00",offset:15,exponent:1},ground:{mainColor:"#ff9292",diffLightColor:"#af9d9d",diffLightIntensity:.55,maskStrength:1.22},lightning:{topColor:"#f290a1",bottomColor:"#d8d694",intensity:.275},trails:{color:"#f4ddb1",speed:1,metalness:0,roughness:0,envMapIntensity:1},leo:{color:"#010101",emissive:"#913d00"}},{color1:"#c31a65",color2:"#9b81ea",vignetteColorHex:"#170840",haloMaskInner:0,contrast:0,brightness:1,tintColorHex:"#1400ff",tintOpacity:.26,sky:{topColor:"#0084ff",bottomColor:"#ff0000",offset:15,exponent:1},ground:{mainColor:"#ff0000",diffLightColor:"#0084ff",diffLightIntensity:.55,maskStrength:.5},lightning:{topColor:"#4100ff",bottomColor:"#0038ff",intensity:.075},trails:{color:"#ff0000",speed:1,metalness:0,roughness:0,envMapIntensity:1},leo:{color:"#0000ff",emissive:"#840000"}},{color1:"#9b9fc2",color2:"#73538A",vignetteColorHex:"#170840",haloMaskInner:0,contrast:0,brightness:1,tintColorHex:"#1400ff",tintOpacity:.26,isSelected:!0,sky:{topColor:"#cde7ff",bottomColor:"#300000",offset:15,exponent:1},ground:{mainColor:"#ba3a3a",diffLightColor:"#698cad",diffLightIntensity:.55,maskStrength:.5},lightning:{topColor:"#170059",bottomColor:"#0038ff",intensity:.075},trails:{color:"#3d0000",speed:1,metalness:0,roughness:0,envMapIntensity:1},leo:{color:"#0000ff",emissive:"#840000"}},{color1:"#20A481",color2:"#4562A9",vignetteColorHex:"#000000",haloMaskInner:0,contrast:0,brightness:1,tintColorHex:"#000000",tintOpacity:.1,sky:{topColor:"#21bf8f",bottomColor:"#220038",offset:15,exponent:1},ground:{mainColor:"#bc00ff",diffLightColor:"#00b27c",diffLightIntensity:.55,maskStrength:.5},lightning:{topColor:"#004430",bottomColor:"#2f003f",intensity:.25},trails:{color:"#8ee8d2",speed:1,metalness:0,roughness:0,envMapIntensity:1},leo:{color:"#8ee8d2",emissive:"#720a84"}},{color1:"#303030",color2:"#000000",vignetteColorHex:"#010101",haloMaskInner:.622,contrast:.429,brightness:.891,tintColorHex:"#ffffff",tintOpacity:0,sky:{topColor:"#4c4c4c",bottomColor:"#353535",offset:15,exponent:1.9},ground:{mainColor:"#222222",diffLightColor:"#010101",diffLightIntensity:.5,maskStrength:1.22},lightning:{topColor:"#1c1c1c",bottomColor:"#aaaaaa",intensity:.5},trails:{color:"#f4ddb1",speed:1,metalness:0,roughness:0,envMapIntensity:1},leo:{color:"#010101",emissive:"#913d00"}}]},{}],115:[function(e,t,n){"use strict";var r=e("@babel/runtime/helpers/interopRequireDefault"),i=r(e("@babel/runtime/regenerator")),a=r(e("@babel/runtime/helpers/asyncToGenerator")),o=e("three"),s=e("../../../utils/math");n.changeColors=f;var l,u=e("../../../helpers/colorHelper"),c=e("../../../core/properties"),h=e("../../../core/settings");n.preInit=function(e){n.container.position.set(0,2,0);var t=function(e){for(var t=[],n=new o.Vector3,r=14,i=4,a=0;a<e;a++)n.x=Math.random()*d-100,n.y=Math.random()*i-i/2,n.z=Math.random()*r-r/2,n.z>-1.2&&n.z<1.2&&(n.y=2*Math.random()-.5),t.push(n.x,n.y,n.z);return t}(e);l=function(e,t){for(var n=t,r=[],i=[],a=[],l=new o.BoxBufferGeometry(1,1,1,9,9,9),u=0;u<e;u++){var c=.6+Math.random()*(.9-.6),h=.01*Math.random(),f=h;r.push(c,h,f),i.push(Math.min(c,Math.min(h,f))),a.push(s.getRandomFloat(10,25))}var p=new o.InstancedBufferGeometry;p.copy(l),p.setAttribute("boxPosition",new o.InstancedBufferAttribute(new Float32Array(n),3)),p.setAttribute("boxSize",new o.InstancedBufferAttribute(new Float32Array(r),3)),p.setAttribute("boxRadius",new o.InstancedBufferAttribute(new Float32Array(i),1)),p.setAttribute("boxSpeed",new o.InstancedBufferAttribute(new Float32Array(a),1)),p.instanceCount=1/0;var v=new o.MeshStandardMaterial({color:"#ffffff",transparent:!0,metalness:0,roughness:0,envMapIntensity:1.5});window.rainmat=v;var m={time:{value:0},speed:{value:1},alphaDistance:{value:10},distribution_x:{value:d}};v.onBeforeCompile=function(e){e.uniforms.time=m.time,e.uniforms.speed=m.speed,e.uniforms.alphaDistance=m.alphaDistance,e.uniforms.distribution_x=m.distribution_x,e.vertexShader="\n      uniform float time;\n      uniform float speed;\n      uniform float distribution_x;\n      attribute vec3 boxPosition;\n      attribute vec3 boxSize;\n      attribute float boxRadius;\n      attribute float boxSpeed;\n      varying float v_posShiftX;\n      "+e.vertexShader,e.vertexShader=e.vertexShader.replace("#include <begin_vertex>","#include <begin_vertex>\n    \n        vec3 signs = sign(position);\n        vec3 box = boxSize - vec3(boxRadius);\n       \n        transformed = signs * box + normalize(position) * boxRadius;\n    \n        vec3 posShift = boxPosition;\n        posShift.x = mod(posShift.x + distribution_x + time * boxSpeed *speed, distribution_x) - distribution_x/2.0;\n        v_posShiftX = posShift.x;\n        transformed += posShift;\n        "),e.fragmentShader="\n      uniform float alphaDistance;\n      varying float v_posShiftX;\n      "+e.fragmentShader,e.fragmentShader=e.fragmentShader.replace("#include <dithering_fragment>","#include <dithering_fragment>\n      \n        float alpha = 1.0 - abs( v_posShiftX / alphaDistance);\n\n        gl_FragColor.a = alpha;\n      "),v.userData.shader=e};var g=new o.Mesh(p,v);return g.renderOrder=.1,g}(e,t),n.container.add(l)},n.init=function(e,t){if(c.trails.color=e.trails.color,c.trails.speed=e.trails.speed,c.trails.metalness=e.trails.metalness,c.trails.roughness=e.trails.roughness,c.trails.envMapIntensity=e.trails.envMapIntensity,t){var n=t.addFolder("trails");n.addColor(c.trails,"color").listen(),n.add(c.trails,"speed",0,30,1e-5).listen(),n.add(c.trails,"metalness",0,30,1e-5).listen(),n.add(c.trails,"roughness",0,10,1e-5).listen(),n.add(c.trails,"envMapIntensity",0,10,1e-5).listen(),n.open()}},n.update=function(e){if(!l.material.userData.shader)return;l.material.userData.shader.uniforms.time.value+=e,h.LOOK_DEV_MODE&&window.dat&&(l.material.color.setStyle(c.trails.color),l.material.userData.shader.uniforms.speed.value=c.trails.speed,l.material.metalness=c.trails.metalness,l.material.roughness=c.trails.roughness,l.material.envMapIntensity=c.trails.envMapIntensity)},n.changeColors=f,n.container=new o.Object3D,n.container.rotation.y=.5*Math.PI;var d=200;function f(e){return p.apply(this,arguments)}function p(){return(p=(0,a.default)(i.default.mark((function e(t){return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c.trails.color=t.trails.color,c.trails.speed=t.trails.speed,c.trails.metalness=t.trails.metalness,c.trails.roughness=t.trails.roughness,c.trails.envMapIntensity=t.trails.envMapIntensity,e.abrupt("return",u.fadeMaterialColor(l.material,t.trails.color,.5,.2));case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}},{"../../../core/properties":71,"../../../core/settings":72,"../../../helpers/colorHelper":78,"../../../utils/math":104,"@babel/runtime/helpers/asyncToGenerator":5,"@babel/runtime/helpers/interopRequireDefault":12,"@babel/runtime/regenerator":24,three:63}],116:[function(e,t,n){"use strict";var r=e("@babel/runtime/helpers/interopRequireDefault"),i=r(e("@babel/runtime/helpers/classCallCheck")),a=r(e("@babel/runtime/helpers/createClass")),o=r(e("@babel/runtime/helpers/get")),s=r(e("@babel/runtime/helpers/inherits")),l=r(e("@babel/runtime/helpers/possibleConstructorReturn")),u=r(e("@babel/runtime/helpers/getPrototypeOf"));function c(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=(0,u.default)(e);if(t){var i=(0,u.default)(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return(0,l.default)(this,n)}}var h=e("../../core/properties"),d=(e("../../helpers/fboHelper"),e("../Stage")),f=e("./stage1AreaLight/stage1AreaLight"),p=e("./stage1Car/stage1Car"),v=e("./stage1Floor/stage1Floor"),m=e("./stage1Rings/stage1Rings"),g=e("./stage1Themes"),_=(e("three"),e("glslify"),function(e){(0,s.default)(n,e);var t=c(n);function n(){return(0,i.default)(this,n),t.call(this,1,{bloomAmount:5,bloomThreshold:.3,bloomSmoothWidth:1,haloWidth:.736,haloRGBShift:.016,haloStrength:.06,haloMaskInner:0,haloMaskOuter:1,bokehAutoDistance:!0,bokehAmount:1,bokehFNumber:.14})}return(0,a.default)(n,[{key:"preInit",value:function(){(0,o.default)((0,u.default)(n.prototype),"preInit",this).call(this),f.preInit(),this.container.add(f.container),p.preInit(),this.container.add(p.container),v.preInit(),this.container.add(v.container),m.preInit(),this.container.add(m.container);for(var e=0;e<g.length;e++){var t=g[e];if(t.isSelected){p.color2=t.color1,p.carPaintRoughness2=t.isShinny?.05:.55;break}}}},{key:"init",value:function(){(0,o.default)((0,u.default)(n.prototype),"init",this).call(this),f.init(),p.init(),v.init(),m.init()}},{key:"setOrbitControls",value:function(){var e=h.orbitControls;e.minPolarAngle=.75,e.maxPolarAngle=1.55,e.minDistance=3,e.maxDistance=7,e.rotateSpeed=.3,e.enableDamping=!0,e.enablePan=!1}},{key:"show",value:function(){(0,o.default)((0,u.default)(n.prototype),"show",this).call(this),h.orbitCamera.position.set(-2,1.25,5),this.setOrbitControls(),f.sharedUniforms.u_posZOffset.value=0}},{key:"getThemes",value:function(){return g}},{key:"changeTheme",value:function(e){return 1==p.colorRatio&&(p.colorRatio=0,p.color1=p.color2,p.carPaintRoughness1=p.carPaintRoughness2,p.color2=e.color1,p.carPaintRoughness2=e.isShinny?.05:.55,!0)}},{key:"resize",value:function(e,t){(0,o.default)((0,u.default)(n.prototype),"resize",this).call(this,e,t),f.resize(e,t),p.resize(e,t),v.resize(e,t),m.resize(e,t)}},{key:"update",value:function(e){(0,o.default)((0,u.default)(n.prototype),"update",this).call(this,e),f.update(e),p.update(e),m.update(e)}}]),n}(d));t.exports=new _},{"../../core/properties":71,"../../helpers/fboHelper":79,"../Stage":105,"./stage1AreaLight/stage1AreaLight":117,"./stage1Car/stage1Car":118,"./stage1Floor/stage1Floor":119,"./stage1Rings/stage1Rings":120,"./stage1Themes":121,"@babel/runtime/helpers/classCallCheck":6,"@babel/runtime/helpers/createClass":7,"@babel/runtime/helpers/get":9,"@babel/runtime/helpers/getPrototypeOf":10,"@babel/runtime/helpers/inherits":11,"@babel/runtime/helpers/interopRequireDefault":12,"@babel/runtime/helpers/possibleConstructorReturn":17,glslify:26,three:63}],117:[function(e,t,n){"use strict";var r=e("@babel/runtime/helpers/interopRequireDefault"),i=r(e("@babel/runtime/helpers/classCallCheck")),a=r(e("@babel/runtime/helpers/createClass")),o=e("../../../core/settings"),s=e("../../../core/properties"),l=e("../../../helpers/fboHelper"),u=e("three"),c=e("glslify"),h=e("../../../effects/mipmapper/Mipmapper"),d=new u.Matrix4,f=new u.Matrix4,p=function(){function e(){(0,i.default)(this,e),this.scene=new u.Scene,this.container=new u.Object3D,this.mesh=null,this.aoTexture=null,this.RADIUS=4,this.WIDTH=this.RADIUS*Math.PI,this.HEIGHT=1*this.WIDTH,this.TEXTURE_WIDTH=1024,this.TEXTURE_HEIGHT=1024,this.hasInitialized=!1,this.mipmapper=null,this.lodRenderTarget=null,this.testTexture=null,this.sharedUniforms={u_areaLightLodTexture:{value:null},u_areaLightLodTextureSize:{value:null},u_areaLightLodTextureMaxLod:{value:0},u_areaLightLtc1:{value:null},u_areaLightLtc2:{value:null},u_areaLightSize:{value:new u.Vector3},u_areaLightHalfWidth:{value:new u.Vector3},u_areaLightHalfHeight:{value:new u.Vector3},u_areaLightTunnelRadius:{value:this.RADIUS},u_areaLightPosition:{value:new u.Vector3},u_areaLightIntensity:{value:5},u_posZOffset:{value:0},u_cinematicRatio:{value:0}}}return(0,a.default)(e,[{key:"preInit",value:function(){var e=this;this.mipmapper=new h,this.mipmapper.resize(this.TEXTURE_WIDTH,this.TEXTURE_HEIGHT,1.5*this.TEXTURE_WIDTH,this.TEXTURE_HEIGHT),this.lodRenderTarget=l.createRenderTarget(1.5*this.TEXTURE_WIDTH,this.TEXTURE_HEIGHT),this.lodRenderTarget.depthBuffer=!0,this.sharedUniforms.u_areaLightLodTexture.value=this.lodRenderTarget.texture,this.sharedUniforms.u_areaLightLodTextureSize.value=this.mipmapper.textureSize,this.sharedUniforms.u_areaLightLodTextureMaxLod.value=this.mipmapper.maxMipmapLevel,this.sharedUniforms.u_areaLightSize.value.set(this.WIDTH,this.HEIGHT,this.RADIUS),s.loader.add(o.MODEL_PATH+"ltc_mats.buf",{type:"xhr",responseType:"arraybuffer",weight:128,onLoad:function(t){var n=new u.DataTexture(new Float32Array(t,0,16384),64,64,u.RGBAFormat,u.FloatType,u.UVMapping,u.ClampToEdgeWrapping,u.ClampToEdgeWrapping,u.LinearFilter,u.NearestFilter),r=new u.DataTexture(new Float32Array(t,65536,16384),64,64,u.RGBAFormat,u.FloatType,u.UVMapping,u.ClampToEdgeWrapping,u.ClampToEdgeWrapping,u.LinearFilter,u.NearestFilter);n.needsUpdate=!0,r.needsUpdate=!0,e.sharedUniforms.u_areaLightLtc1.value=n,e.sharedUniforms.u_areaLightLtc2.value=r}})}},{key:"onModelLoad",value:function(e,t){}},{key:"init",value:function(){var e=new u.CylinderBufferGeometry(1,1,1,64,1,!0,0,Math.PI);e.rotateY(.5*Math.PI),e.scale(this.RADIUS/this.WIDTH,1,this.RADIUS),e.translate(0,0,this.RADIUS),this.mesh=new u.Mesh(e,new u.ShaderMaterial({uniforms:{u_areaLightLodTexture:this.sharedUniforms.u_areaLightLodTexture,u_areaLightIntensity:this.sharedUniforms.u_areaLightIntensity},vertexShader:c(["#define GLSLIFY 1\nvarying vec2 v_uv;\n\nvoid main () {\n\tvec4 mvPosition = modelViewMatrix * vec4(position, 1.0);\n\tgl_Position = projectionMatrix * mvPosition;\n\tv_uv = vec2(1.0 - uv.x, 1.0 - uv.y);\n\tv_uv = v_uv * vec2(0.6666667, 1.0);\n}"]),fragmentShader:c(["#define GLSLIFY 1\nuniform sampler2D u_areaLightLodTexture;\nuniform float u_areaLightIntensity;\n\nvarying vec2 v_uv;\n\nvoid main () {\n\tgl_FragColor = texture2D(u_areaLightLodTexture, v_uv) * u_areaLightIntensity;\n}"]),side:u.BackSide})),e.rotateY(Math.PI),this.mesh.position.y=this.RADIUS,this.mesh.rotation.x=.5*-Math.PI,this.mesh.scale.set(this.WIDTH,this.HEIGHT,1),this.hasInitialized=!0}},{key:"resize",value:function(e,t){}},{key:"_renderScene",value:function(){}},{key:"update",value:function(e){if(this.hasInitialized){this.sharedUniforms.u_cinematicRatio.value=s.cinematicRatio,this.sharedUniforms.u_areaLightIntensity.value=5+4*s.cinematicRatio,this.mesh.updateMatrixWorld(!0),f.identity(),d.copy(this.mesh.matrixWorld),f.extractRotation(d),this.sharedUniforms.u_areaLightPosition.value.setFromMatrixPosition(this.mesh.matrixWorld),this.sharedUniforms.u_areaLightHalfWidth.value.set(.5*this.WIDTH,0,0).applyMatrix4(f),this.sharedUniforms.u_areaLightHalfHeight.value.set(0,.5*this.HEIGHT,0).applyMatrix4(f);var t=l.getColorState(),n=s.renderer,r=this.mipmapper,i=n.getRenderTarget();n.setRenderTarget(this.lodRenderTarget),n.setViewport(0,0,2*r.textureSize.width/3,r.textureSize.height),n.setScissor(0,0,2*r.textureSize.width/3,r.textureSize.height),n.setScissorTest(!0),n.render(this.scene,l.camera),n.setViewport(0,0,this.lodRenderTarget.width,this.lodRenderTarget.height),n.setScissorTest(!1),r.render(this.lodRenderTarget),i?(n.setViewport(0,0,i.width,i.height),n.setRenderTarget(i)):n.setViewport(0,0,s.width,s.height),l.setColorState(t)}}}]),e}();t.exports=new p},{"../../../core/properties":71,"../../../core/settings":72,"../../../effects/mipmapper/Mipmapper":77,"../../../helpers/fboHelper":79,"@babel/runtime/helpers/classCallCheck":6,"@babel/runtime/helpers/createClass":7,"@babel/runtime/helpers/interopRequireDefault":12,glslify:26,three:63}],118:[function(e,t,n){"use strict";var r=e("@babel/runtime/helpers/interopRequireDefault"),i=r(e("@babel/runtime/helpers/defineProperty")),a=r(e("@babel/runtime/helpers/classCallCheck")),o=r(e("@babel/runtime/helpers/createClass")),s=e("../../../core/settings"),l=e("../../../core/properties"),u=e("../stage1AreaLight/stage1AreaLight"),c=e("mout/object/mixIn"),h=e("three"),d=e("glslify"),f=e("../../carTiresConfigs"),p=e("../../../effects/glPositionOffset/glPositionOffset"),v=function(){function e(){(0,a.default)(this,e),this.container=new h.Object3D,this.bodyMesh=null,this.windowsMesh=null,this.colorRatio=1,this.color1="#ffffff",this.color2="#ffffff",this.carPaintRoughness1=.05,this.carPaintRoughness2=.05,this.tireContainers=[],this.tireMeshes=[],this.sharedUniforms={u_color1:{value:new h.Color(0)},u_color2:{value:new h.Color(0)},u_colorRatio:{value:0},u_carFromZ:{value:-2.28797},u_carLength:{value:4.98493},u_carPaintRoughness1:{value:.05},u_carPaintRoughness2:{value:.05}},this.hasInitialized=!1}return(0,o.default)(e,[{key:"preInit",value:function(){l.loader.add(s.MODEL_PATH+"full_body.buf",{weight:3282,onLoad:this.onModelLoad.bind(this,"full_body")}),l.loader.add(s.MODEL_PATH+"full_windows.buf",{weight:28,onLoad:this.onModelLoad.bind(this,"full_windows")}),l.loader.add(s.MODEL_PATH+"full_tire.buf",{weight:86,onLoad:this.onModelLoad.bind(this,"full_tire")})}},{key:"onModelLoad",value:function(e,t){var n=new h.Mesh(t,new h.ShaderMaterial({uniforms:c((0,i.default)({u_worldNormalMatrix:{value:new h.Matrix3}},"u_worldNormalMatrix",{value:new h.Matrix3}),this.sharedUniforms,u.sharedUniforms,p.sharedUniforms),vertexShader:d(["#define GLSLIFY 1\nattribute float isCarPaint;\nattribute float occlusion;\nattribute float roughness;\nattribute float specular;\nattribute float diffuse;\n\nuniform mat3 u_worldNormalMatrix;\nuniform float u_areaLightTunnelRadius;\n\nuniform float u_carFromZ;\nuniform float u_carLength;\nuniform float u_carPaintRoughness;\n\n#ifdef IS_FULLBODY\nvarying float v_carRatio;\n#endif\n\nvarying vec3 v_wrappedWorldNormal;\nvarying vec3 v_wrappedWorldPosition;\nvarying vec3 v_wrappedWorldCameraPosition;\n\nvarying float v_isCarPaint;\nvarying float v_occlusion;\nvarying float v_roughness;\nvarying float v_specular;\nvarying float v_diffuse;\n\n// #include <glPositionOffset>\n\nvec2 rotate(vec2 v, float a) {\n\tfloat s = sin(a);\n\tfloat c = cos(a);\n\tmat2 m = mat2(c, -s, s, c);\n\treturn m * v;\n}\n\nvec3 wrapPosition (vec3 worldPos) {\n\treturn vec3(\n\t\t(atan(worldPos.y, -worldPos.x) - 1.5707963267948966) * u_areaLightTunnelRadius,\n\t\tlength(vec2(worldPos.y, worldPos.x)),\n\t\tworldPos.z\n\t);\n}\nvec3 wrapDirection (vec3 worldPos, vec3 v) {\n\tfloat offsetAngle = 1.5707963267948966 - atan(worldPos.y, -worldPos.x);\n\tv.xy = rotate(v.xy, offsetAngle);\n\treturn v;\n}\n\nvoid main () {\n\tvec4 mvPosition = modelViewMatrix * vec4(position, 1.0);\n\tgl_Position = projectionMatrix * mvPosition;\n\n\tvec3 worldPosition = (modelMatrix * vec4(position, 1.0)).xyz;\n\tv_wrappedWorldPosition = wrapPosition(worldPosition);\n\tv_wrappedWorldNormal = wrapDirection(worldPosition, u_worldNormalMatrix * normal);\n\tv_wrappedWorldCameraPosition = wrapPosition(cameraPosition); // TODO move this to cpu\n\t\n\tgl_Position = projectionMatrix * viewMatrix * vec4(worldPosition, 1.0);\n\t\n\t// v_worldPosition = worldPosition;\n\t// v_worldNormal = u_worldNormalMatrix * normal;\n\t// v_worldCameraPosition = cameraPosition; // TODO move this to cpu\n\n\t// v_wrappedWorldPosition = v_worldPosition;\n\t// v_wrappedWorldNormal = v_worldNormal;\n\t// v_wrappedWorldCameraPosition = v_worldCameraPosition;\n\n\tv_isCarPaint = isCarPaint;\n\tv_occlusion = occlusion;\n\tv_roughness = roughness;\n\tv_specular = specular;\n\tv_diffuse = isCarPaint > 0.5 ? 1.0 : diffuse;\n\n\t#ifdef IS_FULLBODY\n\tv_carRatio = 1.0 - (position.z - u_carFromZ) / u_carLength;\n\t#endif\n\t// gl_Position = glPositionOffset(gl_Position);\n}"]),fragmentShader:d(['#define GLSLIFY 1\nuniform sampler2D u_aoTexture;\n\nuniform sampler2D u_areaLightLodTexture;\nuniform sampler2D u_areaLightLtc1;\nuniform sampler2D u_areaLightLtc2;\n\nuniform vec2 u_areaLightLodTextureSize;\nuniform float u_areaLightLodTextureMaxLod;\nuniform float u_areaLightTunnelRadius;\n\nuniform vec3 u_areaLightHalfWidth;\nuniform vec3 u_areaLightHalfHeight;\nuniform vec3 u_areaLightPosition;\nuniform float u_areaLightIntensity;\n\nuniform float u_carPaintRoughness1;\nuniform float u_carPaintRoughness2;\n\nvarying float v_isCarPaint;\nvarying float v_occlusion;\nvarying float v_roughness;\nvarying float v_specular;\nvarying float v_diffuse;\n\nvarying vec3 v_wrappedWorldNormal;\nvarying vec3 v_wrappedWorldPosition;\nvarying vec3 v_wrappedWorldCameraPosition;\n\n#ifdef IS_FULLBODY\nuniform vec3 u_color1;\nuniform vec3 u_color2;\nvarying float v_carRatio;\nuniform float u_colorRatio;\n#endif\n\n#include <textureBicubic>\n#include <lodMipmapSample>\n\nfloat normalFiltering(float roughness, const vec3 worldNormal) {\n    // Kaplanyan 2016, "Stable specular highlights"\n    // Tokuyoshi 2017, "Error Reduction and Simplification for Shading Anti-Aliasing"\n    // Tokuyoshi and Kaplanyan 2019, "Improved Geometric Specular Antialiasing"\n\n    // This implementation is meant for deferred rendering in the original paper but\n    // we use it in forward rendering as well (as discussed in Tokuyoshi and Kaplanyan\n    // 2019). The main reason is that the forward version requires an expensive transform\n    // of the half vector by the tangent frame for every light. This is therefore an\n    // approximation but it works well enough for our needs and provides an improvement\n    // over our original implementation based on Vlachos 2015, "Advanced VR Rendering".\n\n    vec3 du = dFdx(worldNormal);\n    vec3 dv = dFdy(worldNormal);\n\tfloat _specularAntiAliasingVariance = 150.0;\n\tfloat _specularAntiAliasingThreshold = 0.25;\n    float variance = _specularAntiAliasingVariance * (dot(du, du) + dot(dv, dv));\n\n    float kernelRoughness = min(2.0 * variance, _specularAntiAliasingThreshold);\n    float squareRoughness = clamp(roughness * roughness + kernelRoughness, 0.0, 1.0);\n\n    return sqrt(squareRoughness);\n    // return roughness;\n}\n\nfloat LTC_ClippedSphereFormFactor( const in vec3 f ) {\n\t// Real-Time Area Lighting: a Journey from Research to Production (p.102)\n\t// An approximation of the form factor of a horizon-clipped rectangle.\n\tfloat l = length( f );\n\treturn max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );\n}\n\nvec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {\n\tfloat x = dot( v1, v2 );\n\tfloat y = abs( x );\n\t// rational polynomial approximation to theta / sin( theta ) / 2PI\n\tfloat a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;\n\tfloat b = 3.4175940 + ( 4.1616724 + y ) * y;\n\tfloat v = a / b;\n\tfloat theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;\n\treturn cross( v1, v2 ) * theta_sintheta;\n}\n\n// https://eheitzresearch.wordpress.com/415-2/\nvec3 FetchDiffuseFilteredTexture(sampler2D texLightFiltered, float lodMax, vec2 lodTextureSize, float roughness, vec3 p1_, vec3 p2_, vec3 p3_, vec3 p4_) {\n    // area light plane basis\n    vec3 V1 = p2_ - p1_;\n    vec3 V2 = p4_ - p1_;\n    vec3 planeOrtho = (cross(V1, V2));\n    float planeAreaSquared = dot(planeOrtho, planeOrtho);\n    float planeDistxPlaneArea = dot(planeOrtho, p1_);\n    // orthonormal projection of (0,0,0) in area light space\n    vec3 P = planeDistxPlaneArea * planeOrtho / planeAreaSquared - p1_;\n\n    // find tex coords of P\n    float dot_V1_V2 = dot(V1,V2);\n    float inv_dot_V1_V1 = 1.0 / dot(V1, V1);\n    vec3 V2_ = V2 - V1 * dot_V1_V2 * inv_dot_V1_V1;\n    vec2 Puv;\n    Puv.y = dot(V2_, P) / dot(V2_, V2_);\n    Puv.x = dot(V1, P)*inv_dot_V1_V1 - dot_V1_V2*inv_dot_V1_V1*Puv.y ;\n\n    // LOD\n    float d = abs(planeDistxPlaneArea) / pow(planeAreaSquared, 0.75);\n\n\tfloat lod = min(lodMax, log(d * 50.0 * lodTextureSize.y + 1.0) * roughness);\n\t// vec2 uv = clamp(vec2(0.125, 0.125) + 0.75 * Puv, vec2(0.0), vec2(1.0));\n\tvec2 uv = clamp(Puv, vec2(0.0), vec2(1.0));\n\tuv.y = 1.0 - uv.y;\n\n    // return texture2DLodEXT(texLightFiltered, uv, lod).rgb;\n\t// vec2 uv2 = uv;\n\t// uv2.x = mod(uv2.x, 2.0) > 1.0 ? -1.0 : 1.0;\n\t// vec3 light = lodMipmapSampleCubic(texLightFiltered, uv2, lod, lodTextureSize).rgb;\n\t// light *= smoothstep(1.0, 0.5, uv.x - 0.5);\n\treturn lodMipmapSampleCubic(texLightFiltered, uv, lod, lodTextureSize).rgb;\n\t// return lodMipmapSample(texLightFiltered, uv, lod, lodTextureSize).rgb;\n}\n\nmat3 transposeMat3( const in mat3 m ) {\n\tmat3 tmp;\n\ttmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );\n\ttmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );\n\ttmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );\n\treturn tmp;\n}\n\nvec3 LTC_Evaluate(sampler2D texLightFiltered, float lodMax, vec2 lodTextureSize, float roughness,  const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {\n\n\t// bail if point is on back side of plane of light\n\t// assumes ccw winding order of light vertices\n\tvec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];\n\tvec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];\n\tvec3 lightNormal = cross( v1, v2 );\n\n\tif( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );\n\n\t// construct orthonormal basis around N\n\tvec3 T1, T2;\n\tT1 = normalize( V - N * dot( V, N ) );\n\tT2 = - cross( N, T1 ); // negated from paper; possibly due to a different handedness of world coordinate system\n\n\t// compute transform\n\tmat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );\n\n\t// transform rect\n\tvec3 coords[ 4 ];\n\tcoords[ 0 ] = mat * ( rectCoords[ 0 ] - P );\n\tcoords[ 1 ] = mat * ( rectCoords[ 1 ] - P );\n\tcoords[ 2 ] = mat * ( rectCoords[ 2 ] - P );\n\tcoords[ 3 ] = mat * ( rectCoords[ 3 ] - P );\n\n\tvec3 textureLight = FetchDiffuseFilteredTexture(texLightFiltered, lodMax, lodTextureSize, roughness, coords[0], coords[1], coords[2], coords[3]);\n\n\t// project rect onto sphere\n\tcoords[ 0 ] = normalize( coords[ 0 ] );\n\tcoords[ 1 ] = normalize( coords[ 1 ] );\n\tcoords[ 2 ] = normalize( coords[ 2 ] );\n\tcoords[ 3 ] = normalize( coords[ 3 ] );\n\n\t// calculate vector form factor\n\tvec3 vectorFormFactor = vec3( 0.0 );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );\n\n\t// adjust for horizon clipping\n\tfloat result = LTC_ClippedSphereFormFactor( vectorFormFactor );\n\n/*\n\t// alternate method of adjusting for horizon clipping (see referece)\n\t// refactoring required\n\tfloat len = length( vectorFormFactor );\n\tfloat z = vectorFormFactor.z / len;\n\n\tconst float LUT_SIZE  = 64.0;\n\tconst float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;\n\tconst float LUT_BIAS  = 0.5 / LUT_SIZE;\n\n\t// tabulated horizon-clipped sphere, apparently...\n\tvec2 uv = vec2( z * 0.5 + 0.5, len );\n\tuv = uv * LUT_SCALE + LUT_BIAS;\n\n\tfloat scale = texture2D( ltc_2, uv ).w;\n\n\tfloat result = len * scale;\n*/\n\treturn vec3( result ) * textureLight;\n\n}\n\nvec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {\n\tconst float LUT_SIZE = 64.0;\n\tconst float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;\n\tconst float LUT_BIAS = 0.5 / LUT_SIZE;\n\tfloat dotNV = clamp( dot( N, V ), 0.0, 1.0 );\n\t// texture parameterized by sqrt( GGX alpha ) and sqrt( 1 - cos( theta ) )\n\tvec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );\n\tuv = uv * LUT_SCALE + LUT_BIAS;\n\treturn uv;\n}\n\nfloat checkersTexture( in vec3 p ) {\n    vec3 q = floor(p);\n    return mod( q.x+q.y+q.z, 2.0 );\n}\n\nvec2 cylIntersect( in vec3 ro, in vec3 rd, in vec3 cb, in vec3 ca, float cr ){\n    vec3  oc = ro - cb;\n    float card = dot(ca,rd);\n    float caoc = dot(ca,oc);\n    float a = 1.0 - card*card;\n    float b = dot( oc, rd) - caoc*card;\n    float c = dot( oc, oc) - caoc*caoc - cr*cr;\n    float h = b*b - a*c;\n    if( h<0.0 ) return vec2(-1.0); //no intersection\n    h = sqrt(h);\n    return vec2(-b-h,-b+h)/a;\n}\n\nvoid main () {\n\tfloat roughness = v_roughness;//5;//mix(0.0, 0.5, checkersTexture(v_wrappedWorldPosition * 2.0));\n\tfloat metalness = 0.0;\n\n\tvec3 albedo = vec3(v_diffuse);\n\t#ifdef IS_WINDOWS\n\t\tmetalness = 0.65;\n\t\tvec3 diffuseColor = albedo * ( 1.0 - metalness );\n\t\tvec3 specularColor = mix( vec3(0.04), albedo, metalness );\n\t\troughness = 0.0;\n\t#else\n\t\t\n\t\t#ifdef IS_FULLBODY\n\t\t\tfloat gradient = mix(0.0075, 0.002, v_carRatio);\n\t\t\tfloat emissionIntensity = v_isCarPaint > 0.5 ? smoothstep(gradient, 0.0, abs(u_colorRatio * (1.0 + gradient * 2.0) - v_carRatio) ) : 0.0;\n\t\t\tfloat colorMixRatio = step(0.0, u_colorRatio - v_carRatio);\n\t\t\tvec3 carPaint = mix(u_color1, u_color2, colorMixRatio) * 1.5;\n\t\t\tvec3 emission = vec3(emissionIntensity * (carPaint + 1.0));\n\t\t\troughness = v_isCarPaint > 0.5 ? mix(u_carPaintRoughness1, u_carPaintRoughness2, colorMixRatio) : roughness;\n\t\t\talbedo = v_isCarPaint > 0.5 ? carPaint : albedo;\n\t\t\t\n\t\t\tvec3 diffuseColor = albedo;\n\t\t#else\n\t\t\tvec3 diffuseColor = max(vec3(0.08), albedo);\n\t\t#endif\n\n\t\tvec3 specularColor = vec3(v_specular);\n\t#endif\n\n\tvec3 normal = normalize(v_wrappedWorldNormal);\n\tvec3 cameraToWorld = normalize(v_wrappedWorldCameraPosition - v_wrappedWorldPosition);\n\tvec3 position = v_wrappedWorldPosition;\n\tvec3 lightPos = u_areaLightPosition;\n\n\tfloat specularRoughness = normalFiltering(roughness, normal);\n\tvec3 rectCoords[ 4 ];\n\trectCoords[ 0 ] = lightPos + u_areaLightHalfWidth - u_areaLightHalfHeight; // counterclockwise; light shines in local neg z direction\n\trectCoords[ 1 ] = lightPos - u_areaLightHalfWidth - u_areaLightHalfHeight;\n\trectCoords[ 2 ] = lightPos - u_areaLightHalfWidth + u_areaLightHalfHeight;\n\trectCoords[ 3 ] = lightPos + u_areaLightHalfWidth + u_areaLightHalfHeight;\n\tvec2 uv = LTC_Uv( normal, cameraToWorld, specularRoughness );\n\tvec4 t1 = texture2D( u_areaLightLtc1, uv );\n\tvec4 t2 = texture2D( u_areaLightLtc2, uv );\n\tmat3 mInv = mat3(\n\t\tvec3( t1.x, 0, t1.y ),\n\t\tvec3(    0, 1,    0 ),\n\t\tvec3( t1.z, 0, t1.w )\n\t);\n\t// LTC Fresnel Approximation by Stephen Hill\n\t// http://blog.selfshadow.com/publications/s2016-advances/s2016_ltc_fresnel.pdf\n\tvec3 fresnel = ( specularColor * t2.x + ( vec3( 1.0 ) - specularColor ) * t2.y );\n\n\tvec3 color = vec3(0.0);\n\tfloat ao = sqrt(v_occlusion);\n\n\t#ifdef IS_WINDOWS\n\t\tvec3 directDiffuse = vec3(0.0);\n\t\tvec3 directSpecular = fresnel  * LTC_Evaluate(u_areaLightLodTexture, u_areaLightLodTextureMaxLod, u_areaLightLodTextureSize, specularRoughness, normal, cameraToWorld, position, mInv, rectCoords ) * u_areaLightIntensity;\n\t#else\n\t\tvec3 directDiffuse = diffuseColor * LTC_Evaluate(u_areaLightLodTexture, u_areaLightLodTextureMaxLod, u_areaLightLodTextureSize, 1.0, normal, cameraToWorld, position, mat3( 1.0 ), rectCoords ) * u_areaLightIntensity * ao;\n\t\tvec3 directSpecular = vec3(0.0);\n\t\tdirectSpecular += fresnel * LTC_Evaluate(u_areaLightLodTexture, u_areaLightLodTextureMaxLod, u_areaLightLodTextureSize, specularRoughness, normal, cameraToWorld, position, mInv, rectCoords ) * u_areaLightIntensity;\n\t\tdirectSpecular *= clamp( pow( clamp(dot(normal, cameraToWorld), 0.0, 1.0) + ao, exp2( - 16.0 * specularRoughness - 1.0 ) ) - 1.0 + ao, 0.0, 1.0 );\n\t#endif\n\n\tcolor += directDiffuse;\n\tcolor += directSpecular;\n\n\t// color *= ao;\n\n\t#ifdef IS_WINDOWS\n\t\tgl_FragColor = vec4(color, 0.1);\n\t#else\n\t\tgl_FragColor = vec4(color, 1.0);\n\t\t#ifdef IS_FULLBODY\n\t\t\tgl_FragColor.rgb += emission;\n\t\t#endif \n\t#endif\n}'])}));if(n.material.extensions.derivatives=!0,n.onBeforeRender=this.onMeshBeforeRender.bind(this,n),"full_body"==e)n.material.defines.IS_FULLBODY=!0,this.bodyMesh=n,this.container.add(n);else if("full_tire"===e)for(var r in f){var a=new h.Object3D,o=new h.Mesh(t,new h.ShaderMaterial({uniforms:c({u_worldNormalMatrix:{value:new h.Matrix3}},u.sharedUniforms,p.sharedUniforms),vertexShader:n.material.vertexShader,fragmentShader:n.material.fragmentShader}));o.material.extensions.derivatives=!0,a.add(o),this.container.add(a),o.onBeforeRender=this.onMeshBeforeRender.bind(this,o);var s=f[r];o.userData.config=s,a.position.copy(s),a.rotation.y=s.isFlipped?Math.PI:0,this.tireContainers.push(a),this.tireMeshes.push(o)}else n.material.transparent=!0,n.material.defines.IS_WINDOWS=!0,n.material.blending=h.CustomBlending,n.material.blendSrc=h.OneFactor,n.material.blendDst=h.OneMinusSrcAlphaFactor,n.material.blendSrcAlpha=h.ZeroFactor,n.material.blendDstAlpha=h.OneFactor,this.windowsMesh=n,this.container.add(n)}},{key:"onMeshBeforeRender",value:function(e){e.material.uniforms.u_worldNormalMatrix.value.getNormalMatrix(e.matrixWorld)}},{key:"init",value:function(){this.hasInitialized=!0}},{key:"resize",value:function(e,t){}},{key:"update",value:function(e){for(var t=0,n=this.tireMeshes.length;t<n;t++){var r=this.tireMeshes[t];r.rotation.x=-u.sharedUniforms.u_posZOffset.value/.754819*(r.userData.config.isFlipped?-1:1)}this.colorRatio=Math.min(this.colorRatio+2*e,1),this.sharedUniforms.u_colorRatio.value=this.colorRatio,this.sharedUniforms.u_color1.value.setStyle(this.color1),this.sharedUniforms.u_color2.value.setStyle(this.color2),this.sharedUniforms.u_carPaintRoughness1.value=this.carPaintRoughness1,this.sharedUniforms.u_carPaintRoughness2.value=this.carPaintRoughness2}}]),e}();t.exports=new v},{"../../../core/properties":71,"../../../core/settings":72,"../../../effects/glPositionOffset/glPositionOffset":76,"../../carTiresConfigs":107,"../stage1AreaLight/stage1AreaLight":117,"@babel/runtime/helpers/classCallCheck":6,"@babel/runtime/helpers/createClass":7,"@babel/runtime/helpers/defineProperty":8,"@babel/runtime/helpers/interopRequireDefault":12,glslify:26,"mout/object/mixIn":45,three:63}],119:[function(e,t,n){"use strict";var r=e("../../../core/browser"),i=e("../../../core/settings"),a=e("../../../core/properties"),o=e("../../../helpers/fboHelper"),s=e("../../../effects/mipmapper/Mipmapper"),l=e("../../../effects/blur/blur"),u=e("../../../utils/math"),c=e("../stage1AreaLight/stage1AreaLight"),h=(e("mout/object/mixIn"),e("three")),d=e("glslify");n.preInit=function(){O=n.container=new h.Object3D,(f=a.loader.add(i.TEXTURE_PATH+"floor.jpg",{type:"texture",weight:519}).content).wrapS=f.wrapT=h.RepeatWrapping,p=a.loader.add(i.TEXTURE_PATH+"stage1_floor_ao.png",{type:"texture",weight:90,minFilter:h.LinearFilter}).content},n.init=function(){v=new s,m=new h.Vector2,(g=o.createRenderTarget(1,1)).depthBuffer=!0,_=new h.Matrix4,D=new h.Matrix4,I=new h.Matrix4,y=0,x=new h.PerspectiveCamera,b=new h.Plane,w=new h.Vector3,T=new h.Vector3,M=new h.Vector3,S=new h.Matrix4,E=new h.Vector3,A=new h.Vector4,L=new h.Vector3,C=new h.Vector3,R=new h.Vector3,k=new h.Vector4,(P=new h.PlaneBufferGeometry(50,50)).rotateX(-.5*Math.PI),(F=n.mesh=new h.Mesh(P,new h.ShaderMaterial({uniforms:{u_infoTexture:{value:f},u_aoTexture:{value:p},u_textureMatrix:{value:_},u_textureSize:{value:m},u_mipmapTextureSize:{value:v.textureSize},u_mipmapTexture:{value:g.texture},u_mipmapMaxLod:{value:1},u_randSeed:{value:0},u_posZOffset:c.sharedUniforms.u_posZOffset},vertexShader:d(["#define GLSLIFY 1\nuniform mat4 u_textureMatrix;\nuniform float u_posZOffset;\n\nvarying vec2 v_uv;\nvarying vec2 v_uv2;\nvarying vec2 v_aoUv;\nvarying vec4 v_reflectionTextureUv;\nvarying vec3 v_worldPosition;\n\nvarying vec3 v_viewNormal;\nvarying vec3 v_viewPosition;\n\nvoid main () {\n\tvec3 pos = position;\n\tpos.z -= u_posZOffset;\n\n\tv_uv = pos.xz * 0.08;\n\tv_uv2 = pos.xz * 0.19 + 0.321;\n\tvec3 reflectionPos = position;\n\t// reflectionPos.y = -0.05;\n\tv_reflectionTextureUv = u_textureMatrix * vec4( reflectionPos, 1.0 );\n\n\tv_worldPosition = position;\n\n\tv_viewNormal = normalMatrix * normal;\n\n\tv_aoUv = v_worldPosition.xz / vec2(5.0, 15.0) * 0.5 + 0.5;\n\n\tvec4 mvPosition = modelViewMatrix * vec4(position, 1.0);\n\tv_viewPosition = -mvPosition.xyz;\n\tgl_Position = projectionMatrix * mvPosition;\n}"]),fragmentShader:d(["#define GLSLIFY 1\nuniform sampler2D u_infoTexture;\nuniform sampler2D u_aoTexture;\n\nuniform sampler2D u_mipmapTexture;\nuniform vec2 u_textureSize;\nuniform vec2 u_mipmapTextureSize;\nuniform float u_mipmapMaxLod;\nuniform float u_noiseTime;\n\n#include <textureBicubic>\n#include <lodMipmapSample>\n\nvarying vec4 v_reflectionTextureUv;\nvarying vec2 v_uv;\nvarying vec2 v_uv2;\nvarying vec2 v_aoUv;\nvarying vec3 v_worldPosition;\nvarying vec3 v_viewNormal;\nvarying vec3 v_viewPosition;\n\n#define roughLodSample lodMipmapSampleCubic\n\nfloat sdBox(vec3 p, vec3 b) {\n    vec3 q = abs(p) - b;\n    return length(max(q, 0.0)) + min(max(q.x, max(q.y, q.z)), 0.0);\n}\n\nvoid main () {\n\tvec3 viewNormal = normalize(v_viewNormal);\n\tfloat d = dot(viewNormal, normalize(v_viewPosition));\n\tfloat f = smoothstep(0.95, 1.0, d);\n\t\n\tvec2 ao2 = texture2D(u_aoTexture, v_aoUv).rg;\n\n\tvec2 reflectionUv = v_reflectionTextureUv.xy / v_reflectionTextureUv.w;\n\n\tfloat lodRatio = u_mipmapMaxLod / 12.0;\n\n\tfloat lodMultiplier = 0.1 + 0.28 * ao2.g;\n\tfloat baseLod = 6.0 * ao2.g;\n    vec3 color = lodMipmapSampleCubic(u_mipmapTexture, reflectionUv, baseLod * lodRatio, u_mipmapTextureSize).rgb;\n\t\n\tvec3 info;\n\tvec3 blury;\n\tinfo = texture2D(u_infoTexture, v_uv).rgb;\n    blury = roughLodSample(u_mipmapTexture, reflectionUv + info.br / 128.0 * lodMultiplier, (info.r * info.g * 8.0 * lodMultiplier + baseLod) * lodRatio, u_mipmapTextureSize).rgb;\n\tcolor = mix(color, blury, clamp((info.g - 0.25) * 5.0, 0.0, 1.0));\n\t\n\tinfo = texture2D(u_infoTexture, v_uv2).rgb;\n    blury = roughLodSample(u_mipmapTexture, reflectionUv, (info.r * 5.0 * lodMultiplier + baseLod) * lodRatio, u_mipmapTextureSize).rgb;\n\tcolor = mix(color, blury, clamp((info.b - 0.3) *  7.0, 0.0, 1.0));\n\n\tgl_FragColor = vec4(color * mix(0.75, 1.0, info.g) * ao2.r, 1.0);\n\n}"])}))).name="floor",F.userData.skipReflection=!0,O.add(F),(r.isMobile||r.isOculusBrowser)&&(F.material.defines.IS_MOBILE=!0);F.onBeforeRender=N,D.makeRotationX(-.5*Math.PI),D.premultiply(I)},n.resize=function(e,t){if(!m)return;var n=r.isMobile?.5:1;e=2*Math.ceil(e*n/2),t=2*Math.ceil(t*n/2),e=u.powerTwoFloor(e),t=u.powerTwoFloor(t),a.renderer.xr.isPresenting&&(e=2*Math.ceil(e/4));m.set(e,t),g.setSize(1.5*m.x,m.y),v.resize(m.x,m.y,g.width,g.height),F.material.uniforms.u_mipmapMaxLod.value=v.maxMipmapLevel};var f,p,v,m,g,_,y,x,b,w,T,M,S,E,A,L,C,R,k,P,D,I,O=n.container=null,F=n.mesh=null;function N(e,t,n){if(m){if("recursion"in n.userData){if(n.userData.recursion===recursion)return;n.userData.recursion++}if(T.setFromMatrixPosition(D),M.setFromMatrixPosition(n.matrixWorld),S.extractRotation(D),w.set(0,0,1),w.applyMatrix4(S),C.subVectors(T,M),!(C.dot(w)>0)){C.reflect(w).negate(),C.add(T),S.extractRotation(n.matrixWorld),E.set(0,0,-1),E.applyMatrix4(S),E.add(M),R.subVectors(T,E),R.reflect(w).negate(),R.add(T),x.position.copy(C),x.up.set(0,1,0),x.up.applyMatrix4(S),x.up.reflect(w),x.lookAt(R),x.near=n.near,x.far=n.far,x.updateMatrixWorld(),x.projectionMatrix.copy(n.projectionMatrix),_.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),_.multiply(x.projectionMatrix),_.multiply(x.matrixWorldInverse),_.multiply(F.matrixWorld),b.setFromNormalAndCoplanarPoint(w,T),b.applyMatrix4(x.matrixWorldInverse),A.set(b.normal.x,b.normal.y,b.normal.z,b.constant);var r=x.projectionMatrix;k.x=(Math.sign(A.x)+r.elements[8])/r.elements[0],k.y=(Math.sign(A.y)+r.elements[9])/r.elements[5],k.z=-1,k.w=(1+r.elements[10])/r.elements[14],A.multiplyScalar(2/A.dot(k)),r.elements[2]=A.x,r.elements[6]=A.y,r.elements[10]=A.z+1-y,r.elements[14]=A.w,L.setFromMatrixPosition(n.matrixWorld);var i=e.getRenderTarget(),o=e.xr.enabled,s=e.shadowMap.autoUpdate;e.xr.enabled=!1,e.shadowMap.autoUpdate=!1,e.setRenderTarget(g),e.setViewport(0,0,m.x,m.y),a.renderer.xr.isPresenting?(e.setScissor(0,0,a.width,a.height),e.setScissorTest(!1)):(e.setScissor(0,0,m.x,m.y),e.setScissorTest(!0)),a.scene.traverse(U),e.render(t,x),e.setRenderTarget(null),e.setViewport(0,0,a.width,a.height),a.renderer.xr.isPresenting||e.setScissor(0,0,a.width,a.height),l.blur9(4,.5,g),v.render(g),e.xr.enabled=o,e.shadowMap.autoUpdate=s,e.setRenderTarget(i),e.setViewport(0,0,a.width,a.height),e.setScissorTest(!1);var u=n.viewport;void 0!==u&&e.state.viewport(u),a.scene.traverse(B),F.material.uniforms.u_randSeed.value=1e3*Math.random()}}}function U(e){e.userData.skipReflection?(e.userData.isVisible=e.visible,e.visible=!1):e.material&&e.material.uniforms&&e.material.uniforms.u_isReflection&&(e.material.uniforms.u_isReflection.value=1)}function B(e){e.userData.skipReflection?e.visible=e.userData.isVisible:e.material&&e.material.uniforms&&e.material.uniforms.u_isReflection&&(e.material.uniforms.u_isReflection.value=0)}},{"../../../core/browser":70,"../../../core/properties":71,"../../../core/settings":72,"../../../effects/blur/blur":74,"../../../effects/mipmapper/Mipmapper":77,"../../../helpers/fboHelper":79,"../../../utils/math":104,"../stage1AreaLight/stage1AreaLight":117,glslify:26,"mout/object/mixIn":45,three:63}],120:[function(e,t,n){"use strict";var r=e("@babel/runtime/helpers/interopRequireDefault"),i=r(e("@babel/runtime/helpers/classCallCheck")),a=r(e("@babel/runtime/helpers/createClass")),o=(e("../../../core/settings"),e("../../../core/properties")),s=(e("../../../helpers/fboHelper"),e("../stage1AreaLight/stage1AreaLight")),l=e("mout/object/mixIn"),u=e("three"),c=e("glslify"),h=function(){function e(){(0,i.default)(this,e),this.container=new u.Object3D,this.mesh=null,this.lightMesh=null,this.pointMesh=null,this.hasInitialized=!1,this.instanceCount=16,this.sharedUniforms={u_time:{value:0},u_ringDistance:{value:0}}}return(0,a.default)(e,[{key:"preInit",value:function(){this.sharedUniforms.u_ringDistance.value=1/(this.instanceCount-1)*s.HEIGHT*2}},{key:"init",value:function(){this._initMainMesh(),this._initFloorPointMesh(),this.hasInitialized=!0}},{key:"_initMainMesh",value:function(){var e=new u.CylinderBufferGeometry(1,1,1,4,64),t=new u.InstancedBufferGeometry;for(var n in e.attributes)t.setAttribute(n,e.attributes[n]);t.setIndex(e.getIndex());for(var r=new Uint8Array(this.instanceCount),i=0;i<this.instanceCount;i++)r[i]=i;t.setAttribute("instanceId",new u.InstancedBufferAttribute(r,1)),t.rotateY(.25*Math.PI),t.translate(0,.5001,0),this.mesh=new u.Mesh(t,new u.ShaderMaterial({uniforms:l({u_time:this.sharedUniforms.u_time,u_ringDistance:this.sharedUniforms.u_ringDistance,u_instanceCount:{value:this.instanceCount}},s.sharedUniforms),vertexShader:c(["#define GLSLIFY 1\nattribute float instanceId;\n\nuniform float u_time;\nuniform float u_instanceCount;\nuniform float u_ringDistance;\nuniform vec3 u_areaLightSize;\nuniform float u_posZOffset;\nuniform float u_cinematicRatio;\n\n#ifdef IS_POINTS\n\tattribute float instanceSide;\n\tvarying vec2 v_uv;\n#else\n\tvarying vec3 v_viewNormal;\n#endif\n\nvarying float v_intensity;\n\nvec2 rotate(vec2 v, float a) {\n\tfloat s = sin(a);\n\tfloat c = cos(a);\n\tmat2 m = mat2(c, -s, s, c);\n\treturn m * v;\n}\n\n#ifdef IS_LIGHT\n\tvec3 wrapPosition (vec3 worldPos) {\n\t\treturn vec3 (\n\t\t\t1.0 - atan(worldPos.y, -worldPos.x) / 1.5707963267948966,\n\t\t\tworldPos.z / u_areaLightSize.y * 2.0,\n\t\t\t0.0\n\t\t);\n\t}\n\tvec3 wrapDirection (vec3 worldPos, vec3 v) {\n\t\tfloat offsetAngle = 1.5707963267948966 - atan(worldPos.y, -worldPos.x);\n\t\tv.xy = rotate(v.xy, offsetAngle);\n\t\treturn v;\n\t}\n#endif\n\nvoid main () {\n\n\tfloat radius = 4.0;\n\tfloat tubeRadius = 0.075;\n\tfloat tubeRadiusZ = 0.0375;\n\t#ifdef IS_LIGHT\n\ttubeRadiusZ *= 3.0;\n\t#endif\n\n\tfloat ringRatio;\n\t#ifdef IS_POINTS\n\t\tringRatio = 0.5 - instanceSide * 0.5;\n\t\tvec3 pos = vec3(\n\t\t\tradius * instanceSide + position.x * tubeRadius * 25.0,\n\t\t\t0.001,\n\t\t\tposition.z * tubeRadiusZ * 25.0\n\t\t);\n\t\tv_uv = uv;\n\t#else\n\t\tringRatio = position.y;\n\t\tfloat angle = 3.141592653589793 * ringRatio;\n\t\tvec3 pos = vec3(\n\t\t\tcos(angle) * (radius + position.x * tubeRadius),\n\t\t\tsin(angle) * (radius + position.x * tubeRadius),\n\t\t\tposition.z * tubeRadiusZ\n\t\t);\n\t\tv_viewNormal = normal;\n\t\tv_viewNormal.xy = rotate(v_viewNormal.xy, -angle);\n\t\tv_viewNormal = normalMatrix * v_viewNormal;\n\t#endif\n\tpos.z += instanceId * u_ringDistance - u_areaLightSize.y + mod(u_posZOffset, u_ringDistance);\n\n\t// v_intensity = cos(u_time * 1.5+ instanceId * 0.5 - ringRatio * 0.0) * 0.5 + 0.5;\n\tv_intensity = cos(u_time * 1.75 + pos.z * 0.075) * 0.5 + 0.5;\n\n\tv_intensity = min(v_intensity + u_cinematicRatio , 1.0);\n\t// v_intensity = fract(u_time * 0.5 + instanceId * 0.1 - ringRatio * 0.0);\n\t// v_intensity = max(0.0, fract(u_time * 0.5 + instanceId * 0.1 - ringRatio * 0.0) * 2.0 - 1.0) * 0.99 + 0.01;\n\n\tv_intensity *= smoothstep(u_areaLightSize.y, u_areaLightSize.y - u_ringDistance, abs(pos.z));\n\n\t#ifdef IS_LIGHT\n\tgl_Position = vec4(wrapPosition(pos), 1.0);\n\t#else\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4(pos, 1.0);\n\t#endif\n\n}"]),fragmentShader:c(["#define GLSLIFY 1\n#ifdef IS_POINTS\n\tvarying vec2 v_uv;\n\tfloat sdBox( vec2 p, vec2 b ) {\n\t\tvec2 q = abs(p) - b;\n\t\treturn length(max(q,0.0)) + min(max(q.x, q.y),0.0);\n\t}\n#else\n\tvarying vec3 v_viewNormal;\n#endif\n\nvarying float v_intensity;\n\nvoid main () {\n\t#ifdef IS_POINTS\n\tvec2 toCenter = (v_uv - 0.5) * 2.0;\n\t// gl_FragColor = vec4(v_intensity, v_intensity, v_intensity, max(0.0, 1.0 - pow(smoothstep(0.06, 1.0, length(toCenter)), 0.15)) * 0.5);\n\tgl_FragColor = vec4(v_intensity, v_intensity, v_intensity, pow(0.975 - clamp(sdBox(toCenter, vec2(0.05, 0.065)), 0.0, 1.0), 5.0));\n\t#else\n\tvec3 viewNormal = normalize(v_viewNormal);\n\tgl_FragColor = vec4(v_intensity * (1.0 + abs(viewNormal.z) * 0.25));\n\t#endif\n}"])})),this.mesh.frustumCulled=!1,this.container.add(this.mesh),this.lightMesh=new u.Mesh(t,new u.ShaderMaterial({uniforms:l({},this.mesh.material.uniforms),vertexShader:c(["#define GLSLIFY 1\nattribute float instanceId;\n\nuniform float u_time;\nuniform float u_instanceCount;\nuniform float u_ringDistance;\nuniform vec3 u_areaLightSize;\nuniform float u_posZOffset;\nuniform float u_cinematicRatio;\n\n#ifdef IS_POINTS\n\tattribute float instanceSide;\n\tvarying vec2 v_uv;\n#else\n\tvarying vec3 v_viewNormal;\n#endif\n\nvarying float v_intensity;\n\nvec2 rotate(vec2 v, float a) {\n\tfloat s = sin(a);\n\tfloat c = cos(a);\n\tmat2 m = mat2(c, -s, s, c);\n\treturn m * v;\n}\n\n#ifdef IS_LIGHT\n\tvec3 wrapPosition (vec3 worldPos) {\n\t\treturn vec3 (\n\t\t\t1.0 - atan(worldPos.y, -worldPos.x) / 1.5707963267948966,\n\t\t\tworldPos.z / u_areaLightSize.y * 2.0,\n\t\t\t0.0\n\t\t);\n\t}\n\tvec3 wrapDirection (vec3 worldPos, vec3 v) {\n\t\tfloat offsetAngle = 1.5707963267948966 - atan(worldPos.y, -worldPos.x);\n\t\tv.xy = rotate(v.xy, offsetAngle);\n\t\treturn v;\n\t}\n#endif\n\nvoid main () {\n\n\tfloat radius = 4.0;\n\tfloat tubeRadius = 0.075;\n\tfloat tubeRadiusZ = 0.0375;\n\t#ifdef IS_LIGHT\n\ttubeRadiusZ *= 3.0;\n\t#endif\n\n\tfloat ringRatio;\n\t#ifdef IS_POINTS\n\t\tringRatio = 0.5 - instanceSide * 0.5;\n\t\tvec3 pos = vec3(\n\t\t\tradius * instanceSide + position.x * tubeRadius * 25.0,\n\t\t\t0.001,\n\t\t\tposition.z * tubeRadiusZ * 25.0\n\t\t);\n\t\tv_uv = uv;\n\t#else\n\t\tringRatio = position.y;\n\t\tfloat angle = 3.141592653589793 * ringRatio;\n\t\tvec3 pos = vec3(\n\t\t\tcos(angle) * (radius + position.x * tubeRadius),\n\t\t\tsin(angle) * (radius + position.x * tubeRadius),\n\t\t\tposition.z * tubeRadiusZ\n\t\t);\n\t\tv_viewNormal = normal;\n\t\tv_viewNormal.xy = rotate(v_viewNormal.xy, -angle);\n\t\tv_viewNormal = normalMatrix * v_viewNormal;\n\t#endif\n\tpos.z += instanceId * u_ringDistance - u_areaLightSize.y + mod(u_posZOffset, u_ringDistance);\n\n\t// v_intensity = cos(u_time * 1.5+ instanceId * 0.5 - ringRatio * 0.0) * 0.5 + 0.5;\n\tv_intensity = cos(u_time * 1.75 + pos.z * 0.075) * 0.5 + 0.5;\n\n\tv_intensity = min(v_intensity + u_cinematicRatio , 1.0);\n\t// v_intensity = fract(u_time * 0.5 + instanceId * 0.1 - ringRatio * 0.0);\n\t// v_intensity = max(0.0, fract(u_time * 0.5 + instanceId * 0.1 - ringRatio * 0.0) * 2.0 - 1.0) * 0.99 + 0.01;\n\n\tv_intensity *= smoothstep(u_areaLightSize.y, u_areaLightSize.y - u_ringDistance, abs(pos.z));\n\n\t#ifdef IS_LIGHT\n\tgl_Position = vec4(wrapPosition(pos), 1.0);\n\t#else\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4(pos, 1.0);\n\t#endif\n\n}"]),fragmentShader:c(["#define GLSLIFY 1\n#ifdef IS_POINTS\n\tvarying vec2 v_uv;\n\tfloat sdBox( vec2 p, vec2 b ) {\n\t\tvec2 q = abs(p) - b;\n\t\treturn length(max(q,0.0)) + min(max(q.x, q.y),0.0);\n\t}\n#else\n\tvarying vec3 v_viewNormal;\n#endif\n\nvarying float v_intensity;\n\nvoid main () {\n\t#ifdef IS_POINTS\n\tvec2 toCenter = (v_uv - 0.5) * 2.0;\n\t// gl_FragColor = vec4(v_intensity, v_intensity, v_intensity, max(0.0, 1.0 - pow(smoothstep(0.06, 1.0, length(toCenter)), 0.15)) * 0.5);\n\tgl_FragColor = vec4(v_intensity, v_intensity, v_intensity, pow(0.975 - clamp(sdBox(toCenter, vec2(0.05, 0.065)), 0.0, 1.0), 5.0));\n\t#else\n\tvec3 viewNormal = normalize(v_viewNormal);\n\tgl_FragColor = vec4(v_intensity * (1.0 + abs(viewNormal.z) * 0.25));\n\t#endif\n}"])})),this.lightMesh.frustumCulled=!1,this.lightMesh.material.defines.IS_LIGHT=!0,s.scene.add(this.lightMesh)}},{key:"_initFloorPointMesh",value:function(){var e=new u.PlaneBufferGeometry(1,1);e.rotateX(-.5*Math.PI);var t=new u.InstancedBufferGeometry;for(var n in e.attributes)t.setAttribute(n,e.attributes[n]);t.setIndex(e.getIndex());for(var r=new Uint8Array(2*this.instanceCount),i=new Int8Array(2*this.instanceCount),a=0;a<2*this.instanceCount;a++)r[a]=~~(a/2),i[a]=a%2*2-1;t.setAttribute("instanceId",new u.InstancedBufferAttribute(r,1)),t.setAttribute("instanceSide",new u.InstancedBufferAttribute(i,1)),this.pointMesh=new u.Mesh(t,new u.ShaderMaterial({uniforms:l({u_time:this.sharedUniforms.u_time,u_ringDistance:this.sharedUniforms.u_ringDistance,u_instanceCount:{value:this.instanceCount}},s.sharedUniforms),vertexShader:c(["#define GLSLIFY 1\nattribute float instanceId;\n\nuniform float u_time;\nuniform float u_instanceCount;\nuniform float u_ringDistance;\nuniform vec3 u_areaLightSize;\nuniform float u_posZOffset;\nuniform float u_cinematicRatio;\n\n#ifdef IS_POINTS\n\tattribute float instanceSide;\n\tvarying vec2 v_uv;\n#else\n\tvarying vec3 v_viewNormal;\n#endif\n\nvarying float v_intensity;\n\nvec2 rotate(vec2 v, float a) {\n\tfloat s = sin(a);\n\tfloat c = cos(a);\n\tmat2 m = mat2(c, -s, s, c);\n\treturn m * v;\n}\n\n#ifdef IS_LIGHT\n\tvec3 wrapPosition (vec3 worldPos) {\n\t\treturn vec3 (\n\t\t\t1.0 - atan(worldPos.y, -worldPos.x) / 1.5707963267948966,\n\t\t\tworldPos.z / u_areaLightSize.y * 2.0,\n\t\t\t0.0\n\t\t);\n\t}\n\tvec3 wrapDirection (vec3 worldPos, vec3 v) {\n\t\tfloat offsetAngle = 1.5707963267948966 - atan(worldPos.y, -worldPos.x);\n\t\tv.xy = rotate(v.xy, offsetAngle);\n\t\treturn v;\n\t}\n#endif\n\nvoid main () {\n\n\tfloat radius = 4.0;\n\tfloat tubeRadius = 0.075;\n\tfloat tubeRadiusZ = 0.0375;\n\t#ifdef IS_LIGHT\n\ttubeRadiusZ *= 3.0;\n\t#endif\n\n\tfloat ringRatio;\n\t#ifdef IS_POINTS\n\t\tringRatio = 0.5 - instanceSide * 0.5;\n\t\tvec3 pos = vec3(\n\t\t\tradius * instanceSide + position.x * tubeRadius * 25.0,\n\t\t\t0.001,\n\t\t\tposition.z * tubeRadiusZ * 25.0\n\t\t);\n\t\tv_uv = uv;\n\t#else\n\t\tringRatio = position.y;\n\t\tfloat angle = 3.141592653589793 * ringRatio;\n\t\tvec3 pos = vec3(\n\t\t\tcos(angle) * (radius + position.x * tubeRadius),\n\t\t\tsin(angle) * (radius + position.x * tubeRadius),\n\t\t\tposition.z * tubeRadiusZ\n\t\t);\n\t\tv_viewNormal = normal;\n\t\tv_viewNormal.xy = rotate(v_viewNormal.xy, -angle);\n\t\tv_viewNormal = normalMatrix * v_viewNormal;\n\t#endif\n\tpos.z += instanceId * u_ringDistance - u_areaLightSize.y + mod(u_posZOffset, u_ringDistance);\n\n\t// v_intensity = cos(u_time * 1.5+ instanceId * 0.5 - ringRatio * 0.0) * 0.5 + 0.5;\n\tv_intensity = cos(u_time * 1.75 + pos.z * 0.075) * 0.5 + 0.5;\n\n\tv_intensity = min(v_intensity + u_cinematicRatio , 1.0);\n\t// v_intensity = fract(u_time * 0.5 + instanceId * 0.1 - ringRatio * 0.0);\n\t// v_intensity = max(0.0, fract(u_time * 0.5 + instanceId * 0.1 - ringRatio * 0.0) * 2.0 - 1.0) * 0.99 + 0.01;\n\n\tv_intensity *= smoothstep(u_areaLightSize.y, u_areaLightSize.y - u_ringDistance, abs(pos.z));\n\n\t#ifdef IS_LIGHT\n\tgl_Position = vec4(wrapPosition(pos), 1.0);\n\t#else\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4(pos, 1.0);\n\t#endif\n\n}"]),fragmentShader:c(["#define GLSLIFY 1\n#ifdef IS_POINTS\n\tvarying vec2 v_uv;\n\tfloat sdBox( vec2 p, vec2 b ) {\n\t\tvec2 q = abs(p) - b;\n\t\treturn length(max(q,0.0)) + min(max(q.x, q.y),0.0);\n\t}\n#else\n\tvarying vec3 v_viewNormal;\n#endif\n\nvarying float v_intensity;\n\nvoid main () {\n\t#ifdef IS_POINTS\n\tvec2 toCenter = (v_uv - 0.5) * 2.0;\n\t// gl_FragColor = vec4(v_intensity, v_intensity, v_intensity, max(0.0, 1.0 - pow(smoothstep(0.06, 1.0, length(toCenter)), 0.15)) * 0.5);\n\tgl_FragColor = vec4(v_intensity, v_intensity, v_intensity, pow(0.975 - clamp(sdBox(toCenter, vec2(0.05, 0.065)), 0.0, 1.0), 5.0));\n\t#else\n\tvec3 viewNormal = normalize(v_viewNormal);\n\tgl_FragColor = vec4(v_intensity * (1.0 + abs(viewNormal.z) * 0.25));\n\t#endif\n}"])})),this.pointMesh.material.defines.IS_POINTS=!0,this.pointMesh.frustumCulled=!1,this.pointMesh.material.depthWrite=!1,this.pointMesh.material.transparent=!0,this.pointMesh.material.blending=u.CustomBlending,this.pointMesh.material.blendSrc=u.SrcAlphaFactor,this.pointMesh.material.blendDst=u.OneMinusSrcAlphaFactor,this.pointMesh.material.blendSrcAlpha=u.OneFactor,this.pointMesh.material.blendDstAlpha=u.OneFactor,this.container.add(this.pointMesh)}},{key:"resize",value:function(e,t){}},{key:"update",value:function(e){this.hasInitialized&&(this.sharedUniforms.u_time.value+=-1*e,1==o.cinematicRatio&&(this.sharedUniforms.u_time.value=0))}}]),e}();t.exports=new h},{"../../../core/properties":71,"../../../core/settings":72,"../../../helpers/fboHelper":79,"../stage1AreaLight/stage1AreaLight":117,"@babel/runtime/helpers/classCallCheck":6,"@babel/runtime/helpers/createClass":7,"@babel/runtime/helpers/interopRequireDefault":12,glslify:26,"mout/object/mixIn":45,three:63}],121:[function(e,t,n){"use strict";t.exports=[{color1:"#ffffff",color2:"#adadad",isShinny:!0,isSelected:!0},{color1:"#060606",color2:"#3b3131",isShinny:!0},{color1:"#ff006b",color2:"#ff91be",isShinny:!0},{color1:"#ff0000",color2:"#ff7171",isShinny:!0},{color1:"#ffa000",color2:"#fec567",isShinny:!0},{color1:"#12e800",color2:"#a3c89f",isShinny:!0},{color1:"#0038ff",color2:"#567cff",isShinny:!0}]},{}],122:[function(e,t,n){"use strict";var r=e("../core/settings"),i=e("../core/properties"),a=e("../utils/math"),o=e("../audios/audios"),s=e("./stage0/stage0"),l=e("./stage1/stage1"),u=e("three"),c=e("min-signal"),h=e("mout/queryString/getQuery");n.preInit=function(){n.container=new u.Object3D;for(var e=0;e<d.length;e++){var t=d[e];t.preInit(),n.container.add(t.container)}},n.init=function(){for(var e=0;e<d.length;e++){d[e].init()}},n.changeToNext=function(){p((f+1)%d.length)},n.changeTo=p,n.resize=function(e,t){for(var n=0;n<d.length;n++){d[n].resize(e,t)}},n.update=function(e){for(var t=function(t){var s=d[t],l=s.isActive,u=t===f;u!==l&&(u?(n.isIdle=!1,s.show(),i.final.cachePreviousFrame(i.postprocessing),o.play("transition"),n.onChangeStarted.dispatch(s),history.pushState({},"",(0==t?r.STAGE_0_ID:r.STAGE_1_ID)+h(window.location.href)),gsap.to(n,{duration:1,currentIndexRatio:f,ease:Linear.easeNone}),gsap.set(i,{cacheBlendRatio:1,cacheBlendDirection:1==f?-1:1,ease:Linear.easeNone}),gsap.to(i,{duration:1,cacheBlendRatio:0,ease:Expo.easeInOut,onComplete:function(){n.isIdle=!0,n.onChangeCompleted.dispatch(s)}})):s.hide()),s.isActive&&(i.cacheBlendRatio>.5&&(i.cameraDollyZoomFovOffset=0==s.index?70:40),i.visualTimeScale=0==s.index?a.mix(1,.1,i.cinematicRatio):1,s.update(e))},s=0;s<d.length;s++)t(s)},n.isIdle=!0,n.currentIndexRatio=0,n.onChangeStarted=new c,n.onChangeCompleted=new c;var d=[s,l],f=r.DEFAULT_STAGE_INDEX;function p(e){f!=e&&n.isIdle&&(n.isIdle=!1,f=e)}},{"../audios/audios":66,"../core/properties":71,"../core/settings":72,"../utils/math":104,"./stage0/stage0":111,"./stage1/stage1":116,"min-signal":29,"mout/queryString/getQuery":47,three:63}],123:[function(e,t,n){"use strict";var r,i,a,o,s,l=e("../core/settings"),u=e("../core/properties"),c=e("three"),h=e("./stages");function d(e){r=new c.Mesh(e,new c.MeshBasicMaterial)}function f(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:a;if(!r)return!1;i.setFromCamera(t,u.camera);var n=i.intersectObject(r);return n.length?(e.copy(n[0].point),1):(i.ray.intersectPlane(o,e),2)}n.preInit=function(){n.container=new c.Object3D,i=new c.Raycaster,a=new c.Vector2,s=new c.Vector3,o=new c.Plane(new c.Vector3(0,1,0),0),u.loader.add(l.MODEL_PATH+"low.buf",{weight:10,onLoad:d}),h.preInit(),n.container.add(h.container)},n.init=function(){h.init()},n.onDown=function(){return},n.rayCastCar=f,n.resize=function(e,t){h.resize(e,t)},n.update=function(e){if(h.update(e),u.bokehAutoDistance){var t=u.camera.far;f(s)&&(t=Math.min(t,s.distanceTo(u.camera.position)));var n=.08*(t-u.bokehFocusDistance);n=Math.min(Math.abs(n),.25)*Math.sign(n),u.bokehFocusDistance+=n}},n.container=null},{"../core/properties":71,"../core/settings":72,"./stages":122,three:63}]},{},[82]);