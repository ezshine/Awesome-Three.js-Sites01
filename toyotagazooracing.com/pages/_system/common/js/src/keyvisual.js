(function(f){var i=(function(){var o={SP:0,PC:1};var u={TOP:0,DETAIL:1};var p={NONE:0,NORMAL:1,SLIDESHOW:2};var v={BOTH:"1",PC:"2",MOBILE:"3"};function z(F,A,B,D,E){this.layout=(A?o.PC:o.SP);this.pageType=B;this.kvs=[];var C=m(F,D);if(this.layout===o.PC){this.items=n(C)}else{this.items=y(C)}if(this.layout===o.SP&&B===u.TOP){this.items=$.grep(this.items,function(H,G){return(H.type===v.PC)?false:true},false)}this.setting={enableOnDetailPage:C.keyvisualEnableOnDetailPage,dispContents:E,sliderOption:j(C)}}function t(A){if(this.items.length===0||(this.pageType===u.DETAIL&&this.setting.enableOnDetailPage!=="1")){return null}var D=[];if(this.items.length>1){A.find(".share").remove()}var C=this.layout;var B=this.setting.dispContents;$.each(this.items,function(){var E=new c(A.clone(true),this,C);D.push(E.toHtml(B))});return(this.items.length>1)?$("<div/>").addClass("slides is-hidden").append(D):D[0]}function m(D,C){var B;if(!D.keyVisualInfo){B={items:[]}}else{var A=D.keyVisualInfo.keyValues;if(A&&A.keyVisualInfo){B=$.extend({},A.keyVisualInfo);if(!B.items){B.items=[]}}}$.each(B.items,function(){$.extend(this,{origHref:C.href,origTarget:C.target})});return B}function n(B){var A=[];$.each(B.items,function(){var D=this.keyvisualDisplayType;var C=this.keyvisualImage;if((D===v.BOTH||D===v.PC)&&l(C)){A.push({type:v.PC,image:C,prop:this})}});return A}function y(B){var A=[];$.each(B.items,function(){var D=this.keyvisualDisplayType;var C=this.keyvisualImage;var E=this.keyvisualMobileImage;if((D===v.MOBILE||D===v.BOTH)&&l(E)){A.push({type:v.MOBILE,image:E,prop:this})}else{if(D===v.BOTH&&l(C)){A.push({type:v.PC,image:C,prop:this})}}});return A}function j(C){var B={startSlide:0,slideMargin:5,minSlides:1,maxSlides:3,moveSlides:1,nextText:"",prevText:"",useCSS:false,slideSelector:".grid",controls:true,adaptiveHeight:true,preloadImages:"all"};if(C.keyvisualAnimPattern){switch(C.keyvisualAnimPattern){case"1":$.extend(B,{mode:"horizontal"});break;case"2":$.extend(B,{mode:"vertical"});break;case"3":$.extend(B,{mode:"fade",onSlideAfter:function(E,F,G){z.setFitTextOnce(E)}});break}}var A=300;if(C.keyvisualAnimIntervalTime){A=parseInt(C.keyvisualAnimIntervalTime)}if(!isNaN(A)){$.extend(B,{speed:A})}if(C.keyvisualAnimShowTime){var D=parseInt(C.keyvisualAnimShowTime);if(!isNaN(D)){$.extend(B,{pause:D})}}if(C.keyvisualAnimAutoStart){$.extend(B,{auto:(C.keyvisualAnimAutoStart==="1")})}return B}function l(A){return A&&A.fileUrl}function s(){if(this.items.length===0){return p.NONE}else{if(this.items.length===1){return p.NORMAL}else{return p.SLIDESHOW}}}function x(){return this.setting}function w(){setTimeout(function(){$("#keyvisual .grid").each(function(){r($(this))})},750)}function k(A){if(A.hasClass("fitted")){return}r(A);A.addClass("fitted")}function r(A){var D=A.find(".title").width();var C=D/506;var E=C*2.3;E=(C<1)?2.5:E+0.3;var B=(C<1)?0.42:D/1204;A.find(".title").width(B*100+"%");A.find(".date").fitText(4,{minFontSize:12,lineHeightAdjustment:true,heightAdjustment:true,line:1});A.find(".title").fitText(E,{minFontSize:12,lineHeightAdjustment:true,lineHeightAdd:9,heightAdjustment:true,heightAdd:10,line:9});A.find(".button").fitText(1.066)}function q(){$.fn.fitTextRemove();$("#keyvisual .grid").removeClass("fitted")}z.prototype={constructor:z,getType:s,toHtml:t,getSetting:x};z.LAYOUT=o;z.PAGE_TYPE=u;z.TYPE=p;z.setFitTextAll=w;z.setFitTextOnce=k;z.clearFitText=q;return z}());var c=(function(){var l={NONE:"0",BOTH:"1",PC:"2",SP:"3"};function o(r,t,s){this.html=r;this.title=new e(this.html,t.prop,s);this.announceDate=new h(this.html,t.prop,s);this.Button=new d(this.html,t.prop,s);this.link=new a(this.html,t.prop,s);this.parts=[this.title,this.announceDate,this.Button];this.data=t}function p(){$.each(this.parts,function(){this.setContents()});this.link.setContents()}function k(){$.each(this.parts,function(){this.setCss()})}function n(r){if(!r){this.html.find(".grid-header").remove();this.html.find(".grid-body").remove();this.html.find(".category-box").remove();this.html.find(".share").remove();this.html.find(".thumb .grid-thumbnail").prependTo(this.html.find(".thumb"));this.html.find(".thumb a").remove()}q.call(this);if(r){p.call(this);k.call(this);this.title.getElement().hover(j)}return this.html}function q(){this.html.removeClass("is-text");this.html.find(".thumb .grid-thumbnail").removeClass("lazy").attr("src",this.data.image.fileUrl);this.html.find(".thumb .grid-thumbnail").attr("alt",(this.data.prop.keyvisualAlt?f.Common.Util.unescapeHTML(this.data.prop.keyvisualAlt):""))}function j(){$("#keyvisual").toggleClass("hoverTopGrid")}function m(s,u,t){var r;switch(u){case l.BOTH:r=true;break;case l.PC:r=(s===i.LAYOUT.PC)?true:false;break;case l.SP:r=(s===i.LAYOUT.SP)?true:false;break;case l.NONE:r=false;break;default:r=t}return r}o.prototype={constructor:o,toHtml:n};o.DISP_TYPE=l;o.isDisp=m;return o}());var e=(function(){function k(n,p,o){this.pelem=n;this.elem=n.find(".title");this.enable=c.isDisp(o,p.keyvisualTitleEnable,true);this.text=p.keyvisualTitle&&p.keyvisualTitle.replace(/\r?\n/g,"<br>");this.decoration=new g(p.keyvisualFontColor,(p.keyvisualTextShadow?p.keyvisualTextShadow:"1"));this.position=new b(this.defaultPos,p.keyvisualTextPosition,p.keyvisualTitlePositionXType,p.keyvisualTitlePositionXVol,p.keyvisualTitlePositionYType,p.keyvisualTitlePositionYVol)}function m(){if(this.text){this.elem.html(this.text)}}function j(){var n={};if(this.enable){n=$.extend(this.position.getCss(true),this.decoration.getCss())}else{n={display:"none"}}this.elem.css(n)}function l(){return this.elem}k.prototype={defaultPos:{xLeft:3,xRight:8,yTop:20},constructor:k,setContents:m,setCss:j,getElement:l};return k}());var h=(function(){function k(m,o,n){this.elem=m.find(".grid-header .date");this.enable=c.isDisp(n,o.keyvisualAnnounceDate,c.DISP_TYPE.PC);this.text=o.keyvisualAnnouncementDateString;this.decoration=new g(o.keyvisualFontColor,o.keyvisualTextShadow);this.position=new b(this.defaultPos,o.keyvisualTextPosition,o.keyvisualAnnounceDatePositionXType,o.keyvisualAnnounceDatePositionXVol,o.keyvisualAnnounceDatePositionYType,o.keyvisualAnnounceDatePositionYVol)}function l(){if(this.text){this.elem.html(this.text)}}function j(){var n={};var m={};if(this.enable){m=this.position.getCss(true);n=this.decoration.getCss()}else{m={display:"none"}}this.elem.css(n);this.elem.parent().css(m)}k.prototype={defaultPos:{xLeft:3,xRight:8,yTop:13},constructor:k,setContents:l,setCss:j};return k}());var d=(function(){function j(m,o,n){this.elem=null;this.pelem=m.find(".grid-body");this.enable=c.isDisp(n,o.keyvisualButtonEnable,c.DISP_TYPE.PC);this.image=o.keyvisualButton&&o.keyvisualButton.fileUrl;this.text=o.keyvisualButtonTitle?o.keyvisualButtonTitle.replace(/\r?\n/g,"<br>"):"";this.position=new b(this.defaultPos,o.keyvisualTextPosition,o.keyvisualButtonPositionXType,o.keyvisualButtonPositionXVol,o.keyvisualButtonPositionYType,o.keyvisualButtonPositionYVol)}function l(){if(!this.enable){return}var n=$("<a/>").addClass("button");if(this.image){var m=$("<img/>").attr({src:this.image,alt:"button"});n.addClass("image").append(m)}else{n.addClass("text btn01 l-text-ellipsis").html(this.text)}this.elem=n;this.elem.data(this.position);this.pelem.append(n)}function k(){if(!this.enable){return}this.elem.css(this.position.getCss(false))}j.prototype={defaultPos:{xLeft:3,xRight:8,yTop:30},constructor:j,setContents:l,setCss:k};return j}());var a=(function(){var n={NONE:"0",DYNAMIC:"1",STATIC:"2"};var l={SELF:"1",BLANK:"2"};function k(o,r,q){this.elem=o;var p=r.keyvisualLinkJump;this.enable=p!==n.NONE;this.href=(p===n.STATIC)?r.keyvisualLinkUrl:r.origHref;var s=(r.keyvisualLinkTarget===l.SELF)?"_self":"_blank";this.target=(p===n.STATIC)?s:r.origTarget;this.isKeyvisualTitleEnable=c.isDisp(q,r.keyvisualTitleEnable,true)}function m(){if(this.enable&&this.href){this.elem.find("a").not(".addthis_toolbox > *,.category").attr({href:this.href,target:this.target});if(this.elem.find(".addthis_toolbox").length>0){this.elem.find(".addthis_toolbox").attr("addthis:url",this.href)}}else{var s=this.elem.find(".thumb");var r=s.find("img");s.append(r);var q=this.elem.find(".grid-body");var o=q.find("a.title").text();var p=$("<span />").addClass("title").text(o);if(!this.isKeyvisualTitleEnable){p.css("display","none")}q.append(p);this.elem.find("a").remove()}}function j(){}k.prototype={constructor:k,setContents:m,setCss:j};return k}());var g=(function(){function k(l,m){this.fontColor=l&&("#"+l);this.shadowEnabled=(m==="1")}function j(){var l={};if(this.fontColor){$.extend(l,{color:this.fontColor})}if(!this.shadowEnabled){$.extend(l,{"text-shadow":"none",filter:"none"})}return l}k.prototype={constructor:k,getCss:j};return k}());var b=(function(){var o={LEFT:"1",RIGHT:"2"};var n={LEFT:"1",RIGHT:"2"};var j={ABOVE:"1",BELOW:"2"};function k(q,u,t,s,r,p){this.defaultPos=q;this.align=u;this.xType=t||n.LEFT;this.yType=r||j.ABOVE;this.xVol=s?Number(s):0;this.yVol=p?Number(p):0}function l(r){var s={};if(this.align===o.RIGHT){var q=this.defaultPos.xRight+(this.xType===n.LEFT?this.xVol:-this.xVol);$.extend(s,{right:q+"%",left:"auto"},(r?{"text-align":"right"}:{}))}else{var q=this.defaultPos.xLeft+(this.xType===n.LEFT?-this.xVol:this.xVol);$.extend(s,{left:q+"%",right:"auto"},(r?{"text-align":"left"}:{}))}var p=this.defaultPos.yTop+(this.yType===j.ABOVE?-this.yVol:this.yVol);$.extend(s,{top:p+"%"});return s}function m(r){var p=r.parent+r.margin;if(Number(this.yVol)>0){var q=r.base*this.yVol/100;p+=(this.yType===j.ABOVE?-q:q)}return{top:p+"px"}}k.prototype={constructor:k,getCss:l,getOffset:m};return k}());f.Keyvisuals=i}(TMC));